000010 IDENTIFICATION DIVISION.                                         00000100
000020 PROGRAM-ID.     BQVFB9.                                          00000200
000030 AUTHOR. N9143 - R. D'ELIA.                                       00000300
000040 DATE-WRITTEN.  06/04/2000.                                       00000400
000050*************************************************************     00000500
000060*$1 TITOLO - CONTROLLI ASSEGNO NON A BUON FINE - RECORD V49       00000600
000070*************************************************************     00000700
000080*$1 FUNZIONI SVOLTE E LOGICA DI ELABORAZIONE                      00000800
000090*   IL COMPONENTE RICEVE IN INPUT I DATI RELATIVI AL RECORD       00000900
000100*   DI TIPO V49 E SVOLGE DEI CONTROLLI FORMALI E DI               00001000
000110*   CONGRUENZA SUI CAMPI.                                         00001100
000120*   IN CASO DI INCORRETTEZZE PROVVEDE AD IMPOSTARE (NELLO         00001200
000130*   STESSO MODULO) DEI CODICI DI ERRORE ED INCREMENTA I           00001300
000140*   CONTATORI RELATIVI AL TIPO DI ERRORE (BLOCCANTE/NON           00001400
000150*   BLOCCANTE)                                                    00001500
000160*                                                                 00001600
000170* 2. ARCHIVI GESTITI                                              00001700
000180*      NESSUNO                                                    00001800
000190*                                                                 00001900
000200* 3. SUBROUTINES RICHIAMATE                                       00002000
000210*      NOME     DESCRIZIONE                                       00002100
000220*    BQVFDA    CONTROLLO DATE                                     00002200
000230*    BQVFSR    ROUTINE DI ABEND                                   00002300
000240*    BQVFB3    CONTROLLO FORMALE DEL CODICE FISCALE               00002400
000250*                                                                 00002500
000260 ENVIRONMENT DIVISION.                                            00002600
000270 CONFIGURATION SECTION.                                           00002700
000280 SPECIAL-NAMES.                                                   00002800
000290     DECIMAL-POINT IS COMMA.                                      00002900
000300 INPUT-OUTPUT SECTION.                                            00003000
000310 FILE-CONTROL.                                                    00003100
000320 DATA DIVISION.                                                   00003200
000330 FILE SECTION.                                                    00003300
000340***************  WORKING STORAGE SECTION  **********************  00003400
000350 WORKING-STORAGE SECTION.                                         00003500
000360 77  W-S                            PIC X(8) VALUE 'BQVFB9WS'.    00003600
000370 77  W-ABEND-CODE                   PIC 9(004).                   00003700
000380** CODICE AMBITO LETTO DAL FILE                                   00003800
000390 77  W-AMBITO-INP                PIC X(3).                        00003900
000400** CODICE REGIONE LETTO DAL FILE                                  00004000
000410 77  W-REGIONE-INP               PIC X(2).                        00004100
000420** CODICE PROVINCIA LETTA DAL FILE                                00004200
000430 77  W-PROV-INP                  PIC X(2).                        00004300
000440** CODICE AZIENDA LETTA DAL FILE                                  00004400
000450 77  W-AZIENDA-INP               PIC X(5).                        00004500
000460 77  W-FLAG-TROVATO              PIC 9(1).                        00004600
000470*---               TRACCIATO RECORD "ESITI" - BANCA               00004700
000480     COPY 'FBQVFB21'.                                             00004800
000490*---               TRACCIATO RECORD "ESITI" - CONCESSIONARIO      00004900
000500*    COPY 'FBQVFD21'.                                             00005000
000510*---        CAMPI APPOGGIO PER SEGNO E RELATIVI ERRORI            00005100
000520 01  W-SEGNO                       PIC X(001).                    00005200
000530 01  W-SEGNO-ERR                   PIC 9(003).                    00005300
000540 01  W-SEGNO-ERR-A                 PIC X(001).                    00005400
000550*---        CAMPI APPOGGIO PER SALDO E RELATIVI ERRORI            00005500
000560 01  W-SALDO                       PIC 9(015).                    00005600
000570 01  W-SALDOA REDEFINES W-SALDO    PIC X(015).                    00005700
000580 01  W-SALDO-ERR                   PIC 9(003).                    00005800
000590 01  W-SALDO-ERR-A                 PIC X(001).                    00005900
000600*---                                                              00006000
000610 01  W-SALDO-P                     PIC 9(015).                    00006100
000620 01  W-SALDO-N                     PIC 9(015).                    00006200
000630 01  W-DIFF                        PIC S9(015).                   00006300
000640 01  W-DIFF1 REDEFINES W-DIFF      PIC 9(015).                    00006400
000650*---                                                              00006500
000660*---     CAMPI APPOGGIO PER  CONTROLLO DATA                       00006600
000670 01  W-DATA-PASS                       PIC 9(6).                  00006700
000680*---                                                              00006800
000690 01  W-DATA-INPUT.                                                00006900
000700     03  W-DATA-INP-SS                 PIC 99.                    00007000
000710     03  W-DATA-INP.                                              00007100
000720         05  W-DATA-INP-AA             PIC 99.                    00007200
000730         05  W-DATA-INP-MM             PIC 99.                    00007300
000740         05  W-DATA-INP-GG             PIC 99.                    00007400
000750*--- CAMPO DI APPOGGIO PER IL CONTROLLO DELLE ULTIME 3 CIFRE DI IM00007500
000760 01  W-IMPORTO.                                                   00007600
000770     03 W-IMPORTO-FILLER               PIC 9(012).                00007700
000780     03 W-IMPORTO-3                    PIC 9(003).                00007800
000790 01  W-IMPORTOA REDEFINES W-IMPORTO.                              00007900
000800     03 W-IMPORTOA-FILLER               PIC 9(013).               00008000
000810     03 W-IMPORTO-2                    PIC 9(002).                00008100
000820*---     CAMPO DI APPOGGIO PER IL CONTROLLO SU REGIONE 1 E REGIONE00008200
000830 01  W-APPO-COD-REG                    PIC X(002).                00008300
000840*--- INDICE UTILIZZATO NELLA PERFORM A2-010 PER CAPIRE SE SI TRATT00008400
000850*--- SALDO REGIONE, O SALDO ERARIO O INPS.                        00008500
000860 01  W-IND                             PIC 9(001).                00008600
000870*                                                                 00008700
000880*--- CAMPI PER I CONTROLLI FORMALI DEL NUMERO DI RIFERIMENTO      00008800
000890 01  W-NUMERO-RIF.                                                00008900
000900     03  W-NUMERO-RIF-10               PIC X(010).                00009000
000910     03  W-NUMERO-RIF-CK               PIC X(001).                00009100
000920 01  CHECK-DIGIT                       PIC X(001).                00009200
000930*                                                                 00009300
000940*---     CAMPI PER CONTROLLO CF                                   00009400
000950 01  W-APPO-CF.                                                   00009500
000960     03  W-APPO-CF-SX                  PIC X(011).                00009600
000970     03  W-APPO-CF-DX                  PIC X(005).                00009700
000980*---                                                              00009800
000990 01  W-APPO-CF-RED REDEFINES W-APPO-CF.                           00009900
001000     03  FILLER                        PIC X(005).                00010000
001010     03  W-APPO-CF-RED-DX              PIC X(011).                00010100
001020*---                                                              00010200
001030 01  W-PARAM-BQVFB3.                                              00010300
001040     03  W-BQVFB3-COD-FISC                 PIC X(016).            00010400
001050     03  W-BQVFB3-COD-RIT                  PIC X(001).            00010500
001060*                                                                 00010600
001070*---     COPY PER ROUTINE CONTROLLO DATE                          00010700
001080     COPY 'FBQVFDA1'.                                             00010800
001090*                                                                 00010900
001100*------------------------------------------------                 00011000
001110* INIZIO MODIFICA CODICE A BARRE - 12/2004                        00011100
001120*                                                                 00011200
001130 01  W-ID-PAGAM                     PIC 9(018).                   00011300
001140 01  W-ID-PAGAM-R REDEFINES                                       00011400
001150     W-ID-PAGAM                     PIC X(018).                   00011500
001160*                                                                 00011600
001170 01  W-IDENT-PAGAM                  PIC 9(018).                   00011700
001180 01  W-IDENT-PAGAM-R REDEFINES                                    00011800
001190     W-IDENT-PAGAM.                                               00011900
001200     03  W-IDENT-PAGAM-16           PIC 9(016).                   00012000
001210     03  W-IDENT-PAGAM-16-R REDEFINES                             00012100
001220         W-IDENT-PAGAM-16.                                        00012200
001230        05  W-IDENT-PAGAM-15        PIC 9(015).                   00012300
001240        05  W-IDENT-PAGAM-C1        PIC 9(001).                   00012400
001250     03  W-IDENT-PAGAM-C2           PIC 9(002).                   00012500
001260*                                                                 00012600
001270 01  W-IDENT-PAGAM-CALC-16      PIC 9(016).                       00012700
001280 01  W-IDENT-PAGAM-CALC-16-R REDEFINES                            00012800
001290     W-IDENT-PAGAM-CALC-16.                                       00012900
001300    03  W-IDENT-PAGAM-CALC-15        PIC 9(015).                  00013000
001310    03  W-IDENT-PAGAM-CALC-C1        PIC 9(001).                  00013100
001320*                                                                 00013200
001330 01  W-IND1                         PIC 9(002).                   00013300
001340 01  W-IND2                         PIC 9(002).                   00013400
001350*                                                                 00013500
001360 01  W-RESTO-PAGAM                  PIC 9(002).                   00013600
001370* INIZIO MODIFICA GM                                              00013700
001380*01  W-APPO-DIVIDE                  PIC 9(001).                   00013800
001390 01  W-APPO-DIVIDE                  PIC 9(008).                   00013900
001400 01  W-RESTO-PAGAM1                 PIC 9(002).                   00014000
001410 01  W-RESTO-PAGAM2                 PIC 9(002).                   00014100
001420* FINE MODIFICA GM                                                00014200
001430*                                                                 00014300
001440 01  W-TOTALE1                      PIC 9(016).                   00014400
001450 01  W-TOTALE1-TAB REDEFINES W-TOTALE1.                           00014500
001460     03  W-TOTALE1-EL OCCURS 16    PIC 9(001).                    00014600
001470*                                                                 00014700
001480 01  W-TOTALE2                      PIC 9(003).                   00014800
001490*                                                                 00014900
001500 01  W-APPO-TOTALE3                 PIC 9(003).                   00015000
001510*                                                                 00015100
001520 01  W-TOTALE3                      PIC 9(003).                   00015200
001530 01  W-TOTALE3A   REDEFINES                                       00015300
001540     W-TOTALE3.                                                   00015400
001550    03  W-TOTALE3-1-2               PIC 9(002).                   00015500
001560    03  W-TOTALE3-3                 PIC 9(001).                   00015600
001570*                                                                 00015700
001580 01  W-TOTALE4                      PIC 9(002).                   00015800
001590 01  W-TOTALE4A   REDEFINES                                       00015900
001600     W-TOTALE4.                                                   00016000
001610    03  W-TOTALE4-1                 PIC 9(001).                   00016100
001620    03  W-TOTALE4-2                 PIC 9(001).                   00016200
001630*                                                                 00016300
001640* FINE MODIFICA CODICE A BARRE - 12/2004                          00016400
001650*                                                                 00016500
001660* INIZIO MODIFICA GM PER PC                                       00016600
001670 01  W-APPO-PAGAM-CALC.                                           00016700
001680     03 W-IDENT-PAGAM-CALC-A         PIC 9(8).                    00016800
001690     03 W-IDENT-PAGAM-CALC-B         PIC 9(8).                    00016900
001700 01 W-IDENT-PAGAM-CALC-10            PIC 9(10).                   00017000
001710* FINE MODIFICA GM PER PC                                         00017100
001720*------------------------------------------------                 00017200
001730********************** LINKAGE SECTION ***************************00017300
001740*                                                                 00017400
001750 LINKAGE SECTION.                                                 00017500
001760*----                                                             00017600
001770*---               AREA DI COLLOQUIO                              00017700
001780*----                                                             00017800
001790*---     FLAG INDICANTE LA PROVENIENZA:                           00017900
001800*---   .. "B" BANCA;                                              00018000
001810*---   .. "C" CONCESSIONARIO                                      00018100
001820 01  W-PROV                        PIC X(001).                    00018200
001830*---     AREA DATI RELATIVA AL FILE ESITO                         00018300
001840 01  W-DATI                        PIC X(512).                    00018400
001850*---   CONTATORE ERRORI NON BLOCCANTI                             00018500
001860 01  W-CTR1                        PIC 9(009).                    00018600
001870*---   CONTATORE ERRORI BLOCCANTI                                 00018700
001880 01  W-CTR2                        PIC 9(009).                    00018800
001890*---                                                              00018900
001900**TABELLA CONTENETE I CODICI AZIENDA PRELEVATI DAL FILE SEQ.      00019000
001910**BQVFAZ  (PER I CONTROLLI CUI CODICI ABI)                        00019100
001920*---                                                              00019200
001930 01  W-TAB-AZIENDE.                                               00019300
001940     03 W-TAB-AZIENDE-NUM-MAX    PIC 9(004) VALUE 2000.           00019400
001950     03 W-TAB-AZIENDE-OCC.                                        00019500
001960        05 W-TAB-AZIENDE-EL      OCCURS 2000 TIMES                00019600
001970                                 ASCENDING W-TAB-AZ-COD-NUM       00019700
001980                                 INDEXED BY W-PUNT-AZIENDE.       00019800
001990           07 W-TAB-AZ-COD-NUM PIC 9(005).                        00019900
002000           07 W-TAB-AZ-COD-ALF   REDEFINES                        00020000
002010                    W-TAB-AZ-COD-NUM   PIC X(005).                00020100
002020*---                                                              00020200
002030**TABELLA CONTENETE I CODICI REGIONI PRELEVATI DAL FILE BQVFRE    00020300
002040*---                                                              00020400
002050 01  W-TAB-REGIONI.                                               00020500
002060     03 W-TAB-REGIONI-NUM-MAX        PIC 9(002) VALUE 50.         00020600
002070     03 W-TAB-REGIONI-OCC.                                        00020700
002080        05 W-TAB-REGIONI-EL OCCURS    50 TIMES                    00020800
002090                                    ASCENDING W-TAB-REGIONI-COD   00020900
002100                                    INDEXED BY W-PUNT-REGIONI.    00021000
002110           07 W-TAB-REGIONI-COD      PIC X(002).                  00021100
002120*---                                                              00021200
002130**TABELLA CONTENETE I CODICI PROVINCE PRELEVATI DAL FILE BQVFPR   00021300
002140*---                                                              00021400
002150 01  W-TAB-PROV.                                                  00021500
002160     03 W-TAB-PROV-NUM-MAX        PIC 9(003) VALUE 150.           00021600
002170     03 W-TAB-PROV-OCC.                                           00021700
002180        05 W-TAB-PROV-EL OCCURS   150 TIMES                       00021800
002190                                    ASCENDING W-TAB-PROV-COD      00021900
002200                                    INDEXED BY W-PUNT-PROV.       00022000
002210           07 W-TAB-PROV-COD      PIC X(002).                     00022100
002220********************** PROCEDURE DIVISION ************************00022200
002230*                                                                 00022300
002240 PROCEDURE DIVISION   USING W-PROV W-DATI W-CTR1 W-CTR2           00022400
002250                            W-TAB-AZIENDE                         00022500
002260                            W-TAB-REGIONI W-TAB-PROV.             00022600
002270 ML-010-INIZIO.                                                   00022700
002280*---   INIZIALIZZAZIONE DELLE AREE DI LAVORO                      00022800
002290     MOVE ZERO                      TO W-DIFF.                    00022900
002300     MOVE ZERO                      TO W-DIFF1.                   00023000
002310     MOVE ZERO                      TO W-SALDO-P.                 00023100
002320     MOVE ZERO                      TO W-SALDO-N.                 00023200
002330     PERFORM RZ-010-INIZIA THRU RZ-010-INIZIA-EX.                 00023300
002340*---   IMPOSTAZIONE AREA DI PASSAGGIO RELATIVA AI DATI E          00023400
002350*---   ALLA TABELLA DI TOTALIZZAZIONE A SECONDA DELLA PROVENIENZA 00023500
002360*---                                                              00023600
002370*    IF W-PROV EQUAL 'B'                                          00023700
002380*      GO TO ML-030.                                              00023800
002390*ML-020.                                                          00023900
002400*    MOVE W-DATI                    TO BQVFD21.                   00024000
002410*---   ROUTINE PER IMPOSTARE I CAMPI DELLA COPY FBQVFD21 IN       00024100
002420*---   FBQVFB21.                                                  00024200
002430*---                                                              00024300
002440*    PERFORM RX-010-BANCA THRU RX-010-BANCA-EX.                   00024400
002450*    GO TO ML-040.                                                00024500
002460 ML-030.                                                          00024600
002470     MOVE W-DATI                    TO BQVFB21.                   00024700
002480 ML-040.                                                          00024800
002490*---                                                              00024900
002500*---        ROUTINE DI CONTROLLO SALDI                            00025000
002510*---                                                              00025100
002520     PERFORM A1-010-SALDI THRU A1-010-SALDI-EX.                   00025200
002530*---                                                              00025300
002540*---   ROUTINE DI CONTROLLO FORMALE DEI CAMPI CODICE CAB,         00025400
002550*---   MODALITA' DI CONFERIMENTO DELEGA, DATA BONIFICO,           00025500
002560*---   IMPORTO SCOPERTO, COD. ABI BANCA TRASSATA/EMITTENTE,       00025600
002570*---   COD. CAB DIPENDENZA TRASSATA/EMITTENTE,  NUMERO ASSEGNO,   00025700
002580*---   PROGRESSIVO RIGA, SIGLA PROVINCIA, PROG. ACCRED./BONIFICIO,00025800
002590*---   COD. CONCESSIONE (E RALATIVO FLAG ERRORE), CODICE FISCALE, 00025900
002600*---   (E RELATIVO FLAG ERRORE), DATA RISCOSSIONE,                00026000
002610*---   CODICE PRIMA E SECONDA REGIONE, NUM. RECORD ERARIO,        00026100
002620*---   NUM. RECORD INPS, NUM. RECORD REGIONI E NUMERO QUIETANZA.  00026200
002630*---                                                              00026300
002640     PERFORM B1-010-CONTR-FORM THRU B1-010-CONTR-FORM-EX.         00026400
002650*--- NEW:                                                         00026500
002660     PERFORM C1-010-CONTR-FORM THRU C1-010-CONTR-FORM-EX.         00026600
002670*---                                                              00026700
002680*    IF W-PROV EQUAL 'B'                                          00026800
002690*      GO TO ML-060.                                              00026900
002700 ML-050.                                                          00027000
002710*---   ROUTINE PER IMPOSTARE I CAMPI DELLA COPY FBQVFB21 IN       00027100
002720*---   FBQVFD21.                                                  00027200
002730*---                                                              00027300
002740*    PERFORM RY-010-CONC THRU RY-010-CONC-EX.                     00027400
002750*    MOVE BQVFD21             TO W-DATI.                          00027500
002760*    GO TO ML-990.                                                00027600
002770 ML-060.                                                          00027700
002780     MOVE BQVFB21             TO W-DATI.                          00027800
002790 ML-990.                                                          00027900
002800     GOBACK.                                                      00028000
002810*-------------------------------------------------------------    00028100
002820*---     SI EFFETTUANO DEI CONTROLLI FORMALI E DI QUADRATURA      00028200
002830*---     SUI SALDI                                                00028300
002840*-------------------------------------------------------------    00028400
002850 A1-010-SALDI.                                                    00028500
002860*---   IMPOSTAZIONE CAMPI PER CONTROLLO ERARIO                    00028600
002870     MOVE ZERO                            TO W-SEGNO-ERR.         00028700
002880     MOVE ZERO                            TO W-SEGNO-ERR-A.       00028800
002890     MOVE ZERO                            TO W-SALDO-ERR.         00028900
002900     MOVE ZERO                            TO W-SALDO-ERR-A.       00029000
002910     MOVE 1                               TO W-IND.               00029100
002920     MOVE BQVFB21-49-SEGNO-ERARIO         TO W-SEGNO.             00029200
002930*    MOVE BQVFB21-49-SALDO-ERARIOA        TO W-SALDOA.            00029300
002940     MOVE BQVFB21-49-SALDO-ERARIO         TO W-SALDO.             00029400
002950*---                                                              00029500
002960     PERFORM A2-010-SAL-PAR THRU A2-010-SAL-PAR-EX.               00029600
002970*---                                                              00029700
002980*---   IMPOSTAZIONE DEI CAMPI RESTITUITI DALLA ROUTINE PRIMA      00029800
002990*---   RICHIAMATA NEI CAMPI DEL FILE DATI.                        00029900
003000     MOVE W-SEGNO-ERR           TO BQVFB21-49-ERR-SEGNO-ERARIO.   00030000
003010     MOVE W-SEGNO-ERR-A         TO BQVFB21-49-ERR-SEGNO-ERARIO-A. 00030100
003020     MOVE W-SALDO-ERR           TO BQVFB21-49-ERR-SALDO-ERARIO.   00030200
003030     MOVE W-SALDO-ERR-A         TO BQVFB21-49-ERR-SALDO-ERARIO-A. 00030300
003040*---   IMPOSTAZIONE CAMPI PER CONTROLLO INPS                      00030400
003050     MOVE ZERO                            TO W-SEGNO-ERR.         00030500
003060     MOVE ZERO                            TO W-SEGNO-ERR-A.       00030600
003070     MOVE ZERO                            TO W-SALDO-ERR.         00030700
003080     MOVE ZERO                            TO W-SALDO-ERR-A.       00030800
003090     MOVE 2                               TO W-IND.               00030900
003100     MOVE BQVFB21-49-SEGNO-INPS           TO W-SEGNO.             00031000
003110     MOVE BQVFB21-49-SALDO-INPSA          TO W-SALDOA.            00031100
003120*---                                                              00031200
003130     PERFORM A2-010-SAL-PAR THRU A2-010-SAL-PAR-EX.               00031300
003140*---                                                              00031400
003150*---   IMPOSTAZIONE DEI CAMPI RESTITUITI DALLA ROUTINE PRIMA      00031500
003160*---   RICHIAMATA NEI CAMPI DEL FILE DATI.                        00031600
003170*---                                                              00031700
003180     MOVE W-SEGNO-ERR           TO BQVFB21-49-ERR-SEGNO-INPS.     00031800
003190     MOVE W-SEGNO-ERR-A         TO BQVFB21-49-ERR-SEGNO-INPS-A.   00031900
003200     MOVE W-SALDO-ERR           TO BQVFB21-49-ERR-SALDO-INPS.     00032000
003210     MOVE W-SALDO-ERR-A         TO BQVFB21-49-ERR-SALDO-INPS-A.   00032100
003220*---   IMPOSTAZIONE CAMPI PER CONTROLLO REGIONE SEZIONE 1         00032200
003230     MOVE ZERO                            TO W-SEGNO-ERR.         00032300
003240     MOVE ZERO                            TO W-SEGNO-ERR-A.       00032400
003250     MOVE ZERO                            TO W-SALDO-ERR.         00032500
003260     MOVE ZERO                            TO W-SALDO-ERR-A.       00032600
003270     MOVE 3                               TO W-IND.               00032700
003280     MOVE BQVFB21-49-SEGNO-REG            TO W-SEGNO.             00032800
003290     MOVE BQVFB21-49-SALDO-REGA           TO W-SALDOA.            00032900
003300*---                                                              00033000
003310     PERFORM A2-010-SAL-PAR THRU A2-010-SAL-PAR-EX.               00033100
003320*---                                                              00033200
003330*---   IMPOSTAZIONE DEI CAMPI RESTITUITI DALLA ROUTINE PRIMA      00033300
003340*---   RICHIAMATA NEI CAMPI DEL FILE DATI.                        00033400
003350     MOVE W-SEGNO-ERR           TO BQVFB21-49-ERR-SEGNO-REG.      00033500
003360     MOVE W-SEGNO-ERR-A         TO BQVFB21-49-ERR-SEGNO-REG-A.    00033600
003370     MOVE W-SALDO-ERR           TO BQVFB21-49-ERR-SALDO-REG.      00033700
003380     MOVE W-SALDO-ERR-A         TO BQVFB21-49-ERR-SALDO-REG-A.    00033800
003390*---   IMPOSTAZIONE CAMPI PER CONTROLLO ALTRI ENTI                00033900
003400     MOVE ZERO                            TO W-SEGNO-ERR.         00034000
003410     MOVE ZERO                            TO W-SEGNO-ERR-A.       00034100
003420     MOVE ZERO                            TO W-SALDO-ERR.         00034200
003430     MOVE ZERO                            TO W-SALDO-ERR-A.       00034300
003440     MOVE 4                               TO W-IND.               00034400
003450     MOVE BQVFB21-49-SEGNO-ENTE           TO W-SEGNO.             00034500
003460     MOVE BQVFB21-49-SALDO-ENTE           TO W-SALDOA.            00034600
003470*    MOVE BQVFB21-49-COD-REG2A            TO W-APPO-COD-REG.      00034700
003480*---                                                              00034800
003490     PERFORM A2-010-SAL-PAR THRU A2-010-SAL-PAR-EX.               00034900
003500*---                                                              00035000
003510*---   IMPOSTAZIONE DEI CAMPI RESTITUITI DALLA ROUTINE PRIMA      00035100
003520*---   RICHIAMATA NEI CAMPI DEL FILE DATI.                        00035200
003530     MOVE W-SEGNO-ERR           TO BQVFB21-49-ERR-SEGNO-ENTE.     00035300
003540     MOVE W-SEGNO-ERR-A         TO BQVFB21-49-ERR-SEGNO-ENTE-A.   00035400
003550     MOVE W-SALDO-ERR           TO BQVFB21-49-ERR-SALDO-ENTE.     00035500
003560     MOVE W-SALDO-ERR-A         TO BQVFB21-49-ERR-SALDO-ENTE-A.   00035600
003570*---   IMPOSTAZIONE CAMPI PER CONTROLLO INAIL                     00035700
003580     MOVE ZERO                            TO W-SEGNO-ERR.         00035800
003590     MOVE ZERO                            TO W-SEGNO-ERR-A.       00035900
003600     MOVE ZERO                            TO W-SALDO-ERR.         00036000
003610     MOVE ZERO                            TO W-SALDO-ERR-A.       00036100
003620     MOVE 5                               TO W-IND.               00036200
003630     MOVE BQVFB21-49-SEGNO-INAIL          TO W-SEGNO.             00036300
003640     MOVE BQVFB21-49-SALDO-INAIL          TO W-SALDOA.            00036400
003650*    MOVE BQVFB21-49-COD-REG2A            TO W-APPO-COD-REG.      00036500
003660*---                                                              00036600
003670     PERFORM A2-010-SAL-PAR THRU A2-010-SAL-PAR-EX.               00036700
003680*---                                                              00036800
003690*---   IMPOSTAZIONE DEI CAMPI RESTITUITI DALLA ROUTINE PRIMA      00036900
003700*---   RICHIAMATA NEI CAMPI DEL FILE DATI.                        00037000
003710     MOVE W-SEGNO-ERR           TO BQVFB21-49-ERR-SEGNO-INAIL     00037100
003720     MOVE W-SEGNO-ERR-A         TO BQVFB21-49-ERR-SEGNO-INAIL-A.  00037200
003730     MOVE W-SALDO-ERR           TO BQVFB21-49-ERR-SALDO-INAIL     00037300
003740     MOVE W-SALDO-ERR-A         TO BQVFB21-49-ERR-SALDO-INAIL-A.  00037400
003750*---   IMPOSTAZIONE CAMPI PER CONTROLLO ALTRI ENTI                00037500
003760     MOVE ZERO                            TO W-SEGNO-ERR.         00037600
003770     MOVE ZERO                            TO W-SEGNO-ERR-A.       00037700
003780     MOVE ZERO                            TO W-SALDO-ERR.         00037800
003790     MOVE ZERO                            TO W-SALDO-ERR-A.       00037900
003800     MOVE 6                               TO W-IND.               00038000
003810     MOVE BQVFB21-49-SEGNO-ALTRI          TO W-SEGNO.             00038100
003820     MOVE BQVFB21-49-SALDO-ALTRI          TO W-SALDOA.            00038200
003830*    MOVE BQVFB21-49-COD-REG2A            TO W-APPO-COD-REG.      00038300
003840*---                                                              00038400
003850     PERFORM A2-010-SAL-PAR THRU A2-010-SAL-PAR-EX.               00038500
003860*---                                                              00038600
003870*---   IMPOSTAZIONE DEI CAMPI RESTITUITI DALLA ROUTINE PRIMA      00038700
003880*---   RICHIAMATA NEI CAMPI DEL FILE DATI.                        00038800
003890     MOVE W-SEGNO-ERR           TO BQVFB21-49-ERR-SEGNO-ALTRI     00038900
003900     MOVE W-SEGNO-ERR-A         TO BQVFB21-49-ERR-SEGNO-ALTRI-A.  00039000
003910     MOVE W-SALDO-ERR           TO BQVFB21-49-ERR-SALDO-ALTRI     00039100
003920     MOVE W-SALDO-ERR-A         TO BQVFB21-49-ERR-SALDO-ALTRI-A.  00039200
003930*                                                                 00039300
003940*---   IMPOSTAZIONE CAMPI PER CONTROLLO SALDO ACCISE              00039400
003950*                                                                 00039500
003960     MOVE ZERO                            TO W-SEGNO-ERR.         00039600
003970     MOVE ZERO                            TO W-SEGNO-ERR-A.       00039700
003980     MOVE ZERO                            TO W-SALDO-ERR.         00039800
003990     MOVE ZERO                            TO W-SALDO-ERR-A.       00039900
004000     MOVE 7                               TO W-IND.               00040000
004010     MOVE BQVFB21-49-SEGNO-ACCISE         TO W-SEGNO.             00040100
004020     MOVE BQVFB21-49-SALDO-ACCISE         TO W-SALDO.             00040200
004030*                                                                 00040300
004040     PERFORM A2-010-SAL-PAR THRU A2-010-SAL-PAR-EX.               00040400
004050*                                                                 00040500
004060*---   IMPOSTAZIONE DEI CAMPI RESTITUITI DALLA ROUTINE PRIMA      00040600
004070*---   RICHIAMATA NEI CAMPI DEL FILE DATI.                        00040700
004080*                                                                 00040800
004090     MOVE W-SEGNO-ERR           TO BQVFB21-49-ERR-SEGNO-ACCISE.   00040900
004100     MOVE W-SEGNO-ERR-A         TO BQVFB21-49-ERR-SEGNO-ACCISE-A. 00041000
004110     MOVE W-SALDO-ERR           TO BQVFB21-49-ERR-SALDO-ACCISE.   00041100
004120     MOVE W-SALDO-ERR-A         TO BQVFB21-49-ERR-SALDO-ACCISE-A. 00041200
004130*                                                                 00041300
004140                                                                  00041400
004150*---        SI CONTROLLA IL SALDO FINALE                          00041500
004160*---   SI CONTROLLA LA NUMERICITA' DEL SALDO FINALE               00041600
004170     IF BQVFB21-49-SALDO-FINALEA NUMERIC                          00041700
004180       GO TO A1-020.                                              00041800
004190 A1-015.                                                          00041900
004200*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00042000
004210     MOVE 33                     TO BQVFB21-49-ERR-SALDO-FINALE.  00042100
004220     MOVE 'W'                    TO BQVFB21-49-ERR-SALDO-FINALE-A.00042200
004230     ADD  1                      TO W-CTR1.                       00042300
004240     GO TO A1-030.                                                00042400
004250 A1-020.                                                          00042500
004260*---   SI CONTROLLA CHE IL SALDO FINALE SIA DIVERSO DA ZERO E     00042600
004270*---   CHE, SE LA DIVISA E' ITL, LE ULTIME CIFRE SIANO 000        00042700
004280     MOVE BQVFB21-49-SALDO-FINALE TO W-IMPORTO.                   00042800
004290*    IF BQVFB21-49-SALDO-FINALE > ZERO            AND             00042900
004300*       (BQVFB21-49-DIV-OPER NOT EQUAL 'ITL'  OR                  00043000
004310*        (BQVFB21-49-DIV-OPER = 'ITL' AND                         00043100
004320*         W-IMPORTO-3 EQUAL ZERO         )      )                 00043200
004330*INIZIO MODIFICA EURO                                             00043300
004340*CB 30/11/2001                                                    00043400
004350     IF BQVFB21-49-DATA-RISC <= '20011231'                        00043500
004360          IF BQVFB21-49-SALDO-FINALE > ZERO            AND        00043600
004370            ((BQVFB21-49-DIV-OPER NOT EQUAL 'ITL'  AND            00043700
004380              BQVFB21-49-DIV-OPER NOT EQUAL 'EUR')    OR          00043800
004390              (BQVFB21-49-DIV-OPER = 'ITL' AND                    00043900
004400               W-IMPORTO-3 EQUAL ZERO         )       OR          00044000
004410              (BQVFB21-49-DIV-OPER = 'EUR' AND                    00044100
004420              (BQVFB21-49-DATA-BONIF-APPART > '20011231' OR       00044200
004430               W-IMPORTO-2 EQUAL ZERO         )))                 00044300
004440               GO TO A1-030                                       00044400
004450          ELSE                                                    00044500
004460               GO TO A1-025                                       00044600
004470          END-IF                                                  00044700
004480     END-IF.                                                      00044800
004490               GO TO A1-030.                                      00044900
004500*CB 30/11/2001                                                    00045000
004510*FINE   MODIFICA EURO                                             00045100
004520 A1-025.                                                          00045200
004530*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00045300
004540     IF (BQVFB21-49-SALDO-FINALE > ZERO) OR                       00045400
004550        (BQVFB21-49-SALDO-FINALE = ZERO  AND                      00045500
004560         BQVFB21-49-CAUS-ANNUL = 1)                               00045600
004570        MOVE 96                  TO BQVFB21-49-ERR-SALDO-FINALE   00045700
004580        MOVE 'W'                 TO BQVFB21-49-ERR-SALDO-FINALE-A 00045800
004590        ADD  1                   TO W-CTR1.                       00045900
004600 A1-030.                                                          00046000
004610*---   SI CONTROLLA SE E' STATO RISCONTRATO UN ERRORE SUL         00046100
004620*---   SALDO FINALE O SUI SALDI PARZIALI                          00046200
004630     IF BQVFB21-49-ERR-SALDO-FINALE NOT EQUAL ZERO  OR            00046300
004640        BQVFB21-49-ERR-SALDO-ERARIO NOT EQUAL ZERO  OR            00046400
004650        BQVFB21-49-ERR-SALDO-INPS NOT EQUAL ZERO    OR            00046500
004660        BQVFB21-49-ERR-SALDO-REG  NOT EQUAL ZERO    OR            00046600
004670        BQVFB21-49-ERR-SALDO-ENTE NOT EQUAL ZERO    OR            00046700
004680        BQVFB21-49-ERR-SALDO-INAIL NOT EQUAL ZERO   OR            00046800
004690        BQVFB21-49-ERR-SALDO-ALTRI NOT EQUAL ZERO   OR            00046900
004700        BQVFB21-49-ERR-SALDO-ACCISE NOT EQUAL ZERO   OR           00047000
004710        BQVFB21-49-ERR-SEGNO-ERARIO NOT EQUAL ZERO  OR            00047100
004720        BQVFB21-49-ERR-SEGNO-INPS NOT EQUAL ZERO    OR            00047200
004730        BQVFB21-49-ERR-SEGNO-REG  NOT EQUAL ZERO    OR            00047300
004740        BQVFB21-49-ERR-SEGNO-ENTE NOT EQUAL ZERO    OR            00047400
004750        BQVFB21-49-ERR-SEGNO-INAIL NOT EQUAL ZERO   OR            00047500
004760        BQVFB21-49-ERR-SEGNO-ALTRI NOT EQUAL ZERO   OR            00047600
004770        BQVFB21-49-ERR-SEGNO-ACCISE NOT EQUAL ZERO                00047700
004780       GO TO A1-010-SALDI-EX.                                     00047800
004790 A1-040.                                                          00047900
004800*---   NON SONO STATI RISCONTRATI ERRORI SUI CAMPI SALDO:         00048000
004810*---   SI RICHIAMA LA ROUTINE CHE SOMMA IN DUE DISTINTE AREE      00048100
004820*---   I SALDI POSITIVI CON QUELLI NEGATIVI (DICHIARATI)          00048200
004830     PERFORM B2-010-SOMMA THRU B2-010-SOMMA-EX.                   00048300
004840*---   SI CALCOLA LA DIFFERENZA TRA SALDO POSITIVO E NEGATIVO.    00048400
004850     COMPUTE W-DIFF = W-SALDO-P - W-SALDO-N.                      00048500
004860*---   TALE DIFFERENZA NON PUO' ESSERE NEGATIVA E COMUNQUE DEVE   00048600
004870*---   ESSERE PARI AL SALDO FINALE.                               00048700
004880     IF W-DIFF NOT LESS ZERO                    AND               00048800
004890        W-DIFF1 EQUAL BQVFB21-49-SALDO-FINALE                     00048900
004900       GO TO A1-010-SALDI-EX.                                     00049000
004910 A1-050.                                                          00049100
004920*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00049200
004930*    MOVE 503                    TO BQVFB21-49-ERR-SALDO-FINALE.  00049300
004940*    MOVE 'W'                    TO BQVFB21-49-ERR-SALDO-FINALE-A.00049400
004950*    ADD  1                      TO W-CTR1.                       00049500
004960 A1-010-SALDI-EX.                                                 00049600
004970     EXIT.                                                        00049700
004980*---------------------------------------------------------------- 00049800
004990*---   ROUTINE DI CONTROLLO FORMALE DEI CAMPI CODICE CAB,         00049900
005000*---   MODALITA' DI CONFERIMENTO DELEGA, DATA BONIFICO,           00050000
005010*---   IMPORTO SCOPERTO, COD. ABI BANCA TRASSATA/EMITTENTE,       00050100
005020*---   COD. CAB DIPENDENZA TRASSATA/EMITTENTE, NUMERO ASSEGNO,    00050200
005030*---   PROGRESSIVO RIGA, SIGLA PROVINCIA, PROG. ACCRED./BONIFICIO,00050300
005040*---   COD. CONCESSIONE (E RALATIVO FLAG ERRORE), CODICE FISCALE, 00050400
005050*---   (E RELATIVO FLAG ERRORE), DATA RISCOSSIONE,                00050500
005060*---   CODICE PRIMA E SECONDA REGIONE, NUM. RECORD ERARIO,        00050600
005070*---   NUM. RECORD INPS, NUM. RECORD REGIONI E NUMERO QUIETANZA.  00050700
005080*---------------------------------------------------------------- 00050800
005090 B1-010-CONTR-FORM.                                               00050900
005100*---   SI CONTROLLA LA CORRETTA IMPOSTAZIONE DELLA MODALITA'      00051000
005110*---   DI PAGAMENTO                                               00051100
005120*---                                                              00051200
005130     IF BQVFB21-49-MOD-PAG EQUAL 'B'   OR                         00051300
005140        BQVFB21-49-MOD-PAG EQUAL 'C'   OR                         00051400
005150        BQVFB21-49-MOD-PAG EQUAL 'P'   OR                         00051500
005160        BQVFB21-49-MOD-PAG EQUAL 'Q'   OR                         00051600
005170        BQVFB21-49-MOD-PAG EQUAL SPACE                            00051700
005180       GO TO B1-030.                                              00051800
005190 B1-020.                                                          00051900
005200*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00052000
005210     MOVE 55                         TO BQVFB21-49-ERR-MOD-PAG.   00052100
005220     MOVE 'W'                        TO BQVFB21-49-ERR-MOD-PAG-A. 00052200
005230     ADD  1                          TO W-CTR1.                   00052300
005240 B1-030.                                                          00052400
005250*---   CONTROLLO NUMERICITA' CODICE CAB (SOLO SE DA BANCA)        00052500
005260*---                                                              00052600
005270     IF BQVFB21-49-COD-CABA NUMERIC  OR                           00052700
005280        W-PROV              EQUAL 'C'                             00052800
005290       GO TO B1-040.                                              00052900
005300 B1-035.                                                          00053000
005310*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00053100
005320     MOVE 33                         TO BQVFB21-49-ERR-COD-CAB.   00053200
005330     MOVE 'W'                        TO BQVFB21-49-ERR-COD-CAB-A. 00053300
005340     ADD  1                          TO W-CTR1.                   00053400
005350     GO TO B1-050.                                                00053500
005360 B1-040.                                                          00053600
005370*---   CONTROLLO IMPOSTAZIONE CODICE CAB (SOLO SE DA BANCA)       00053700
005380*---                                                              00053800
005390     IF BQVFB21-49-COD-CABA GREATER ZERO OR                       00053900
005400        W-PROV              EQUAL 'C'                             00054000
005410       GO TO B1-050.                                              00054100
005420 B1-045.                                                          00054200
005430*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00054300
005440     MOVE 39                         TO BQVFB21-49-ERR-COD-CAB.   00054400
005450     MOVE 'W'                        TO BQVFB21-49-ERR-COD-CAB-A. 00054500
005460     ADD  1                          TO W-CTR1.                   00054600
005470 B1-050.                                                          00054700
005480*---   CONTROLLO CORRETTA IMPOSTAZIONE CONFERIMENTO DELEGA        00054800
005490*---                                                              00054900
005500*    IF BQVFB21-49-MOD-CONFER EQUAL '0' OR                        00055000
005510*       BQVFB21-49-MOD-CONFER EQUAL '1' OR                        00055100
005520*       BQVFB21-49-MOD-CONFER EQUAL '2'                           00055200
005530*      GO TO B1-070.                                              00055300
005540 B1-060.                                                          00055400
005550*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00055500
005560*    MOVE 55                      TO BQVFB21-49-ERR-MOD-CONFER.   00055600
005570*    MOVE 'W'                     TO BQVFB21-49-ERR-MOD-CONFER-A. 00055700
005580*    ADD  1                          TO W-CTR1.                   00055800
005590 B1-070.                                                          00055900
005600*---             CONTROLLO DATA BONIFICO D'APPARTENENZA           00056000
005610*---   IMPOSTAZIONE PARAMETRI PER RICHIAMO ROUTINE DI CONTROLLO   00056100
005620*---                                                              00056200
005630*---          IMPOSTAZIONE DELLA DATA DA CONTROLLARE              00056300
005640     MOVE BQVFB21-49-DATA-BONIF-APPART TO BQVFDA1-DAT1.           00056400
005650     MOVE SPACE                        TO BQVFDA1-DAT2.           00056500
005660*---                                                              00056600
005670     CALL 'BQVFDA' USING BQVFDA1.                                 00056700
005680*---                                                              00056800
005690     IF BQVFDA1-OK = 0                                            00056900
005700        GO TO B1-080.                                             00057000
005710 B1-075.                                                          00057100
005720*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00057200
005730     MOVE 96                 TO BQVFB21-49-ERR-DATA-BONIF-APP.    00057300
005740     MOVE 'W'                TO BQVFB21-49-ERR-DATA-BON-APP-A.    00057400
005750     ADD  1                  TO W-CTR1.                           00057500
005760     GO TO B1-090.                                                00057600
005770 B1-080.                                                          00057700
005780*---  SI CONTROLLA CHE LA DATA BONIFICO DI APPARTENENZA           00057800
005790*---  SIA UN GIORNO LAVORATIVO                                    00057900
005800     IF BQVFDA1-FESTIVO   = 1 OR                                  00058000
005810        BQVFDA1-SETTIMANA > 5                                     00058100
005820        GO TO B1-085.                                             00058200
005830 B1-082.                                                          00058300
005840*--- SI CONTROLLA CHE LA DATA DI ACCRED. SIA INFERIORE ALLA       00058400
005850*--- DATA DI SISTEMA                                              00058500
005860     IF BQVFB21-49-DATA-BONIF-APPART  < BQVFB21-DATA-BONIF        00058600
005870        GO TO B1-090.                                             00058700
005880 B1-084.                                                          00058800
005890*---  DATA BONIFICO DI APPARTENENZA >= DATA BONIFICO              00058900
005900*---                                                              00059000
005910     ADD 1                        TO W-CTR1.                      00059100
005920     MOVE 45                 TO BQVFB21-49-ERR-DATA-BONIF-APP.    00059200
005930     MOVE 'W'                TO BQVFB21-49-ERR-DATA-BON-APP-A.    00059300
005940     GO TO B1-090.                                                00059400
005950 B1-085.                                                          00059500
005960*---  DATA BONIFICO DI APPARTENENZA = GIORNO LAVORATIVO           00059600
005970*---                                                              00059700
005980     ADD 1                        TO W-CTR1.                      00059800
005990     MOVE 45                 TO BQVFB21-49-ERR-DATA-BONIF-APP.    00059900
006000     MOVE 'W'                TO BQVFB21-49-ERR-DATA-BON-APP-A.    00060000
006010     GO TO B1-090.                                                00060100
006020 B1-090.                                                          00060200
006030*---                                                              00060300
006040 B1-100.                                                          00060400
006050*---                                                              00060500
006060 B1-105.                                                          00060600
006070*---   SI CONTROLLA L'IMPORTO NON COPERTO DA ASSEGNO SIA MINORE O 00060700
006080*--- UGUALE A  IMPORTO SALDO FINALE (SE IL SALDO E' CORRETTO)     00060800
006090     IF BQVFB21-49-ERR-SALDO-FINALE NOT EQUAL ZERO                00060900
006100       GO TO B1-108.                                              00061000
006110 B1-106.                                                          00061100
006120*---                                                              00061200
006130 B1-108.                                                          00061300
006140*---   LA CAUSALE DI ANNULLAMENTO E' 4 O 5 O 6                    00061400
006150*---   OPPURE LA CAUSALE DI ANNULLAMENTO E' 7                     00061500
006160* INIZIO MODIFICA CODICE A BARRE - 12/2004                        00061600
006170**** IF  (BQVFB21-49-CAUS-ANNUL = 4) OR                           00061700
006180******** (BQVFB21-49-CAUS-ANNUL = 5) OR                           00061800
006190******** (BQVFB21-49-CAUS-ANNUL = 6) OR                           00061900
006200******** (BQVFB21-49-CAUS-ANNUL = 7)                              00062000
006210****** GO TO B1-205.                                              00062100
006220*---                                                              00062200
006230     IF  (BQVFB21-49-CAUS-ANNUL = 4) OR                           00062300
006240         (BQVFB21-49-CAUS-ANNUL = 5) OR                           00062400
006250         (BQVFB21-49-CAUS-ANNUL = 6) OR                           00062500
006260         (BQVFB21-49-CAUS-ANNUL = 7) OR                           00062600
006270         (BQVFB21-49-CAUS-ANNUL = 8) OR                           00062700
006280         (BQVFB21-49-CAUS-ANNUL = 9)                              00062800
006290       GO TO B1-205.                                              00062900
006300*---                                                              00063000
006310* FINE MODIFICA CODICE A BARRE - 12/2004                          00063100
006320 B1-110.                                                          00063200
006330*---   SI CONTROLLA LA NUMERICITA' DEL CODICE ABI RELATIVO        00063300
006340*---   ALLA BANCA TRASSATA/EMITTENTE                              00063400
006350*---                                                              00063500
006360*--- MODIFICA DEL 12/10/1999 PER CAUSA ANNULLAMENTO=3             00063600
006370*---                                                              00063700
006380     IF BQVFB21-49-ABI-TRASS-EMITTA NUMERIC AND                   00063800
006390      ((BQVFB21-49-ABI-TRASS-EMITT > ZERO AND                     00063900
006400        BQVFB21-49-CAUS-ANNUL = 1) OR                             00064000
006410       (BQVFB21-49-ABI-TRASS-EMITT = ZERO AND                     00064100
006420        BQVFB21-49-CAUS-ANNUL NOT = 1))                           00064200
006430       GO TO B1-130.                                              00064300
006440 B1-120.                                                          00064400
006450*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00064500
006460     MOVE 24                 TO BQVFB21-49-ERR-ABI-TRASS-EMITT.   00064600
006470     IF BQVFB21-49-ABI-TRASS-EMITTA NOT NUMERIC                   00064700
006480        MOVE 33              TO BQVFB21-49-ERR-ABI-TRASS-EMITT.   00064800
006490     IF BQVFB21-49-CAUS-ANNUL = 2                                 00064900
006500        MOVE 15              TO BQVFB21-49-ERR-ABI-TRASS-EMITT.   00065000
006510     MOVE 'W'                TO BQVFB21-49-ERR-ABI-TRASS-EMI-A.   00065100
006520     ADD  1                  TO W-CTR1.                           00065200
006530     GO TO B1-170.                                                00065300
006540 B1-130.                                                          00065400
006550     IF BQVFB21-49-ERR-ABI-TRASS-EMITT > ZERO OR                  00065500
006560        BQVFB21-49-ABI-TRASS-EMITT = ZERO                         00065600
006570        GO TO B1-170.                                             00065700
006580 B1-135.                                                          00065800
006590*---   IMPOSTAZIONE CHIAVE PER .................                  00065900
006600     MOVE BQVFB21-49-ABI-TRASS-EMITT  TO W-AZIENDA-INP.           00066000
006610*---  ....  CONTROLLARE SULLA TABELLA AZIENDE LA PRESENZA  DEL    00066100
006620*---   CODICE ABI                                                 00066200
006630     SEARCH  ALL W-TAB-AZIENDE-EL                                 00066300
006640        AT END MOVE ZERO TO W-FLAG-TROVATO                        00066400
006650     WHEN W-TAB-AZ-COD-NUM(W-PUNT-AZIENDE)                        00066500
006660                                     EQUAL W-AZIENDA-INP          00066600
006670        MOVE 1           TO W-FLAG-TROVATO.                       00066700
006680*---                                                              00066800
006690*---   SI CONTROLLA SE E' STATA TROVATA ALMENO 1 OCCORRENZA       00066900
006700     IF W-FLAG-TROVATO = 1                                        00067000
006710       GO TO B1-170.                                              00067100
006720 B1-140.                                                          00067200
006730*---   IL CODICE ABI IN OGGETTO NON E' PRESENTE IN BASE           00067300
006740*---   INFORMATIVA                                                00067400
006750*---        S'IMPOSTA                                             00067500
006760*    MOVE 146                TO BQVFB21-49-ERR-ABI-TRASS-EMITT.   00067600
006770     MOVE 55                 TO BQVFB21-49-ERR-ABI-TRASS-EMITT.   00067700
006780     MOVE 'W'                TO BQVFB21-49-ERR-ABI-TRASS-EMI-A.   00067800
006790     ADD  1                  TO W-CTR1.                           00067900
006800 B1-170.                                                          00068000
006810*---   SI CONTROLLA LA NUMERICITA' DEL CODICE CAB RELATIVO        00068100
006820*---   ALLA BANCA TRASSATA/EMITTENTE                              00068200
006830*---                                                              00068300
006840     IF BQVFB21-49-CAB-TRASS-EMITTA NUMERIC                       00068400
006850       GO TO B1-180.                                              00068500
006860 B1-175.                                                          00068600
006870*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00068700
006880     MOVE 33                 TO BQVFB21-49-ERR-CAB-TRASS-EMITT.   00068800
006890     MOVE 'W'                TO BQVFB21-49-ERR-CAB-TRASS-EMI-A.   00068900
006900     ADD  1                  TO W-CTR1.                           00069000
006910     GO TO B1-190.                                                00069100
006920 B1-180.                                                          00069200
006930*---   SI CONTROLLA CHE IL CODICE CAB RELATIVO                    00069300
006940*---   ALLA BANCA TRASSATA/EMITTENTE SIA > ZERO                   00069400
006950*---                                                              00069500
006960*--- MODIFICA DEL 12/10/1999 PER CAUSA ANNULLAMENTO=3             00069600
006970*---                                                              00069700
006980     IF (BQVFB21-49-CAB-TRASS-EMITT > ZERO AND                    00069800
006990         BQVFB21-49-CAUS-ANNUL = 1) OR                            00069900
007000        (BQVFB21-49-CAB-TRASS-EMITT = ZERO AND                    00070000
007010         BQVFB21-49-CAUS-ANNUL NOT = 1)                           00070100
007020       GO TO B1-190.                                              00070200
007030 B1-185.                                                          00070300
007040*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00070400
007050     MOVE 39                 TO BQVFB21-49-ERR-CAB-TRASS-EMITT.   00070500
007060     IF BQVFB21-49-CAUS-ANNUL = 2                                 00070600
007070        MOVE 15              TO BQVFB21-49-ERR-CAB-TRASS-EMITT.   00070700
007080     MOVE 'W'                TO BQVFB21-49-ERR-CAB-TRASS-EMI-A.   00070800
007090     ADD  1                  TO W-CTR1.                           00070900
007100     GO TO B1-190.                                                00071000
007110 B1-190.                                                          00071100
007120*---   SI CONTROLLA L'IMPOSTAZIONE DEL NUMERO ASSEGNO             00071200
007130*---                                                              00071300
007140*--- MODIFICA DEL 12/10/1999 PER CAUSA ANNULLAMENTO=3             00071400
007150*---                                                              00071500
007160     IF BQVFB21-49-NUM-ASSEGNO NUMERIC        AND                 00071600
007170      ((BQVFB21-49-NUM-ASSEGNO > ZERO AND                         00071700
007180        BQVFB21-49-CAUS-ANNUL = 1) OR                             00071800
007190       (BQVFB21-49-NUM-ASSEGNO = ZERO AND                         00071900
007200        BQVFB21-49-CAUS-ANNUL NOT = 1))                           00072000
007210       GO TO B1-210.                                              00072100
007220 B1-200.                                                          00072200
007230*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00072300
007240     MOVE 39                 TO BQVFB21-49-ERR-NUM-ASSEGNO.       00072400
007250     IF BQVFB21-49-CAUS-ANNUL = 2                                 00072500
007260        MOVE 15              TO BQVFB21-49-ERR-NUM-ASSEGNO.       00072600
007270     MOVE 'W'                TO BQVFB21-49-ERR-NUM-ASSEGNO-A.     00072700
007280     ADD  1                  TO W-CTR1.                           00072800
007290     GO TO B1-210.                                                00072900
007300 B1-205.                                                          00073000
007310*                                                                 00073100
007320*--- LA CAUSALE DI ANNULLAMENTO E' 7: NON VENGONO FATTI CONTROLLI 00073200
007330*                                                                 00073300
007340*--------------------------------------------------------         00073400
007350* INIZIO MODIFICA CODICE A BARRE - 12/2004                        00073500
007360     IF  (BQVFB21-49-CAUS-ANNUL = 7 OR 8 OR 9)                    00073600
007370        GO TO B1-207.                                             00073700
007380* FINE MODIFICA CODICE A BARRE - 12/2004                          00073800
007390*--------------------------------------------------------         00073900
007400*--- LA CAUSALE DI ANNULLAMENTO E' 4 O 5 O 6                      00074000
007410*                                                                 00074100
007420*---   ROUTINE DI CONTROLLO DEL NUMERO DI RIFERIMENTO.            00074200
007430*                                                                 00074300
007440     PERFORM B3-010-NUM-RIF THRU B3-010-NUM-RIF-EX.               00074400
007450*                                                                 00074500
007460*---         CONTROLLO CODICE DI CONTROLLO NUMERO DI RIFERIMENTO  00074600
007470*                                                                 00074700
007480     IF BQVFB21-49-COD-CONT-NRIFA NOT NUMERIC                     00074800
007490        MOVE 33                   TO BQVFB21-49-ERR-COD-CONT-NRIF 00074900
007500        ADD 1                     TO W-CTR2                       00075000
007510        MOVE 'E'               TO BQVFB21-49-ERR-COD-CONT-NRIF-A. 00075100
007520*                                                                 00075200
007530*F INIZIO MODIFICA CODICE A BARRE - 12/2004                       00075300
007540*                                                                 00075400
007550 B1-207.                                                          00075500
007560*---   ROUTINE DI CONTROLLO DELL'IDENTIFICATIVO PAGAMENTO         00075600
007570*                                                                 00075700
007580     IF ((BQVFB21-49-CAUS-ANNUL = 8 OR 9) OR                      00075800
007590         (BQVFB21-49-CAUS-ANNUL = 7 AND                           00075900
007600          BQVFB21-49-IDENT-PAGAM GREATER ZERO))                   00076000
007610        MOVE BQVFB21-49-IDENT-PAGAM TO W-ID-PAGAM                 00076100
007620        PERFORM B4-010-ID-PAGAM THRU B4-010-ID-PAGAM-EX.          00076200
007630*                                                                 00076300
007640*F FINE MODIFICA CODICE A BARRE - 12/2004                         00076400
007650*                                                                 00076500
007660 B1-210.                                                          00076600
007670*---   SI CONTROLLA CHE IL PROGRESSIVO RIGA ABBIA VALORE 000      00076700
007680*---                                                              00076800
007690     IF BQVFB21-49-PROG-RIGAA NUMERIC      AND                    00076900
007700        BQVFB21-49-PROG-RIGA  EQUAL ZERO                          00077000
007710       GO TO B1-230.                                              00077100
007720 B1-220.                                                          00077200
007730*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00077300
007740     MOVE 55                 TO BQVFB21-49-ERR-PROG-RIGA.         00077400
007750     MOVE 'W'                TO BQVFB21-49-ERR-PROG-RIGA-A.       00077500
007760     ADD  1                  TO W-CTR1.                           00077600
007770 B1-230.                                                          00077700
007780*---                                                              00077800
007790     IF W-PROV EQUAL 'C'                                          00077900
007800       GO TO B1-270.                                              00078000
007810 B1-235.                                                          00078100
007820     MOVE BQVFB21-49-SIGLA-PROV  TO W-PROV-INP.                   00078200
007830*---  SI CONTROLLA LA PRESENZA DELLA PROVINCIA IN TABELLA         00078300
007840*---  (SOLO SE DA BANCA)                                          00078400
007850     SEARCH  ALL W-TAB-PROV-EL                                    00078500
007860        AT END MOVE ZERO TO W-FLAG-TROVATO                        00078600
007870     WHEN W-TAB-PROV-COD(W-PUNT-PROV) EQUAL W-PROV-INP            00078700
007880        MOVE 1           TO W-FLAG-TROVATO.                       00078800
007890*---                                                              00078900
007900*---   SI CONTROLLA SE E' STATA TROVATA ALMENO 1 OCCORRENZA       00079000
007910*---                                                              00079100
007920     IF W-FLAG-TROVATO = 1                                        00079200
007930       GO TO B1-270.                                              00079300
007940 B1-240.                                                          00079400
007950*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00079500
007960     MOVE 119                TO BQVFB21-49-ERR-SIGLA-PROV.        00079600
007970     MOVE 'W'                TO BQVFB21-49-ERR-SIGLA-PROV-A       00079700
007980     ADD  1                  TO W-CTR1.                           00079800
007990 B1-270.                                                          00079900
008000*---   SI CONTROLLA CHE IL PROGRESSIVO ACCREDITAMENTO/BONIFICO    00080000
008010*---   SIA ZERO (SOLO DA BANCHE)                                  00080100
008020*---                                                              00080200
008030     IF W-PROV EQUAL 'C'                       OR                 00080300
008040        BQVFB21-49-PROG-ACCR-BONA EQUAL ZERO                      00080400
008050       GO TO B1-290.                                              00080500
008060 B1-280.                                                          00080600
008070*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00080700
008080     MOVE  55                TO BQVFB21-49-ERR-PROG-ACCR-BON.     00080800
008090     MOVE 'W'                TO BQVFB21-49-ERR-PROG-ACCR-BON-A.   00080900
008100     ADD  1                  TO W-CTR1.                           00081000
008110* ASTERISCATO IL CONTROLLO SUL CF: ESEGUITO NEL MAIN              00081100
008120 B1-290.                                                          00081200
008130*---   SI CONTROLLA IL FLAG CONCESSIONE                           00081300
008140*---                                                              00081400
008150*    IF BQVFB21-49-FLAG-ERR-CONC EQUAL '0' OR                     00081500
008160*       BQVFB21-49-FLAG-ERR-CONC EQUAL '1'                        00081600
008170*      GO TO B1-310.                                              00081700
008180*--- NEW:                                                         00081800
008190***  MOVE BQVFB21-49-CODICE-FISC     TO W-APPO-CF.                00081900
008200***  INSPECT W-APPO-CF REPLACING ALL SPACE BY ZERO.               00082000
008210*---   SI CONTROLLA SE SI TRATTA DI CF RELATIVO A PERS. FIS.      00082100
008220*---                                                              00082200
008230**** IF W-APPO-CF NOT NUMERIC                                     00082300
008240****   MOVE W-APPO-CF       TO W-BQVFB3-COD-FISC                  00082400
008250****   GO TO B1-420.                                              00082500
008260*--- NEW: FINE.                                                   00082600
008270*B1-300.                                                          00082700
008280*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00082800
008290*    MOVE  55                TO BQVFB21-49-ERR-FLAG-ERR-CONC.     00082900
008300*    MOVE 'E'                TO BQVFB21-49-ERR-FLAG-ERR-CONC-A.   00083000
008310*    ADD  1                  TO W-CTR2.                           00083100
008320*B1-310.                                                          00083200
008330*---                                                              00083300
008340*    IF BQVFB21-49-CODICE-CONCA NOT NUMERIC                       00083400
008350*       MOVE ZERO TO W-FLAG-TROVATO                               00083500
008360*      GO TO B1-314.                                              00083600
008370*B1-312.                                                          00083700
008380*    MOVE BQVFB21-49-CODICE-CONC TO W-AMBITO-INP.                 00083800
008390*---  SI CONTROLLA   SULLA TABELLA LA PRESENZA DEL                00083900
008400*---  CODICE CONCESSIONE                                          00084000
008410*    SEARCH  ALL W-TAB-AMBITI-EL                                  00084100
008420*       AT END MOVE ZERO TO W-FLAG-TROVATO                        00084200
008430*    WHEN W-TAB-AMBITI-COD-ALF(W-PUNT-AMBITI) EQUAL W-AMBITO-INP  00084300
008440*       MOVE 1           TO W-FLAG-TROVATO.                       00084400
008450*B1-314.                                                          00084500
008460*    IF W-FLAG-TROVATO = 1                                        00084600
008470*      GO TO B1-360.                                              00084700
008480*B1-320.                                                          00084800
008490*---   OCCORRENZA NON TROVATA; SI TESTA IL FLAG ERRORE RELATIVO   00084900
008500*---                                                              00085000
008510*    IF BQVFB21-49-FLAG-ERR-CONC EQUAL '1'                        00085100
008520*      GO TO B1-390.                                              00085200
008530*B1-340.                                                          00085300
008540*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00085400
008550*    MOVE  504               TO BQVFB21-49-ERR-CODICE-CONC.       00085500
008560*    MOVE 'E'                TO BQVFB21-49-ERR-CODICE-CONC-A.     00085600
008570*    ADD  1                  TO W-CTR2.                           00085700
008580*    IF BQVFB21-49-ERR-FLAG-ERR-CONC EQUAL ZERO                   00085800
008590*      MOVE  24              TO BQVFB21-49-ERR-FLAG-ERR-CONC      00085900
008600*      MOVE 'E'              TO BQVFB21-49-ERR-FLAG-ERR-CONC-A    00086000
008610*      ADD  1                TO W-CTR2.                           00086100
008620*    GO TO B1-390.                                                00086200
008630*B1-360.                                                          00086300
008640*---   OCCORRENZA TROVATA; SI TESTA IL FLAG ERRORE RELATIVO       00086400
008650*---                                                              00086500
008660*    IF BQVFB21-49-FLAG-ERR-CONC EQUAL '0'                        00086600
008670*      GO TO B1-390.                                              00086700
008680*B1-365.                                                          00086800
008690*---                                                              00086900
008700*    IF BQVFB21-49-FLAG-ERR-CONC NOT EQUAL '1'                    00087000
008710*      GO TO B1-390.                                              00087100
008720*B1-370.                                                          00087200
008730*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00087300
008740*    MOVE  24                TO BQVFB21-49-ERR-FLAG-ERR-CONC.     00087400
008750*    MOVE 'W'                TO BQVFB21-49-ERR-FLAG-ERR-CONC-A.   00087500
008760*    ADD  1                  TO W-CTR1.                           00087600
008770*B1-390.                                                          00087700
008780*    MOVE BQVFB21-49-CODICE-FISC     TO W-APPO-CF.                00087800
008790*    INSPECT W-APPO-CF REPLACING ALL SPACE BY ZERO.               00087900
008800*---   SI CONTROLLA SE SI TRATTA DI CF RELATIVO A PERS. FIS.      00088000
008810*---                                                              00088100
008820*    IF W-APPO-CF NOT NUMERIC                                     00088200
008830*      MOVE W-APPO-CF       TO W-BQVFB3-COD-FISC                  00088300
008840*      GO TO B1-420.                                              00088400
008850****B1-400.                                                       00088500
008860*---   CF DI 11 CARATTERI                                         00088600
008870*---           SI CONTROLLA SE E' ALLINEATO A SINISTRA            00088700
008880*---                                                              00088800
008890**** IF W-APPO-CF-DX EQUAL ZERO                                   00088900
008900****   MOVE SPACE               TO W-APPO-CF-DX                   00089000
008910****   MOVE W-APPO-CF           TO W-BQVFB3-COD-FISC              00089100
008920****   GO TO B1-420.                                              00089200
008930**** B1-410.                                                      00089300
008940*---   CF DI 11 CARATTERI  ALLINEATO A DESTRA                     00089400
008950****     MOVE W-APPO-CF-RED-DX    TO W-BQVFB3-COD-FISC.           00089500
008960**** B1-420.                                                      00089600
008970*---   SI CONTROLLA IL FLAG COD. FISCALE                          00089700
008980*---                                                              00089800
008990**** IF BQVFB21-49-FLAG-ERR-CF   EQUAL '0' OR                     00089900
009000****    BQVFB21-49-FLAG-ERR-CF   EQUAL '1'                        00090000
009010****   GO TO B1-440.                                              00090100
009020**** B1-430.                                                      00090200
009030*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00090300
009040**** MOVE  55                TO BQVFB21-49-ERR-FLAG-ERR-CF.       00090400
009050**** MOVE 'E'                TO BQVFB21-49-ERR-FLAG-ERR-CF-A.     00090500
009060**** ADD  1                  TO W-CTR2.                           00090600
009070**** B1-440.                                                      00090700
009080*---   SI RICHIAMA LA ROUTINE PER CONTROLLO CF, SOLO SE QUESTO E' 00090800
009090*--- IMPOSTATO                                                    00090900
009100**** IF W-APPO-CF-SX           EQUAL ZERO      OR                 00091000
009110****    BQVFB21-49-CODICE-FISC EQUAL LOW-VALUE OR                 00091100
009120****    BQVFB21-49-CODICE-FISC EQUAL HIGH-VALUE                   00091200
009130****    MOVE 1 TO W-BQVFB3-COD-RIT                                00091300
009140**** ELSE                                                         00091400
009150****    CALL 'BQVFB3' USING W-PARAM-BQVFB3                        00091500
009160**** END-IF.                                                      00091600
009170*---   CONTROLLO ESITO                                            00091700
009180*---                                                              00091800
009190**** IF W-BQVFB3-COD-RIT = ZERO                                   00091900
009200****   GO TO B1-480.                                              00092000
009210**** B1-450.                                                      00092100
009220*---   CODICE ERRATO                                              00092200
009230*---                                                              00092300
009240**** IF BQVFB21-49-FLAG-ERR-CF EQUAL '1'                          00092400
009250****   GO TO B1-520.                                              00092500
009260**** B1-460.                                                      00092600
009270*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00092700
009280**** MOVE   96               TO BQVFB21-49-ERR-CODICE-FISC.       00092800
009290**** MOVE 'E'                TO BQVFB21-49-ERR-CODICE-FISC-A.     00092900
009300**** ADD  1                  TO W-CTR2.                           00093000
009310**** IF BQVFB21-49-ERR-FLAG-ERR-CF EQUAL ZERO                     00093100
009320****   MOVE  24              TO BQVFB21-49-ERR-FLAG-ERR-CF        00093200
009330****   MOVE 'E'              TO BQVFB21-49-ERR-FLAG-ERR-CF-A      00093300
009340****   ADD  1                TO W-CTR2.                           00093400
009350**** GO TO B1-520.                                                00093500
009360**** B1-480.                                                      00093600
009370*---   CF CORRETTO                                                00093700
009380*---                                                              00093800
009390**** IF BQVFB21-49-FLAG-ERR-CF EQUAL '0'                          00093900
009400****   GO TO B1-520.                                              00094000
009410**** B1-490.                                                      00094100
009420*---                                                              00094200
009430**** IF BQVFB21-49-FLAG-ERR-CF NOT EQUAL '1'                      00094300
009440****   GO TO B1-520.                                              00094400
009450**** B1-500.                                                      00094500
009460*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00094600
009470**** MOVE  24                TO BQVFB21-49-ERR-FLAG-ERR-CF.       00094700
009480**** MOVE 'W'                TO BQVFB21-49-ERR-FLAG-ERR-CF-A.     00094800
009490**** ADD  1                  TO W-CTR1.                           00094900
009500 B1-520.                                                          00095000
009510*---             CONTROLLO DATA RISCOSSIONE                       00095100
009520*---   IMPOSTAZIONE PARAMETRI PER RICHIAMO ROUTINE DI CONTROLLO   00095200
009530*---                                                              00095300
009540*---          IMPOSTAZIONE DELLA DATA DA CONTROLLARE              00095400
009550     MOVE BQVFB21-49-DATA-RISC         TO BQVFDA1-DAT1.           00095500
009560     MOVE SPACE                        TO BQVFDA1-DAT2.           00095600
009570*---                                                              00095700
009580     CALL 'BQVFDA' USING BQVFDA1.                                 00095800
009590*---                                                              00095900
009600*---                                                              00096000
009610     IF BQVFDA1-OK = 0                                            00096100
009620        GO TO B1-530.                                             00096200
009630 B1-525.                                                          00096300
009640*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00096400
009650     MOVE 96                 TO BQVFB21-49-ERR-DATA-RISC.         00096500
009660     MOVE 'W'                TO BQVFB21-49-ERR-DATA-RISC-A.       00096600
009670     ADD  1                  TO W-CTR1.                           00096700
009680     GO TO B1-540.                                                00096800
009690 B1-530.                                                          00096900
009700*---  SI CONTROLLA CHE LA DATA RISCOSSIONE SIA <= DATA-BONIF-APPAR00097000
009710*---                                                              00097100
009720     IF   BQVFB21-49-DATA-RISC <= BQVFB21-49-DATA-BONIF-APPART    00097200
009730        GO TO B1-540.                                             00097300
009740 B1-535.                                                          00097400
009750*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00097500
009760     MOVE 45                 TO BQVFB21-49-ERR-DATA-RISC.         00097600
009770     MOVE 'W'                TO BQVFB21-49-ERR-DATA-RISC-A.       00097700
009780     ADD  1                  TO W-CTR1.                           00097800
009790*     GO TO B1-540.                                               00097900
009800 B1-540.                                                          00098000
009810*--                                                               00098100
009820 B1-545.                                                          00098200
009830*---                                                              00098300
009840 B1-550.                                                          00098400
009850*---                                                              00098500
009860 B1-580.                                                          00098600
009870*--   CODICE REGIONE PUO' ASSUMERE VALORE 00, IN QUESTO CASO      00098700
009880*--   NON SI ACCEDE ALLA TABELLA BQVB11                           00098800
009890*    IF BQVFB21-49-COD-REG2A EQUAL '00'                           00098900
009900*       GO TO B1-620.                                             00099000
009910*--- NEW:                                                         00099100
009920*--   CONTROLLO NUMERICITA RIGHE ERARIO                           00099200
009930     IF BQVFB21-49-NUMRIG-ERARIOA NUMERIC                         00099300
009940        GO TO B1-600.                                             00099400
009950*--- NEW: FINE.                                                   00099500
009960 B1-585.                                                          00099600
009970*    MOVE BQVFB21-49-COD-REG2A    TO W-REGIONE-INP.               00099700
009980*---  SI CONTROLLA   SULLA TABELLA  LA PRESENZA DELLA             00099800
009990*---   REGIONE                                                    00099900
010000*    PERFORM RA-010-RIC-REG THRU RA-990-RIC-REG-EX.               00100000
010010*---   SI CONTROLLA SE E' STATA TROVATA ALMENO 1 OCCORRENZA       00100100
010020*---                                                              00100200
010030*    IF W-FLAG-TROVATO = 1                                        00100300
010040*      GO TO B1-620.                                              00100400
010050 B1-590.                                                          00100500
010060*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00100600
010070     MOVE  33                TO BQVFB21-49-ERR-NUMRIG-ERARIO.     00100700
010080     MOVE 'W'                TO BQVFB21-49-ERR-NUMRIG-ERARIO-A.   00100800
010090     ADD  1                  TO W-CTR1.                           00100900
010100 B1-600.                                                          00101000
010110*--- NEW:                                                         00101100
010120*--   CONTROLLO NUMERICITA RIGHE INPS                             00101200
010130     IF BQVFB21-49-NUMRIG-INPSA NUMERIC                           00101300
010140        GO TO B1-620.                                             00101400
010150*--- NEW: FINE.                                                   00101500
010160 B1-610.                                                          00101600
010170*--- NEW:                                                         00101700
010180*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00101800
010190     MOVE  33                TO BQVFB21-49-ERR-NUMRIG-INPS.       00101900
010200     MOVE 'W'                TO BQVFB21-49-ERR-NUMRIG-INPS-A.     00102000
010210     ADD  1                  TO W-CTR1.                           00102100
010220*--- NEW: FINE.                                                   00102200
010230 B1-620.                                                          00102300
010240*---   CONTROLLO NUMERICITA' RIGHE REGIONI                        00102400
010250*---                                                              00102500
010260     IF BQVFB21-49-NUMRIG-REGIONIA NUMERIC                        00102600
010270       GO TO B1-640.                                              00102700
010280 B1-630.                                                          00102800
010290*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00102900
010300     MOVE  33                TO BQVFB21-49-ERR-NUMRIG-REGIONI.    00103000
010310     MOVE 'W'                TO BQVFB21-49-ERR-NUMRIG-REG-A.      00103100
010320     ADD  1                  TO W-CTR1.                           00103200
010330 B1-640.                                                          00103300
010340*---   CONTROLLO NUMERICITA' RIGHE ENTI LOCALI                    00103400
010350*---                                                              00103500
010360     IF BQVFB21-49-NUMRIG-ENTIA NUMERIC                           00103600
010370       GO TO B1-660.                                              00103700
010380 B1-650.                                                          00103800
010390*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00103900
010400     MOVE  33                TO BQVFB21-49-ERR-NUMRIG-ENTI.       00104000
010410     MOVE 'W'                TO BQVFB21-49-ERR-NUMRIG-ENTI-A.     00104100
010420     ADD  1                  TO W-CTR1.                           00104200
010430 B1-660.                                                          00104300
010440*---   CONTROLLO NUMERICITA' RIGHE INAIL                          00104400
010450*---                                                              00104500
010460     IF BQVFB21-49-NUMRIG-INAILA   NUMERIC                        00104600
010470       GO TO B1-670.                                              00104700
010480 B1-665.                                                          00104800
010490*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00104900
010500     MOVE  33                TO BQVFB21-49-ERR-NUMRIG-INAIL.      00105000
010510     MOVE 'W'                TO BQVFB21-49-ERR-NUMRIG-INAIL-A.    00105100
010520     ADD  1                  TO W-CTR1.                           00105200
010530*--- NEW:                                                         00105300
010540 B1-670.                                                          00105400
010550*---   CONTROLLO NUMERICITA' RIGHE ALTRI ENTI                     00105500
010560*---                                                              00105600
010570     IF BQVFB21-49-NUMRIG-ALTRIA   NUMERIC                        00105700
010580       GO TO B1-710.                                              00105800
010590 B1-675.                                                          00105900
010600*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00106000
010610     MOVE  33                TO BQVFB21-49-ERR-NUMRIG-ALTRI.      00106100
010620     MOVE 'W'                TO BQVFB21-49-ERR-NUMRIG-ALTRI-A.    00106200
010630     ADD  1                  TO W-CTR1.                           00106300
010640*--- NEW: FINE.                                                   00106400
010650*B1-680.                                                          00106500
010660*---   SI CONTROLLA LA NUMERICITA' DEL CAMPO NUMERO               00106600
010670*---   QUIETAMZA SOLO SE SI PROVIENE DA CONCESSIONARIO            00106700
010680*---                                                              00106800
010690*    IF W-PROV EQUAL 'B'                                          00106900
010700*      GO TO B1-010-CONTR-FORM-EX.                                00107000
010710*B1-690.                                                          00107100
010720*---                                                              00107200
010730*    IF BQVFD21-50-NUM-QUIA NUMERIC                               00107300
010740*      GO TO B1-010-CONTR-FORM-EX.                                00107400
010750*B1-700.                                                          00107500
010760*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00107600
010770*    MOVE  33                TO BQVFD21-50-ERR-NUM-QUI.           00107700
010780*    MOVE 'W'                TO BQVFD21-50-ERR-NUM-QUI-A.         00107800
010790*    ADD  1                  TO W-CTR1.                           00107900
010800 B1-710.                                                          00108000
010810*---   CONTROLLO NUMERICITA' RIGHE ACCISE                         00108100
010820     IF BQVFB21-49-NUMRIG-ACCISEA NUMERIC                         00108200
010830        GO TO B1-730.                                             00108300
010840 B1-720.                                                          00108400
010850*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00108500
010860*                                                                 00108600
010870     MOVE  33                TO BQVFB21-49-ERR-NUMRIG-ACCISE.     00108700
010880     MOVE 'W'                TO BQVFB21-49-ERR-NUMRIG-ACCISE-A.   00108800
010890     ADD  1                  TO W-CTR1.                           00108900
010900 B1-730.                                                          00109000
010910*---   CONTROLLO VALORIZZAZIONE RIGHE ACCISE                      00109100
010920*                                                                 00109200
010930     IF (BQVFB21-49-NUMRIG-INAIL > ZERO OR                        00109300
010940         BQVFB21-49-NUMRIG-ALTRI > ZERO   )                       00109400
010950        IF (BQVFB21-49-NUMRIG-ACCISE = 0)                         00109500
010960          GO TO  B1-010-CONTR-FORM-EX                             00109600
010970        END-IF                                                    00109700
010980     ELSE                                                         00109800
010990          GO TO  B1-010-CONTR-FORM-EX.                            00109900
011000 B1-740.                                                          00110000
011010*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00110100
011020*                                                                 00110200
011030     MOVE  96                TO BQVFB21-49-ERR-NUMRIG-ACCISE.     00110300
011040     MOVE 'E'                TO BQVFB21-49-ERR-NUMRIG-ACCISE-A.   00110400
011050     ADD  1                  TO W-CTR2.                           00110500
011060 B1-010-CONTR-FORM-EX.                                            00110600
011070     EXIT.                                                        00110700
011080*---                                                              00110800
011090*---              CONTROLLO NUMERO DI RIFERIMENTO.                00110900
011100*                                                                 00111000
011110 B3-010-NUM-RIF.                                                  00111100
011120*                                                                 00111200
011130     IF BQVFB21-49-NUM-RIFERA NUMERIC                             00111300
011140       GO TO B3-030.                                              00111400
011150*                                                                 00111500
011160 B3-020.                                                          00111600
011170*                                                                 00111700
011180     MOVE 33                      TO BQVFB21-49-ERR-NUM-RIFER.    00111800
011190     ADD 1                        TO W-CTR2.                      00111900
011200     MOVE 'E'                     TO BQVFB21-49-ERR-NUM-RIFER-A.  00112000
011210     GO TO B3-010-NUM-RIF-EX.                                     00112100
011220*                                                                 00112200
011230 B3-030.                                                          00112300
011240*                                                                 00112400
011250     MOVE BQVFB21-49-NUM-RIFERA   TO W-NUMERO-RIF.                00112500
011260*                                                                 00112600
011270     IF W-NUMERO-RIF NOT EQUAL SPACES  AND                        00112700
011280        W-NUMERO-RIF NOT EQUAL ZERO                               00112800
011290        GO TO B3-050.                                             00112900
011300*                                                                 00113000
011310 B3-040.                                                          00113100
011320*                                                                 00113200
011330     GO TO B3-010-NUM-RIF-EX.                                     00113300
011340*                                                                 00113400
011350 B3-050.                                                          00113500
011360*---                                                              00113600
011370*--- CONTROLLO FORMALE DEL CAMPO NUMERO RIFERIMENTO               00113700
011380*---                                                              00113800
011390     MOVE SPACE            TO  W-BQVFB3-COD-FISC.                 00113900
011400     MOVE W-NUMERO-RIF     TO  W-BQVFB3-COD-FISC.                 00114000
011410     CALL 'BQVFB3'        USING    W-PARAM-BQVFB3.                00114100
011420*---                                                              00114200
011430     IF W-BQVFB3-COD-RIT = ZERO                                   00114300
011440        GO TO B3-010-NUM-RIF-EX.                                  00114400
011450*                                                                 00114500
011460 B3-060.                                                          00114600
011470*---     ERRORE BLOCCANTE                                         00114700
011480     MOVE 36                      TO BQVFB21-49-ERR-NUM-RIFER.    00114800
011490     ADD 1                        TO W-CTR2.                      00114900
011500     MOVE 'E'                     TO BQVFB21-49-ERR-NUM-RIFER-A.  00115000
011510*                                                                 00115100
011520 B3-010-NUM-RIF-EX.                                               00115200
011530     EXIT.                                                        00115300
011540*                                                                 00115400
011550*************************************************************     00115500
011560* PERFORM PER CONTROLLO CODICE A BARRE                            00115600
011570*************************************************************     00115700
011580*                                                                 00115800
011590* INIZIO MODIFICA CODICE A BARRE - 12/2004                        00115900
011600*                                                                 00116000
011610*                                                                 00116100
011620*---              CONTROLLO IDENTIFICATIVO PAGAMENTO              00116200
011630*                                                                 00116300
011640 B4-010-ID-PAGAM.                                                 00116400
011650*                                                                 00116500
011660     IF W-ID-PAGAM     NUMERIC                                    00116600
011670       GO TO B4-030.                                              00116700
011680*                                                                 00116800
011690 B4-020.                                                          00116900
011700*                                                                 00117000
011710     MOVE 33    TO BQVFB21-49-ERR-IDENT-PAGAM.                    00117100
011720     ADD 1                        TO W-CTR2.                      00117200
011730     MOVE 'E'   TO BQVFB21-49-ERR-IDENT-PAGAM-A.                  00117300
011740     GO TO B4-010-ID-PAGAM-EX.                                    00117400
011750*                                                                 00117500
011760 B4-030.                                                          00117600
011770*                                                                 00117700
011780     MOVE W-ID-PAGAM              TO W-IDENT-PAGAM.               00117800
011790*                                                                 00117900
011800     IF W-IDENT-PAGAM NOT EQUAL SPACES  AND                       00118000
011810        W-IDENT-PAGAM NOT EQUAL ZERO                              00118100
011820        GO TO B4-050.                                             00118200
011830*                                                                 00118300
011840 B4-040.                                                          00118400
011850*                                                                 00118500
011860     MOVE 96    TO BQVFB21-49-ERR-IDENT-PAGAM.                    00118600
011870     ADD 1                        TO W-CTR2.                      00118700
011880     MOVE 'E'   TO BQVFB21-49-ERR-IDENT-PAGAM-A.                  00118800
011890     GO TO B4-010-ID-PAGAM-EX.                                    00118900
011900*                                                                 00119000
011910 B4-050.                                                          00119100
011920*---                                                              00119200
011930*--- CONTROLLO FORMALE DEL CAMPO NUMERO RIFERIMENTO               00119300
011940*---                                                              00119400
011950     MOVE BQVFB21-49-IDENT-PAGAM      TO W-IDENT-PAGAM.           00119500
011960     MOVE 1                           TO W-IND1.                  00119600
011970     MOVE 2                           TO W-IND2.                  00119700
011980     COMPUTE W-TOTALE1 = W-IDENT-PAGAM-15 +                       00119800
011990                         BQVFB21-49-SALDO-FINALE.                 00119900
012000     MOVE ZERO                        TO W-TOTALE2.               00120000
012010     MOVE ZERO                        TO W-APPO-TOTALE3.          00120100
012020     MOVE ZERO                        TO W-TOTALE3.               00120200
012030     MOVE ZERO                        TO W-TOTALE4.               00120300
012040*                                                                 00120400
012050 B4-060.                                                          00120500
012060*---                                                              00120600
012070     COMPUTE W-TOTALE2 = W-TOTALE2 + (W-TOTALE1-EL(W-IND2) * 2).  00120700
012080     ADD 2 TO W-IND2.                                             00120800
012090     IF W-IND2 NOT GREATER 16                                     00120900
012100        GO TO B4-060.                                             00121000
012110*                                                                 00121100
012120 B4-070.                                                          00121200
012130*---                                                              00121300
012140     COMPUTE W-APPO-TOTALE3 = W-APPO-TOTALE3 +                    00121400
012150                             W-TOTALE1-EL(W-IND1).                00121500
012160     ADD 2 TO W-IND1.                                             00121600
012170     IF W-IND1 NOT GREATER 15                                     00121700
012180        GO TO B4-070.                                             00121800
012190*                                                                 00121900
012200 B4-080.                                                          00122000
012210*---                                                              00122100
012220     COMPUTE W-TOTALE3 = W-APPO-TOTALE3 + W-TOTALE2.              00122200
012230     COMPUTE W-TOTALE4 = 10 - W-TOTALE3-3.                        00122300
012240     MOVE W-IDENT-PAGAM-15 TO W-IDENT-PAGAM-CALC-15.              00122400
012250     MOVE W-TOTALE4-2      TO W-IDENT-PAGAM-CALC-C1.              00122500
012260* INIZIO MODIFICA GM PER PC                                       00122600
012270**** DIVIDE 93 INTO W-IDENT-PAGAM-CALC-16 GIVING W-APPO-DIVIDE    00122700
012280******************************** REMAINDER W-RESTO-PAGAM.         00122800
012290     MOVE W-IDENT-PAGAM-CALC-16  TO W-APPO-PAGAM-CALC.            00122900
012300     DIVIDE 93 INTO W-IDENT-PAGAM-CALC-A GIVING W-APPO-DIVIDE     00123000
012310                                 REMAINDER W-RESTO-PAGAM1.        00123100
012320     DIVIDE 93 INTO W-IDENT-PAGAM-CALC-B GIVING W-APPO-DIVIDE     00123200
012330                                 REMAINDER W-RESTO-PAGAM2.        00123300
012340     COMPUTE W-IDENT-PAGAM-CALC-10 = W-RESTO-PAGAM1 * 100000000 + 00123400
012350                                     W-RESTO-PAGAM2.              00123500
012360     DIVIDE 93 INTO W-IDENT-PAGAM-CALC-10 GIVING W-APPO-DIVIDE    00123600
012370                                 REMAINDER W-RESTO-PAGAM.         00123700
012380* FINE MODIFICA GM PER PC                                         00123800
012390     IF W-TOTALE4-2 = W-IDENT-PAGAM-C1 AND                        00123900
012400        W-RESTO-PAGAM = W-IDENT-PAGAM-C2                          00124000
012410           GO TO B4-010-ID-PAGAM-EX.                              00124100
012420*                                                                 00124200
012430 B4-090.                                                          00124300
012440*---     ERRORE BLOCCANTE                                         00124400
012450     MOVE 39    TO BQVFB21-49-ERR-IDENT-PAGAM.                    00124500
012460     ADD 1                        TO W-CTR1.                      00124600
012470     MOVE 'W'   TO BQVFB21-49-ERR-IDENT-PAGAM-A.                  00124700
012480*                                                                 00124800
012490 B4-010-ID-PAGAM-EX.                                              00124900
012500     EXIT.                                                        00125000
012510*                                                                 00125100
012520* FINE MODIFICA CODICE A BARRE - 12/2004                          00125200
012530*                                                                 00125300
012540                                                                  00125400
012550*                                                                 00125500
012560**************************************************************    00125600
012570*--- NEW PERFORM:                                                 00125700
012580*--- CONTROLLO CODICE ALTRI ENTI                                  00125800
012590**************************************************************    00125900
012600*                                                                 00126000
012610 C1-010-CONTR-FORM.                                               00126100
012620      IF BQVFB21-49-COD-ALTRO EQUAL ZERO  OR                      00126200
012630         BQVFB21-49-COD-ALTRO EQUAL '0001' OR                     00126300
012640         BQVFB21-49-COD-ALTRO EQUAL '0002' OR                     00126400
012650         BQVFB21-49-COD-ALTRO EQUAL '0003' OR                     00126500
012660         BQVFB21-49-COD-ALTRO EQUAL '0004' OR                     00126600
012661         BQVFB21-49-COD-ALTRO EQUAL '0005' OR                     00126700
012662         BQVFB21-49-COD-ALTRO EQUAL '0006' OR                     00126710
012663         BQVFB21-49-COD-ALTRO EQUAL '0007' OR                     00126720
012664         BQVFB21-49-COD-ALTRO EQUAL '0008' OR                     00126730
012665         BQVFB21-49-COD-ALTRO EQUAL '0009' OR                     00126740
012666         BQVFB21-49-COD-ALTRO EQUAL '0010' OR                     00126750
012667         BQVFB21-49-COD-ALTRO EQUAL '0011' OR                     00126760
012668         BQVFB21-49-COD-ALTRO EQUAL '0012' OR                     00126770
012669         BQVFB21-49-COD-ALTRO EQUAL '0013'                        00126780
012680         GO TO C1-030.                                            00126800
012690 C1-020.                                                          00126900
012700*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00127000
012710     MOVE  504               TO BQVFB21-49-ERR-COD-ALTRO.         00127100
012720     MOVE 'W'                TO BQVFB21-49-ERR-COD-ALTRO-A.       00127200
012730     ADD  1                  TO W-CTR1.                           00127300
012740 C1-030.                                                          00127400
012750      IF BQVFB21-49-CAUS-ANNUL EQUAL 1  OR                        00127500
012760         BQVFB21-49-CAUS-ANNUL EQUAL 2  OR                        00127600
012770         BQVFB21-49-CAUS-ANNUL EQUAL 3  OR                        00127700
012780         BQVFB21-49-CAUS-ANNUL EQUAL 4  OR                        00127800
012790         BQVFB21-49-CAUS-ANNUL EQUAL 5  OR                        00127900
012800         BQVFB21-49-CAUS-ANNUL EQUAL 6  OR                        00128000
012810         BQVFB21-49-CAUS-ANNUL EQUAL 7  OR                        00128100
012820* INIZIO MODIFICA CODICE A BARRE - 12/2004                        00128200
012830         BQVFB21-49-CAUS-ANNUL EQUAL 8  OR                        00128300
012840         BQVFB21-49-CAUS-ANNUL EQUAL 9                            00128400
012850* FINE MODIFICA CODICE A BARRE - 12/2004                          00128500
012860         GO TO C1-050.                                            00128600
012870 C1-040.                                                          00128700
012880*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00128800
012890     MOVE  55                TO BQVFB21-49-ERR-CAUS-ANNUL.        00128900
012900     MOVE 'E'                TO BQVFB21-49-ERR-CAUS-ANNUL-A.      00129000
012910     ADD  1                  TO W-CTR2.                           00129100
012920 C1-050.                                                          00129200
012930*--- SI CONTROLLA SE SONO STATI RISCONTRATI ERRORI SULLA          00129300
012940*--- CAUSALE ANNULL. OPPURE SULLA DATA-BONIF-APART                00129400
012950      IF BQVFB21-49-ERR-CAUS-ANNUL     NOT EQUAL ZERO  OR         00129500
012960         BQVFB21-49-ERR-DATA-BONIF-APP NOT EQUAL ZERO             00129600
012970         GO TO C1-010-CONTR-FORM-EX.                              00129700
012980 C1-060.                                                          00129800
012990      IF BQVFB21-49-CAUS-ANNUL  EQUAL 2                           00129900
013000      OR BQVFB21-49-CAUS-ANNUL  EQUAL 4                           00130000
013010      OR BQVFB21-49-CAUS-ANNUL  EQUAL 8                           00130100
013020         GO TO C1-090.                                            00130200
013030 C1-070.                                                          00130300
013040*--- CAUSALE ANNUL.=1,3,5,6,7    : DATA-BONIF-REND=DATA-APPART    00130400
013050      IF BQVFB21-49-DATA-BONIF-REN      EQUAL                     00130500
013060         BQVFB21-49-DATA-BONIF-APPART                             00130600
013070         GO TO C1-010-CONTR-FORM-EX.                              00130700
013080 C1-080.                                                          00130800
013090*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00130900
013100     MOVE  39                TO BQVFB21-49-ERR-DATA-BONIF-REN     00131000
013110     MOVE 'W'                TO BQVFB21-49-ERR-DATA-BON-REN-A.    00131100
013120     ADD  1                  TO W-CTR1.                           00131200
013130     GO TO C1-010-CONTR-FORM-EX.                                  00131300
013140 C1-090.                                                          00131400
013150*--- CAUSALE ANNUL.=2 O 4: DATA-BONIF-REND <= DATA-APPART         00131500
013160      IF BQVFB21-49-DATA-BONIF-REN    NOT GREATER                 00131600
013170         BQVFB21-49-DATA-BONIF-APPART                             00131700
013180         GO TO C1-110.                                            00131800
013190 C1-100.                                                          00131900
013200*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00132000
013210     MOVE  39                TO BQVFB21-49-ERR-DATA-BONIF-REN     00132100
013220     MOVE 'W'                TO BQVFB21-49-ERR-DATA-BON-REN-A.    00132200
013230     ADD  1                  TO W-CTR1.                           00132300
013240     GO TO C1-010-CONTR-FORM-EX.                                  00132400
013250 C1-110.                                                          00132500
013260*--- ROUTINE DI CONTROLLO DATA BONIFICO RENDICAZIONE              00132600
013270*---   IMPOSTAZIONE PARAMETRI PER RICHIAMO ROUTINE DI CONTROLLO   00132700
013280*---                                                              00132800
013290*---          IMPOSTAZIONE DELLA DATA DA CONTROLLARE              00132900
013300     MOVE BQVFB21-49-DATA-BONIF-REN    TO BQVFDA1-DAT1.           00133000
013310     MOVE SPACE                        TO BQVFDA1-DAT2.           00133100
013320*---                                                              00133200
013330     CALL 'BQVFDA' USING BQVFDA1.                                 00133300
013340*---                                                              00133400
013350*---                                                              00133500
013360     IF BQVFDA1-OK = 0                                            00133600
013370        GO TO C1-130.                                             00133700
013380 C1-120.                                                          00133800
013390*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00133900
013400     MOVE  96                TO BQVFB21-49-ERR-DATA-BONIF-REN     00134000
013410     MOVE 'W'                TO BQVFB21-49-ERR-DATA-BON-REN-A.    00134100
013420     ADD  1                  TO W-CTR1.                           00134200
013430     GO TO C1-010-CONTR-FORM-EX.                                  00134300
013440 C1-130.                                                          00134400
013450*--- DATA-BONIF-REND DEVE ESSERE UN GIORNO LAVORATIVO             00134500
013460     IF BQVFDA1-SETTIMANA > 5 OR                                  00134600
013470        BQVFDA1-FESTIVO = '1'                                     00134700
013480        GO TO C1-160.                                             00134800
013490 C1-140.                                                          00134900
013500*--- SI CONTROLLA CHE DATA BONIFICO RENDIC. SIA < DELLA DATA      00135000
013510*--- BONIFICO DI RIFERIMENTO.                                     00135100
013520      IF BQVFB21-49-DATA-BONIF-REN    LESS                        00135200
013530         BQVFB21-DATA-BONIF                                       00135300
013540         GO TO C1-010-CONTR-FORM-EX.                              00135400
013550 C1-150.                                                          00135500
013560*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00135600
013570     MOVE  45                TO BQVFB21-49-ERR-DATA-BONIF-REN     00135700
013580     MOVE 'W'                TO BQVFB21-49-ERR-DATA-BON-REN-A.    00135800
013590     ADD  1                  TO W-CTR1.                           00135900
013600     GO TO C1-010-CONTR-FORM-EX.                                  00136000
013610 C1-160.                                                          00136100
013620*---   IMPOSTAZIONE ERRORE NON BLOCCANTE                          00136200
013630     MOVE  45                TO BQVFB21-49-ERR-DATA-BONIF-REN     00136300
013640     MOVE 'W'                TO BQVFB21-49-ERR-DATA-BON-REN-A.    00136400
013650     ADD  1                  TO W-CTR1.                           00136500
013660 C1-010-CONTR-FORM-EX.                                            00136600
013670     EXIT.                                                        00136700
013680*--- NEW PERFORM FINE.                                            00136800
013690*--------------------------------------------------------------   00136900
013700*---   CONTROLLI SUI SALDI PER SEZIONE:                           00137000
013710*---   ..  W-IND = 1              ERARIO                          00137100
013720*---   ..  W-IND = 2              INPS                            00137200
013730*---   ..  W-IND = 3              REGIONE                         00137300
013740*---   ..  W-IND = 4              ENTI LOCALI                     00137400
013750*---   ..  W-IND = 5              INAIL                           00137500
013760*---   ..  W-IND = 6              ALTRI ENTI                      00137600
013770 A2-010-SAL-PAR.                                                  00137700
013780*---   SI CONTROLLA L'ESATTA IMPOSTAZIONE DEL SEGNO               00137800
013790     IF (W-SEGNO EQUAL 'N' AND W-IND NOT EQUAL 7) OR              00137900
013800        W-SEGNO EQUAL 'P'                                         00138000
013810       GO TO A2-030.                                              00138100
013820 A2-020.                                                          00138200
013830*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00138300
013840     MOVE 55                         TO W-SEGNO-ERR.              00138400
013850     MOVE 'E'                        TO W-SEGNO-ERR-A.            00138500
013860     ADD  1                          TO W-CTR2.                   00138600
013870 A2-030.                                                          00138700
013880*---   SI CONTROLLA LA NUMERICITA' DEL SALDO                      00138800
013890     IF W-SALDOA NUMERIC                                          00138900
013900       GO TO A2-050.                                              00139000
013910 A2-040.                                                          00139100
013920*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00139200
013930     MOVE 33                         TO W-SALDO-ERR.              00139300
013940     MOVE 'E'                        TO W-SALDO-ERR-A.            00139400
013950     ADD  1                          TO W-CTR2.                   00139500
013960     GO TO A2-010-SAL-PAR-EX.                                     00139600
013970 A2-050.                                                          00139700
013980*---   SI CONTROLLA L'IMPOSTAZIONE DEL SALDO                      00139800
013990     IF W-SALDO EQUAL ZERO                                        00139900
014000       GO TO A2-010-SAL-PAR-EX.                                   00140000
014010 A2-052.                                                          00140100
014020*---   SI CONTROLLA L'IMPOSTAZIONE DELLA REGIONE                  00140200
014030*    IF W-IND > 2 AND                                             00140300
014040*    IF W-IND = 3              AND                                00140400
014050*       W-APPO-COD-REG = ZERO                                     00140500
014060*       MOVE 15                      TO W-SALDO-ERR               00140600
014070*       MOVE 'E'                     TO W-SALDO-ERR-A             00140700
014080*       ADD  1                       TO W-CTR2                    00140800
014090*       GO TO A2-010-SAL-PAR-EX.                                  00140900
014100*---                                                              00141000
014110*---   SE IL NRO RIGHE DETTAGLIO INAIL > 0  O                     00141100
014120*---   SE IL NRO RIGHE DETTAGLIO ALTRI ENTI > 0                   00141200
014130*---   E SE W-IND = 7 IL SALDO DEVE ESSERE NULLO.                 00141300
014140*                                                                 00141400
014150     IF (W-IND   NOT EQUAL 7) OR                                  00141500
014160        (W-IND   EQUAL 7                    AND                   00141600
014170         BQVFB21-49-NUMRIG-INAILA = ZERO    AND                   00141700
014180         BQVFB21-49-NUMRIG-ALTRIA = ZERO       )                  00141800
014190        GO TO A2-055.                                             00141900
014200 A2-053.                                                          00142000
014210*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00142100
014220     MOVE 96                         TO W-SALDO-ERR.              00142200
014230     MOVE 'E'                        TO W-SALDO-ERR-A.            00142300
014240     ADD  1                          TO W-CTR2.                   00142400
014250     GO TO A2-010-SAL-PAR-EX.                                     00142500
014260 A2-055.                                                          00142600
014270*---   SI CONTROLLA L'IMPOSTAZIONE DELLA DIVISA                   00142700
014280     IF BQVFB21-49-DIV-OPER NOT EQUAL 'ITL' AND                   00142800
014290        BQVFB21-49-DIV-OPER NOT EQUAL 'EUR'                       00142900
014300       GO TO A2-010-SAL-PAR-EX.                                   00143000
014310*A2-060.                                                          00143100
014320*---   SI CONTROLLA L'IMPOSTAZIONE DELLA DIVISA                   00143200
014330*    IF BQVFB21-49-DIV-OPER EQUAL 'EUR'                           00143300
014340*      GO TO A2-010-SAL-PAR-EX.                                   00143400
014350 A2-070.                                                          00143500
014360*---   SE DIVISA = ITL SI CONTROLLA CHE LE ULTIME                 00143600
014370*---   TRE CIFRE SIANO IMPOSTATE A ZERO                           00143700
014380*---   SE DIVISA = EUR SI CONTROLLA CHE LE ULTIME                 00143800
014390*---   DUE CIFRE SIANO IMPOSTATE A ZERO                           00143900
014400     MOVE W-SALDO TO W-IMPORTO.                                   00144000
014410*INIZIO MODIFICA EURO                                             00144100
014420*CB 30/11/2001                                                    00144200
014430     IF BQVFB21-49-DATA-RISC <= '20011231'                        00144300
014440          IF (BQVFB21-49-DIV-OPER EQUAL 'EUR' AND                 00144400
014450             (BQVFB21-49-DATA-BONIF-APPART > '20011231' OR        00144500
014460              W-IMPORTO-2 EQUAL ZERO))            OR              00144600
014470             (BQVFB21-49-DIV-OPER EQUAL 'ITL'  AND                00144700
014480              W-IMPORTO-3 EQUAL ZERO)                             00144800
014490              GO TO A2-010-SAL-PAR-EX                             00144900
014500          ELSE                                                    00145000
014510              GO TO A2-080                                        00145100
014520          END-IF                                                  00145200
014530     END-IF.                                                      00145300
014540              GO TO A2-010-SAL-PAR-EX.                            00145400
014550*CB 30/11/2001                                                    00145500
014560*FINE   MODIFICA EURO                                             00145600
014570 A2-080.                                                          00145700
014580*---   IMPOSTAZIONE ERRORE BLOCCANTE                              00145800
014590     MOVE 96                         TO W-SALDO-ERR.              00145900
014600     MOVE 'E'                        TO W-SALDO-ERR-A.            00146000
014610     ADD  1                          TO W-CTR2.                   00146100
014620 A2-010-SAL-PAR-EX.                                               00146200
014630     EXIT.                                                        00146300
014640*--------------------------------------------------------------   00146400
014650*---   SI SOMMANO IN AREE DISTINTE I SALDI POSITIVI E NEGATIVI    00146500
014660 B2-010-SOMMA.                                                    00146600
014670     MOVE ZERO                TO W-SALDO-P.                       00146700
014680     MOVE ZERO                TO W-SALDO-N.                       00146800
014690*---   SI CONTROLLA IL SEGNO ERARIO                               00146900
014700*---                                                              00147000
014710     IF BQVFB21-49-SEGNO-ERARIO EQUAL 'P'                         00147100
014720       GO TO B2-030.                                              00147200
014730 B2-020.                                                          00147300
014740*---   S'INCREMENTA IL SALDO NEGATIVO                             00147400
014750     COMPUTE W-SALDO-N = W-SALDO-N + BQVFB21-49-SALDO-ERARIO.     00147500
014760     GO TO B2-040.                                                00147600
014770 B2-030.                                                          00147700
014780*---   S'INCREMENTA IL SALDO POSITIVO                             00147800
014790     COMPUTE W-SALDO-P = W-SALDO-P + BQVFB21-49-SALDO-ERARIO.     00147900
014800 B2-040.                                                          00148000
014810*---   SI CONTROLLA IL SEGNO INPS                                 00148100
014820*---                                                              00148200
014830     IF BQVFB21-49-SEGNO-INPS EQUAL 'P'                           00148300
014840       GO TO B2-060.                                              00148400
014850 B2-050.                                                          00148500
014860*---   S'INCREMENTA IL SALDO NEGATIVO                             00148600
014870     COMPUTE W-SALDO-N = W-SALDO-N + BQVFB21-49-SALDO-INPS.       00148700
014880     GO TO B2-070.                                                00148800
014890 B2-060.                                                          00148900
014900*---   S'INCREMENTA IL SALDO POSITIVO                             00149000
014910     COMPUTE W-SALDO-P = W-SALDO-P + BQVFB21-49-SALDO-INPS.       00149100
014920 B2-070.                                                          00149200
014930*---   SI CONTROLLA IL SEGNO REGIONE                              00149300
014940*---                                                              00149400
014950     IF BQVFB21-49-SEGNO-REG  EQUAL 'P'                           00149500
014960       GO TO B2-090.                                              00149600
014970 B2-080.                                                          00149700
014980*---   S'INCREMENTA IL SALDO NEGATIVO                             00149800
014990     COMPUTE W-SALDO-N = W-SALDO-N + BQVFB21-49-SALDO-REG.        00149900
015000     GO TO B2-100.                                                00150000
015010 B2-090.                                                          00150100
015020*---   S'INCREMENTA IL SALDO POSITIVO                             00150200
015030     COMPUTE W-SALDO-P = W-SALDO-P + BQVFB21-49-SALDO-REG.        00150300
015040 B2-100.                                                          00150400
015050*---   SI CONTROLLA IL SEGNO ENTI LOCALI                          00150500
015060*---                                                              00150600
015070     IF BQVFB21-49-SEGNO-ENTE EQUAL 'P'                           00150700
015080       GO TO B2-120.                                              00150800
015090 B2-110.                                                          00150900
015100*---   S'INCREMENTA IL SALDO NEGATIVO                             00151000
015110     COMPUTE W-SALDO-N = W-SALDO-N + BQVFB21-49-SALDO-ENTE.       00151100
015120     GO TO B2-130.                                                00151200
015130 B2-120.                                                          00151300
015140*---   S'INCREMENTA IL SALDO POSITIVO                             00151400
015150     COMPUTE W-SALDO-P = W-SALDO-P + BQVFB21-49-SALDO-ENTE.       00151500
015160 B2-130.                                                          00151600
015170*---   SI CONTROLLA IL SEGNO INAIL                                00151700
015180*---                                                              00151800
015190     IF BQVFB21-49-SEGNO-INAIL EQUAL 'P'                          00151900
015200       GO TO B2-150.                                              00152000
015210 B2-140.                                                          00152100
015220*---   S'INCREMENTA IL SALDO NEGATIVO                             00152200
015230     COMPUTE W-SALDO-N = W-SALDO-N + BQVFB21-49-SALDO-INAIL.      00152300
015240     GO TO B2-160.                                                00152400
015250 B2-150.                                                          00152500
015260*---   S'INCREMENTA IL SALDO POSITIVO                             00152600
015270     COMPUTE W-SALDO-P = W-SALDO-P + BQVFB21-49-SALDO-INAIL.      00152700
015280 B2-160.                                                          00152800
015290*---   SI CONTROLLA IL SEGNO ALTRI ENTI                           00152900
015300*---                                                              00153000
015310     IF BQVFB21-49-SEGNO-ALTRI EQUAL 'P'                          00153100
015320       GO TO B2-180.                                              00153200
015330 B2-170.                                                          00153300
015340*---   S'INCREMENTA IL SALDO NEGATIVO                             00153400
015350     COMPUTE W-SALDO-N = W-SALDO-N + BQVFB21-49-SALDO-ALTRI.      00153500
015360     GO TO B2-190.                                                00153600
015370 B2-180.                                                          00153700
015380*---   S'INCREMENTA IL SALDO POSITIVO                             00153800
015390     COMPUTE W-SALDO-P = W-SALDO-P + BQVFB21-49-SALDO-ALTRI.      00153900
015400 B2-190.                                                          00154000
015410*---   SI CONTROLLA IL SEGNO ACCISE                               00154100
015420*---                                                              00154200
015430     IF BQVFB21-49-SEGNO-ACCISE EQUAL 'P'                         00154300
015440       GO TO B2-210.                                              00154400
015450 B2-200.                                                          00154500
015460*---   S'INCREMENTA IL SALDO NEGATIVO                             00154600
015470     COMPUTE W-SALDO-N = W-SALDO-N + BQVFB21-49-SALDO-ACCISE.     00154700
015480     GO TO B2-010-SOMMA-EX.                                       00154800
015490 B2-210.                                                          00154900
015500*---   S'INCREMENTA IL SALDO POSITIVO                             00155000
015510     COMPUTE W-SALDO-P = W-SALDO-P + BQVFB21-49-SALDO-ACCISE.     00155100
015520 B2-010-SOMMA-EX.                                                 00155200
015530     EXIT.                                                        00155300
015540*--------------------------------------------------------------   00155400
015550*---   LA ROUTINE SPOSTA I DATI DEL RECORD ESITO CONCESSIONARIO   00155500
015560*---   IN QUELLO RELATIVO AD ESITO BANCA                          00155600
015570*--------------------------------------------------------------   00155700
015580*RX-010-BANCA.                                                    00155800
015590*    MOVE BQVFD21-50-SALDO-ERARIOA               TO               00155900
015600*                        BQVFB21-49-SALDO-ERARIOA.                00156000
015610*    MOVE BQVFD21-50-SALDO-FINALEA               TO               00156100
015620*                        BQVFB21-49-SALDO-FINALEA.                00156200
015630*    MOVE BQVFD21-50-SALDO-INPSA                 TO               00156300
015640*                        BQVFB21-49-SALDO-INPSA.                  00156400
015650*    MOVE BQVFD21-50-SALDO-REGA                  TO               00156500
015660*                        BQVFB21-49-SALDO-REGA.                   00156600
015670*                                                                 00156700
015680*--- NEW:                                                         00156800
015690*    MOVE BQVFD21-50-SALDO-ENTEA                 TO               00156900
015700*                        BQVFB21-49-SALDO-ENTEA.                  00157000
015710*    MOVE BQVFD21-50-SALDO-INAILA                 TO              00157100
015720*                        BQVFB21-49-SALDO-INAILA.                 00157200
015730*    MOVE BQVFD21-50-SALDO-ALTRIA                 TO              00157300
015740*                        BQVFB21-49-SALDO-ALTRIA.                 00157400
015750*--- NEW: FINE.                                                   00157500
015760*    MOVE BQVFD21-50-SALDO-REG2A                 TO               00157600
015770*                        BQVFB21-49-SALDO-REG2A.                  00157700
015780*    MOVE BQVFD21-50-SEGNO-ERARIO                TO               00157800
015790*                        BQVFB21-49-SEGNO-ERARIO.                 00157900
015800*    MOVE BQVFD21-50-SEGNO-INPS                  TO               00158000
015810*                        BQVFB21-49-SEGNO-INPS.                   00158100
015820*    MOVE BQVFD21-50-SEGNO-REG                  TO                00158200
015830*                        BQVFB21-49-SEGNO-REG.                    00158300
015840*    MOVE BQVFD21-50-SEGNO-REG2                  TO               00158400
015850*                        BQVFB21-49-SEGNO-REG2.                   00158500
015860*--- NEW:                                                         00158600
015870*    MOVE BQVFD21-50-SEGNO-ENTE                  TO               00158700
015880*                        BQVFB21-49-SEGNO-ENTE.                   00158800
015890*    MOVE BQVFD21-50-SEGNO-INAIL                  TO              00158900
015900*                        BQVFB21-49-SEGNO-INAIL.                  00159000
015910*    MOVE BQVFD21-50-SEGNO-ALTRI                  TO              00159100
015920*                        BQVFB21-49-SEGNO-ALTRI.                  00159200
015930*--- NEW: FINE.                                                   00159300
015940*    MOVE BQVFD21-50-MOD-CONFER                  TO               00159400
015950*                        BQVFB21-49-MOD-CONFER.                   00159500
015960*    MOVE BQVFD21-50-MOD-PAG                     TO               00159600
015970*                       BQVFB21-49-MOD-PAG.                       00159700
015980*    MOVE BQVFD21-50-DATA-BONIF-APPART           TO               00159800
015990*                        BQVFB21-49-DATA-BONIF-APPART.            00159900
016000*    MOVE BQVFD21-50-IMP-NON-COPERTOA            TO               00160000
016010*                        BQVFB21-49-IMP-NON-COPERTOA.             00160100
016020*    MOVE BQVFD21-50-ABI-TRASS-EMITTA            TO               00160200
016030*                        BQVFB21-49-ABI-TRASS-EMITTA.             00160300
016040*    MOVE BQVFD21-50-CAB-TRASS-EMITTA            TO               00160400
016050*                        BQVFB21-49-CAB-TRASS-EMITTA.             00160500
016060*    MOVE BQVFD21-50-NUM-ASSEGNO                 TO               00160600
016070*                        BQVFB21-49-NUM-ASSEGNO.                  00160700
016080*    MOVE BQVFD21-50-PROG-RIGAA                  TO               00160800
016090*                        BQVFB21-49-PROG-RIGAA.                   00160900
016100*    MOVE BQVFD21-50-CODICE-CONCA                TO               00161000
016110*                        BQVFB21-49-CODICE-CONCA.                 00161100
016120*    MOVE BQVFD21-50-CODICE-FISC                 TO               00161200
016130*                        BQVFB21-49-CODICE-FISC.                  00161300
016140*    MOVE BQVFD21-50-FLAG-ERR-CONC               TO               00161400
016150*                        BQVFB21-49-FLAG-ERR-CONC.                00161500
016160*    MOVE BQVFD21-50-FLAG-ERR-CF                 TO               00161600
016170*                        BQVFB21-49-FLAG-ERR-CF.                  00161700
016180*    MOVE BQVFD21-50-DATA-RISC                   TO               00161800
016190*                        BQVFB21-49-DATA-RISC.                    00161900
016200*    MOVE BQVFD21-50-DIV-OPER                    TO               00162000
016210*                        BQVFB21-49-DIV-OPER.                     00162100
016220*    MOVE BQVFD21-50-COD-REGA                   TO                00162200
016230*                        BQVFB21-49-COD-REGA.                     00162300
016240*    MOVE BQVFD21-50-COD-REG2A                   TO               00162400
016250*                        BQVFB21-49-COD-REG2A.                    00162500
016260*    MOVE BQVFD21-50-NUMRIG-ERARIOA              TO               00162600
016270*                        BQVFB21-49-NUMRIG-ERARIOA.               00162700
016280*    MOVE BQVFD21-50-NUMRIG-INPSA                TO               00162800
016290*                        BQVFB21-49-NUMRIG-INPSA.                 00162900
016300*    MOVE BQVFD21-50-NUMRIG-REGIONIA             TO               00163000
016310*                        BQVFB21-49-NUMRIG-REGIONIA.              00163100
016320*--- NEW:                                                         00163200
016330*    MOVE BQVFD21-50-NUMRIG-ENTIA                TO               00163300
016340*                        BQVFB21-49-NUMRIG-ENTIA.                 00163400
016350*    MOVE BQVFD21-50-NUMRIG-INAILA               TO               00163500
016360*                        BQVFB21-49-NUMRIG-INAILA.                00163600
016370*    MOVE BQVFD21-50-NUMRIG-ALTRIA               TO               00163700
016380*                        BQVFB21-49-NUMRIG-ALTRIA.                00163800
016390*--- NEW: FINE.                                                   00163900
016400*    MOVE BQVFD21-50-ERR-PROG-RIGA               TO               00164000
016410*                        BQVFB21-49-ERR-PROG-RIGA.                00164100
016420*    MOVE BQVFD21-50-ERR-PROG-RIGA-A             TO               00164200
016430*                        BQVFB21-49-ERR-PROG-RIGA-A.              00164300
016440*--- NEW:                                                         00164400
016450*    MOVE BQVFD21-50-COD-ALTRO                   TO               00164500
016460*                        BQVFB21-49-COD-ALTRO.                    00164600
016470*    MOVE BQVFD21-50-CAUS-ANNUL                  TO               00164700
016480*                        BQVFB21-49-CAUS-ANNUL.                   00164800
016490*    MOVE BQVFD21-50-DATA-BONIF-REND             TO               00164900
016500*                        BQVFB21-49-DATA-BONIF-REND.              00165000
016510*--- NEW: FINE.                                                   00165100
016520*RX-010-BANCA-EX.                                                 00165200
016530*    EXIT.                                                        00165300
016540*---   LA ROUTINE SPOSTA I DATI DEL RECORD ESITO BANCA IN QUELLO  00165400
016550*---   RELATIVO AD ESITO CONCESSIONARIO                           00165500
016560*RY-010-CONC.                                                     00165600
016570*---   IMPOSTAZIONE DEI CODICI DI ERRORE                          00165700
016580*    MOVE BQVFB21-49-ERR-SALDO-ERARIO                TO           00165800
016590*                        BQVFD21-50-ERR-SALDO-ERARIO.             00165900
016600*    MOVE BQVFB21-49-ERR-SALDO-FINALE                TO           00166000
016610*                        BQVFD21-50-ERR-SALDO-FINALE.             00166100
016620*    MOVE BQVFB21-49-ERR-SALDO-INPS                  TO           00166200
016630*                        BQVFD21-50-ERR-SALDO-INPS.               00166300
016640*    MOVE BQVFB21-49-ERR-SALDO-REG                   TO           00166400
016650*                        BQVFD21-50-ERR-SALDO-REG.                00166500
016660*    MOVE BQVFB21-49-ERR-SALDO-REG2                  TO           00166600
016670*                        BQVFD21-50-ERR-SALDO-REG2.               00166700
016680*--- NEWW:                                                        00166800
016690*    MOVE BQVFB21-49-ERR-SALDO-ENTE                  TO           00166900
016700*                        BQVFD21-50-ERR-SALDO-ENTE.               00167000
016710*    MOVE BQVFB21-49-ERR-SALDO-INAIL                 TO           00167100
016720*                        BQVFD21-50-ERR-SALDO-INAIL.              00167200
016730*    MOVE BQVFB21-49-ERR-SALDO-ALTRI                 TO           00167300
016740*                        BQVFD21-50-ERR-SALDO-ALTRI.              00167400
016750*--- NEWW: FINE.                                                  00167500
016760*    MOVE BQVFB21-49-ERR-SEGNO-ERARIO                TO           00167600
016770*                        BQVFD21-50-ERR-SEGNO-ERARIO.             00167700
016780*    MOVE BQVFB21-49-ERR-SEGNO-INPS                  TO           00167800
016790*                        BQVFD21-50-ERR-SEGNO-INPS.               00167900
016800*    MOVE BQVFB21-49-ERR-SEGNO-REG                   TO           00168000
016810*                        BQVFD21-50-ERR-SEGNO-REG.                00168100
016820*    MOVE BQVFB21-49-ERR-SEGNO-REG2                  TO           00168200
016830*                        BQVFD21-50-ERR-SEGNO-REG2.               00168300
016840*--- NEW:                                                         00168400
016850*    MOVE BQVFB21-49-ERR-SEGNO-ENTE                  TO           00168500
016860*                        BQVFD21-50-ERR-SEGNO-ENTE.               00168600
016870*    MOVE BQVFB21-49-ERR-SEGNO-INAIL                 TO           00168700
016880*                        BQVFD21-50-ERR-SEGNO-INAIL.              00168800
016890*    MOVE BQVFB21-49-ERR-SEGNO-ALTRI                 TO           00168900
016900*                        BQVFD21-50-ERR-SEGNO-ALTRI.              00169000
016910*--- NEW: FINE.                                                   00169100
016920*    MOVE BQVFB21-49-ERR-MOD-CONFER                  TO           00169200
016930*                        BQVFD21-50-ERR-MOD-CONFER.               00169300
016940*    MOVE BQVFB21-49-ERR-MOD-PAG                     TO           00169400
016950*                        BQVFD21-50-ERR-MOD-PAG.                  00169500
016960*    MOVE BQVFB21-49-ERR-DATA-BONIF-APP              TO           00169600
016970*                        BQVFD21-50-ERR-DATA-BONIF-APP.           00169700
016980*    MOVE BQVFB21-49-ERR-IMP-NON-COPERTO             TO           00169800
016990*                        BQVFD21-50-ERR-IMP-NON-COPERTO.          00169900
017000*    MOVE BQVFB21-49-ERR-ABI-TRASS-EMITT             TO           00170000
017010*                        BQVFD21-50-ERR-ABI-TRASS-EMITT.          00170100
017020*    MOVE BQVFB21-49-ERR-CAB-TRASS-EMITT             TO           00170200
017030*                        BQVFD21-50-ERR-CAB-TRASS-EMITT.          00170300
017040*    MOVE BQVFB21-49-ERR-NUM-ASSEGNO                 TO           00170400
017050*                        BQVFD21-50-ERR-NUM-ASSEGNO.              00170500
017060*    MOVE BQVFB21-49-ERR-PROG-RIGA               TO               00170600
017070*                        BQVFD21-50-ERR-PROG-RIGA.                00170700
017080*    MOVE BQVFB21-49-ERR-CODICE-CONC             TO               00170800
017090*                        BQVFD21-50-ERR-CODICE-CONC.              00170900
017100*    MOVE BQVFB21-49-ERR-CODICE-FISC             TO               00171000
017110*                        BQVFD21-50-ERR-CODICE-FISC.              00171100
017120*    MOVE BQVFB21-49-ERR-FLAG-ERR-CONC           TO               00171200
017130*                        BQVFD21-50-ERR-FLAG-ERR-CONC.            00171300
017140*    MOVE BQVFB21-49-ERR-FLAG-ERR-CF             TO               00171400
017150*                        BQVFD21-50-ERR-FLAG-ERR-CF.              00171500
017160*    MOVE BQVFB21-49-ERR-DATA-RISC               TO               00171600
017170*                        BQVFD21-50-ERR-DATA-RISC.                00171700
017180*    MOVE BQVFB21-49-ERR-DIV-OPER                TO               00171800
017190*                        BQVFD21-50-ERR-DIV-OPER.                 00171900
017200*    MOVE BQVFB21-49-ERR-COD-REG                 TO               00172000
017210*                        BQVFD21-50-ERR-COD-REG.                  00172100
017220*    MOVE BQVFB21-49-ERR-COD-REG2                TO               00172200
017230*                        BQVFD21-50-ERR-COD-REG2.                 00172300
017240*    MOVE BQVFB21-49-ERR-NUMRIG-ERARIO           TO               00172400
017250*                        BQVFD21-50-ERR-NUMRIG-ERARIO.            00172500
017260*    MOVE BQVFB21-49-ERR-NUMRIG-INPS             TO               00172600
017270*                        BQVFD21-50-ERR-NUMRIG-INPS.              00172700
017280*    MOVE BQVFB21-49-ERR-NUMRIG-REGIONI          TO               00172800
017290*                        BQVFD21-50-ERR-NUMRIG-REGIONI.           00172900
017300*--- NEW:                                                         00173000
017310*    MOVE BQVFB21-49-ERR-NUMRIG-ENTI             TO               00173100
017320*                        BQVFD21-50-ERR-NUMRIG-ENTI.              00173200
017330*    MOVE BQVFB21-49-ERR-NUMRIG-INAIL          TO                 00173300
017340*                        BQVFD21-50-ERR-NUMRIG-INAIL.             00173400
017350*    MOVE BQVFB21-49-ERR-NUMRIG-ALTRI            TO               00173500
017360*                        BQVFD21-50-ERR-NUMRIG-ALTRI.             00173600
017370*    MOVE BQVFB21-49-ERR-COD-ALTRO               TO               00173700
017380*                        BQVFD21-50-ERR-COD-ALTRO.                00173800
017390*    MOVE BQVFB21-49-ERR-CAUS-ANNUL              TO               00173900
017400*                        BQVFD21-50-ERR-CAUS-ANNUL.               00174000
017410*    MOVE BQVFB21-49-ERR-DATA-BONIF-REN          TO               00174100
017420*                        BQVFD21-50-ERR-DATA-BONIF-REN.           00174200
017430*--- NEW: FINE.                                                   00174300
017440*---   IMPOSTAZIONE DEL TIPO DI ERRORE:                           00174400
017450*---       "B" BLOCCANTE                                          00174500
017460*---       "W" NON BLOCCANTE                                      00174600
017470*    MOVE BQVFB21-49-ERR-SALDO-ERARIO-A              TO           00174700
017480*                        BQVFD21-50-ERR-SALDO-ERARIO-A.           00174800
017490*    MOVE BQVFB21-49-ERR-SALDO-FINALE-A              TO           00174900
017500*                        BQVFD21-50-ERR-SALDO-FINALE-A.           00175000
017510*    MOVE BQVFB21-49-ERR-SALDO-INPS-A                TO           00175100
017520*                        BQVFD21-50-ERR-SALDO-INPS-A.             00175200
017530*    MOVE BQVFB21-49-ERR-SALDO-REG-A                TO            00175300
017540*                        BQVFD21-50-ERR-SALDO-REG-A.              00175400
017550*    MOVE BQVFB21-49-ERR-SALDO-REG2-A                TO           00175500
017560*                        BQVFD21-50-ERR-SALDO-REG2-A.             00175600
017570*--- NEW:                                                         00175700
017580*    MOVE BQVFB21-49-ERR-SALDO-ENTE-A                TO           00175800
017590*                        BQVFD21-50-ERR-SALDO-ENTE-A.             00175900
017600*    MOVE BQVFB21-49-ERR-SALDO-INAIL-A                TO          00176000
017610*                        BQVFD21-50-ERR-SALDO-INAIL-A.            00176100
017620*    MOVE BQVFB21-49-ERR-SALDO-ALTRI-A                TO          00176200
017630*                        BQVFD21-50-ERR-SALDO-ALTRI-A.            00176300
017640*--- NEW: FINE.                                                   00176400
017650*    MOVE BQVFB21-49-ERR-SEGNO-ERARIO-A              TO           00176500
017660*                        BQVFD21-50-ERR-SEGNO-ERARIO-A.           00176600
017670*    MOVE BQVFB21-49-ERR-SEGNO-INPS-A                TO           00176700
017680*                        BQVFD21-50-ERR-SEGNO-INPS-A.             00176800
017690*    MOVE BQVFB21-49-ERR-SEGNO-REG-A                 TO           00176900
017700*                        BQVFD21-50-ERR-SEGNO-REG-A.              00177000
017710*    MOVE BQVFB21-49-ERR-SEGNO-REG2-A                TO           00177100
017720*                        BQVFD21-50-ERR-SEGNO-REG2-A.             00177200
017730*--- NEW:                                                         00177300
017740*    MOVE BQVFB21-49-ERR-SEGNO-ENTE-A                TO           00177400
017750*                        BQVFD21-50-ERR-SEGNO-ENTE-A.             00177500
017760*    MOVE BQVFB21-49-ERR-SEGNO-INAIL-A                TO          00177600
017770*                        BQVFD21-50-ERR-SEGNO-INAIL-A.            00177700
017780*    MOVE BQVFB21-49-ERR-SEGNO-ALTRI-A                TO          00177800
017790*                        BQVFD21-50-ERR-SEGNO-ALTRI-A.            00177900
017800*--- NEW: FINE.                                                   00178000
017810*    MOVE BQVFB21-49-ERR-MOD-CONFER-A                TO           00178100
017820*                        BQVFD21-50-ERR-MOD-CONFER-A.             00178200
017830*    MOVE BQVFB21-49-ERR-MOD-PAG-A                   TO           00178300
017840*                        BQVFD21-50-ERR-MOD-PAG-A.                00178400
017850*    MOVE BQVFB21-49-ERR-DATA-BON-APP-A              TO           00178500
017860*                        BQVFD21-50-ERR-DATA-BON-APP-A.           00178600
017870*    MOVE BQVFB21-49-ERR-IMP-NON-COP-A               TO           00178700
017880*                        BQVFD21-50-ERR-IMP-NON-COP-A.            00178800
017890*    MOVE BQVFB21-49-ERR-ABI-TRASS-EMI-A             TO           00178900
017900*                        BQVFD21-50-ERR-ABI-TRASS-EMI-A.          00179000
017910*    MOVE BQVFB21-49-ERR-CAB-TRASS-EMI-A             TO           00179100
017920*                        BQVFD21-50-ERR-CAB-TRASS-EMI-A.          00179200
017930*    MOVE BQVFB21-49-ERR-NUM-ASSEGNO-A               TO           00179300
017940*                        BQVFD21-50-ERR-NUM-ASSEGNO-A.            00179400
017950*    MOVE BQVFB21-49-ERR-PROG-RIGA-A             TO               00179500
017960*                        BQVFD21-50-ERR-PROG-RIGA-A.              00179600
017970*    MOVE BQVFB21-49-ERR-CODICE-CONC-A           TO               00179700
017980*                        BQVFD21-50-ERR-CODICE-CONC-A.            00179800
017990*    MOVE BQVFB21-49-ERR-CODICE-FISC-A           TO               00179900
018000*                        BQVFD21-50-ERR-CODICE-FISC-A.            00180000
018010*    MOVE BQVFB21-49-ERR-FLAG-ERR-CONC-A         TO               00180100
018020*                        BQVFD21-50-ERR-FLAG-ERR-CONC-A.          00180200
018030*    MOVE BQVFB21-49-ERR-FLAG-ERR-CF-A           TO               00180300
018040*                        BQVFD21-50-ERR-FLAG-ERR-CF-A.            00180400
018050*    MOVE BQVFB21-49-ERR-DATA-RISC-A             TO               00180500
018060*                        BQVFD21-50-ERR-DATA-RISC-A.              00180600
018070*    MOVE BQVFB21-49-ERR-DIV-OPER-A             TO                00180700
018080*                        BQVFD21-50-ERR-DIV-OPER-A.               00180800
018090*    MOVE BQVFB21-49-ERR-COD-REG-A              TO                00180900
018100*                       BQVFD21-50-ERR-COD-REG-A.                 00181000
018110*    MOVE BQVFB21-49-ERR-COD-REG2-A              TO               00181100
018120*                        BQVFD21-50-ERR-COD-REG2-A.               00181200
018130*    MOVE BQVFB21-49-ERR-NUMRIG-ERARIO-A         TO               00181300
018140*                        BQVFD21-50-ERR-NUMRIG-ERARIO-A.          00181400
018150*    MOVE BQVFB21-49-ERR-NUMRIG-INPS-A           TO               00181500
018160*                        BQVFD21-50-ERR-NUMRIG-INPS-A.            00181600
018170*    MOVE BQVFB21-49-ERR-NUMRIG-REG-A            TO               00181700
018180*                        BQVFD21-50-ERR-NUMRIG-REG-A.             00181800
018190*    MOVE BQVFB21-49-ERR-NUMRIG-ENTI-A           TO               00181900
018200*                        BQVFD21-50-ERR-NUMRIG-ENTI-A.            00182000
018210*    MOVE BQVFB21-49-ERR-NUMRIG-INAIL-A          TO               00182100
018220*                        BQVFD21-50-ERR-NUMRIG-INAIL-A.           00182200
018230*    MOVE BQVFB21-49-ERR-NUMRIG-ALTRI-A          TO               00182300
018240*                        BQVFD21-50-ERR-NUMRIG-ALTRI-A.           00182400
018250*    MOVE BQVFB21-49-ERR-COD-ALTRO-A      TO                      00182500
018260*                        BQVFD21-50-ERR-COD-ALTRO-A.              00182600
018270*    MOVE BQVFB21-49-ERR-CAUS-ANNUL-A     TO                      00182700
018280*                        BQVFD21-50-ERR-CAUS-ANNUL-A.             00182800
018290*    MOVE BQVFB21-49-ERR-DATA-BON-REN-A   TO                      00182900
018300*                        BQVFD21-50-ERR-DATA-BON-REN-A.           00183000
018310*RY-010-CONC-EX.                                                  00183100
018320*    EXIT.                                                        00183200
018330*                                                                 00183300
018340****************************************************************  00183400
018350*---   LA ROUTINE INIZIALIZZA I CAMPI RELATIVI AGLI ERRORI        00183500
018360*---   NEL RECORD RELATIVO AD ESITO BANCA                         00183600
018370****************************************************************  00183700
018380*                                                                 00183800
018390 RZ-010-INIZIA.                                                   00183900
018400*---   CODICI DI ERRORE                                           00184000
018410     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-ERARIO.          00184100
018420     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-FINALE.          00184200
018430     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-INPS.            00184300
018440     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-REG.             00184400
018450     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-ENTE.            00184500
018460     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-INAIL.           00184600
018470     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-ALTRI.           00184700
018480     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-ACCISE.          00184800
018490     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-ERARIO.          00184900
018500     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-INPS.            00185000
018510     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-REG.             00185100
018520     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-ENTE.            00185200
018530     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-INAIL.           00185300
018540     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-ALTRI.           00185400
018550     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-ACCISE.          00185500
018560**** MOVE ZERO           TO BQVFB21-49-ERR-MOD-CONFER.            00185600
018570     MOVE ZERO           TO BQVFB21-49-ERR-COD-CAB.               00185700
018580     MOVE ZERO           TO BQVFB21-49-ERR-MOD-PAG.               00185800
018590     MOVE ZERO           TO BQVFB21-49-ERR-DATA-BONIF-APP.        00185900
018600**** MOVE ZERO           TO BQVFB21-49-ERR-IMP-NON-COPERTO.       00186000
018610     MOVE ZERO           TO BQVFB21-49-ERR-ABI-TRASS-EMITT.       00186100
018620     MOVE ZERO           TO BQVFB21-49-ERR-CAB-TRASS-EMITT.       00186200
018630     MOVE ZERO           TO BQVFB21-49-ERR-NUM-ASSEGNO.           00186300
018640     MOVE ZERO           TO BQVFB21-49-ERR-NUM-RIFER.             00186400
018650     MOVE ZERO           TO BQVFB21-49-ERR-COD-CONT-NRIF.         00186500
018660     MOVE ZERO           TO BQVFB21-49-ERR-SIGLA-PROV.            00186600
018670     MOVE ZERO           TO BQVFB21-49-ERR-PROG-ACCR-BON.         00186700
018680**** MOVE ZERO           TO BQVFB21-49-ERR-CODICE-CONC.           00186800
018690     MOVE ZERO           TO BQVFB21-49-ERR-CODICE-FISC.           00186900
018700**** MOVE ZERO           TO BQVFB21-49-ERR-FLAG-ERR-CONC.         00187000
018710     MOVE ZERO           TO BQVFB21-49-ERR-FLAG-ERR-CF.           00187100
018720     MOVE ZERO           TO BQVFB21-49-ERR-DATA-RISC.             00187200
018730**** MOVE ZERO           TO BQVFB21-49-ERR-COD-REG.               00187300
018740**** MOVE ZERO           TO BQVFB21-49-ERR-COD-REG2.              00187400
018750     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-ERARIO.         00187500
018760     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-INPS.           00187600
018770     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-REGIONI.        00187700
018780     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-ENTI.           00187800
018790     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-INAIL.          00187900
018800     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-ALTRI.          00188000
018810     MOVE ZERO           TO BQVFB21-49-ERR-COD-ALTRO.             00188100
018820     MOVE ZERO           TO BQVFB21-49-ERR-CAUS-ANNUL.            00188200
018830     MOVE ZERO           TO BQVFB21-49-ERR-DATA-BONIF-REN.        00188300
018840*  INIZIO MODIFICA CODICE A BARRE - 12/2004                       00188400
018850     MOVE ZERO           TO BQVFB21-49-ERR-IDENT-PAGAM.           00188500
018860*  FINE MODIFICA CODICE A BARRE - 12/2004                         00188600
018870**** MOVE ZERO           TO BQVFB21-49-ERR-DIV-OPER.              00188700
018880*---   TIPO DI ERRORE:                                            00188800
018890*---   .. "E"   BLOCCANTE;                                        00188900
018900*---   .. "W"   NON BLOCCANTE                                     00189000
018910     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-ERARIO-A.        00189100
018920     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-FINALE-A.        00189200
018930     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-INPS-A.          00189300
018940     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-REG-A.           00189400
018950**** MOVE ZERO           TO BQVFB21-49-ERR-SALDO-REG2-A.          00189500
018960     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-ENTE-A.          00189600
018970     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-INAIL-A.         00189700
018980     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-ALTRI-A.         00189800
018990     MOVE ZERO           TO BQVFB21-49-ERR-SALDO-ACCISE-A.        00189900
019000     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-ERARIO-A.        00190000
019010     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-INPS-A.          00190100
019020     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-REG-A.           00190200
019030***** MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-REG2-A.         00190300
019040     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-ENTE-A.          00190400
019050     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-INAIL-A.         00190500
019060     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-ALTRI-A.         00190600
019070     MOVE ZERO           TO BQVFB21-49-ERR-SEGNO-ACCISE-A.        00190700
019080**** MOVE ZERO           TO BQVFB21-49-ERR-MOD-CONFER-A.          00190800
019090     MOVE ZERO           TO BQVFB21-49-ERR-COD-CAB-A.             00190900
019100     MOVE ZERO           TO BQVFB21-49-ERR-MOD-PAG-A.             00191000
019110     MOVE ZERO           TO BQVFB21-49-ERR-DATA-BON-APP-A.        00191100
019120**** MOVE ZERO           TO BQVFB21-49-ERR-IMP-NON-COP-A.         00191200
019130     MOVE ZERO           TO BQVFB21-49-ERR-ABI-TRASS-EMI-A.       00191300
019140     MOVE ZERO           TO BQVFB21-49-ERR-CAB-TRASS-EMI-A.       00191400
019150     MOVE ZERO           TO BQVFB21-49-ERR-NUM-ASSEGNO-A.         00191500
019160     MOVE ZERO           TO BQVFB21-49-ERR-NUM-RIFER-A.           00191600
019170     MOVE ZERO           TO BQVFB21-49-ERR-COD-CONT-NRIF-A.       00191700
019180     MOVE ZERO           TO BQVFB21-49-ERR-SIGLA-PROV-A.          00191800
019190     MOVE ZERO           TO BQVFB21-49-ERR-PROG-ACCR-BON-A.       00191900
019200***** MOVE ZERO           TO BQVFB21-49-ERR-CODICE-CONC-A.        00192000
019210     MOVE ZERO           TO BQVFB21-49-ERR-CODICE-FISC-A.         00192100
019220***** MOVE ZERO           TO BQVFB21-49-ERR-FLAG-ERR-CONC-A.      00192200
019230     MOVE ZERO           TO BQVFB21-49-ERR-FLAG-ERR-CF-A.         00192300
019240     MOVE ZERO           TO BQVFB21-49-ERR-DATA-RISC-A.           00192400
019250**** MOVE ZERO           TO BQVFB21-49-ERR-COD-REG-A.             00192500
019260***** MOVE ZERO           TO BQVFB21-49-ERR-COD-REG2-A.           00192600
019270     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-ERARIO-A.       00192700
019280     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-INPS-A.         00192800
019290     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-REG-A.          00192900
019300     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-ENTI-A.         00193000
019310     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-INAIL-A.        00193100
019320     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-ALTRI-A.        00193200
019330     MOVE ZERO           TO BQVFB21-49-ERR-NUMRIG-ACCISE-A.       00193300
019340     MOVE ZERO           TO BQVFB21-49-ERR-COD-ALTRO-A.           00193400
019350     MOVE ZERO           TO BQVFB21-49-ERR-CAUS-ANNUL-A.          00193500
019360**** MOVE ZERO           TO BQVFB21-50-ERR-DIV-OPER-A.            00193600
019370     MOVE ZERO           TO BQVFB21-49-ERR-DATA-BON-REN-A.        00193700
019380*  INIZIO MODIFICA CODICE A BARRE - 12/2004                       00193800
019390     MOVE ZERO           TO BQVFB21-49-ERR-IDENT-PAGAM-A.         00193900
019400*  FINE MODIFICA CODICE A BARRE - 12/2004                         00194000
019410 RZ-010-INIZIA-EX.                                                00194100
019420     EXIT.                                                        00194200
