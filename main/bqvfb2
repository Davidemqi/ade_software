000010 IDENTIFICATION DIVISION.                                         00000100
000020 PROGRAM-ID.     BQVFB2.                                          00000200
000030 AUTHOR. N9143 - R. D'ELIA.                                       00000300
000040 DATE-WRITTEN.  12/05/2001.                                       00000400
000050*************************************************************     00000500
000060*$1 TITOLO -  CONTROLLO TIPO RECORD 02  -  SEZIONE INPS           00000600
000070*************************************************************     00000700
000080*$1 FUNZIONI SVOLTE E LOGICA DI ELABORAZIONE                      00000800
000090*   IL COMPONENTE RICEVE IN INPUT I DATI RELATIVI AL RECORD       00000900
000100*   DI TIPO 02 (TRAMITE MODULO DI COLLOQUIO FBQVFB21) E           00001000
000110*   SVOLGE DEI CONTROLLI FORMALI E DI CONGRUENZA SUI CAMPI;       00001100
000120*   IN CASO DI INCORRETTEZZE PROVVEDE AD IMPOSTARE (NELLO         00001200
000130*   STESSO MODULO) DEI CODICI DI ERRORE ED INCREMENTA I           00001300
000140*   CONTATORI RELATIVI AL TIPO DI ERRORE (BLOCCANTE/NON           00001400
000150*   BLOCCANTE)                                                    00001500
000160*                                                                 00001600
000170* 2. ARCHIVI GESTITI                                              00001700
000180*      NESSUNO                                                    00001800
000190*                                                                 00001900
000200* 3. SUBROUTINES RICHIAMATE                                       00002000
000210*      NOME       DESCRIZIONE                                     00002100
000220*    BQVFSR    ROUTINE DI ABEND                                   00002200
000230*                                                                 00002300
000240 ENVIRONMENT DIVISION.                                            00002400
000250 CONFIGURATION SECTION.                                           00002500
000260 SPECIAL-NAMES.                                                   00002600
000270     DECIMAL-POINT IS COMMA.                                      00002700
000280 INPUT-OUTPUT SECTION.                                            00002800
000290 FILE-CONTROL.                                                    00002900
000300 DATA DIVISION.                                                   00003000
000310 FILE SECTION.                                                    00003100
000320***************  WORKING STORAGE SECTION  **********************  00003200
000330 WORKING-STORAGE SECTION.                                         00003300
000340 77  W-S                            PIC X(8) VALUE 'BQVFB2WS'.    00003400
000350** CODICE SEDE INPS LETTO DAL FILE                                00003500
000360 77  W-SEDE-INP                     PIC X(4).                     00003600
000370** MATRICOLA INPS LETTA DAL FILE                                  00003700
000380 77  W-MATR-INP                     PIC X(4).                     00003800
000390** CODICE PROVINCIA LETTO DAL FILE                                00003900
000400 77  W-PROV-INP                     PIC X(2).                     00004000
000410** CODICE AMBITO LETTO DAL FILE                                   00004100
000420 77  W-AMBITO-INP                   PIC X(3).                     00004200
000430 77  W-DATA-INP                     PIC X(8).                     00004300
000440 77  W-PROV-OUT                     PIC X(2).                     00004400
000450 77  W-SAP-OUT                      PIC X(4).                     00004500
000460 77  W-FLAG-TROVATO                 PIC 9(1).                     00004600
000470 77  W-FF                           PIC X(2).                     00004700
000480*01  W-CAUS-CONTR                   PIC X(004).                   00004800
000490*    88  W-CAUS-CONTR-OK    VALUE 'DPP ' 'AP  ' 'CP  ' 'DPPR'     00004900
000500*                                 'DPPI' 'APR ' 'API ' 'CPR '     00005000
000510*                                 'CPI '.                         00005100
000520*---    DATA RISCOSSIONE                                          00005200
000530*---                                                              00005300
000540 01  W-DATA-RISC.                                                 00005400
000550     03  W-DATA-RISC-AAAAMM.                                      00005500
000560         05  W-DATA-RISC-AA         PIC X(004).                   00005600
000570         05  W-DATA-RISC-MM         PIC X(002).                   00005700
000580     03  W-DATA-RISC-GG             PIC X(002).                   00005800
000590*---                                                              00005900
000600 01  W-CAUSALE-OK                   PIC X(002).                   00006000
000610*--- NEW:                                                         00006100
000620 01  W-FLAG-ERR                     PIC X(001).                   00006200
000630*--- NEW: FINE.                                                   00006300
000640*---   CAMPI PER INDICARE IL FORMATO MATRICOLA                    00006400
000650*---                                                              00006500
000660 01  W-FORMATI.                                                   00006600
000670     03  W-FORMATO-DAL              PIC X(001).                   00006700
000680     03  W-FORMATO-DAL-OK           PIC X(001).                   00006800
000690     03  W-FORMATO-AL               PIC X(001).                   00006900
000700     03  W-FORMATO-AL-OK            PIC X(001).                   00007000
000710     03  W-FORMATO-MATR             PIC X(001).                   00007100
000720     03  W-FORMATO-MATR-OK          PIC X(001).                   00007200
000730     03  W-PAG-RIMB                 PIC X(001).                   00007300
000740*---   CAMPO DI APPOGGIO PER ERRORE RISCONTRATO                   00007400
000750*---                                                              00007500
000760 01  W-ERR                          PIC 9(003).                   00007600
000770*---                                                              00007700
000780*--- MODIFICHE MAGGIO 2001                                        00007800
000790*---                                                              00007900
000800*--- CAMPI DI APPOGGIO PER IL CODICE FISCALE                      00008000
000810*---                                                              00008100
000820 01  W-PF-PNF                       PIC X(003).                   00008200
000830 01  W-APPO-CF.                                                   00008300
000840     03  W-APPO-CF-SX.                                            00008400
000850         05  W-APPO-CF-DENOM.                                     00008500
000860             07 W-APPO-CF-DENOM-L1  PIC X(01).                    00008600
000870             07 W-APPO-CF-DENOM-L2  PIC X(01).                    00008700
000880             07 W-APPO-CF-DENOM-L3  PIC X(01).                    00008800
000890             07 W-APPO-CF-DENOM-L4  PIC X(01).                    00008900
000900             07 W-APPO-CF-DENOM-L5  PIC X(01).                    00009000
000910             07 W-APPO-CF-DENOM-L6  PIC X(01).                    00009100
000920         05  W-APPO-CF-ANNO         PIC X(02).                    00009200
000930         05  W-APPO-CF-MESE         PIC X(01).                    00009300
000940             88  W-APPO-CF-MESE-OK                                00009400
000950                 VALUE 'A' 'B' 'C' 'D' 'E' 'H' 'L'                00009500
000960                       'M' 'P' 'R' 'S' 'T'.                       00009600
000970         05  W-APPO-CF-GIORNO       PIC X(02).                    00009700
000980     03  W-APPO-CF-DX.                                            00009800
000990         05  W-APPO-CF-CATAST       PIC X(01).                    00009900
001000             88  W-COD-FISC-CATAST-OK                             00010000
001010                 VALUE 'A' 'B' 'C' 'D' 'E' 'F' 'G'                00010100
001020                       'H' 'I' 'L' 'M' 'Z'.                       00010200
001030         05  FILLER                 PIC X(04).                    00010300
001040*                                                                 00010400
001050 01  W-CF-CATAST.                                                 00010500
001060     03  FILLER                        PIC X(11).                 00010600
001070     03  W-CATAST.                                                00010700
001080        05  W-CATAST-SOTTO1            PIC X(01).                 00010800
001090        05  W-CATAST-SOTTO2.                                      00010900
001100            07  W-CATAST-SOTTO21       PIC X(01).                 00011000
001110               88  W-CATAST-SOTTO21-OK VALUE                      00011100
001120                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00011200
001130            07  W-CATAST-SOTTO22       PIC X(01).                 00011300
001140               88  W-CATAST-SOTTO22-OK VALUE                      00011400
001150                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00011500
001160            07  W-CATAST-SOTTO23       PIC X(01).                 00011600
001170               88  W-CATAST-SOTTO23-OK VALUE                      00011700
001180                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00011800
001190*                                                                 00011900
001200 01  W-CF.                                                        00012000
001210     03  FILLER                         PIC X(08).                00012100
001220     03  W-CF-MESE                      PIC X(01).                00012200
001230                                                                  00012300
001240         88  W-CF-MESE-30-OK  VALUE 'D' 'H' 'P' 'S'.              00012400
001250                                                                  00012500
001260*                                                                 00012600
001270         88  W-CF-MESE-31-OK  VALUE 'A' 'C' 'E' 'L' 'M' 'R' 'T'.  00012700
001280                                                                  00012800
001290*                                                                 00012900
001300         88  W-CF-MESE-28-OK  VALUE 'B'.                          00013000
001310                                                                  00013100
001320*                                                                 00013200
001330*01  W-APPO-CF-RED REDEFINES W-APPO-CF.                           00013300
001340*    03  FILLER                     PIC X(05).                    00013400
001350*    03  W-APPO-CF-RED-DX           PIC X(11).                    00013500
001360 01  W-APPO-CF-11.                                                00013600
001370     03  W-APPO-CF-11-PROG          PIC 9(07).                    00013700
001380     03  W-APPO-CF-11-COD-UFF       PIC 9(03).                    00013800
001390     03  FILLER                     PIC X(06).                    00013900
001400 01  W-PARAM-BQVFB3.                                              00014000
001410     03  W-BQVFB3-COD-FISC          PIC X(16).                    00014100
001420     03  W-BQVFB3-COD-RIT           PIC X.                        00014200
001430*--- FLAG PER SEGNALAZIONE SALTO CALL ALLA ROUTINE DI             00014300
001440*--- CONTROLLO DEL CHECK DIGIT DEL CF                             00014400
001450 01  W-FLAG-NO-BQVFB3               PIC 9(01).                    00014500
001460*---                                                              00014600
001470*---   CAMPI DI APPOGGIO PER I FORMATI                            00014700
001480*---                                                              00014800
001490 01  W-FORM-MATR                    PIC X(001).                   00014900
001500 01  W-TIPO-INIZ-RIF                PIC X(001).                   00015000
001510 01  W-TIPO-FINE-RIF                PIC X(001).                   00015100
001520 01  W-FLAG-COMPEN                  PIC X(001).                   00015200
001530*---                                                              00015300
001540*---   STRUTTURA MATRICOLA FORMATO 1                              00015400
001550*---                                                              00015500
001560 01  W-MATR1.                                                     00015600
001570     03  W-MATR1-1-10.                                            00015700
001580         05  W-MATR1-1-2            PIC X(002).                   00015800
001590         05  W-MATR1-3-10.                                        00015900
001600             07  W-MATR1-3-8        PIC X(006).                   00016000
001610             07  W-MATR1-9          PIC X(001).                   00016100
001620             07  W-MATR1-10         PIC X(001).                   00016200
001630     03  W-MATR1-RESTO              PIC X(007).                   00016300
001640*---                                                              00016400
001650 01  W-MATR1B.                                                    00016500
001660     03  W-MATR1B-EL OCCURS 8       PIC 9(001).                   00016600
001670     03  W-MATR1B-RESTO             PIC X(009).                   00016700
001680*---                                                              00016800
001690*---   STRUTTURA MATRICOLA FORMATO 2                              00016900
001700*---                                                              00017000
001710 01  W-MATR2.                                                     00017100
001720     03  W-MATR2-1-5                PIC X(005).                   00017200
001730     03  W-MATR2-RESTO              PIC X(012).                   00017300
001740*---                                                              00017400
001750*---   STRUTTURA MATRICOLA FORMATO 3                              00017500
001760*---                                                              00017600
001770 01  W-MATR3.                                                     00017700
001780**** 03  W-MATR3-1-10               PIC X(010).                   00017800
001790     03  W-MATR3-1-8                PIC X(008).                   00017900
001800     03  W-MATR3-9-10               PIC X(002).                   00018000
001810     03  W-MATR3-11                 PIC X(001).                   00018100
001820     03  W-MATR3-12-13              PIC X(002).                   00018200
001830     03  W-MATR3-14                 PIC X(001).                   00018300
001840     03  W-MATR3-15-16              PIC X(002).                   00018400
001850     03  W-MATR3-17                 PIC X(001).                   00018500
001860*---                                                              00018600
001870*---   STRUTTURA MATRICOLA FORMATO 4                              00018700
001880*---                                                              00018800
001890 01  W-MATR4.                                                     00018900
001900     03  W-MATR4-1-2-3              PIC X(003).                   00019000
001910     03  W-MATR4-4-8                PIC X(005).                   00019100
001920     03  W-MATR4-9-10               PIC X(002).                   00019200
001930     03  W-MATR4-RESTO              PIC X(007).                   00019300
001940*---                                                              00019400
001950*---   STRUTTURA MATRICOLA FORMATO 5                              00019500
001960*---                                                              00019600
001970 01  W-MATR5.                                                     00019700
001980     03  W-MATR5-1                  PIC X(001).                   00019800
001990     03  W-MATR5-2-8                PIC X(007).                   00019900
002000     03  W-MATR5-9-10               PIC X(002).                   00020000
002010     03  W-MATR5-11                 PIC X(001).                   00020100
002020     03  W-MATR5-12                 PIC X(001).                   00020200
002030     03  W-MATR5-13-14              PIC X(002).                   00020300
002040     03  W-MATR5-15                 PIC X(001).                   00020400
002050     03  W-MATR5-16-17              PIC X(002).                   00020500
002060*---                                                              00020600
002070 01  W-MATR5A.                                                    00020700
002080     03  W-EL-MATR5A OCCURS 14      PIC 9(001).                   00020800
002090     03  FILLER                     PIC X(003).                   00020900
002100*---                                                              00021000
002110 01  W-MATR5B.                                                    00021100
002120     03  W-EL-MATR5B                PIC 9(015).                   00021200
002130     03  W-EL-MATR5B-RESTO          PIC X(002).                   00021300
002140*---                                                              00021400
002150*---  STRUTTURA MATRICOLA FORMATO 9                               00021500
002160*---                                                              00021600
002170 01  W-MATR9.                                                     00021700
002180     03  W-MATR9-1-15               PIC X(015).                   00021800
002190     03  W-MATR9-16                 PIC X(001).                   00021900
002200     03  W-MATR9-17                 PIC X(001).                   00022000
002210*---                                                              00022100
002220 01  W-MATR9B.                                                    00022200
002230     03  W-MATR9B-EL OCCURS 15      PIC 9(001).                   00022300
002240     03  W-MATR9B-RESTO             PIC X(002).                   00022400
002250*---                                                              00022500
002260*---   STRUTTURA MATRICOLA FORMATO A                              00022600
002270*---                                                              00022700
002280 01  W-MATRA.                                                     00022800
002290     03  W-MATRA-1-10               PIC X(010).                   00022900
002300     03  W-MATRA-11                 PIC X(001).                   00023000
002310     03  W-MATRA-12                 PIC X(001).                   00023100
002320*---                                                              00023200
002330 01  W-MATRAB.                                                    00023300
002340     03  W-MATRAB-EL OCCURS 10      PIC 9(001).                   00023400
002350     03  W-MATRAB-RESTO             PIC X(002).                   00023500
002360*---                                                              00023600
002370*---                                                              00023700
002380*---   STRUTTURA MATRICOLA FORMATO B                              00023800
002390*---                                                              00023900
002400 01  W-MATRB.                                                     00024000
002410     03  W-MATRB-1-8.                                             00024100
002420         05  W-MATRB-1-2            PIC X(002).                   00024200
002430         05  W-MATRB-3-8            PIC X(006).                   00024300
002440     03  W-MATRB-9                  PIC X(001).                   00024400
002450     03  W-MATRB-10                 PIC X(001).                   00024500
002460     03  W-MATRB-11-14              PIC X(004).                   00024600
002470*---                                                              00024700
002480 01  W-MATRBB.                                                    00024800
002490     03  W-MATRBB-EL OCCURS 8       PIC 9(001).                   00024900
002500     03  W-MATRBB-RESTO             PIC X(006).                   00025000
002501*---                                                              00025100
002540*---                                                              00025200
002541*---   STRUTTURA MATRICOLA FORMATO D                              00025300
002542*---                                                              00025400
002543 01  W-MATRD.                                                     00025500
002544     03  W-MATRD-1-9                PIC X(009).                   00025600
002545     03  W-MATRD-10-17              PIC X(008).                   00025700
002546*---                                                              00025800
002547 01  W-MATRDB.                                                    00025900
002548     03  W-MATRDB-EL OCCURS 9       PIC 9(001).                   00026000
002549     03  W-MATRDB-RESTO             PIC X(008).                   00026100
002550*---                                                              00026200
002551*---                                                              00026300
002552*---                                                              00026400
002553*---   STRUTTURA MATRICOLA FORMATO E                              00026500
002554*---                                                              00026600
002555 01  W-MATRE.                                                     00026700
002556     03  W-MATRE-1-13.                                            00026800
002557         05  W-MATRE-1-10           PIC X(010).                   00026900
002558         05  W-MATRE-11-13          PIC X(003).                   00027000
002559     03  W-MATRE-14                 PIC X(001).                   00027100
002560     03  W-MATRE-15-17              PIC X(003).                   00027200
002561*---                                                              00027300
002562 01  W-MATREB.                                                    00027400
002563     03  W-MATREB-EL OCCURS 13      PIC 9(001).                   00027500
002564     03  W-MATREB-RESTO             PIC X(004).                   00027600
002565*---                                                              00027700
002566 01  W-SOMMA-DISPARI                PIC 9(003).                   00027800
002567 01  W-SOMMA-PARI                   PIC 9(003).                   00027900
002568*---                                                              00028000
002569 01  W-PARI-PER-TRE                 PIC 9(003).                   00028100
002570 01  W-PARI-PIU-DISPARI             PIC 9(003).                   00028200
002571 01  W-PARI-PIU-DISPARI-R REDEFINES                               00028300
002572     W-PARI-PIU-DISPARI.                                          00028400
002573     03  W-PARI-PIU-DISPARI-1-2     PIC 9(002).                   00028500
002574     03  W-PARI-PIU-DISPARI-3       PIC 9(001).                   00028600
002575*---                                                              00028700
002576 01  W-COD-CONTR-MATRE              PIC 9(001).                   00028800
002577*---                                                              00028900
002578*---                                                              00029000
002579*---   CAMPI PER OPERAZIONI ALGEBRICHE SU MATRICOLA               00029100
002920*---                                                              00029200
002921 01  W-QUOZ.                                                      00029300
002922     03  W-QUOZ-EL OCCURS 4         PIC 9(008).                   00029400
002923*---                                                              00029500
002924 01  W-REST.                                                      00029600
002925     03  W-REST-EL OCCURS 4         PIC 9(003).                   00029700
002926*---   CAMPI PER CONTROLLARE (IN CASO DI DIVISA = ITL) CHE        00029800
002927*---   LE ULTIME TRE CIFRE DELL'IMPORTO SIANO IMPOSTATE           00029900
002928*---   A ZERO.                                                    00030000
002929 01  W-CIFRE.                                                     00030100
002930     03  W-CIFRE-FILLER             PIC 9(012).                   00030200
002931*--- NEW:                                                         00030300
002932     03  W-CIFRE-TRE.                                             00030400
002933         05  FILLER                 PIC 9(001).                   00030500
002934         05  W-CIFRE-DUE            PIC 9(002).                   00030600
002935*--- NEW: FINE.                                                   00030700
002936*---                                                              00030800
002937 01  W-SOMMA                        PIC 9(010).                   00030900
002938 01  W-SOMMA-UN1                    PIC 9(001).                   00031000
002939 01  W-SOMMA-UN2                    PIC 9(001).                   00031100
002940 01  W-UNITA                        PIC 9(001).                   00031200
002941 01  W-RESTO2                       PIC 9(002).                   00031300
002942 01  W-RESTO3                       PIC 9(001).                   00031400
002943 01  W-RESTO                        PIC 9(002).                   00031500
002944 01  W-RESTO1 REDEFINES W-RESTO     PIC X(002).                   00031600
002945*---   INDICI                                                     00031700
002946 01  W-IND                          PIC 9(002).                   00031800
002947 01  W-IND1                         PIC 9(002).                   00031900
002948 01  W-PAGAM                        PIC X(015).                   00032000
002949 01  W-PAGAM1 REDEFINES W-PAGAM.                                  00032100
002950     03  FILLER                     PIC X(005).                   00032200
002951     03  W-PAGAMEN                  PIC X(010).                   00032300
002952*---   DEFINIZIONE DELLA CODE LINE                                00032400
002953 01  W-CODE-LINE.                                                 00032500
002954     03  W-CODE-LINE1               PIC 9(010).                   00032600
002955     03  W-CODE-LINE2               PIC 9(004).                   00032700
002956     03  W-CODE-LINE3               PIC 9(004).                   00032800
002957     03  W-CODE-LINE4               PIC 9(017).                   00032900
002958*---                                                              00033000
002959 01  W-CODE-LINE-A REDEFINES W-CODE-LINE.                         00033100
002960     03  W-CODE-LINE-EL1            PIC 9(008).                   00033200
002961     03  W-CODE-LINE-EL2            PIC 9(008).                   00033300
002962     03  W-CODE-LINE-EL3            PIC 9(008).                   00033400
002963     03  W-CODE-LINE-EL4            PIC 9(008).                   00033500
002964     03  FILLER                     PIC X(003).                   00033600
002965*---                                                              00033700
002966 01  W-CODE-LINE-B REDEFINES W-CODE-LINE-A.                       00033800
002967     03  W-CODE-LINE-B-EL OCCURS 34 PIC 9(001).                   00033900
002968     03  FILLER                     PIC X(001).                   00034000
002969*---                                                              00034100
002970 01  W-RIF.                                                       00034200
002971     03  W-MESE-RIF                 PIC X(002).                   00034300
002972     03  W-ANNO-RIF                 PIC X(004).                   00034400
002973*---                                                              00034500
002974 01  W-RIF1.                                                      00034600
002975     03  W-ANNO-RIF1                PIC X(004).                   00034700
002976     03  W-MESE-RIF1                PIC X(002).                   00034800
002977*---                                                              00034900
002978 01  W-RIF2.                                                      00035000
002979     03  W-ANNO-RIF2                PIC X(004).                   00035100
002980     03  W-MESE-RIF2                PIC X(002).                   00035200
002981*---               TRACCIATO RECORD "ESITI" - BANCA               00035300
002982     COPY 'FBQVFB21'.                                             00035400
002983*---               TRACCIATO RECORD "ESITI" - CONCESSIONARIO      00035500
002984*    COPY 'FBQVFD21'.                                             00035600
002985*---        TABELLA PER TOTALIZZARE                               00035700
002986 01  W-TAB.                                                       00035800
002987*    03  W-TAB-EL OCCURS 4.                                       00035900
002988*--- NEW:                                                         00036000
002989     03  W-TAB-EL OCCURS 7.                                       00036100
002990         05  W-TAB-EL-PAG           PIC 9(015).                   00036200
002991         05  W-TAB-EL-RIM           PIC 9(015).                   00036300
002992*---                                                              00036400
002993*--- MODIFICHE MAGGIO 2001                                        00036500
002994*---                                                              00036600
002995*---                                                              00036700
002996*--- COPY CATALOGATA PER L'ARCHIVIO BQVFB3                        00036800
002997*---                                                              00036900
002998     COPY FBQVFB31.                                               00037000
002999********************** LINKAGE SECTION ***************************00037100
003000*                                                                 00037200
003001 LINKAGE SECTION.                                                 00037300
003002*---                                                              00037400
003003*---               AREA DI COLLOQUIO                              00037500
003004*---                                                              00037600
003005*---   FLAG INDICANTE LA PROVENIENZA:                             00037700
003006*---   .. "B" BANCA;                                              00037800
003007*---   .. "C" CONCESSIONARIO                                      00037900
003008 01  W-PROV                        PIC X(001).                    00038000
003009*---   AREA DATI RELATIVA AL FILE ESITO                           00038100
003010*01  W-DATI                        PIC X(440).                    00038200
003011*--- NEW:                                                         00038300
003012 01  W-DATI                        PIC X(512).                    00038400
003013*---   TABELLA IMPORTI                                            00038500
003014*01  W-TABELLA                     PIC X(120).                    00038600
003015*--- NEW:                                                         00038700
003016 01  W-TABELLA                     PIC X(210).                    00038800
003017*---   TIPO PERSONA: FISICA/NON FISICA                            00038900
003018 01  W-PERS                        PIC X(003).                    00039000
003019*---   DIVISA                                                     00039100
003020 01  W-DIVISA                      PIC X(003).                    00039200
003021*---   CONTATORE ERRORI NON BLOCCANTI                             00039300
003022 01  W-CTR1                        PIC 9(009).                    00039400
003023*---   CONTATORE ERRORI BLOCCANTI                                 00039500
003024 01  W-CTR2                        PIC 9(009).                    00039600
003025*---                                                              00039700
003026**TABELLA CONTENENTE LE MATRICOLE INPS PRELEVATE DAL FILE BQVFMA  00039800
003891*---                                                              00039900
003892**MODIFICA 13/03/2006                                             00040000
003893**AGGIUNTO DESCR E FLAG-COMPEN                                    00040100
003894 01  W-TAB-MATR.                                                  00040200
003895     03 W-TAB-MATR-NUM-MAX        PIC 9(004)  VALUE 1500.         00040300
003896     03 W-TAB-MATR-OCC.                                           00040400
003897        05 W-TAB-MATR-EL OCCURS  1500 TIMES                       00040500
003898                                    ASCENDING W-TAB-MATR-KEY      00040600
003899                                    INDEXED BY W-PUNT-MATR.       00040700
003900           07 W-TAB-MATR-KEY.                                     00040800
003901              09 W-TAB-MATR-COD      PIC X(004).                  00040900
003902              09 W-TAB-MATR-INI-VAL  PIC X(008).                  00041000
003903           07 W-TAB-MATR-FIN-VAL  PIC X(008).                     00041100
003904           07 W-TAB-MATR-FORM     PIC X(001).                     00041200
003905           07 W-TAB-MATR-TIPO-INI PIC X(001).                     00041300
003906           07 W-TAB-MATR-TIPO-FIN PIC X(001).                     00041400
003907           07 W-TAB-MATR-DESCR    PIC X(060).                     00041500
003908           07 W-TAB-MATR-FL-COMP  PIC X(001).                     00041600
003909*---                                                              00041700
003910**TABELLA CONTENETE I CODICI SEDI INPS PRELEVATI DAL FILE BQVFSE  00041800
003911*---                                                              00041900
003912 01  W-TAB-SEDE.                                                  00042000
003913     03 W-TAB-SEDE-NUM-MAX        PIC 9(003) VALUE 500.           00042100
003914     03 W-TAB-SEDE-OCC.                                           00042200
003915        05 W-TAB-SEDE-EL OCCURS   500 TIMES                       00042300
003916                                    ASCENDING W-TAB-SEDE-COD      00042400
003917                                    INDEXED BY W-PUNT-SEDE.       00042500
003918           07 W-TAB-SEDE-COD      PIC X(004).                     00042600
004270*---                                                              00042700
004271 01  W-FLAG-CRED                   PIC X(001).                    00042800
004272********************** PROCEDURE DIVISION ************************00042900
004273*                                                                 00043000
004274 PROCEDURE DIVISION   USING W-PROV W-DATI W-TABELLA W-PERS        00043100
004275                            W-DIVISA W-CTR1 W-CTR2                00043200
004276                            W-TAB-MATR W-TAB-SEDE                 00043300
004277                            W-FLAG-CRED.                          00043400
004278 ML-010-INIZIO.                                                   00043500
004279*---   INIZIALIZZAZIONE DELLE AREE DI LAVORO                      00043600
004280*---                                                              00043700
004281     MOVE SPACE                    TO W-FORMATI.                  00043800
004282     PERFORM RZ-010-INIZIA THRU RZ-010-INIZIA-EX.                 00043900
004283*---   IMPOSTAZIONE AREA DI PASSAGGIO RELATIVA AI DATI E          00044000
004284*---   ALLA TABELLA DI TOTALIZZAZIONE A SECONDA DELLA PROVENIENZA 00044100
004285*---                                                              00044200
004286*    IF W-PROV EQUAL 'B'                                          00044300
004287*      GO TO ML-030.                                              00044400
004288*ML-020.                                                          00044500
004289*    MOVE W-DATI                    TO BQVFD21.                   00044600
004290*---   ROUTINE PER IMPOSTARE I CAMPI DELLA COPY FBQVFD21 IN       00044700
004291*---   FBQVFB21 NEL CASO IN CUI LA PROVENIENZA E' CONCESSIONARIO 000044800
004292*---                                                              00044900
004293*    PERFORM RX-010-BANCA THRU RX-010-BANCA-EX.                   00045000
004294*    GO TO ML-040.                                                00045100
004295 ML-030.                                                          00045200
004296     MOVE W-DATI                    TO BQVFB21.                   00045300
004297 ML-040.                                                          00045400
004298     MOVE W-TABELLA                 TO W-TAB.                     00045500
004299*---                                                              00045600
004300*---   ROUTINE DI CONTROLLO DELLA SEDE INPS E DELLA CAUSALE       00045700
004301     PERFORM A1-010-SEDE-CAUS THRU A1-010-SEDE-CAUS-EX.           00045800
004302*---                                                              00045900
004303*---              ROUTINE DI CONTROLLO MATRICOLA                  00046000
004304     PERFORM B1-010-MATR      THRU B1-010-MATR-EX.                00046100
004305*---                                                              00046200
004306*---       ROUTINE DI CONTROLLO INIZIO RIFERIMENTO                00046300
004307     PERFORM C1-010-RIF-DAL   THRU C1-010-RIF-DAL-EX.             00046400
004308*---                                                              00046500
004309*---       ROUTINE DI CONTROLLO FINE   RIFERIMENTO                00046600
004310     PERFORM D1-010-RIF-AL    THRU D1-010-RIF-AL-EX.              00046700
004311*---                                                              00046800
004312*---  ROUTINE DI CONTROLLO PAGAMENTI E RIMBORSI                   00046900
004313     PERFORM E1-010-CONTR     THRU E1-010-CONTR-EX.               00047000
004314*---                                                              00047100
004315*---    IMPOSTAZIONE CAMPI DI COMODO IN AREA DI PASSAGGIO         00047200
004316     MOVE W-TAB               TO W-TABELLA.                       00047300
004317*    IF W-PROV EQUAL 'B'                                          00047400
004318*      GO TO ML-060.                                              00047500
004319*ML-050.                                                          00047600
004320*---   ROUTINE PER IMPOSTARE I CAMPI DELLA COPY FBQVFB21 IN       00047700
004321*---   FBQVFD21.                                                  00047800
004322*---                                                              00047900
004323*    PERFORM RY-010-CONC THRU RY-010-CONC-EX.                     00048000
004324*    MOVE BQVFD21             TO W-DATI.                          00048100
004325*    GO TO ML-990.                                                00048200
004326 ML-060.                                                          00048300
004327     MOVE BQVFB21             TO W-DATI.                          00048400
004328 ML-990.                                                          00048500
004329     GOBACK.                                                      00048600
004330*---         CONTROLLO SEDE/CAUSALE                               00048700
004331 A1-010-SEDE-CAUS.                                                00048800
004332*---   CONTROLLO CORRETTA IMPOSTAZIONE DEL FLAG SEDE              00048900
004333*---                                                              00049000
004334     IF BQVFB21-02-FLAG-ERR-SEDE EQUAL '0'  OR                    00049100
004335        BQVFB21-02-FLAG-ERR-SEDE EQUAL '1'                        00049200
004336       GO TO A1-030.                                              00049300
004337 A1-020.                                                          00049400
004338*---   ERRORE BLOCCANTE                                           00049500
004339*---                                                              00049600
004340     ADD 1                    TO W-CTR2.                          00049700
004341     MOVE 55                  TO BQVFB21-02-ERR-FLAG-ERR-SEDE.    00049800
004342     MOVE 'E'                 TO BQVFB21-02-ERR-FLAG-ERR-SEDE-A.  00049900
004343 A1-030.                                                          00050000
004344*---   CONTROLLO NUMERICITA' DELLA SEDE                           00050100
004345*---                                                              00050200
004346     IF BQVFB21-02-COD-SEDE NUMERIC                               00050300
004347       GO TO A1-070.                                              00050400
004348 A1-040.                                                          00050500
004349*---   SEDE NON NUMERICA SI CONTROLLA SE L'ERRORE ERA GIA' STATO  00050600
004350*---   SEGNALATO NEL RELATIVO FLAG                                00050700
004351*---                                                              00050800
004352     IF BQVFB21-02-FLAG-ERR-SEDE EQUAL '1'                        00050900
004353       GO TO A1-150.                                              00051000
004354 A1-050.                                                          00051100
004355*---   ERRORI BLOCCANTE E NON                                     00051200
004356     ADD 1                    TO W-CTR2.                          00051300
004357     MOVE 33                  TO BQVFB21-02-ERR-COD-SEDE.         00051400
004358     MOVE 'E'                 TO BQVFB21-02-ERR-COD-SEDE-A.       00051500
004359     IF BQVFB21-02-ERR-FLAG-ERR-SEDE EQUAL ZERO                   00051600
004360       ADD 1                  TO W-CTR2                           00051700
004361       MOVE 24                TO BQVFB21-02-ERR-FLAG-ERR-SEDE     00051800
004362       MOVE 'E'               TO BQVFB21-02-ERR-FLAG-ERR-SEDE-A.  00051900
004363     GO TO A1-150.                                                00052000
004364 A1-070.                                                          00052100
004365*---   SI ACCEDE ALLA TABELLA PER ACCERTARE CHE LA                00052200
004366*---   SEDE SIA CORRETTA                                          00052300
004367*---                                                              00052400
004368     MOVE BQVFB21-02-COD-SEDE TO W-SEDE-INP.                      00052500
004369     SEARCH  ALL W-TAB-SEDE-EL                                    00052600
004370        AT END MOVE ZERO TO W-FLAG-TROVATO                        00052700
004371     WHEN W-TAB-SEDE-COD(W-PUNT-SEDE) EQUAL  W-SEDE-INP           00052800
004372        MOVE 1           TO W-FLAG-TROVATO.                       00052900
004373*---   SI CONTROLLA SE ESISTE ALMENO 1 OCCORRENZA                 00053000
004374     IF W-FLAG-TROVATO = 1                                        00053100
004375       GO TO A1-120.                                              00053200
004376 A1-090.                                                          00053300
004377*---   SEDE NON ESISTENTE: SI CONTROLLA SE L'ERRORE ERA GIA' STATO00053400
004378*---   SEGNALATO NEL RELATIVO FLAG                                00053500
004379*---                                                              00053600
004380     IF BQVFB21-02-FLAG-ERR-SEDE EQUAL '1'                        00053700
004381       GO TO A1-150.                                              00053800
004382 A1-100.                                                          00053900
004383*---   ERRORI BLOCCANTE E NON                                     00054000
004384     ADD 1                    TO W-CTR2.                          00054100
004385     MOVE 504                 TO BQVFB21-02-ERR-COD-SEDE.         00054200
004386     MOVE 'E'                 TO BQVFB21-02-ERR-COD-SEDE-A.       00054300
004387     IF BQVFB21-02-ERR-FLAG-ERR-SEDE EQUAL ZERO                   00054400
004388       ADD 1                  TO W-CTR2                           00054500
004389       MOVE 24                TO BQVFB21-02-ERR-FLAG-ERR-SEDE     00054600
004390       MOVE 'E'               TO BQVFB21-02-ERR-FLAG-ERR-SEDE-A.  00054700
004391     GO TO A1-150.                                                00054800
004392 A1-120.                                                          00054900
004393*---   IL CODICE SEDE IMPOSTATO E' CORRETTO (NUMERICO E PRESENTE  00055000
004394*---   IN BASE INFORMATIVA); SI CONTROLLA L'IMPOSTAZIONE DEL      00055100
004395*---   RELATIVO FLAG DI ERRORE                                    00055200
004396*---                                                              00055300
004397     IF BQVFB21-02-FLAG-ERR-SEDE EQUAL '0'                        00055400
004398       GO TO A1-150.                                              00055500
004399*--- NEW:                                                         00055600
004400 A1-130.                                                          00055700
004401     IF BQVFB21-02-FLAG-ERR-SEDE NOT EQUAL '1'                    00055800
004402       GO TO A1-150.                                              00055900
004403*--- NEW: FINE.                                                   00056000
004404 A1-140.                                                          00056100
004405*---   ERRORE NON BLOCCANTE                                       00056200
004406*---                                                              00056300
004407     ADD 1                   TO W-CTR1.                           00056400
004408     MOVE 24                 TO BQVFB21-02-ERR-FLAG-ERR-SEDE.     00056500
004409     MOVE 'W'                TO BQVFB21-02-ERR-FLAG-ERR-SEDE-A.   00056600
004410 A1-150.                                                          00056700
004411*---   SI CONTROLLA L'ESATTA IMPOSTAZIONE DEL FLAG CAUSALE        00056800
004412*---                                                              00056900
004413     IF BQVFB21-02-FLAG-ERR-CAUSALE EQUAL '0'  OR                 00057000
004414        BQVFB21-02-FLAG-ERR-CAUSALE EQUAL '1'                     00057100
004415       GO TO A1-160.                                              00057200
004416 A1-155.                                                          00057300
004417*---   ERRORE BLOCCANTE                                           00057400
004418     ADD 1                    TO W-CTR2.                          00057500
004419     MOVE 55                  TO BQVFB21-02-ERR-FLAG-ERR-CAU.     00057600
004420     MOVE 'E'                 TO BQVFB21-02-ERR-FLAG-ERR-CAU-A.   00057700
004421 A1-160.                                                          00057800
004422*---                                                              00057900
004423*---   SI CONTROLLA L'ESISTENZA DELLA CAUSALE IN BASE INF.        00058000
004424     PERFORM F2-010-CAUS THRU F2-010-CAUS-EX.                     00058100
004425     IF W-CAUSALE-OK EQUAL 'SI'                                   00058200
004426       GO TO A1-210.                                              00058300
004427 A1-180.                                                          00058400
004428*---   CAUSALE NON VALIDA: SI CONTROLLA SE L'ERRORE ERA GIA' STATO00058500
004429*---   SEGNALATO NEL RELATIVO FLAG                                00058600
004430*---                                                              00058700
004431     IF BQVFB21-02-FLAG-ERR-CAUSALE EQUAL '1'                     00058800
004432        GO TO A1-010-SEDE-CAUS-EX.                                00058900
004433 A1-190.                                                          00059000
004434*---   ERRORI BLOCCANTE E NON                                     00059100
004435     ADD 1                    TO W-CTR2.                          00059200
004436     MOVE 504                 TO BQVFB21-02-ERR-CAUSALE.          00059300
004437     MOVE 'E'                 TO BQVFB21-02-ERR-CAUSALE-A.        00059400
004438     IF BQVFB21-02-ERR-FLAG-ERR-CAU EQUAL ZERO                    00059500
004439       ADD 1                  TO W-CTR2                           00059600
004440       MOVE 24                TO BQVFB21-02-ERR-FLAG-ERR-CAU      00059700
004441       MOVE 'E'               TO BQVFB21-02-ERR-FLAG-ERR-CAU-A.   00059800
004442     GO TO A1-010-SEDE-CAUS-EX.                                   00059900
004443 A1-210.                                                          00060000
004444*---   CAUSALE CORRETTA; SI CONTROLLA L'IMPOSTAZIONE DEL          00060100
004445*---   RELATIVO FLAG.                                             00060200
004446*---                                                              00060300
004447     IF BQVFB21-02-FLAG-ERR-CAUSALE EQUAL '0'                     00060400
004448       GO TO A1-010-SEDE-CAUS-EX.                                 00060500
004449 A1-220.                                                          00060600
004450*---   CAUSALE CORRETTA; SI CONTROLLA L'IMPOSTAZIONE DEL          00060700
004451*---   RELATIVO FLAG.                                             00060800
006090*---                                                              00060900
006091     IF BQVFB21-02-FLAG-ERR-CAUSALE NOT EQUAL '1'                 00061000
006092       GO TO A1-010-SEDE-CAUS-EX.                                 00061100
006093 A1-230.                                                          00061200
006094*---   ERRORE NON BLOCCANTE                                       00061300
006095     ADD 1                      TO W-CTR1.                        00061400
006096     MOVE 24                 TO BQVFB21-02-ERR-FLAG-ERR-CAU.      00061500
006097     MOVE 'W'                TO BQVFB21-02-ERR-FLAG-ERR-CAU-A.    00061600
006098 A1-010-SEDE-CAUS-EX.                                             00061700
006099     EXIT.                                                        00061800
006100*---         ROUTINE DI CONTROLLO MATRICOLA                       00061900
006101 B1-010-MATR.                                                     00062000
006102     MOVE ZERO                   TO W-ERR.                        00062100
006103*---   CONTROLLO CORRETTA IMPOSTAZIONE DEL FLAG MATRICOLA         00062200
006104*---                                                              00062300
006105     IF BQVFB21-02-FLAG-ERR-MATR EQUAL '0'  OR                    00062400
006106        BQVFB21-02-FLAG-ERR-MATR EQUAL '1'                        00062500
006107       GO TO B1-030.                                              00062600
006108 B1-020.                                                          00062700
006109*---   ERRORE BLOCCANTE                                           00062800
006110     ADD 1                    TO W-CTR2.                          00062900
006111     MOVE 55                  TO BQVFB21-02-ERR-FLAG-ERR-MATR.    00063000
006112     MOVE 'E'                 TO BQVFB21-02-ERR-FLAG-ERR-MATR-A.  00063100
006113 B1-030.                                                          00063200
006114*---   SI CONTROLLA SE LA CAUSALE E' VALIDA                       00063300
006115*---                                                              00063400
006116     IF W-CAUSALE-OK EQUAL 'SI'                                   00063500
006117       GO TO B1-110.                                              00063600
006118 B1-040.                                                          00063700
006119*---   SI CONTROLLA SE LA MATRICOLA E' IMPOSTATA                  00063800
006390*---                                                              00063900
006391     IF BQVFB21-02-MATR-INPS EQUAL SPACE                          00064000
006392       GO TO B1-100.                                              00064100
006393*---   MODIFICA DEL 11/04/2002 PER NUOVO FORMALISMO MATRICOLA     00064200
006394 B1-041-D.                                                        00064210
006395*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00064220
006396*---   MATRICOLA PER VEDERE SE E' DI TIPO D                       00064230
006397*---                                                              00064240
006398     MOVE 'D'                    TO W-FORMATO-MATR.               00064250
006399     MOVE ZERO                   TO W-ERR.                        00064260
006400*---                                                              00064270
006401     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00064280
006402*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00064290
006403*---   LA MATRICOLA HA FORMATO D                                  00064291
006404*---                                                              00064292
006405     IF W-ERR EQUAL ZERO                                          00064293
006406       MOVE 'S'                    TO W-FORMATO-MATR-OK           00064294
006407       GO TO B1-240.                                              00064295
006408*---                                                              00064296
006409*---                                                              00064297
006410*---                                                              00064298
006411 B1-041-E.                                                        00064299
006412*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00064300
006413*---   MATRICOLA PER VEDERE SE E' DI TIPO E                       00064301
006414*---                                                              00064302
006415     MOVE 'E'                    TO W-FORMATO-MATR.               00064303
006416     MOVE ZERO                   TO W-ERR.                        00064304
006417*---                                                              00064305
006418     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00064306
006419*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00064307
006420*---   LA MATRICOLA HA FORMATO E                                  00064308
006421*---                                                              00064309
006422     IF W-ERR EQUAL ZERO                                          00064310
006423       MOVE 'S'                    TO W-FORMATO-MATR-OK           00064311
006424       GO TO B1-240.                                              00064312
006425*---                                                              00064313
006426*---                                                              00064320
006427 B1-041.                                                          00064400
006428*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00064500
006429*---   MATRICOLA PER VEDERE SE E' DI TIPO B                       00064600
006430*---                                                              00064700
006431     MOVE 'B'                    TO W-FORMATO-MATR.               00064800
006432     MOVE ZERO                   TO W-ERR.                        00064900
006433*---                                                              00065000
006434     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00065100
006435*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00065200
006436*---   LA MATRICOLA HA FORMATO B                                  00065300
006437*---                                                              00065400
006438     IF W-ERR EQUAL ZERO                                          00065500
006439       MOVE 'S'                    TO W-FORMATO-MATR-OK           00065600
006440       GO TO B1-240.                                              00065700
006441*---                                                              00065800
006442 B1-042.                                                          00065900
006443*---                                                              00066000
006444*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00066100
006445*---   MATRICOLA PER VEDERE SE E' DI TIPO A                       00066200
006446*---                                                              00066300
006447     MOVE 'A'                    TO W-FORMATO-MATR.               00066400
006448     MOVE ZERO                   TO W-ERR.                        00066500
006449*---                                                              00066600
006450     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00066700
006451*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00066800
006452*---   LA MATRICOLA HA FORMATO A                                  00066900
006453*---                                                              00067000
006454     IF W-ERR EQUAL ZERO                                          00067100
006455       MOVE 'S'                    TO W-FORMATO-MATR-OK           00067200
006456       GO TO B1-240.                                              00067300
006623*---                                                              00067400
006624 B1-043.                                                          00067500
006625*---   MODIFICA DEL 09/11/2001 PER NUOVO FORMALISMO MATRICOLA     00067600
006626*---                                                              00067700
006627*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00067800
006628*---   MATRICOLA PER VEDERE SE E' DI TIPO 9                       00067900
006629*---                                                              00068000
006630     MOVE '9'                    TO W-FORMATO-MATR.               00068100
006631     MOVE ZERO                   TO W-ERR.                        00068200
006632*---                                                              00068300
006633     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00068400
006634*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00068500
006635*---   LA MATRICOLA HA FORMATO 9                                  00068600
006636*---                                                              00068700
006637     IF W-ERR EQUAL ZERO                                          00068800
006638       MOVE 'S'                    TO W-FORMATO-MATR-OK           00068900
006639       GO TO B1-240.                                              00069000
006640*---                                                              00069100
006641*---   FINE MODIFICA                                              00069200
006930*---                                                              00069300
006931*---   MODIFICA DEL 14/08/2001 PER NUOVA GESTIONE CAUSALI ERRATE  00069400
006932*---                                                              00069500
006933 B1-044.                                                          00069600
006934*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00069700
006935*---   MATRICOLA PER VEDERE SE E' DI TIPO 8                       00069800
006936*---                                                              00069900
006937     MOVE '8'                    TO W-FORMATO-MATR.               00070000
006938     MOVE ZERO                   TO W-ERR.                        00070100
006939*---                                                              00070200
006940     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00070300
006941*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00070400
006942*---   LA MATRICOLA HA FORMATO 8                                  00070500
007060*---                                                              00070600
007061     IF W-ERR EQUAL ZERO                                          00070700
007062       MOVE 'S'                    TO W-FORMATO-MATR-OK           00070800
007063       GO TO B1-240.                                              00070900
007064*---                                                              00071000
007065*---   FINE MODIFICA                                              00071100
007066*---                                                              00071200
007067 B1-050.                                                          00071300
007068*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00071400
007069*---   MATRICOLA PER VEDERE SE E' DI TIPO 1                       00071500
007070*---                                                              00071600
007071     MOVE '1'                    TO W-FORMATO-MATR.               00071700
007072     MOVE ZERO                   TO W-ERR.                        00071800
007190*---                                                              00071900
007191     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00072000
007192*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00072100
007193*---   LA MATRICOLA HA FORMATO 1                                  00072200
007194*---                                                              00072300
007195     IF W-ERR EQUAL ZERO                                          00072400
007196*      GO TO B1-240.                                              00072500
007197*--- NEW:                                                         00072600
007198       GO TO B1-090.                                              00072700
007199 B1-055.                                                          00072800
007200*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00072900
007201*---   MATRICOLA PER VEDERE SE E' DI TIPO 3                       00073000
007202*---                                                              00073100
007203     MOVE '3'                    TO W-FORMATO-MATR.               00073200
007204     MOVE ZERO                   TO W-ERR.                        00073300
007340*---                                                              00073400
007341     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00073500
007342*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00073600
007343*---   LA MATRICOLA HA FORMATO 3                                  00073700
007344*---                                                              00073800
007345     IF W-ERR EQUAL ZERO                                          00073900
007346       GO TO B1-240.                                              00074000
007347 B1-060.                                                          00074100
007348*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00074200
007349*---   MATRICOLA PER VEDERE SE E' DI TIPO 5                       00074300
007350*---                                                              00074400
007351     MOVE '5'                    TO W-FORMATO-MATR.               00074500
007352     MOVE ZERO                   TO W-ERR.                        00074600
007353*---                                                              00074700
007354     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00074800
007355*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00074900
007356*---   LA MATRICOLA HA FORMATO 5                                  00075000
007357*---                                                              00075100
007358     IF W-ERR EQUAL ZERO                                          00075200
007359       GO TO B1-240.                                              00075300
007360 B1-065.                                                          00075400
007361*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00075500
007362*---   MATRICOLA PER VEDERE SE E' DI TIPO 4                       00075600
007363*---                                                              00075700
007364     MOVE '4'                    TO W-FORMATO-MATR.               00075800
007365     MOVE ZERO                   TO W-ERR.                        00075900
007366*---                                                              00076000
007367     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00076100
007368*---   SE LA ROUTINE NON HA RISCONTRATO ERRORI VUOL DIRE CHE      00076200
007369*---   LA MATRICOLA HA FORMATO 4                                  00076300
007370*---                                                              00076400
007371     IF W-ERR EQUAL ZERO                                          00076500
007372*      GO TO B1-240.                                              00076600
007373*--- NEW:                                                         00076700
007374       GO TO B1-080.                                              00076800
007375 B1-070.                                                          00076900
007376*---   SI RICHIAMA LA ROUTINE CHE CONTROLLA IL FORMATO DELLA      00077000
007377*---   MATRICOLA PER VEDERE SE E' DI TIPO 2                       00077100
007378*---                                                              00077200
007379     MOVE '2'                    TO W-FORMATO-MATR.               00077300
007380     MOVE ZERO                   TO W-ERR.                        00077400
007381*---                                                              00077500
007382     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00077600
007383     IF W-ERR NOT EQUAL ZERO                                      00077700
007384        GO TO B1-240.                                             00077800
007385*--- NEW:                                                         00077900
007386 B1-075.                                                          00078000
007387*--- MATR. DI TIPO 2: SI IMPOSTA DI CONSEGUENZA IL CAMPO          00078100
007388*--- CAUSALE DEL FILE ESITO                                       00078200
007389*GM  MOVE 'DPC '                 TO BQVFB21-02-CAUSALE-ERR.       00078300
007390     MOVE 'C10 '                 TO BQVFB21-02-CAUSALE-ERR.       00078400
007391     GO TO B1-240.                                                00078500
007392 B1-080.                                                          00078600
007393*--- MATR. DI TIPO 4: SI IMPOSTA DI CONSEGUENZA IL CAMPO          00078700
007394*--- CAUSALE DEL FILE ESITO                                       00078800
007395     MOVE 'PESC'                 TO BQVFB21-02-CAUSALE-ERR.       00078900
007396     GO TO B1-240.                                                00079000
007397 B1-090.                                                          00079100
007398*--- MATR. DI TIPO 1: SI IMPOSTA DI CONSEGUENZA IL CAMPO          00079200
007399*--- CAUSALE DEL FILE ESITO                                       00079300
007400     MOVE 'DM10'                 TO BQVFB21-02-CAUSALE-ERR.       00079400
007401     GO TO B1-240.                                                00079500
007402*--- NEW: FINE.                                                   00079600
007403 B1-100.                                                          00079700
007404*---   MATRICOLA IMPOSTATA A SPAZIO                               00079800
007405*---                                                              00079900
007406     MOVE 'S'                    TO W-FORMATO-MATR-OK.            00080000
007407     MOVE ZERO                   TO W-ERR.                        00080100
007408     GO TO B1-240.                                                00080200
007409 B1-110.                                                          00080300
007410*---   CAUSALE ESISTENTE SI CONTROLLA SE IL FORMATO DELLA         00080400
007411*---   MATRICOLA DA TABELLA DEV'ESSERE SPAZIO                     00080500
007412*---                                                              00080600
007413     IF W-FORM-MATR EQUAL SPACE                                   00080700
007414       GO TO B1-190.                                              00080800
007415 B1-120.                                                          00080900
007416*---    S'IMPOSTA IL FORMATO MATRICOLA LETTO E SI                 00081000
007417*---    RICHIAMA LA ROUTINE DI CONTROLLA FORMATO                  00081100
007418*---                                                              00081200
007419     MOVE W-FORM-MATR TO W-FORMATO-MATR.                          00081300
007420     MOVE ZERO                   TO W-ERR.                        00081400
007421*---                                                              00081500
007422     PERFORM A2-010-FORMATO THRU A2-010-FORMATO-EX.               00081600
007423     GO TO B1-240.                                                00081700
007424 B1-190.                                                          00081800
007425*---   SI CONTROLLA CHE LA MATRICOLA  SIA IMPOSTATA A SPAZIO      00081900
007426*---                                                              00082000
007427     IF BQVFB21-02-MATR-INPS EQUAL SPACE                          00082100
007428       GO TO B1-210.                                              00082200
007429 B1-200.                                                          00082300
007430     MOVE 96                     TO W-ERR.                        00082400
007431     GO TO B1-240.                                                00082500
007432 B1-210.                                                          00082600
007433     MOVE ZERO                   TO W-ERR.                        00082700
007434*---   FORMATO MATRICOLA OK                                       00082800
007435     MOVE 'X'                    TO W-FORMATO-MATR-OK.            00082900
007436 B1-240.                                                          00083000
007437*---   SI CONTROLLA SE IL FORMATO DELLA MATRICOLA E'              00083100
007438*---   RISULTATO CORRETTO.                                        00083200
008195*---                                                              00083300
008196     IF W-ERR EQUAL ZERO                                          00083400
008197       GO TO B1-280.                                              00083500
008198 B1-250.                                                          00083600
008199*---   MATRICOLA ERRATA: SI CONTROLLA SE L'ERRORE ERA STATO GIA'  00083700
008200*---   PREVISTO NEL RELATIVOP FLAG.                               00083800
008201*---                                                              00083900
008202     IF BQVFB21-02-FLAG-ERR-MATR EQUAL '1'                        00084000
008203        GO TO B1-010-MATR-EX.                                     00084100
008204 B1-260.                                                          00084200
008205*---   ERRORI BLOCCANTE E NON                                     00084300
008206     ADD 1                    TO W-CTR2.                          00084400
008207     MOVE W-ERR               TO BQVFB21-02-ERR-MATR-INPS.        00084500
008208     MOVE 'E'                 TO BQVFB21-02-ERR-MATR-INPS-A.      00084600
008209     IF BQVFB21-02-ERR-FLAG-ERR-MATR EQUAL ZERO                   00084700
008210       ADD 1                  TO W-CTR2                           00084800
008211       MOVE 24                TO BQVFB21-02-ERR-FLAG-ERR-MATR     00084900
008212       MOVE 'E'               TO BQVFB21-02-ERR-FLAG-ERR-MATR-A.  00085000
008213     GO TO B1-010-MATR-EX.                                        00085100
008214 B1-280.                                                          00085200
008215*---   MATRICOLA CORRETTA: SI CONTROLLA IL RELATIVO FLAG          00085300
008216*---                                                              00085400
008217     IF BQVFB21-02-FLAG-ERR-MATR EQUAL '0'                        00085500
008218       GO TO B1-010-MATR-EX.                                      00085600
008219 B1-290.                                                          00085700
008220     IF BQVFB21-02-FLAG-ERR-MATR NOT EQUAL '1'                    00085800
008221       GO TO B1-010-MATR-EX.                                      00085900
008222 B1-300.                                                          00086000
008223*---   ERRORE NON BLOCCANTE                                       00086100
008224     ADD 1                   TO W-CTR1.                           00086200
008225     MOVE 24                 TO BQVFB21-02-ERR-FLAG-ERR-MATR.     00086300
008226     MOVE 'W'                TO BQVFB21-02-ERR-FLAG-ERR-MATR-A.   00086400
008227 B1-010-MATR-EX.                                                  00086500
008228     EXIT.                                                        00086600
008229*---         ROUTINE DI CONTROLLO RIFERIMENTO DAL                 00086700
008230 C1-010-RIF-DAL.                                                  00086800
008231     MOVE ZERO                   TO W-ERR.                        00086900
008232*---   CONTROLLO CORRETTA IMPOSTAZIONE DEL FLAG MATRICOLA         00087000
008233*---                                                              00087100
008234     IF BQVFB21-02-FLAG-ERR-INIZIO EQUAL '0'  OR                  00087200
008235        BQVFB21-02-FLAG-ERR-INIZIO EQUAL '1'                      00087300
008236       GO TO C1-030.                                              00087400
008237 C1-020.                                                          00087500
008238*---   ERRORE BLOCCANTE                                           00087600
008239     ADD 1                    TO W-CTR2.                          00087700
008240     MOVE 55                  TO BQVFB21-02-ERR-FLAG-ERR-INIZIO.  00087800
008241     MOVE 'E'                 TO BQVFB21-02-ERR-FLAG-ERR-I-A.     00087900
008242 C1-030.                                                          00088000
008243*---   SI CONTROLLA SE L'INIZIO RIFERIMENTO HA VALORE NULLO       00088100
008244*---                                                              00088200
008245*    MODIFICHE DEL 9/4/1999                                       00088300
008246**** IF BQVFB21-02-INIZIO-RIFA EQUAL ZERO AND                     00088400
008247******* W-TIPO-INIZ-RIF NOT EQUAL ZERO    AND                     00088500
008248******* W-TIPO-INIZ-RIF NOT EQUAL 'I'                             00088600
008249****** GO TO C1-160.                                              00088700
008250*---                                                              00088800
008251*--- MODIFICA DEL 09/11/2001 PER NUOVO FORMALISMO MATRICOLA       00088900
008252*---                                                              00089000
008253     IF BQVFB21-02-INIZIO-RIFA EQUAL ZERO AND                     00089100
008254        W-TIPO-INIZ-RIF NOT EQUAL ZERO    AND                     00089200
008255        W-TIPO-INIZ-RIF NOT EQUAL 'I'     AND                     00089300
008256        W-TIPO-INIZ-RIF NOT EQUAL 'J'                             00089400
008257       GO TO C1-160.                                              00089500
008258 C1-035.                                                          00089600
008259*---   SI CONTROLLA SE LA CAUSALE E' VALIDA                       00089700
008260*---                                                              00089800
008261     IF W-CAUSALE-OK EQUAL 'SI'                                   00089900
008262       GO TO C1-070.                                              00090000
008263 C1-040.                                                          00090100
008264*---   SI CONTROLLA SE IL FORMATO DELLA MATRICOLA E' CORRETTO     00090200
008265*--- CAUSALE NON IMPOSTATA E FORMATO MATRICOLA ERRATO:            00090300
008266*--- SI RICHIAMA LA ROUTINE DI CONTROLLO RIFERIMENTO DAL          00090400
008267*--- CON MODALITA' "H" (VEDI ROUTINE CHIAMATA)                    00090500
008268        MOVE 'H'             TO W-FORMATO-DAL.                    00090600
008269        MOVE ZERO            TO W-ERR.                            00090700
008270        PERFORM B2-010-TIPO-RIF-DAL THRU B2-010-TIPO-RIF-DAL-EX.  00090800
008271        GO TO C1-170.                                             00090900
008272 C1-070.                                                          00091000
008273*---   SI RICHIAMA LA ROUTINE DI CONTROLLO RIFERIMENTO DAL        00091100
008274*---   IN BASE AL VALORE DEL CAMPO TIPO-INIZIO-RIF DELLA          00091200
008275*---   TABELLA                                                    00091300
008276*---                                                              00091400
008277     MOVE ZERO                    TO W-ERR.                       00091500
008278     MOVE W-TIPO-INIZ-RIF TO W-FORMATO-DAL.                       00091600
008279     PERFORM B2-010-TIPO-RIF-DAL THRU B2-010-TIPO-RIF-DAL-EX.     00091700
008280     GO TO C1-170.                                                00091800
008281 C1-160.                                                          00091900
008282*---   IMPOSTAZIONE ERRORE PER RIFERIMENTO DAL NULLO,             00092000
008283*---   INDIPENDENTEMENTE DALLA CAUSALE E DAL FORMATO.             00092100
008284*---                                                              00092200
008285     MOVE 55                      TO W-ERR.                       00092300
008286 C1-170.                                                          00092400
008287     IF W-ERR EQUAL ZERO                                          00092500
008288       GO TO C1-210.                                              00092600
008289 C1-180.                                                          00092700
008290     IF BQVFB21-02-FLAG-ERR-INIZIO EQUAL '1'                      00092800
008291        GO TO C1-010-RIF-DAL-EX.                                  00092900
008292 C1-190.                                                          00093000
008293*---   ERRORI BLOCCANTE E NON                                     00093100
008294     ADD 1                    TO W-CTR2.                          00093200
008295     MOVE W-ERR               TO BQVFB21-02-ERR-INIZIO-RIF.       00093300
008296     MOVE 'E'                 TO BQVFB21-02-ERR-INIZIO-RIF-A.     00093400
008297     IF BQVFB21-02-ERR-FLAG-ERR-INIZIO EQUAL ZERO                 00093500
008298       ADD 1                  TO W-CTR2                           00093600
008299       MOVE 24                TO BQVFB21-02-ERR-FLAG-ERR-INIZIO   00093700
008300       MOVE 'E'               TO BQVFB21-02-ERR-FLAG-ERR-I-A.     00093800
008301     GO TO C1-010-RIF-DAL-EX.                                     00093900
008302 C1-210.                                                          00094000
008303*---                                                              00094100
008304     IF BQVFB21-02-FLAG-ERR-INIZIO EQUAL '0'                      00094200
008305       GO TO C1-010-RIF-DAL-EX.                                   00094300
008306 C1-220.                                                          00094400
008307     IF BQVFB21-02-FLAG-ERR-INIZIO NOT EQUAL '1'                  00094500
008308       GO TO C1-010-RIF-DAL-EX.                                   00094600
008309 C1-230.                                                          00094700
008310*---   ERRORE NON BLOCCANTE                                       00094800
008311*---                                                              00094900
008312     ADD 1                   TO W-CTR1.                           00095000
008313     MOVE 24                 TO BQVFB21-02-ERR-FLAG-ERR-INIZIO.   00095100
008314     MOVE 'W'                TO BQVFB21-02-ERR-FLAG-ERR-I-A.      00095200
008315 C1-010-RIF-DAL-EX.                                               00095300
008316     EXIT.                                                        00095400
008317*---          ROUTINE DI CONTROLLO RIFERIMENTO AL                 00095500
008318 D1-010-RIF-AL.                                                   00095600
008319     MOVE ZERO                   TO W-ERR.                        00095700
008320*---   CONTROLLO CORRETTA IMPOSTAZIONE DEL FLAG MATRICOLA         00095800
008321*---                                                              00095900
008322     IF BQVFB21-02-FLAG-ERR-FINE EQUAL '0'    OR                  00096000
008323        BQVFB21-02-FLAG-ERR-FINE EQUAL '1'                        00096100
008324       GO TO D1-030.                                              00096200
008325 D1-020.                                                          00096300
008326*---   ERRORE BLOCCANTE                                           00096400
009110*---                                                              00096500
009111     ADD 1                    TO W-CTR2.                          00096600
009112     MOVE 55                  TO BQVFB21-02-ERR-FLAG-ERR-FINE.    00096700
009113     MOVE 'E'                 TO BQVFB21-02-ERR-FLAG-ERR-F-A.     00096800
009114 D1-030.                                                          00096900
009115*---   SI CONTROLLA SE LA CAUSALE                                 00097000
009116*---                                                              00097100
009117     IF W-CAUSALE-OK EQUAL 'SI'                                   00097200
009118       GO TO D1-080.                                              00097300
009119 D1-040.                                                          00097400
009120*---   SI CONTROLLA SE IL FORMATO DELLA MATRICOLA E' CORRETTO     00097500
009121     IF W-FORMATO-MATR-OK EQUAL '1' OR                            00097600
009122        W-FORMATO-MATR-OK EQUAL '2' OR                            00097700
009123        W-FORMATO-MATR-OK EQUAL '4' OR                            00097800
009124        W-FORMATO-MATR-OK EQUAL 'S'                               00097900
009125       GO TO D1-060.                                              00098000
009126 D1-050.                                                          00098100
009127*---   CAUSALE NON IMPOSTATA E FORMATO MATRICOLA NON VALIDO:      00098200
009128*---   SI RICHIAMA LA ROUTINE DI CONTROLLO RIFERIMENTO AL         00098300
009129*---   CON MODALITA' "B" (VEDI ROUTINE RICHIAMATA).               00098400
009130*---                                                              00098500
009131     MOVE 'B'                     TO W-FORMATO-AL.                00098600
009132     MOVE ZERO                    TO W-ERR.                       00098700
009133     PERFORM C2-010-TIPO-RIF-AL THRU C2-010-TIPO-RIF-AL-EX.       00098800
009134     GO TO D1-160.                                                00098900
009135 D1-060.                                                          00099000
009136*---   CAUSALE NON IMPOSTATA MA FORMATO MATRICOLA CORRETTO; IL    00099100
009137*---   RIFERIMENTO AL DEV'ESSERE IMPOSTATO A ZERO.                00099200
009138*---                                                              00099300
009139*---   MODIFICA DEL 14/08/2001 PER NUOVA GESTIONE CAUSALI ERRATE  00099400
009140*---                                                              00099500
009141*F   IF BQVFB21-02-FINE-RIFA EQUAL ZERO                           00099600
009142*F     GO TO D1-160.                                              00099700
009143     IF BQVFB21-02-FINE-RIFA EQUAL ZERO AND                       00099800
009144        W-FORMATO-MATR-OK NOT EQUAL 'S'                           00099900
009145       GO TO D1-160.                                              00100000
009146*---                                                              00100100
009147*---   FINE MODIFICA                                              00100200
009148*---                                                              00100300
009149 D1-070.                                                          00100400
009150     MOVE 96                      TO W-ERR.                       00100500
009151     GO TO D1-160.                                                00100600
009152 D1-080.                                                          00100700
009153*---   CAUSALE ESISTENTE:                                         00100800
009154*---                                                              00100900
009155     IF W-TIPO-FINE-RIF EQUAL ZERO                                00101000
009156       GO TO D1-140.                                              00101100
009157 D1-090.                                                          00101200
009158*---   SI RICHIAMA LA ROUTINE PER CONTROLLARE IL RIFERIMENTO      00101300
009159*---   DAL IN BASE ALLA TIPOLOGIA LETTA.                          00101400
009160*---                                                              00101500
009161     MOVE ZERO                    TO W-ERR.                       00101600
009162     MOVE W-TIPO-FINE-RIF   TO W-FORMATO-AL.                      00101700
009163     PERFORM C2-010-TIPO-RIF-AL THRU C2-010-TIPO-RIF-AL-EX.       00101800
009164     GO TO D1-160.                                                00101900
009165 D1-140.                                                          00102000
009166*---   RIFERIMENTO AL DEV'ESSERE IMPOSTATO A ZERO.                00102100
009167*---                                                              00102200
009168     IF BQVFB21-02-FINE-RIFA EQUAL ZERO                           00102300
009169       GO TO D1-160.                                              00102400
009170 D1-150.                                                          00102500
009171     MOVE 96                      TO W-ERR.                       00102600
009172 D1-160.                                                          00102700
009173     IF W-ERR EQUAL ZERO                                          00102800
009174       GO TO D1-200.                                              00102900
009175 D1-170.                                                          00103000
009176     IF BQVFB21-02-FLAG-ERR-FINE EQUAL '1'                        00103100
009177        GO TO D1-010-RIF-AL-EX.                                   00103200
009178 D1-180.                                                          00103300
009179*---   ERRORI BLOCCANTE E NON                                     00103400
009180     ADD 1                    TO W-CTR2.                          00103500
009181     MOVE W-ERR               TO BQVFB21-02-ERR-FINE-RIF.         00103600
009182     MOVE 'E'                 TO BQVFB21-02-ERR-FINE-RIF-A.       00103700
009183     IF BQVFB21-02-ERR-FLAG-ERR-FINE EQUAL ZERO                   00103800
009184       ADD 1                  TO W-CTR2                           00103900
009185       MOVE 24                TO BQVFB21-02-ERR-FLAG-ERR-FINE     00104000
009186       MOVE 'E'               TO BQVFB21-02-ERR-FLAG-ERR-F-A.     00104100
009187     GO TO D1-010-RIF-AL-EX.                                      00104200
009188 D1-200.                                                          00104300
009189     IF BQVFB21-02-FLAG-ERR-FINE EQUAL '0'                        00104400
009190       GO TO D1-010-RIF-AL-EX.                                    00104500
009191 D1-210.                                                          00104600
009192     IF BQVFB21-02-FLAG-ERR-FINE NOT EQUAL '1'                    00104700
009193       GO TO D1-010-RIF-AL-EX.                                    00104800
009194 D1-220.                                                          00104900
009195*---   ERRORE NON BLOCCANTE                                       00105000
009196     ADD 1                   TO W-CTR1.                           00105100
009197     MOVE 24                 TO BQVFB21-02-ERR-FLAG-ERR-FINE.     00105200
009198     MOVE 'W'                TO BQVFB21-02-ERR-FLAG-ERR-F-A.      00105300
009199 D1-010-RIF-AL-EX.                                                00105400
009200     EXIT.                                                        00105500
009201*---        ROUTINE DI CONTROLLO CONTRIBUTI                       00105600
009202 E1-010-CONTR.                                                    00105700
009203     IF BQVFB21-02-IMP-RIMB   NUMERIC AND                         00105800
009204        BQVFB21-02-IMP-RIMB   GREATER ZERO                        00105900
009205        MOVE '1' TO W-FLAG-CRED                                   00106000
009206     END-IF.                                                      00106100
009207*---   SI CONTROLLA LA VALIDITA' DELLA CAUSALE                    00106200
009208*---                                                              00106300
009209*--- MODIFICA DEL 14/08/2001 PER NUOVE CAUSALI                    00106400
009210*---                                                              00106500
009211**MODIFICA 13/03/2006                                             00106600
009212** UTILIZZO FLAG-COMPEN                                           00106700
009213*F   MODIFICA DEL 19/09/2005 PER DMRP: SOLO CREDITO               00106800
009214*F   IF BQVFB21-02-CAUSALE EQUAL 'ABS ' OR 'CBS ' OR 'BLAA' OR    00106900
009215*F                               'BPCF' OR 'BLAS' OR 'DMRP'       00107000
009216     IF W-FLAG-COMPEN = 'R'                                       00107100
009217        PERFORM D3-010-PAG THRU D3-010-PAG-EX                     00107200
009218        GO TO E1-010-CONTR-EX.                                    00107300
009219*GM  IF (W-CAUSALE-OK EQUAL 'SI'                   AND            00107400
009220*GM      (BQVFB21-02-CAUSALE EQUAL 'DM10'        OR               00107500
009221*GM       BQVFB21-02-CAUSALE EQUAL 'DPP '        OR               00107600
009222*GM       BQVFB21-02-CAUSALE EQUAL 'AP  '        OR               00107700
009223*GM       BQVFB21-02-CAUSALE EQUAL 'CP  ') )                      00107800
009224*        OR (W-CAUSALE-OK EQUAL 'NO'                   AND        00107900
009225*         W-FORMATO-MATR-OK EQUAL '1')                            00108000
009226*F   AND   (    BQVFB21-02-CAUSALE EQUAL 'DM10'      OR           00108100
009227*F             (BQVFB21-02-CAUSALE EQUAL 'DPP '                   00108200
009228*F              AND                                               00108300
009229*F              BQVFB21-02-DATA-RISC < '20010117')   OR           00108400
009230*F             (BQVFB21-02-CAUSALE EQUAL 'P10 '                   00108500
009231*F              AND                                               00108600
009232*F              BQVFB21-02-DATA-RISC > '20001231')   OR           00108700
009233*F             (BQVFB21-02-CAUSALE EQUAL 'PXX '                   00108800
009234*F              AND                                               00108900
009235*F              BQVFB21-02-DATA-RISC > '20001231')   OR           00109000
009236*F             (BQVFB21-02-CAUSALE EQUAL 'AF  '                   00109100
009237*F              AND                                               00109200
009238*F              BQVFB21-02-DATA-RISC > '20010919')   OR           00109300
009239*F             (BQVFB21-02-CAUSALE EQUAL 'CF  '                   00109400
009240*F              AND                                               00109500
009241*F              BQVFB21-02-DATA-RISC > '20010919')   OR           00109600
009242*F             BQVFB21-02-CAUSALE EQUAL 'AP  '       OR           00109700
009243*F             BQVFB21-02-CAUSALE EQUAL 'CP  ') )                 00109800
009244**MODIFICA 13/03/2006                                             00109900
009245** UTILIZZO FLAG-COMPEN                                           00110000
009246     IF W-CAUSALE-OK EQUAL 'SI' AND                               00110100
009247        W-FLAG-COMPEN = 'E'                                       00110200
009248        GO TO E1-030.                                             00110300
009249*E1-020.                                                          00110400
009250*---   IL SEGNO DEI CONTRIBUTI DEV'ESSRE "P"                      00110500
009251*---                                                              00110600
009252*    IF BQVFB21-02-SEGNO-CONTR EQUAL 'P'                          00110700
009253*      GO TO E1-040.                                              00110800
009254*E1-030.                                                          00110900
009255*---   ERRORE NON BLOCCANTE                                       00111000
009256*    ADD 1                   TO W-CTR1.                           00111100
009257*    MOVE 55                 TO BQVFB21-02-ERR-SEGNO-CONTR.       00111200
009258*    MOVE 'W'                TO BQVFB21-02-ERR-SEGNO-CONTR-A.     00111300
009259*    IF BQVFB21-02-SEGNO-CONTR EQUAL 'N'                          00111400
009260*      MOVE 24               TO BQVFB21-02-ERR-SEGNO-CONTR.       00111500
009261*--- NEW:                                                         00111600
009262 E1-020.                                                          00111700
010874*---   ROUTINE PER CONTROLLARE PAGAMENTI E RIMBORSI               00111800
010875*---                                                              00111900
010876     MOVE '2'                    TO W-PAG-RIMB.                   00112000
010877     PERFORM D2-010-PAG  THRU D2-010-PAG-EX.                      00112100
010878     PERFORM E2-010-RIMB THRU E2-010-RIMB-EX.                     00112200
010879     GO TO E1-010-CONTR-EX.                                       00112300
010880 E1-030.                                                          00112400
010881*---   ROUTINE PER CONTROLLARE PAGAMENTI E RIMBORSI               00112500
010882*---                                                              00112600
010883     MOVE '1'                    TO W-PAG-RIMB.                   00112700
010884     PERFORM D2-010-PAG  THRU D2-010-PAG-EX.                      00112800
010885     PERFORM E2-010-RIMB THRU E2-010-RIMB-EX.                     00112900
010886*--- NEW: FINE.                                                   00113000
010887 E1-010-CONTR-EX.                                                 00113100
010888     EXIT.                                                        00113200
010889*--- VECCHI CONTROLLI CHE NON SERVONO PIU'                        00113300
010890*---   SI CONTROLLA CHE I CONTRIBUTI SIA IMOSTATO A ZERO          00113400
010891*---                                                              00113500
010892*    IF BQVFB21-02-IMP-CONTRA EQUAL ZERO                          00113600
010893*      GO TO E1-010-CONTR-EX.                                     00113700
010894*E1-050.                                                          00113800
010895*---   ERRORE NON BLOCCANTE                                       00113900
010896*    ADD 1                   TO W-CTR1.                           00114000
010897*    MOVE 15                 TO BQVFB21-02-ERR-IMP-CONTR.         00114100
010898*    MOVE 'W'                TO BQVFB21-02-ERR-IMP-CONTR-A.       00114200
010899*    GO TO E1-010-CONTR-EX.                                       00114300
010900*E1-060.                                                          00114400
010901*---   IL SEGNO DEI CONTRIBUTI DEV'ESSRE "P" OR "N"               00114500
010902*---                                                              00114600
010903*    IF BQVFB21-02-SEGNO-CONTR EQUAL 'P' OR                       00114700
010904*       BQVFB21-02-SEGNO-CONTR EQUAL 'N'                          00114800
010905*      GO TO E1-080.                                              00114900
010906*E1-070.                                                          00115000
010907*---   ERRORE NON BLOCCANTE                                       00115100
010908*    ADD 1                   TO W-CTR1.                           00115200
010909*    MOVE 55                 TO BQVFB21-02-ERR-SEGNO-CONTR.       00115300
010910*    MOVE 'W'                TO BQVFB21-02-ERR-SEGNO-CONTR-A.     00115400
010911*E1-080.                                                          00115500
010912*---   ROUTINE PER CONTROLLARE PAGAMENTI E RIMBORSI               00115600
010913*---                                                              00115700
010914*    MOVE '1'                    TO W-PAG-RIMB.                   00115800
010915*    PERFORM D2-010-PAG  THRU D2-010-PAG-EX.                      00115900
010916*    PERFORM E2-010-RIMB THRU E2-010-RIMB-EX.                     00116000
010917*---   SI CONTROLLA CHE CONTRIBUTI SIA NUMERICO                   00116100
010918*---                                                              00116200
010919*    IF BQVFB21-02-IMP-CONTRA NUMERIC                             00116300
010920*      GO TO E1-100.                                              00116400
010921*E1-090.                                                          00116500
010922*---   ERRORE NON BLOCCANTE                                       00116600
010923*    ADD 1                   TO W-CTR1.                           00116700
010924*    MOVE 33                 TO BQVFB21-02-ERR-IMP-CONTR.         00116800
010925*    MOVE 'W'                TO BQVFB21-02-ERR-IMP-CONTR-A.       00116900
010926*    GO TO E1-140.                                                00117000
010927*E1-100.                                                          00117100
010928*---                                                              00117200
010929*    IF BQVFB21-02-SEGNO-CONTR EQUAL 'P'                          00117300
010930*      GO TO E1-140.                                              00117400
010931*E1-110.                                                          00117500
010932*---                                                              00117600
010933*    IF BQVFB21-02-SEGNO-CONTR NOT EQUAL 'N'                      00117700
010934*      GO TO E1-140.                                              00117800
010935*E1-120.                                                          00117900
010936*---   SI CONTROLLA CHE CONTRIBUTI SIA IMPOSTATO                  00118000
010937*---                                                              00118100
010938*    IF BQVFB21-02-IMP-CONTR GREATER ZERO                         00118200
010939*      GO TO E1-140.                                              00118300
010940*E1-130.                                                          00118400
010941*---   ERRORE NON BLOCCANTE                                       00118500
010942*    ADD 1                   TO W-CTR1.                           00118600
010943*    MOVE 39                 TO BQVFB21-02-ERR-IMP-CONTR.         00118700
010944*    MOVE 'W'                TO BQVFB21-02-ERR-IMP-CONTR-A.       00118800
010945*E1-140.                                                          00118900
010946*---   SI VERIFICA SE SI E' VERIFICATO UN ERRORE RELATIVAMENTE    00119000
010947*---   AL CAMPO CONTRIBUTI                                        00119100
010948*---                                                              00119200
010949*    IF BQVFB21-02-ERR-IMP-CONTR NOT EQUAL ZERO                   00119300
010950*      GO TO E1-010-CONTR-EX.                                     00119400
010951*E1-150.                                                          00119500
010952*---   SI CONTROLLA LA DIVISA                                     00119600
010953*---                                                              00119700
010954*    IF W-DIVISA EQUAL SPACE OR                                   00119800
010955*       W-DIVISA EQUAL 'EUR'                                      00119900
010956*      GO TO E1-010-CONTR-EX.                                     00120000
010957*E1-160.                                                          00120100
010958*---   SI CONTROLLA CHE LE ULTIME TRE CIFRE DI CONTRIBUTI SIANO   00120200
010959*---   IMPOSTATE A ZERO (DIVISA = ITL)                            00120300
010960*---                                                              00120400
010961*    MOVE BQVFB21-02-IMP-CONTR     TO W-CIFRE.                    00120500
010962*    IF W-CIFRE-TRE EQUAL ZERO                                    00120600
010963*      GO TO E1-010-CONTR-EX.                                     00120700
010964*E1-170.                                                          00120800
010965*---   ERRORE NON BLOCCANTE                                       00120900
010966*    ADD 1                   TO W-CTR1.                           00121000
010967*    MOVE 15                 TO BQVFB21-02-ERR-IMP-CONTR.         00121100
010968*    MOVE 'W'                TO BQVFB21-02-ERR-IMP-CONTR-A.       00121200
010969*---      ROUTINE DI CONTROLLO CORRETTEZZA MATRICOLA              00121300
010970*---      IN RELAZIONE AL TIPO FORMATO                            00121400
010971*---                                                              00121500
010972*--- --- --- -- --- --- --- --- --- --- --- --- -- --- --- ---    00121600
010973*--- --- --- -- --- --- --- --- --- --- --- --- -- --- --- ---    00121700
010974*---                                                              00121800
010975 A2-010-FORMATO.                                                  00121900
010976*---   CONTROLLO TIPO FORMATO MATRICOLA DA CONTROLLARE            00122000
012028*---                                                              00122100
012029     IF W-FORMATO-MATR EQUAL '1'                                  00122200
012030       GO TO A2-340.                                              00122300
012031 A2-020.                                                          00122400
012032     IF W-FORMATO-MATR EQUAL '2'                                  00122500
012033       GO TO A2-320.                                              00122600
012034 A2-030.                                                          00122700
012035     IF W-FORMATO-MATR EQUAL '4'                                  00122800
012036       GO TO A2-300.                                              00122900
012037 A2-040.                                                          00123000
012038     IF W-FORMATO-MATR EQUAL '3'                                  00123100
012039       GO TO A2-170.                                              00123200
012040 A2-042.                                                          00123300
012041*    MODIFICHE DELL' 11/5/2001                                    00123400
012042     IF W-FORMATO-MATR EQUAL '8'                                  00123500
012043        PERFORM A3-010-CASALINGHE THRU A3-EXIT                    00123600
012044        GO TO A2-010-FORMATO-EX.                                  00123700
012045 A2-043.                                                          00123800
012046*---                                                              00123900
012047*    MODIFICHE DELL' 09/11/2001                                   00124000
012048*---                                                              00124100
012049     IF W-FORMATO-MATR EQUAL '9'                                  00124200
012050        PERFORM A4-010-VISITE     THRU A4-EXIT                    00124300
012051        GO TO A2-010-FORMATO-EX.                                  00124400
012052*---                                                              00124500
012053*--- FINE MODIFICA                                                00124600
012054*---                                                              00124700
012055*---   MODIFICA DEL 29/07/2008 PER NUOVO FORMALISMO MATRICOLA     00124800
012056*---                                                              00124900
012057*---                                                              00125000
012058 A2-043-E.                                                        00125100
012059*---                                                              00125200
012060     IF W-FORMATO-MATR EQUAL 'E'                                  00125300
012061        PERFORM A9-010 THRU A9-EXIT                               00125400
012062        GO TO A2-010-FORMATO-EX.                                  00125500
012063*---                                                              00125600
012064*---                                                              00125700
012065*---                                                              00125800
012066 A2-043-D.                                                        00125900
012067*---                                                              00126000
012068     IF W-FORMATO-MATR EQUAL 'D'                                  00126100
012069        PERFORM A8-010 THRU A8-EXIT                               00126200
012070        GO TO A2-010-FORMATO-EX.                                  00126300
012071*---                                                              00126400
012072*---                                                              00126500
012073 A2-043-C.                                                        00126600
012074*---                                                              00126700
012075     IF W-FORMATO-MATR EQUAL 'C'                                  00126800
012076        PERFORM A7-010 THRU A7-EXIT                               00126900
012077        GO TO A2-010-FORMATO-EX.                                  00127000
012078*---                                                              00127100
012079*---   MODIFICA DEL 11/04/2002 PER NUOVO FORMALISMO MATRICOLA     00127200
012080*---                                                              00127300
012081 A2-043-A.                                                        00127400
012082*---                                                              00127500
012083     IF W-FORMATO-MATR EQUAL 'A'                                  00127600
012084        PERFORM A5-010-DOMESTICI THRU A5-EXIT                     00127700
012085        GO TO A2-010-FORMATO-EX.                                  00127800
012745*---                                                              00127900
012746 A2-043-B.                                                        00128000
012747*---                                                              00128100
012748     IF W-FORMATO-MATR EQUAL 'B'                                  00128200
012749        PERFORM A6-010-CALAMITA THRU A6-EXIT                      00128300
012750        GO TO A2-010-FORMATO-EX.                                  00128400
012751*---                                                              00128500
012752*---   FINE MODIFICA                                              00128600
012753*---                                                              00128700
012754 A2-045.                                                          00128800
012755*    MODIFICHE DEL 9/4/1999                                       00128900
012756     IF W-FORMATO-MATR EQUAL '7' AND                              00129000
012757        BQVFB21-02-MATR-INPS EQUAL SPACE                          00129100
012758       GO TO A2-165.                                              00129200
012759 A2-050.                                                          00129300
012760*---   FORMATO MATRICOLA DI TIPO 5                                00129400
012950*---                                                              00129500
012951     MOVE BQVFB21-02-MATR-INPS        TO W-MATR5.                 00129600
012952*    MODIFICHE DELL' 8/4/1999                                     00129700
012953*    IF (W-MATR5-1 NOT EQUAL '0' AND                              00129800
012954*        W-MATR5-1 NOT EQUAL '3' AND                              00129900
012955*        W-MATR5-1 NOT EQUAL '4' AND                              00130000
012956*        W-MATR5-1 NOT EQUAL '5' AND                              00130100
012957*        W-MATR5-1 NOT EQUAL '6')      OR                         00130200
012958*        W-MATR5-2-8 NOT NUMERIC       OR                         00130300
012959*        W-MATR5-2-8 EQUAL ZERO                                   00130400
012960     IF  W-MATR5-1   NOT NUMERIC      OR                          00130500
012961         W-MATR5-2-8 NOT NUMERIC                                  00130600
012962       GO TO A2-160.                                              00130700
012963 A2-060.                                                          00130800
012964*---                                                              00130900
012965*    MODIFICHE DEL 9/4/1999                                       00131000
012966*     IF (W-MATR5-9-10 NOT NUMERIC OR                             00131100
012967*         W-MATR5-11   NOT NUMERIC OR                             00131200
012968*         W-MATR5-11   EQUAL ZERO)      AND                       00131300
012969*         W-MATR5-1 NOT EQUAL '6'                                 00131400
012970     IF  W-MATR5-9-10 NOT NUMERIC OR                              00131500
012971         W-MATR5-11   NOT NUMERIC                                 00131600
012972       GO TO A2-150.                                              00131700
012973 A2-065.                                                          00131800
012974*---                                                              00131900
012975*    MODIFICHE DEL 9/4/1999                                       00132000
012976*    IF (W-MATR5-12   NOT NUMERIC OR                              00132100
012977*        W-MATR5-12   EQUAL ZERO  OR                              00132200
012978*        W-MATR5-12   GREATER '8')    AND                         00132300
012979*        W-MATR5-1 NOT EQUAL '6'                                  00132400
012980     IF  W-MATR5-12   NOT NUMERIC                                 00132500
012981       GO TO A2-140.                                              00132600
012982 A2-070.                                                          00132700
012983*---                                                              00132800
012984*    MODIFICHE DEL 9/4/1999                                       00132900
012985*    IF W-MATR5-13-14  NOT NUMERIC       OR                       00133000
012986*       W-MATR5-13-14  EQUAL ZERO                                 00133100
012987**      W-MATR5-13-14  > '04'                                     00133200
012988*---                                                              00133300
012989*--- MODIFICA DEL 14/08/2001 PER NUOVE CAUSALI                    00133400
012990*---                                                              00133500
012991*    IF W-MATR5-13-14  NOT NUMERIC                                00133600
012992*      GO TO A2-130.                                              00133700
012993     IF W-MATR5-13-14  NOT NUMERIC                                00133800
012994     OR (BQVFB21-02-DATA-RISC > '20010919'    AND                 00133900
012995         W-MATR5 EQUAL ZERO)                                      00134000
012996       GO TO A2-130.                                              00134100
012997 A2-080.                                                          00134200
012998*---                                                              00134300
012999     MOVE BQVFB21-02-MATR-INPS        TO W-MATR5A.                00134400
013000     MOVE ZERO                        TO W-IND.                   00134500
013001     MOVE ZERO                        TO W-UNITA.                 00134600
013002 A2-085.                                                          00134700
013003*---   SI SOMMANO LE PRIME 14 CIFRE                               00134800
013004*---                                                              00134900
013005     ADD  1                           TO W-IND.                   00135000
013006     COMPUTE W-UNITA = W-UNITA + W-EL-MATR5A(W-IND).              00135100
013007     IF W-IND LESS 14                                             00135200
013008       GO TO A2-085.                                              00135300
013009 A2-090.                                                          00135400
013010*---   L'UNITA' DELLA SOMMA DEV'ESSERE PARI AL 15 CARATTERE      00135500
013011*---                                                              00135600
013012     IF W-MATR5-15 NOT NUMERIC        OR                          00135700
013013        W-UNITA NOT EQUAL W-MATR5-15                              00135800
013014       GO TO A2-120.                                              00135900
013015 A2-100.                                                          00136000
013016*---   SI CONSIDERA LA STRINGA NUMERICA DEI PRIMI 15 CARATTERI,   00136100
013017*---   LA SI DIVIDE PER 93 E SI CONTROLLA CHE IL RESTO SIA PARI   00136200
013018*---   ALLA STRINGA NUMERICA DEL 16/17 BYTE                     00136300
013019*---                                                              00136400
013020     MOVE BQVFB21-02-MATR-INPS        TO W-MATR5B.                00136500
013021     DIVIDE 93 INTO W-EL-MATR5B GIVING W-UNITA                    00136600
013022                                 REMAINDER W-RESTO.               00136700
013023     IF W-MATR5-16-17 NUMERIC            AND                      00136800
013024        W-MATR5-16-17 EQUAL W-RESTO1                              00136900
013025       MOVE '5'                    TO W-FORMATO-MATR-OK           00137000
013026       GO TO A2-010-FORMATO-EX.                                   00137100
013027 A2-110.                                                          00137200
013028*---                                                              00137300
013029     MOVE 96                        TO W-ERR.                     00137400
013030     GO TO A2-010-FORMATO-EX.                                     00137500
013031 A2-120.                                                          00137600
013032*---                                                              00137700
013033     MOVE 96                        TO W-ERR.                     00137800
013034     GO TO A2-010-FORMATO-EX.                                     00137900
013035 A2-130.                                                          00138000
013036*---                                                              00138100
013037     MOVE 96                        TO W-ERR.                     00138200
013038     GO TO A2-010-FORMATO-EX.                                     00138300
013039 A2-140.                                                          00138400
013040*---                                                              00138500
013041     MOVE 96                        TO W-ERR.                     00138600
013042     GO TO A2-010-FORMATO-EX.                                     00138700
013043 A2-150.                                                          00138800
013044*---                                                              00138900
013045     MOVE 96                        TO W-ERR.                     00139000
013046     GO TO A2-010-FORMATO-EX.                                     00139100
013047 A2-160.                                                          00139200
013048*---                                                              00139300
013049     MOVE 96                        TO W-ERR.                     00139400
013050     GO TO A2-010-FORMATO-EX.                                     00139500
013051*    MODIFICHE DEL 9/4/1999                                       00139600
013052 A2-165.                                                          00139700
013053*---                                                              00139800
013054     MOVE '7'                       TO W-FORMATO-MATR-OK.         00139900
013055     GO TO A2-010-FORMATO-EX.                                     00140000
013056 A2-170.                                                          00140100
013057*---                                                              00140200
013058*---   FORMATO MATRICOLA DI TIPO 3                                00140300
013059*---                                                              00140400
013060     MOVE BQVFB21-02-MATR-INPS        TO W-MATR3.                 00140500
013061*---                                                              00140600
013062*--- MODIFICA DEL 14/08/2001 PER NUOVE CAUSALI                    00140700
013063*---                                                              00140800
013064**** IF W-MATR3-1-10 NOT NUMERIC    OR                            00140900
013065****    W-MATR3-1-10 EQUAL ZERO     OR                            00141000
013066     IF W-MATR3-1-8  NOT NUMERIC    OR                            00141100
013067*GM     W-MATR3-1-8  EQUAL ZERO     OR                            00141200
013068        ( W-MATR3-1-8  EQUAL ZERO     AND                         00141300
013069          BQVFB21-02-DATA-RISC < '20010920' )  OR                 00141400
013070        W-MATR3-9-10 NOT NUMERIC    OR                            00141500
013071        W-MATR3-11   NOT NUMERIC    OR                            00141600
013072*GM     W-MATR3-11   EQUAL ZERO                                   00141700
013073        ( W-MATR3-11   EQUAL ZERO     AND                         00141800
013074          BQVFB21-02-DATA-RISC < '20010920' )                     00141900
013075       GO TO A2-290.                                              00142000
013076 A2-175.                                                          00142100
013077*---                                                              00142200
013078*GM  IF W-MATR3-12-13 NOT NUMERIC    OR                           00142300
013079*GM     W-MATR3-12-13 LESS '10'                                   00142400
013080*GM    GO TO A2-280.                                              00142500
013081*---                                                              00142600
013082*--- MODIFICA DEL 14/08/2001 PER NUOVE CAUSALI                    00142700
014280*---                                                              00142800
014281     IF W-MATR3-12-13 NOT NUMERIC    OR                           00142900
014282        ( W-MATR3-12-13 LESS '10'    AND                          00143000
014283          BQVFB21-02-DATA-RISC < '20010920' )                     00143100
014284       GO TO A2-280.                                              00143200
014285 A2-180.                                                          00143300
014286*---                                                              00143400
014287*GM  IF W-MATR3-14    NOT NUMERIC    OR                           00143500
014288*GM     W-MATR3-14    GREATER '6'                                 00143600
014289*GM    GO TO A2-270.                                              00143700
014290*---                                                              00143800
014291*--- MODIFICA DEL 14/08/2001 PER NUOVE CAUSALI                    00143900
014310*---                                                              00144000
014311     IF W-MATR3-14    NOT NUMERIC                OR               00144100
014312        ( W-MATR3-14    GREATER '6'         AND                   00144200
014313          BQVFB21-02-DATA-RISC < '20010920' )    OR               00144300
014314        ( BQVFB21-02-DATA-RISC > '20010919' AND                   00144400
014315          W-MATR3 EQUAL ZERO )                                    00144500
014316       GO TO A2-270.                                              00144600
014317 A2-185.                                                          00144700
014318*---   SI CONTROLLA SE E' POSSIBILE RICOSTRUIRE LA CODE LINE      00144800
014319*---                                                              00144900
014320     MOVE BQVFB21-02-IMP-PAGAMA            TO W-PAGAM.            00145000
014321*---                                                              00145100
014322*--- MODIFICA MAGGIO 2001: SE L'IMPORTO E' IN CENTESIMI DI EURO   00145200
014323*--- SI CONSIDERA SOLO LA PARTE INTERA                            00145300
014324*---                                                              00145400
014325     IF W-DIVISA = 'EUR'                                          00145500
014326        STRING '00' BQVFB21-02-IMP-PAGAMA(1:13)                   00145600
014327        DELIMITED BY SIZE INTO W-PAGAM                            00145700
014328     END-IF.                                                      00145800
014590*---                                                              00145900
014591*--- MODIFICA DEL 14/08/2001 PER NUOVE CAUSALI                    00146000
014592*---                                                              00146100
014593     IF BQVFB21-02-DATA-RISC > '20010919'                         00146200
014594        PERFORM C3-010-PAG THRU C3-010-PAG-EX.                    00146300
014595*---                                                              00146400
014596     MOVE BQVFB21-02-INIZIO-RIFA      TO W-RIF.                   00146500
014597     IF BQVFB21-02-MATR-INPS  NOT NUMERIC OR                      00146600
014598*GM     BQVFB21-02-IMP-PAGAMA NOT NUMERIC OR                      00146700
014599        W-PAGAM               NOT NUMERIC OR                      00146800
014600        W-ANNO-RIF            NOT NUMERIC OR                      00146900
014601        BQVFB21-02-COD-SEDE   NOT NUMERIC                         00147000
014602       MOVE 96                        TO W-ERR                    00147100
014603       GO TO A2-010-FORMATO-EX.                                   00147200
014604 A2-190.                                                          00147300
014605*---   RISCOSTRUZIONE CODE LINE; SI CONSIDERANO I PRIMI 32        00147400
014606*---   CARATTERI E SI DIVIDONO IN 4 GRUPPI DA 8; OGNI             00147500
014607*---   GRUPPO E' DIVISO PER 99.                                   00147600
014608*---                                                              00147700
014609     MOVE W-PAGAMEN               TO W-CODE-LINE1.                00147800
014610     MOVE W-ANNO-RIF              TO W-CODE-LINE2.                00147900
014611     MOVE BQVFB21-02-COD-SEDE     TO W-CODE-LINE3.                00148000
014612     MOVE BQVFB21-02-MATR-INPS    TO W-CODE-LINE4.                00148100
014676*---                                                              00148200
014677*--- MODIFICA DEL 09/11/2001 PER NUOVO FORMALISMO MATRICOLA       00148300
014678*---                                                              00148400
014679**** IF W-MATR3-14 EQUAL '6'                                      00148500
014680     IF W-MATR3-14 EQUAL '6' AND                                  00148600
014681        BQVFB21-02-DATA-RISC < '20010920'                         00148700
014682       MOVE ZERO                  TO W-CODE-LINE1.                00148800
014683*---                                                              00148900
014684*--- FINE MODIFICA                                                00149000
014685*---                                                              00149100
014686     DIVIDE 99 INTO W-CODE-LINE-EL1 GIVING W-QUOZ-EL(1)           00149200
014687                                 REMAINDER W-REST-EL(1).          00149300
014688*---                                                              00149400
014689     DIVIDE 99 INTO W-CODE-LINE-EL2 GIVING W-QUOZ-EL(2)           00149500
014690                                 REMAINDER W-REST-EL(2).          00149600
014691*---                                                              00149700
014692     DIVIDE 99 INTO W-CODE-LINE-EL3 GIVING W-QUOZ-EL(3)           00149800
014693                                 REMAINDER W-REST-EL(3).          00149900
014694*---                                                              00150000
014695     DIVIDE 99 INTO W-CODE-LINE-EL4 GIVING W-QUOZ-EL(4)           00150100
014696                                 REMAINDER W-REST-EL(4).          00150200
014697*---                                                              00150300
014698     MOVE ZERO                   TO W-SOMMA.                      00150400
014699     MOVE ZERO                   TO W-IND.                        00150500
014700 A2-195.                                                          00150600
014701*---   SI SOMMANO TUTTI I QUOZIENTI ED I RESTI OTTENUTI DALLE     00150700
014702*---   PRECEDENTI DIVISIONI                                       00150800
015072*---                                                              00150900
015073     ADD 1                       TO W-IND.                        00151000
015074     COMPUTE W-SOMMA = W-SOMMA + W-QUOZ-EL(W-IND) +               00151100
015075                                 W-REST-EL(W-IND).                00151200
015076*---                                                              00151300
015077     IF W-IND LESS 4                                              00151400
015078       GO TO A2-195.                                              00151500
015079 A2-200.                                                          00151600
015080*---   LA SOMMA DI CUI AL PUNTO PRECEDENTE E' DIVISA PER 99 E     00151700
015081*---   SI CONTROLLA CHE IL RESTO SIA PARI AL 15/16 CARATTERE    00151800
015082*---   DELLA MATRICOLA                                            00151900
015083*---                                                              00152000
015084     DIVIDE 99 INTO W-SOMMA GIVING W-UNITA                        00152100
015085                              REMAINDER W-RESTO.                  00152200
015086*---                                                              00152300
015087     IF W-MATR3-15-16 NOT EQUAL W-RESTO1                          00152400
015088       GO TO A2-260.                                              00152500
015089 A2-210.                                                          00152600
015090*---                                                              00152700
015091     MOVE ZERO                       TO W-SOMMA.                  00152800
015092     MOVE 35                         TO W-IND.                    00152900
015093     MOVE  1                         TO W-IND1.                   00153000
015094 A2-215.                                                          00153100
015095*---   SI CONSIDERA COD-LINE AD ESCLUSIONE DELL'ULTIMO BYTE;      00153200
015096*---   SI MOLTPLICA LA PRIMA CIFRA DI DESTRA PER 2, LA SECONDA    00153300
015097*---   PER 3 E COSI' VIA. SI SOMMANO QUSTI PRODOTTI.              00153400
015098*---   DIVIDE PER 11.                                             00153500
015099*---                                                              00153600
015100     ADD      1                        TO W-IND1.                 00153700
015101     SUBTRACT 1                      FROM W-IND.                  00153800
015102     COMPUTE   W-SOMMA   =   W-SOMMA                +             00153900
015103                 W-CODE-LINE-B-EL(W-IND) * W-IND1.                00154000
015104*---                                                              00154100
015105     IF W-IND GREATER 1                                           00154200
015106       GO TO A2-215.                                              00154300
015107 A2-220.                                                          00154400
015108*---       SI DIVIDE LA SOMMA OTTENUTA PER 11.                    00154500
015109*---                                                              00154600
015110     DIVIDE 11 INTO W-SOMMA GIVING W-UNITA                        00154700
015111                              REMAINDER W-RESTO2.                 00154800
015112*---     SE IL RESTO DELLA DIVISIONE E' 0 OR 1 IL 17 BYTE        00154900
015113*---     DELLA MATRICOLA DEV'ESSRE 0.                             00155000
015114*---                                                              00155100
015115     IF W-RESTO2 EQUAL 0     OR                                   00155200
015116        W-RESTO2 EQUAL 1                                          00155300
015117       GO TO A2-240.                                              00155400
015118                                                                  00155500
015119 A2-225.                                                          00155600
015120*---   IN CASO IL RESTO DELLA DIVISIONE DI CUI AL PUNTO           00155700
015121*---   PRECEDENTE NON SIA 0 OR 1 SI SOTTRAE IL RESTO DA           00155800
015122*---   11 E IL VALORE OTTENUTO DEV'ESSERE PARI AL 17             00155900
015123*---   CARATTERE DELLA MATRICOLA.                                 00156000
015124*---                                                              00156100
015125     COMPUTE W-RESTO3 = 11 - W-RESTO2.                            00156200
015126*---                                                              00156300
015127     IF W-RESTO3 EQUAL W-MATR3-17                                 00156400
015128       MOVE '3'                    TO W-FORMATO-MATR-OK           00156500
015129       GO TO A2-010-FORMATO-EX.                                   00156600
015130 A2-230.                                                          00156700
015131*---                                                              00156800
015132     MOVE 96                   TO W-ERR.                          00156900
015133     GO TO A2-010-FORMATO-EX.                                     00157000
015134 A2-240.                                                          00157100
015135*---                                                              00157200
015136     IF W-MATR3-17 EQUAL ZERO                                     00157300
015137       MOVE '3'                    TO W-FORMATO-MATR-OK           00157400
015138       GO TO A2-010-FORMATO-EX.                                   00157500
015139 A2-250.                                                          00157600
015140     MOVE 96                   TO W-ERR.                          00157700
015141     GO TO A2-010-FORMATO-EX.                                     00157800
015142 A2-260.                                                          00157900
015143*---                                                              00158000
015144     MOVE 96                   TO W-ERR.                          00158100
015145     GO TO A2-010-FORMATO-EX.                                     00158200
015146 A2-270.                                                          00158300
015147*---                                                              00158400
015148     MOVE 96                   TO W-ERR.                          00158500
015149     GO TO A2-010-FORMATO-EX.                                     00158600
015150 A2-280.                                                          00158700
015151*---                                                              00158800
015152     MOVE 96                   TO W-ERR.                          00158900
015153     GO TO A2-010-FORMATO-EX.                                     00159000
015154 A2-290.                                                          00159100
015155*---                                                              00159200
015156     MOVE 96                   TO W-ERR.                          00159300
015157     GO TO A2-010-FORMATO-EX.                                     00159400
015158 A2-300.                                                          00159500
015159*---   FORMATO MATRICOLA DI TIPO 4                                00159600
015160*---                                                              00159700
015161     MOVE BQVFB21-02-MATR-INPS        TO W-MATR4.                 00159800
015162     IF (W-MATR4-1-2-3 EQUAL '300' OR                             00159900
015163         W-MATR4-1-2-3 EQUAL '301')         AND                   00160000
015164         W-MATR4-4-8   NUMERIC              AND                   00160100
015165         W-MATR4-4-8   GREATER ZERO         AND                   00160200
015166         W-MATR4-9-10  NOT EQUAL SPACE      AND                   00160300
015167         W-MATR4-RESTO EQUAL SPACE                                00160400
015168        MOVE '4'                  TO W-FORMATO-MATR-OK            00160500
015169       GO TO A2-010-FORMATO-EX.                                   00160600
015170 A2-310.                                                          00160700
015783*---                                                              00160800
015784     MOVE 96                   TO W-ERR.                          00160900
015785     GO TO A2-010-FORMATO-EX.                                     00161000
015786 A2-320.                                                          00161100
015787*---   FORMATO MATRICOLA DI TIPO 2                                00161200
015788*---                                                              00161300
015789     MOVE BQVFB21-02-MATR-INPS        TO W-MATR2.                 00161400
015790     IF W-MATR2-1-5   NUMERIC           AND                       00161500
015791*--- NEW:                                                         00161600
015792        W-MATR2-1-5   > ZERO            AND                       00161700
015793        W-MATR2-1-5   NOT EQUAL '99999' AND                       00161800
015794*--- NEW: FINE.                                                   00161900
015795        W-MATR2-RESTO NOT EQUAL SPACE                             00162000
015796       MOVE '2'                  TO W-FORMATO-MATR-OK             00162100
015797       GO TO A2-010-FORMATO-EX.                                   00162200
015798 A2-330.                                                          00162300
015799*---                                                              00162400
015800     MOVE 96                   TO W-ERR.                          00162500
015801     GO TO A2-010-FORMATO-EX.                                     00162600
015802 A2-340.                                                          00162700
015803*---   FORMATO MATRICOLA DI TIPO 1                                00162800
015804*---                                                              00162900
015805     MOVE BQVFB21-02-MATR-INPS        TO W-MATR1.                 00163000
015806     IF W-MATR1-1-10 NOT NUMERIC      OR                          00163100
015807        W-MATR1-1-2  EQUAL ZERO       OR                          00163200
015808        W-MATR1-1-2  GREATER '95'                                 00163300
015809       GO TO A2-410.                                              00163400
015810 A2-350.                                                          00163500
015811*---                                                              00163600
015812     IF W-MATR1-3-8 NOT NUMERIC      OR                           00163700
015813        W-MATR1-3-8 EQUAL ZERO                                    00163800
015814       GO TO A2-400.                                              00163900
015815 A2-355.                                                          00164000
015816*---                                                              00164100
015817     MOVE BQVFB21-02-MATR-INPS        TO W-MATR1B.                00164200
015818     MOVE ZERO                        TO W-SOMMA-UN1.             00164300
015819     MOVE ZERO                        TO W-SOMMA-UN2.             00164400
015820     MOVE 1                           TO W-IND.                   00164500
015821     MOVE 2                           TO W-IND1.                  00164600
015822 A2-360.                                                          00164700
015823*---   CICLO PER SOMMARE IN CAMPI DI WORKING SEPARATI I GRUPPI    00164800
015824*---   DI CIFRE 1,3,5,7  E  2,4,6,8                               00164900
016473*---                                                              00165000
016474     COMPUTE W-SOMMA-UN1 = W-SOMMA-UN1 + W-MATR1B-EL(W-IND).      00165100
016475*---                                                              00165200
016476     COMPUTE W-SOMMA-UN2 = W-SOMMA-UN2 + W-MATR1B-EL(W-IND1).     00165300
016477     ADD 2                            TO W-IND.                   00165400
016478     ADD 2                            TO W-IND1.                  00165500
016479     IF W-IND LESS 8                                              00165600
016480       GO TO A2-360.                                              00165700
016481 A2-365.                                                          00165800
016482*---   SI CONTROLLA CHE L'UNITA' DELLA PRIMA SOMMA SIA PARI AL    00165900
016483*---   9 CARATTERE E CHE L'UNITA' DELLA SECONDA SOMMA UGUALE     00166000
016484*---   AL 10 CARATTERE DELLA MATRICOLA.                          00166100
016485*---                                                              00166200
016486     IF W-SOMMA-UN1 NOT EQUAL W-MATR1-9 OR                        00166300
016487        W-SOMMA-UN2 NOT EQUAL W-MATR1-10                          00166400
016488       GO TO A2-390.                                              00166500
016489 A2-370.                                                          00166600
016490*---                                                              00166700
016491     IF W-MATR1-RESTO EQUAL SPACE                                 00166800
016492       MOVE '1'                  TO W-FORMATO-MATR-OK             00166900
016493       GO TO A2-010-FORMATO-EX.                                   00167000
016494 A2-380.                                                          00167100
016495*---                                                              00167200
016496     MOVE 96                   TO W-ERR.                          00167300
016497     GO TO A2-010-FORMATO-EX.                                     00167400
016498 A2-390.                                                          00167500
016499*---                                                              00167600
016500     MOVE 96                   TO W-ERR.                          00167700
016501     GO TO A2-010-FORMATO-EX.                                     00167800
016502 A2-400.                                                          00167900
016503*---                                                              00168000
016504     MOVE 96                   TO W-ERR.                          00168100
016505     GO TO A2-010-FORMATO-EX.                                     00168200
016506 A2-410.                                                          00168300
016777*---                                                              00168400
016778     MOVE 96                   TO W-ERR.                          00168500
016779 A2-010-FORMATO-EX.                                               00168600
016780     EXIT.                                                        00168700
016781*---      ROUTINE DI CONTROLLO CORRETTEZZA RIFERIMENTO DAL        00168800
016872*---                                                              00168900
016873 B2-010-TIPO-RIF-DAL.                                             00169000
016874     MOVE BQVFB21-02-INIZIO-RIFA   TO W-RIF.                      00169100
016875     MOVE BQVFB21-02-DATA-RISC     TO W-DATA-RISC.                00169200
016876     MOVE W-ANNO-RIF               TO W-ANNO-RIF1.                00169300
016877     MOVE W-MESE-RIF               TO W-MESE-RIF1.                00169400
016878*---   SI CONTROLLA LA TIPOLOGIA DEL CONTROLLO DA EFFETTUARE      00169500
016879*---   SUL RIFERIMENTO DAL                                        00169600
016880*---                                                              00169700
016881*---                                                              00169800
016882*---   MODIFICA DEL 11/05/2001 PER INTRODUZIONE NUOVE TIPOLOGIE   00169900
016883*---   DI RIFERIMENTO DAL                                         00170000
016884*---                                                              00170100
016885*--- MODIFICA 06/07/2005 - NUOVO FORMALISMO INIZIO RIF 'N'        00170200
016886*--- MODIFICA 29/07/2008 - NUOVO FORMALISMO INIZIO RIF 'P'        00170300
016887*---                                                              00170400
016888     IF W-FORMATO-DAL EQUAL 'I' OR 'L'  OR  'N' OR 'P'            00170500
016889        PERFORM B3-010-NUOVI-PER THRU B3-EXIT                     00170600
016890        GO TO B2-010-TIPO-RIF-DAL-EX.                             00170700
016891*---                                                              00170800
016892*--- FINE MODIFICA                                                00170900
016893*---                                                              00171000
016894     IF W-FORMATO-DAL EQUAL '0'                                   00171100
016895       GO TO B2-400.                                              00171200
016896 B2-012.                                                          00171300
016897     IF W-FORMATO-DAL EQUAL 'F'                                   00171400
016898       GO TO B2-380.                                              00171500
016899 B2-014.                                                          00171600
016900     IF W-FORMATO-DAL EQUAL 'E'                                   00171700
016901       GO TO B2-350.                                              00171800
016902 B2-016.                                                          00171900
016903     IF W-FORMATO-DAL EQUAL 'A'                                   00172000
016904       GO TO B2-310.                                              00172100
016905 B2-020.                                                          00172200
017023*---                                                              00172300
017024     IF W-FORMATO-DAL EQUAL 'B'                                   00172400
017025       GO TO B2-260.                                              00172500
017026 B2-030.                                                          00172600
017027*---                                                              00172700
017028     IF W-FORMATO-DAL EQUAL 'C'                                   00172800
017029       GO TO B2-210.                                              00172900
017030 B2-040.                                                          00173000
017031*---                                                              00173100
017032     IF W-FORMATO-DAL EQUAL 'D'                                   00173200
017033       GO TO B2-160.                                              00173300
017034 B2-041.                                                          00173400
017035*---                                                              00173500
017036     IF W-FORMATO-DAL EQUAL 'G'                                   00173600
017037       GO TO B2-060.                                              00173700
017038*---                                                              00173800
017039*---                                                              00173900
017040*---   MODIFICA DEL 11/04/2002 PER NUOVO FORMALISMO MATRICOLA     00174000
017041*---                                                              00174100
017042 B2-041-M.                                                        00174200
017043*---                                                              00174300
017044     IF W-FORMATO-DAL EQUAL 'M'                                   00174400
017045       GO TO B2-047-M1.                                           00174500
017046*---                                                              00174600
017047*---   FINE MODIFICA                                              00174700
017048*---                                                              00174800
017049*--- MODIFICA DEL 09/11/2001 PER NUOVO FORMALISMO MATRICOLA       00174900
017050 B2-042.                                                          00175000
017474*---                                                              00175100
017475     IF W-FORMATO-DAL EQUAL 'J'                                   00175200
017476       GO TO B2-050.                                              00175300
017477*---                                                              00175400
017478*--- FINE MODIFICA                                                00175500
017479*---                                                              00175600
017480 B2-043.                                                          00175700
017481*---   CONTROLLO TIPOLOGIA 'H'                                    00175800
017482*---                                                              00175900
017483*---   MODIFICA DEL 14/08/2001 PER NUOVA GESTIONE CAUSALI ERRATE  00176000
017484*---                                                              00176100
017485*F   IF W-MESE-RIF NUMERIC          AND                           00176200
017486*F      W-MESE-RIF GREATER ZERO     AND                           00176300
017487*F      W-MESE-RIF LESS '13'        AND                           00176400
017488*F      W-ANNO-RIF NUMERIC          AND                           00176500
017489*F      W-ANNO-RIF GREATER ZERO                                   00176600
017490*F     GO TO B2-046.                                              00176700
017491     IF W-MESE-RIF NUMERIC          AND                           00176800
017492        W-MESE-RIF GREATER ZERO     AND                           00176900
017493        W-MESE-RIF LESS '13'        AND                           00177000
017494        W-ANNO-RIF NUMERIC          AND                           00177100
017495        W-ANNO-RIF GREATER ZERO     AND                           00177200
017496        W-FORMATO-MATR-OK NOT EQUAL 'S'                           00177300
017497       GO TO B2-046.                                              00177400
017498*---                                                              00177500
017499*---   FINE MODIFICA                                              00177600
017500*---                                                              00177700
017501 B2-044.                                                          00177800
017727*---                                                              00177900
017728     MOVE 55                 TO W-ERR.                            00178000
017729     GO TO B2-010-TIPO-RIF-DAL-EX.                                00178100
017730 B2-046.                                                          00178200
017731*---                                                              00178300
017732     MOVE 'H'               TO W-FORMATO-DAL-OK.                  00178400
017733     GO TO B2-010-TIPO-RIF-DAL-EX.                                00178500
017734*---                                                              00178600
017735*---   MODIFICA DEL 11/04/2002 PER NUOVO FORMALISMO MATRICOLA     00178700
017736*---                                                              00178800
017737 B2-047-M1.                                                       00178900
017738*---   CONTROLLO TIPOLOGIA 'M'                                    00179000
017739*---                                                              00179100
017740     IF W-MESE-RIF NUMERIC                     AND                00179200
017741        W-MESE-RIF GREATER ZERO                AND                00179300
017742        W-MESE-RIF LESS '13'                   AND                00179400
017743        W-ANNO-RIF NUMERIC                     AND                00179500
017744        W-ANNO-RIF GREATER ZERO                AND                00179600
017745        W-RIF1 NOT LESS '197304'               AND                00179700
017746        W-RIF1 NOT GREATER W-DATA-RISC-AAAAMM                     00179800
017747       GO TO B2-047-M3.                                           00179900
017748 B2-047-M2.                                                       00180000
017749*---                                                              00180100
017750     MOVE 55                 TO W-ERR.                            00180200
017751     GO TO B2-010-TIPO-RIF-DAL-EX.                                00180300
017752 B2-047-M3.                                                       00180400
017753*---                                                              00180500
017754     MOVE 'M'                TO W-FORMATO-DAL-OK.                 00180600
017755     GO TO B2-010-TIPO-RIF-DAL-EX.                                00180700
017756*---                                                              00180800
017757*---   FINE MODIFICA                                              00180900
017758*---                                                              00181000
017759*---                                                              00181100
017760*--- MODIFICA DEL 09/11/2001 PER NUOVO FORMALISMO MATRICOLA       00181200
017761*---                                                              00181300
017762 B2-050.                                                          00181400
017763*--- CONTROLLO TIPOLOGIA 'J'                                      00181500
017764*---                                                              00181600
017765     IF (W-MESE-RIF NUMERIC          AND                          00181700
017766         W-MESE-RIF GREATER ZERO     AND                          00181800
017767         W-MESE-RIF LESS '13'        AND                          00181900
017768         W-ANNO-RIF NUMERIC          AND                          00182000
017769         W-ANNO-RIF GREATER ZERO) OR                              00182100
017770         (W-MESE-RIF = ZERO          AND                          00182200
017771          W-ANNO-RIF = ZERO   )                                   00182300
017772       GO TO B2-055.                                              00182400
017773 B2-052.                                                          00182500
017774*---                                                              00182600
017775     MOVE 55                 TO W-ERR.                            00182700
017776     GO TO B2-010-TIPO-RIF-DAL-EX.                                00182800
017777 B2-055.                                                          00182900
017778*---                                                              00183000
017779     MOVE 'J'               TO W-FORMATO-DAL-OK.                  00183100
017780     GO TO B2-010-TIPO-RIF-DAL-EX.                                00183200
017781*---                                                              00183300
017782*--- FINE MODIFICA                                                00183400
017783*---                                                              00183500
017784 B2-060.                                                          00183600
017785*---   CONTROLLO TIPOLOGIA 'G'                                    00183700
017786*---                                                              00183800
017787     IF W-MESE-RIF NUMERIC          AND                           00183900
017788        W-MESE-RIF GREATER ZERO     AND                           00184000
017789        W-MESE-RIF LESS '13'        AND                           00184100
017790        W-ANNO-RIF NUMERIC          AND                           00184200
017791        W-ANNO-RIF GREATER ZERO     AND                           00184300
017792        W-RIF1 NOT LESS '199601'    AND                           00184400
017793        W-RIF1 NOT GREATER W-DATA-RISC-AAAAMM                     00184500
017794       GO TO B2-100.                                              00184600
017795 B2-070.                                                          00184700
017796*---                                                              00184800
017797     MOVE 55                 TO W-ERR.                            00184900
017798     IF W-RIF1 GREATER W-DATA-RISC-AAAAMM                         00185000
017799       MOVE 96               TO W-ERR.                            00185100
017800     GO TO B2-010-TIPO-RIF-DAL-EX.                                00185200
017801 B2-100.                                                          00185300
017802*---                                                              00185400
017803     MOVE 'G'               TO W-FORMATO-DAL-OK.                  00185500
018515     GO TO B2-010-TIPO-RIF-DAL-EX.                                00185600
018516 B2-160.                                                          00185700
018517*---   CONTROLLO TIPOLOGIA 'D'                                    00185800
018518     IF W-MESE-RIF NUMERIC          AND                           00185900
018519        W-MESE-RIF GREATER ZERO     AND                           00186000
018520        W-MESE-RIF LESS '05'        AND                           00186100
018521        W-ANNO-RIF NUMERIC          AND                           00186200
018522        W-ANNO-RIF GREATER 1997                                   00186300
018523       GO TO B2-200.                                              00186400
018524 B2-170.                                                          00186500
018525*---                                                              00186600
018526     MOVE 96                 TO W-ERR.                            00186700
018527     GO TO B2-010-TIPO-RIF-DAL-EX.                                00186800
018528 B2-200.                                                          00186900
018529*---                                                              00187000
018530     MOVE 'D'                TO W-FORMATO-DAL-OK.                 00187100
018531     GO TO B2-010-TIPO-RIF-DAL-EX.                                00187200
018532 B2-210.                                                          00187300
018533*---   CONTROLLO TIPOLOGIA 'C'                                    00187400
018534*---                                                              00187500
018535     IF W-MESE-RIF NUMERIC                     AND                00187600
018536        W-MESE-RIF GREATER ZERO                AND                00187700
018537        W-MESE-RIF LESS '13'                   AND                00187800
018538        W-ANNO-RIF NUMERIC                     AND                00187900
018539        W-ANNO-RIF GREATER ZERO                AND                00188000
018540        W-RIF1 NOT GREATER W-DATA-RISC-AAAAMM                     00188100
018541       GO TO B2-250.                                              00188200
018542 B2-220.                                                          00188300
018543*---                                                              00188400
018544     MOVE 55                 TO W-ERR.                            00188500
018545     IF W-RIF1 GREATER W-DATA-RISC-AAAAMM                         00188600
018546       MOVE 96                 TO W-ERR.                          00188700
018547     GO TO B2-010-TIPO-RIF-DAL-EX.                                00188800
018548 B2-250.                                                          00188900
018549*---                                                              00189000
018550     MOVE 'C'                TO W-FORMATO-DAL-OK.                 00189100
018551     GO TO B2-010-TIPO-RIF-DAL-EX.                                00189200
018552 B2-260.                                                          00189300
018553*---   CONTROLLO TIPOLOGIA 'B'                                    00189400
018950*---                                                              00189500
018951     IF W-MESE-RIF NUMERIC                     AND                00189600
018952        W-MESE-RIF GREATER ZERO                AND                00189700
018953        W-MESE-RIF LESS '13'                   AND                00189800
018954        W-ANNO-RIF NUMERIC                     AND                00189900
018955        W-ANNO-RIF GREATER ZERO                AND                00190000
018956        W-RIF1 NOT LESS '199701'               AND                00190100
018957        W-RIF1 NOT GREATER W-DATA-RISC-AAAAMM                     00190200
018958       GO TO B2-300.                                              00190300
018959 B2-270.                                                          00190400
018960*---                                                              00190500
018961     MOVE 55                 TO W-ERR.                            00190600
018962     IF W-RIF1 LESS '199701'               OR                     00190700
018963        W-RIF1 GREATER W-DATA-RISC-AAAAMM                         00190800
018964       MOVE 96                 TO W-ERR.                          00190900
018965     GO TO B2-010-TIPO-RIF-DAL-EX.                                00191000
018966 B2-300.                                                          00191100
018967*---                                                              00191200
018968     MOVE 'B'                TO W-FORMATO-DAL-OK.                 00191300
018969     GO TO B2-010-TIPO-RIF-DAL-EX.                                00191400
018970 B2-310.                                                          00191500
018971*---   CONTROLLO TIPOLOGIA 'A'                                    00191600
018972*---                                                              00191700
018973     IF W-MESE-RIF NUMERIC                     AND                00191800
018974        W-MESE-RIF GREATER ZERO                AND                00191900
018975        W-MESE-RIF LESS '13'                   AND                00192000
018976        W-ANNO-RIF NUMERIC                     AND                00192100
018977        W-ANNO-RIF GREATER ZERO                AND                00192200
018978        W-RIF1 NOT LESS '199801'               AND                00192300
018979        W-RIF1 NOT GREATER W-DATA-RISC-AAAAMM                     00192400
018980       GO TO B2-340.                                              00192500
018981 B2-320.                                                          00192600
018982*---                                                              00192700
018983     MOVE 55                 TO W-ERR.                            00192800
018984     IF W-RIF1 LESS '199801'               OR                     00192900
018985        W-RIF1 GREATER W-DATA-RISC-AAAAMM                         00193000
018986       MOVE 96                 TO W-ERR.                          00193100
018987     GO TO B2-010-TIPO-RIF-DAL-EX.                                00193200
018988 B2-340.                                                          00193300
018989*---                                                              00193400
018990     MOVE 'A'                TO W-FORMATO-DAL-OK.                 00193500
018991     GO TO B2-010-TIPO-RIF-DAL-EX.                                00193600
018992 B2-350.                                                          00193700
018993*---   CONTROLLO TIPOLOGIA 'E'                                    00193800
018994*---                                                              00193900
018995     IF W-MESE-RIF NUMERIC                     AND                00194000
018996        W-MESE-RIF GREATER ZERO                AND                00194100
018997        W-MESE-RIF LESS '13'                   AND                00194200
018998        W-ANNO-RIF NUMERIC                     AND                00194300
018999        W-ANNO-RIF GREATER ZERO                AND                00194400
019000        W-RIF1 NOT LESS '199710'               AND                00194500
019001        W-RIF1 NOT GREATER W-DATA-RISC-AAAAMM                     00194600
019002       GO TO B2-370.                                              00194700
019003 B2-360.                                                          00194800
019004*---                                                              00194900
019005     MOVE 55                 TO W-ERR.                            00195000
019006     IF W-RIF1 LESS '199710'               OR                     00195100
019007        W-RIF1 GREATER W-DATA-RISC-AAAAMM                         00195200
019008       MOVE 96                 TO W-ERR.                          00195300
019009     GO TO B2-010-TIPO-RIF-DAL-EX.                                00195400
019010 B2-370.                                                          00195500
019011*---                                                              00195600
019012     MOVE 'E'                TO W-FORMATO-DAL-OK.                 00195700
019013     GO TO B2-010-TIPO-RIF-DAL-EX.                                00195800
019014 B2-380.                                                          00195900
019015*---   CONTROLLO TIPOLOGIA 'F'                                    00196000
019016*---                                                              00196100
019017     IF W-MESE-RIF NUMERIC                       AND              00196200
019018        W-MESE-RIF GREATER ZERO                  AND              00196300
019019        W-MESE-RIF LESS '13'                     AND              00196400
019020        W-ANNO-RIF NUMERIC                       AND              00196500
019021        W-ANNO-RIF GREATER ZERO                  AND              00196600
019022        W-RIF1     NOT LESS '198901'             AND              00196700
019023        W-RIF1     NOT GREATER W-DATA-RISC-AAAAMM                 00196800
019024        MOVE 'F'                TO W-FORMATO-DAL-OK               00196900
019025        GO TO B2-010-TIPO-RIF-DAL-EX.                             00197000
019026 B2-390.                                                          00197100
019027*---                                                              00197200
019028     MOVE 55                 TO W-ERR.                            00197300
019029     IF W-RIF1 LESS '198901'               OR                     00197400
019030        W-RIF1 GREATER W-DATA-RISC-AAAAMM                         00197500
019031       MOVE 96                 TO W-ERR.                          00197600
019032     GO TO B2-010-TIPO-RIF-DAL-EX.                                00197700
019033 B2-400.                                                          00197800
019034*---   CONTROLLO TIPOLOGIA '0'                                    00197900
019035*---                                                              00198000
019036     IF W-RIF      NUMERIC                       AND              00198100
019037        W-RIF      EQUAL   ZERO                                   00198200
019038        MOVE '0'                TO W-FORMATO-DAL-OK               00198300
019039        GO TO B2-010-TIPO-RIF-DAL-EX.                             00198400
019040 B2-410.                                                          00198500
019041*---                                                              00198600
019042     MOVE 55                 TO W-ERR.                            00198700
019043 B2-010-TIPO-RIF-DAL-EX.                                          00198800
019044     EXIT.                                                        00198900
019045*---        ROUTINE DI CONTROLLO CORRETTEZZA RIFERIMENTO AL       00199000
019046*---                                                              00199100
019047 C2-010-TIPO-RIF-AL.                                              00199200
019048     MOVE BQVFB21-02-INIZIO-RIFA   TO W-RIF.                      00199300
019049     MOVE W-ANNO-RIF               TO W-ANNO-RIF1.                00199400
019050     MOVE W-MESE-RIF               TO W-MESE-RIF1.                00199500
019051     MOVE BQVFB21-02-FINE-RIFA     TO W-RIF.                      00199600
019052     MOVE W-ANNO-RIF               TO W-ANNO-RIF2.                00199700
019053     MOVE W-MESE-RIF               TO W-MESE-RIF2.                00199800
019054*---   SI CONTROLLA SE RIFERIMENTO AL E' NULLO                    00199900
019055*---                                                              00200000
019056**** IF BQVFB21-02-FINE-RIFA NUMERIC     AND                      00200100
019057******* BQVFB21-02-FINE-RIFA EQUAL ZERO                           00200200
019058****** GO TO C2-580.                                              00200300
019059*---                                                              00200400
019060*--- MODIFICA DEL 09/11/2001 PER NUOVO FORMALISMO MATRICOLA '9'   00200500
019061*---                                                              00200600
019062     IF BQVFB21-02-FINE-RIFA NUMERIC     AND                      00200700
019063        BQVFB21-02-FINE-RIFA EQUAL ZERO  AND                      00200800
019064        W-TIPO-FINE-RIF NOT EQUAL 'E'                             00200900
019065           GO TO C2-580.                                          00201000
019066 C2-014.                                                          00201100
019067*---   SI CONTROLLA LA TIPOLOGIA DEL CONTROLLO DA EFFETTUARE      00201200
019068*---   SUL RIFERIMENTO AL                                         00201300
019069     IF W-FORMATO-AL EQUAL 'E'                                    00201400
019070       GO TO C2-160.                                              00201500
019071*---                                                              00201600
019072*--- FINE MODIFICA                                                00201700
019073*---                                                              00201800
019074 C2-015.                                                          00201900
019075*---   SI CONTROLLA LA TIPOLOGIA DEL CONTROLLO DA EFFETTUARE      00202000
019076*---   SUL RIFERIMENTO AL                                         00202100
019077*---                                                              00202200
019078     IF W-FORMATO-AL EQUAL 'D'                                    00202300
019079       GO TO C2-130.                                              00202400
019080 C2-020.                                                          00202500
019081*---   SI CONTROLLA LA TIPOLOGIA DEL CONTROLLO DA EFFETTUARE      00202600
019082*---   SUL RIFERIMENTO AL                                         00202700
019083*---                                                              00202800
019084     IF W-FORMATO-AL EQUAL 'A'                                    00202900
019085       GO TO C2-100.                                              00203000
019086 C2-030.                                                          00203100
019087*---                                                              00203200
019088     IF W-FORMATO-AL EQUAL 'B'                                    00203300
019089       GO TO C2-070.                                              00203400
019090 C2-040.                                                          00203500
019091*---   CONTROLLO TIPOLOGIA 'C'                                    00203600
019092*---                                                              00203700
019093     IF W-MESE-RIF2 NUMERIC          AND                          00203800
019094        W-MESE-RIF2 GREATER ZERO     AND                          00203900
019095        W-MESE-RIF2 LESS '13'        AND                          00204000
019096        W-ANNO-RIF2 NUMERIC          AND                          00204100
019097        W-ANNO-RIF2 GREATER ZERO     AND                          00204200
019098        W-RIF2 NOT GREATER '199712'  AND                          00204300
019099*---   IL CONTROLLO CON IL RIFERIMENTO DAL VIENE FATTO SOLO SE    00204400
019100*---   ESSO ERA CORRETTO (W-FORMATO-DAL-OK <> SPACE)              00204500
019101       (W-FORMATO-DAL-OK EQUAL SPACE OR                           00204600
019102        (W-FORMATO-DAL-OK NOT EQUAL SPACE AND                     00204700
019103         W-RIF2 NOT LESS W-RIF1))                                 00204800
019104       GO TO C2-060.                                              00204900
019105 C2-050.                                                          00205000
019106*---                                                              00205100
019107     MOVE 55                 TO W-ERR.                            00205200
019108     IF W-RIF2 GREATER '199712'                                   00205300
019109       MOVE 96                 TO W-ERR.                          00205400
019110     GO TO C2-010-TIPO-RIF-AL-EX.                                 00205500
019111 C2-060.                                                          00205600
019112*---                                                              00205700
019113     MOVE 'C'                TO W-FORMATO-AL-OK.                  00205800
019114     GO TO C2-010-TIPO-RIF-AL-EX.                                 00205900
019115 C2-070.                                                          00206000
019116*---   CONTROLLO TIPOLOGIA 'B'                                    00206100
019117*---                                                              00206200
019118     IF W-MESE-RIF2 NUMERIC          AND                          00206300
019119        W-MESE-RIF2 GREATER ZERO     AND                          00206400
019120        W-MESE-RIF2 LESS '13'        AND                          00206500
019121        W-ANNO-RIF2 NUMERIC          AND                          00206600
019122        W-ANNO-RIF2 GREATER ZERO     AND                          00206700
019123*---   IL CONTROLLO CON IL RIFERIMENTO DAL VIENE FATTO SOLO SE    00206800
019124*---   ESSO ERA CORRETTO (W-FORMATO-DAL-OK <> SPACE)              00206900
019125*---                                                              00207000
019126       (W-FORMATO-DAL-OK EQUAL SPACE OR                           00207100
019127        (W-FORMATO-DAL-OK NOT EQUAL SPACE AND                     00207200
019128         W-RIF2 NOT LESS W-RIF1))                                 00207300
019129       GO TO C2-090.                                              00207400
019130 C2-080.                                                          00207500
019131*---                                                              00207600
019132     MOVE 96                 TO W-ERR.                            00207700
019133     GO TO C2-010-TIPO-RIF-AL-EX.                                 00207800
019134 C2-090.                                                          00207900
020692*---                                                              00208000
020693     MOVE 'B'                TO W-FORMATO-AL-OK.                  00208100
020694     GO TO C2-010-TIPO-RIF-AL-EX.                                 00208200
020695 C2-100.                                                          00208300
020696*---   CONTROLLO TIPOLOGIA 'A'                                    00208400
020697*---                                                              00208500
020698     IF W-MESE-RIF2 NUMERIC          AND                          00208600
020699        W-MESE-RIF2 GREATER ZERO     AND                          00208700
020700        W-MESE-RIF2 LESS '13'        AND                          00208800
020701        W-ANNO-RIF2 NUMERIC          AND                          00208900
020702        W-ANNO-RIF2 GREATER ZERO     AND                          00209000
020703*---   IL CONTROLLO CON IL RIFERIMENTO DAL VIENE FATTO SOLO SE    00209100
020704*---   ESSO ERA CORRETTO (W-FORMATO-DAL-OK <> SPACE)              00209200
020705       (W-FORMATO-DAL-OK EQUAL SPACE OR                           00209300
020706        (W-FORMATO-DAL-OK NOT EQUAL SPACE AND                     00209400
020707         W-ANNO-RIF2 EQUAL W-ANNO-RIF1    AND                     00209500
020708         W-MESE-RIF2 NOT LESS W-MESE-RIF1))                       00209600
020709       GO TO C2-120.                                              00209700
020710 C2-110.                                                          00209800
020711*---                                                              00209900
020712     MOVE 96                 TO W-ERR.                            00210000
020713     GO TO C2-010-TIPO-RIF-AL-EX.                                 00210100
020714 C2-120.                                                          00210200
020715*---                                                              00210300
020716     MOVE 'A'                TO W-FORMATO-AL-OK.                  00210400
020717     GO TO C2-010-TIPO-RIF-AL-EX.                                 00210500
020718 C2-130.                                                          00210600
020719*---   CONTROLLO TIPOLOGIA 'D'                                    00210700
020720*---                                                              00210800
020721     IF W-MESE-RIF2 NUMERIC          AND                          00210900
020722        W-MESE-RIF2 GREATER ZERO     AND                          00211000
020723        W-MESE-RIF2 LESS '13'        AND                          00211100
020724        W-ANNO-RIF2 NUMERIC          AND                          00211200
020725        W-ANNO-RIF2 GREATER ZERO     AND                          00211300
020726        W-RIF2 NOT GREATER '199812'  AND                          00211400
020727*---   IL CONTROLLO CON IL RIFERIMENTO DAL VIENE FATTO SOLO SE    00211500
020728*---   ESSO ERA CORRETTO (W-FORMATO-DAL-OK <> SPACE)              00211600
020729       (W-FORMATO-DAL-OK EQUAL SPACE OR                           00211700
020730        (W-FORMATO-DAL-OK NOT EQUAL SPACE AND                     00211800
020731         W-RIF2 NOT LESS W-RIF1))                                 00211900
020732       GO TO C2-150.                                              00212000
020733 C2-140.                                                          00212100
021220*---                                                              00212200
021221     MOVE 55                 TO W-ERR.                            00212300
021222     IF W-RIF2 GREATER '199812' OR                                00212400
021223        W-RIF2 LESS W-RIF1                                        00212500
021224       MOVE 96                 TO W-ERR.                          00212600
021225     GO TO C2-010-TIPO-RIF-AL-EX.                                 00212700
021226 C2-150.                                                          00212800
021227*---                                                              00212900
021228     MOVE 'D'                TO W-FORMATO-AL-OK.                  00213000
021229     GO TO C2-010-TIPO-RIF-AL-EX.                                 00213100
021230*---                                                              00213200
021231*--- MODIFICA DEL 09/11/2001 PER NUOVO FORMALISMO MATRICOLA '9'   00213300
021232*---                                                              00213400
021233 C2-160.                                                          00213500
021234*--- CONTROLLO TIPOLOGIA 'E'                                      00213600
021235*---                                                              00213700
021236     IF (W-MESE-RIF2 NUMERIC          AND                         00213800
021237         W-MESE-RIF2 GREATER ZERO     AND                         00213900
021238         W-MESE-RIF2 LESS '13'        AND                         00214000
021239         W-ANNO-RIF2 NUMERIC          AND                         00214100
021240         W-ANNO-RIF2 GREATER ZERO) OR                             00214200
021241         (W-MESE-RIF2 EQUAL ZERO     AND                          00214300
021242          W-ANNO-RIF2 EQUAL ZERO)                                 00214400
021243      GO TO C2-180.                                               00214500
021244 C2-170.                                                          00214600
021407*---                                                              00214700
021408     MOVE 55                 TO W-ERR.                            00214800
021409     GO TO C2-010-TIPO-RIF-AL-EX.                                 00214900
021410 C2-180.                                                          00215000
021411*---                                                              00215100
021412     MOVE 'E'                TO W-FORMATO-AL-OK.                  00215200
021413     GO TO C2-010-TIPO-RIF-AL-EX.                                 00215300
021414*---                                                              00215400
021415*--- FINE MODIFICA                                                00215500
021416*---                                                              00215600
021417 C2-580.                                                          00215700
021418*---                                                              00215800
021419     MOVE 96                 TO W-ERR.                            00215900
021420 C2-010-TIPO-RIF-AL-EX.                                           00216000
021421     EXIT.                                                        00216100
021422*---      ROUTINE DI CONTROLLO PAGAMENTI                          00216200
021423 D2-010-PAG.                                                      00216300
021424*---   SI CONTROLLA IL FLAG W-PAG-RIMB CHE DISTINGUE IL           00216400
021425*---   TRATTAMENTO DA FARE SUI PAGAMENTI                          00216500
021426*---                                                              00216600
021427     IF W-PAG-RIMB EQUAL '1'                                      00216700
021428       GO TO D2-060.                                              00216800
021429 D2-020.                                                          00216900
021430*---   SI CONTROLLA CHE PAGAMENTI SIA NUMERICO                    00217000
021431*---                                                              00217100
021432     IF BQVFB21-02-IMP-PAGAMA NUMERIC                             00217200
021433       GO TO D2-040.                                              00217300
021434 D2-030.                                                          00217400
021435*---   ERRORE BLOCCANTE                                           00217500
021436*---                                                              00217600
021437     ADD 1                    TO W-CTR2.                          00217700
021438     MOVE 33                  TO BQVFB21-02-ERR-IMP-PAGAM.        00217800
021439     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-PAGAM-A.      00217900
021440     GO TO D2-160.                                                00218000
021441 D2-040.                                                          00218100
021442*---   SI CONTROLLA CHE PAGAMENTI SIA MAGGIORE DI ZERO            00218200
021443*---                                                              00218300
021444     IF BQVFB21-02-IMP-PAGAM GREATER ZERO                         00218400
021445       GO TO D2-160.                                              00218500
021446*D2-050.                                                          00218600
021447*---   PER PAGAMENTI UGUALI A ZERO SI SEGNALA L'ERRORE            00218700
021448*--- PER CAUSALE DIVERSA DA 'DPP', 'AP' E 'CP'                    00218800
021449*    MOVE BQVFB21-02-CAUSALE TO W-CAUS-CONTR.                     00218900
021450*    IF W-CAUS-CONTR-OK                                           00219000
021451*      GO TO D2-160.                                              00219100
021452 D2-052.                                                          00219200
021453*---   ERRORE NON BLOCCANTE                                       00219300
021454*---                                                              00219400
021455     ADD 1                    TO W-CTR1.                          00219500
021456     MOVE 39                  TO BQVFB21-02-ERR-IMP-PAGAM.        00219600
021457     MOVE 'W'                 TO BQVFB21-02-ERR-IMP-PAGAM-A.      00219700
021458     GO TO D2-160.                                                00219800
021459 D2-060.                                                          00219900
021460*---   SI CONTROLLA CHE PAGAMENTI SIA NUMERICO                    00220000
021461*---                                                              00220100
021462     IF BQVFB21-02-IMP-PAGAMA NUMERIC                             00220200
021463       GO TO D2-080.                                              00220300
021464 D2-070.                                                          00220400
021465*---   ERRORE BLOCCANTE                                           00220500
021466*---                                                              00220600
021467     ADD 1                    TO W-CTR2.                          00220700
021468     MOVE 33                  TO BQVFB21-02-ERR-IMP-PAGAM.        00220800
021469     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-PAGAM-A.      00220900
021470     GO TO D2-160.                                                00221000
021471 D2-080.                                                          00221100
021472*---   SI CONTROLLA IL CAMPO SEGNO CONTRIBUTO                     00221200
021473*---                                                              00221300
021474*     IF BQVFB21-02-SEGNO-CONTR NOT EQUAL 'N' AND                 00221400
021475*        BQVFB21-02-SEGNO-CONTR NOT EQUAL 'P'                     00221500
021476*--- NEW:                                                         00221600
021477      IF BQVFB21-02-IMP-RIMBA NOT NUMERIC                         00221700
021478       GO TO D2-160.                                              00221800
021479*--- NEW: FINE.                                                   00221900
021480 D2-090.                                                          00222000
022021*---                                                              00222100
022022*    IF BQVFB21-02-SEGNO-CONTR EQUAL 'P'                          00222200
022023*      GO TO D2-120.                                              00222300
022024*--- NEW:                                                         00222400
022025      IF BQVFB21-02-IMP-RIMBA GREATER ZERO    OR                  00222500
022026        (BQVFB21-02-IMP-RIMBA EQUAL   ZERO  AND                   00222600
022027         BQVFB21-02-IMP-PAGAMA GREATER ZERO)                      00222700
022028       GO TO D2-160.                                              00222800
022029*--- NEW: FINE.                                                   00222900
022030*D2-100.                                                          00223000
022031*---                                                              00223100
022032*    IF BQVFB21-02-IMP-PAGAMA EQUAL ZERO                          00223200
022033*      GO TO D2-160.                                              00223300
022034*D2-110.                                                          00223400
022035*---   ERRORE BLOCCANTE                                           00223500
022036*---                                                              00223600
022037*    ADD 1                   TO W-CTR1.                           00223700
022038*    MOVE 15                 TO BQVFB21-02-ERR-IMP-PAGAM.         00223800
022039*    MOVE 'W'                TO BQVFB21-02-ERR-IMP-PAGAM-A.       00223900
022040*    GO TO D2-160.                                                00224000
022041*D2-120.                                                          00224100
022042*---                                                              00224200
022043*    IF BQVFB21-02-IMP-PAGAMA GREATER ZERO                        00224300
022044*      GO TO D2-140.                                              00224400
022045 D2-130.                                                          00224500
022046*---   ERRORE NON BLOCCANTE                                       00224600
022047*---                                                              00224700
022048     ADD 1                   TO W-CTR1.                           00224800
022049     MOVE 24                 TO BQVFB21-02-ERR-IMP-PAGAM.         00224900
022050     MOVE 'W'                TO BQVFB21-02-ERR-IMP-PAGAM-A.       00225000
022051     GO TO D2-160.                                                00225100
022052*D2-140.                                                          00225200
022053*---   SI CONTROLLA CHE PAGAMENTI SIA <= CONTRIBUTI               00225300
022054*---                                                              00225400
022055*    IF BQVFB21-02-IMP-CONTRA IS NOT NUMERIC OR                   00225500
022056*      (BQVFB21-02-IMP-PAGAM NOT GREATER                          00225600
022057*       BQVFB21-02-IMP-CONTR)                                     00225700
022058*      GO TO D2-160.                                              00225800
022059*D2-150.                                                          00225900
022060*---   ERRORE BLOCCANTE                                           00226000
022511*---                                                              00226100
022512*    ADD 1                   TO W-CTR1.                           00226200
022513*    MOVE 24                 TO BQVFB21-02-ERR-IMP-PAGAM.         00226300
022514*    MOVE 'W'                TO BQVFB21-02-ERR-IMP-PAGAM-A.       00226400
022515 D2-160.                                                          00226500
022516     IF BQVFB21-02-IMP-PAGAMA NUMERIC                             00226600
022517        ADD BQVFB21-02-IMP-PAGAM TO W-TAB-EL-PAG(2).              00226700
022518*---   SI VERIFICA SE SI E' VERIFICATO UN ERRORE RELATIVAMENTE    00226800
022519*---   AL CAMPO PAGAMENTI                                         00226900
022520*---                                                              00227000
022521     IF BQVFB21-02-ERR-IMP-PAGAM NOT EQUAL ZERO                   00227100
022522       GO TO D2-010-PAG-EX.                                       00227200
022523 D2-170.                                                          00227300
022524*---   SI CONTROLLA LA DIVISA                                     00227400
022525*---                                                              00227500
022526*    IF W-DIVISA EQUAL SPACE    OR                                00227600
022527*      W-DIVISA EQUAL 'EUR'                                       00227700
022528*--- NEW:                                                         00227800
022529     IF W-DIVISA EQUAL SPACE                                      00227900
022530       GO TO D2-010-PAG-EX.                                       00228000
022531 D2-180.                                                          00228100
022532*---   SI CONTROLLA CHE LE ULTIME TRE CIFRE DI PAGAMENTI  SIANO   00228200
022533*---   IMPOSTATE A ZERO SE DIVISA = ITL; LE ULTIME DUE CIFRE      00228300
022534*---   SE EUR                                                     00228400
022535     MOVE BQVFB21-02-IMP-PAGAM     TO W-CIFRE.                    00228500
022536*INIZIO MODIFICA EURO                                             00228600
022537*CB 4/12/2001                                                     00228700
022538     IF W-DATA-RISC <= '20011231'                                 00228800
022539          IF (W-DIVISA EQUAL 'ITL'     AND                        00228900
022540              W-CIFRE-TRE EQUAL ZERO)   OR                        00229000
022541             (W-DIVISA EQUAL 'EUR'     AND                        00229100
022542             (BQVFB21-DATA-BONIF > '20011231' OR                  00229200
022543              W-CIFRE-DUE EQUAL ZERO))                            00229300
022544              GO TO D2-010-PAG-EX                                 00229400
022545          ELSE                                                    00229500
022546              GO TO D2-190                                        00229600
022547          END-IF                                                  00229700
022548     END-IF.                                                      00229800
022549              GO TO D2-010-PAG-EX.                                00229900
022550*CB 4/12/2001                                                     00230000
022551*FINE   MODIFICA EURO                                             00230100
022552 D2-190.                                                          00230200
022553*---   ERRORE BLOCCANTE                                           00230300
022554*---                                                              00230400
022555     ADD 1                    TO W-CTR1.                          00230500
022556     MOVE 96                  TO BQVFB21-02-ERR-IMP-PAGAM.        00230600
022557     MOVE 'W'                 TO BQVFB21-02-ERR-IMP-PAGAM-A.      00230700
022558 D2-010-PAG-EX.                                                   00230800
022559     EXIT.                                                        00230900
022560*---     ROUTINE DI CONTROLLO RIMBORSI                            00231000
022561*---                                                              00231100
022562 E2-010-RIMB.                                                     00231200
022563*---   SI CONTROLLA IL FLAG W-PAG-RIMB CHE DISTINGUE IL           00231300
022564*---   TRATTAMENTO DA FARE SUI RIMBORSI                           00231400
022565*---                                                              00231500
022566     IF W-PAG-RIMB EQUAL '1'                                      00231600
022567       GO TO E2-120.                                              00231700
022568 E2-030.                                                          00231800
022569*---   SI CONTROLLA CHE RIMBORSI SIA NUMERICO                     00231900
022570*---                                                              00232000
022571     IF BQVFB21-02-IMP-RIMBA NUMERIC                              00232100
022572       GO TO E2-050.                                              00232200
022573 E2-040.                                                          00232300
022574*---   ERRORE BLOCCANTE                                           00232400
022575*---                                                              00232500
022576     ADD 1                    TO W-CTR2.                          00232600
022577     MOVE 33                  TO BQVFB21-02-ERR-IMP-RIMB.         00232700
022578     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-RIMB-A.       00232800
022579     GO TO E2-210.                                                00232900
022580 E2-050.                                                          00233000
022581*---   SI CONTROLLA CHE RIMBORSI  SIA UGUALE A ZERO               00233100
022582*---                                                              00233200
022583     IF BQVFB21-02-IMP-RIMBA EQUAL ZERO                           00233300
022584       GO TO E2-210.                                              00233400
022585 E2-060.                                                          00233500
022586*---   ERRORE NON BLOCCANTE                                       00233600
022587*---                                                              00233700
022588     ADD 1                   TO W-CTR2.                           00233800
022589     MOVE 24                 TO BQVFB21-02-ERR-IMP-RIMB.          00233900
022590     MOVE 'E'                TO BQVFB21-02-ERR-IMP-RIMB-A.        00234000
022591     GO TO E2-210.                                                00234100
022592 E2-120.                                                          00234200
022593*---   SI CONTROLLA CHE RIMBORSI  SIA NUMERICO                    00234300
022594*---                                                              00234400
022595     IF BQVFB21-02-IMP-RIMBA NUMERIC                              00234500
022596       GO TO E2-140.                                              00234600
022597 E2-130.                                                          00234700
022598*---   ERRORE BLOCCANTE                                           00234800
023004*---                                                              00234900
023005     ADD 1                    TO W-CTR2.                          00235000
023006     MOVE 33                  TO BQVFB21-02-ERR-IMP-RIMB.         00235100
023007     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-RIMB-A.       00235200
023008     GO TO E2-210.                                                00235300
023009*E2-135.                                                          00235400
023010*---   SI CONTROLLA IL CAMPO SEGNO CONTRIBUTO                     00235500
023011*---                                                              00235600
023012*    IF BQVFB21-02-SEGNO-CONTR NOT EQUAL 'N' AND                  00235700
023013*       BQVFB21-02-SEGNO-CONTR NOT EQUAL 'P'                      00235800
023014*      GO TO E2-210.                                              00235900
023015 E2-140.                                                          00236000
023016*---                                                              00236100
023017*    IF BQVFB21-02-SEGNO-CONTR EQUAL 'P'                          00236200
023018*     GO TO E2-190.                                               00236300
023019*--- NEW:                                                         00236400
023020       MOVE BQVFB21-02-INIZIO-RIFA TO W-RIF.                      00236500
023021*GM    IF BQVFB21-02-ERR-INIZIO-RIF EQUAL ZERO      AND           00236600
023022*GM       (BQVFB21-02-CAUSALE   EQUAL 'DPP '    OR                00236700
023023*GM        BQVFB21-02-CAUSALE   EQUAL 'AP  '    OR                00236800
023024*GM        BQVFB21-02-CAUSALE   EQUAL 'CP  ')       AND           00236900
023025*---                                                              00237000
023026*--- MODIFICA DEL 14/08/2001 PER NUOVE CAUSALI                    00237100
023027*---                                                              00237200
023028       IF BQVFB21-02-ERR-INIZIO-RIF EQUAL ZERO                    00237300
023029       AND (     (BQVFB21-02-CAUSALE   EQUAL 'DPP '               00237400
023030                  AND BQVFB21-02-DATA-RISC < '20010117')          00237500
023031              OR                                                  00237600
023032                 (BQVFB21-02-CAUSALE   EQUAL 'P10 '               00237700
023033                  AND BQVFB21-02-DATA-RISC > '20001231')          00237800
023034              OR                                                  00237900
023035                 (BQVFB21-02-CAUSALE   EQUAL 'AP  '               00238000
023036                  AND BQVFB21-02-DATA-RISC < '20010920')          00238100
023037              OR                                                  00238200
023038                 (BQVFB21-02-CAUSALE   EQUAL 'CP  '               00238300
023039                  AND BQVFB21-02-DATA-RISC < '20010920')          00238400
023040              OR                                                  00238500
023041                 (BQVFB21-02-CAUSALE   EQUAL 'PXX '               00238600
023042                  AND BQVFB21-02-DATA-RISC > '20001231') )        00238700
023043*GM           OR                                                  00238800
023044*GM              BQVFB21-02-CAUSALE   EQUAL 'AP  '                00238900
023045*GM           OR                                                  00239000
023046*GM              BQVFB21-02-CAUSALE   EQUAL 'CP  '      )         00239100
023047       AND W-ANNO-RIF LESS '1998'                                 00239200
023048       GO TO E2-170.                                              00239300
023049 E2-150.                                                          00239400
023050*---                                                              00239500
023051      IF  BQVFB21-02-IMP-PAGAMA  NOT NUMERIC         OR           00239600
023052          BQVFB21-02-IMP-PAGAMA  GREATER ZERO        OR           00239700
023053          (BQVFB21-02-IMP-PAGAMA EQUAL   ZERO   AND               00239800
023054           BQVFB21-02-IMP-RIMBA  GREATER ZERO)                    00239900
023055           GO TO E2-210.                                          00240000
023056 E2-160.                                                          00240100
023057*---   ERRORE NON BLOCCANTE                                       00240200
023058*---                                                              00240300
023059     ADD 1                    TO W-CTR2.                          00240400
023060     MOVE 33                  TO BQVFB21-02-ERR-IMP-RIMB.         00240500
023061     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-RIMB-A.       00240600
023062     GO TO E2-210.                                                00240700
023063*--- NEW: FINE.                                                   00240800
023064 E2-170.                                                          00240900
023065*---   SI CONTROLLA CHE RIMBORSI  SIA ZERO                        00241000
023066*---                                                              00241100
023067     IF BQVFB21-02-IMP-RIMBA EQUAL ZERO                           00241200
023068       GO TO E2-210.                                              00241300
023069*E2-180.                                                          00241400
023070*---   ERRORE BLOCCANTE                                           00241500
023071*---                                                              00241600
023072*    ADD 1                   TO W-CTR1.                           00241700
023073*    MOVE 24                 TO BQVFB21-02-ERR-IMP-RIMB.          00241800
023074*    MOVE 'W'                TO BQVFB21-02-ERR-IMP-RIMB-A.        00241900
023075*    GO TO E2-210.                                                00242000
023076*E2-190.                                                          00242100
023077*---   SI CONTROLLA CHE RIMBORSI  SIA UGUALE A ZERO               00242200
023078*---                                                              00242300
023079*    IF BQVFB21-02-IMP-RIMBA EQUAL ZERO                           00242400
023080*      GO TO E2-210.                                              00242500
023081 E2-200.                                                          00242600
023082*---   ERRORE BLOCCANTE                                           00242700
023083*---                                                              00242800
023084     ADD 1                   TO W-CTR2.                           00242900
023085     MOVE 24                 TO BQVFB21-02-ERR-IMP-RIMB.          00243000
023086     MOVE 'E'                TO BQVFB21-02-ERR-IMP-RIMB-A.        00243100
023087 E2-210.                                                          00243200
023088     IF BQVFB21-02-IMP-RIMBA NUMERIC                              00243300
023089        ADD BQVFB21-02-IMP-RIMB TO W-TAB-EL-RIM(2).               00243400
023090*---   SI VERIFICA SE SI E' VERIFICATO UN ERRORE RELATIVAMENTE    00243500
023091*---   AL CAMPO RIMBORSI E SE RIMBORSI E' IMPOSTATO               00243600
023092*---                                                              00243700
023093     IF BQVFB21-02-ERR-IMP-RIMB NOT EQUAL ZERO OR                 00243800
023094        BQVFB21-02-IMP-RIMBA        EQUAL ZERO                    00243900
023095       GO TO E2-010-RIMB-EX.                                      00244000
023096 E2-220.                                                          00244100
023097*---   SI CONTROLLA LA DIVISA                                     00244200
023098*---                                                              00244300
023099     IF W-DIVISA EQUAL SPACE                                      00244400
023100       GO TO E2-010-RIMB-EX.                                      00244500
023101 E2-270.                                                          00244600
023102*---   SI CONTROLLA CHE LE ULTIME TRE CIFRE DI RIMBORSI   SIANO   00244700
023103*---   IMPOSTATE A ZERO (DIVISA = ITL); SE 'EUR' LE ULTIME DUE    00244800
023104     MOVE BQVFB21-02-IMP-RIMB      TO W-CIFRE.                    00244900
023105*INIZIO MODIFICA EURO                                             00245000
023106*CB 4/12/2001                                                     00245100
023107     IF W-DATA-RISC <= '20011231'                                 00245200
023108          IF (W-DIVISA EQUAL 'ITL'     AND                        00245300
023109              W-CIFRE-TRE EQUAL ZERO)   OR                        00245400
023110             (W-DIVISA EQUAL 'EUR'     AND                        00245500
023111             (BQVFB21-DATA-BONIF > '20011231' OR                  00245600
023112              W-CIFRE-DUE EQUAL ZERO))                            00245700
023113              GO TO E2-010-RIMB-EX                                00245800
023114          ELSE                                                    00245900
023115              GO TO E2-280                                        00246000
023116          END-IF                                                  00246100
023117     END-IF.                                                      00246200
023118              GO TO E2-010-RIMB-EX.                               00246300
023119*CB 4/12/2001                                                     00246400
023120*FINE   MODIFICA EURO                                             00246500
023121 E2-280.                                                          00246600
023122*---   ERRORE NON BLOCCANTE                                       00246700
023123*---                                                              00246800
023124     ADD 1                    TO W-CTR2.                          00246900
023125     MOVE 96                  TO BQVFB21-02-ERR-IMP-RIMB.         00247000
023126     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-RIMB-A.       00247100
023127 E2-010-RIMB-EX.                                                  00247200
023128     EXIT.                                                        00247300
023129*---   ROUTINE DI ACCESSO ALLA TABELLA PER CONTROLLARE            00247400
023130*---   CHE LA CAUSALE SIA ESISTENTE                               00247500
023131 F2-010-CAUS.                                                     00247600
023132     IF BQVFB21-02-CAUSALE EQUAL SPACE     OR                     00247700
023133        BQVFB21-02-CAUSALE EQUAL LOW-VALUE                        00247800
023134       GO TO F2-090.                                              00247900
023135 F2-015.                                                          00248000
023136*---   IMPOSTAZIONE VARIABILI HOST                                00248100
023137     MOVE BQVFB21-02-CAUSALE       TO W-MATR-INP.                 00248200
023138*---   SI CONTROLLA SE LA DATA RISCOSSIONE E' CORRETTA            00248300
023139     IF BQVFB21-02-ERR-DATA-RISC EQUAL ZERO                       00248400
023140       GO TO F2-030.                                              00248500
023141 F2-020.                                                          00248600
023142*---   IMPOSTAZIONE CON DATA BONIFICO                             00248700
023143     MOVE BQVFB21-DATA-BONIF       TO W-DATA-INP.                 00248800
023144     GO TO F2-040.                                                00248900
023145 F2-030.                                                          00249000
023146*---   IMPOSTAZIONE CON DATA RISCOSSIONE                          00249100
023147     MOVE BQVFB21-02-DATA-RISC     TO W-DATA-INP.                 00249200
023148 F2-040.                                                          00249300
023149**MODIFICA 13/03/2006                                             00249400
023150** UTILIZZO FLAG-COMPEN                                           00249500
023151*    MODIFICHE DEL 9/4/1999                                       00249600
023152     MOVE 'Z' TO W-TIPO-INIZ-RIF                                  00249700
023153     SET W-PUNT-MATR TO 1.                                        00249800
023154     SEARCH W-TAB-MATR-EL                                         00249900
023155        AT END MOVE ZERO TO W-FLAG-TROVATO                        00250000
023156     WHEN W-TAB-MATR-COD(W-PUNT-MATR) = W-MATR-INP AND            00250100
023157          W-TAB-MATR-INI-VAL(W-PUNT-MATR) NOT > W-DATA-INP        00250200
023158      AND W-TAB-MATR-FIN-VAL(W-PUNT-MATR) NOT < W-DATA-INP        00250300
023159          MOVE W-TAB-MATR-FORM(W-PUNT-MATR) TO W-FORM-MATR        00250400
023160          MOVE W-TAB-MATR-TIPO-INI(W-PUNT-MATR)                   00250500
023161                                         TO W-TIPO-INIZ-RIF       00250600
023162          MOVE W-TAB-MATR-TIPO-FIN(W-PUNT-MATR)                   00250700
023163                                         TO W-TIPO-FINE-RIF       00250800
023164          MOVE W-TAB-MATR-FL-COMP(W-PUNT-MATR)                    00250900
023165                                         TO W-FLAG-COMPEN         00251000
023166          MOVE 1 TO W-FLAG-TROVATO.                               00251100
023167     IF W-FLAG-TROVATO = 1                                        00251200
023168       GO TO F2-080.                                              00251300
023169 F2-050.                                                          00251400
023170*---   CAUSALE INESISTENTE                                        00251500
023171     MOVE 'NO'                 TO W-CAUSALE-OK.                   00251600
023172     GO TO F2-010-CAUS-EX.                                        00251700
023173 F2-080.                                                          00251800
023174*---   CAUSALE   ESISTENTE                                        00251900
023175     MOVE 'SI'                 TO W-CAUSALE-OK.                   00252000
023176     GO TO F2-010-CAUS-EX.                                        00252100
023177 F2-090.                                                          00252200
023178*---   CAUSALE NON VALIDA PERCHE' IMPOSTATA A SPAZIO              00252300
023179     MOVE 'NO'                 TO W-CAUSALE-OK.                   00252400
023180 F2-010-CAUS-EX.                                                  00252500
023181     EXIT.                                                        00252600
023182*---   LA ROUTINE SPOSTA I DATI DEL RECORD ESITO CONCESSIONARIO   00252700
023183*---   IN QUELLO RELATIVO AD ESITO BANCA                          00252800
023184*RX-010-BANCA.                                                    00252900
023185*    MOVE BQVFD21-02-FLAG-ERR-SEDE                TO              00253000
023186*                              BQVFB21-02-FLAG-ERR-SEDE.          00253100
023187*    MOVE BQVFD21-02-COD-SEDEA                    TO              00253200
023188*                              BQVFB21-02-COD-SEDEA.              00253300
023189*    MOVE BQVFD21-02-FLAG-ERR-CAUSALE             TO              00253400
023190*                              BQVFB21-02-FLAG-ERR-CAUSALE.       00253500
023191*    MOVE BQVFD21-02-CAUSALE                      TO              00253600
023192*                              BQVFB21-02-CAUSALE.                00253700
023193*    MOVE BQVFD21-02-FLAG-ERR-MATR                TO              00253800
023194*                              BQVFB21-02-FLAG-ERR-MATR.          00253900
023195*    MOVE BQVFD21-02-FLAG-ERR-INIZIO              TO              00254000
023196*                              BQVFB21-02-FLAG-ERR-INIZIO.        00254100
023197*    MOVE BQVFD21-02-INIZIO-RIFA                  TO              00254200
023198*                              BQVFB21-02-INIZIO-RIFA.            00254300
023199*    MOVE BQVFD21-02-FLAG-ERR-FINE                TO              00254400
023200*                              BQVFB21-02-FLAG-ERR-FINE.          00254500
023201*    MOVE BQVFD21-02-FINE-RIFA                    TO              00254600
023202*                              BQVFB21-02-FINE-RIFA.              00254700
023203*    MOVE BQVFD21-02-SEGNO-CONTR                  TO              00254800
023204*                              BQVFB21-02-SEGNO-CONTR.            00254900
023205*    MOVE BQVFD21-02-IMP-CONTRA                   TO              00255000
023206*                              BQVFB21-02-IMP-CONTRA.             00255100
023207*    MOVE BQVFD21-02-MATR-INPS                    TO              00255200
023208*                              BQVFB21-02-MATR-INPS.              00255300
023209*    MOVE BQVFD21-02-IMP-PAGAMA                   TO              00255400
023210*                              BQVFB21-02-IMP-PAGAMA.             00255500
023211*    MOVE BQVFD21-02-DATA-RISC                    TO              00255600
023212*                              BQVFB21-02-DATA-RISC.              00255700
023213*    MOVE BQVFD21-02-IMP-RIMBA                    TO              00255800
023214*                              BQVFB21-02-IMP-RIMBA.              00255900
023215*    MOVE BQVFD21-02-ERR-DATA-RISC                TO              00256000
023216*                              BQVFB21-02-ERR-DATA-RISC.          00256100
023217*RX-010-BANCA-EX.                                                 00256200
023218*    EXIT.                                                        00256300
023219*---   LA ROUTINE SPOSTA I DATI DEL RECORD ESITO BANCA IN QUELLO  00256400
023220*---   RELATIVO AD ESITO CONCESSIONARIO                           00256500
023221*RY-010-CONC.                                                     00256600
023222*    MOVE BQVFB21-02-ERR-FLAG-ERR-SEDE            TO              00256700
023223*                              BQVFD21-02-ERR-FLAG-ERR-SEDE.      00256800
023224*    MOVE BQVFB21-02-ERR-FLAG-ERR-SEDE-A          TO              00256900
023225*                              BQVFD21-02-ERR-FLAG-ERR-SEDE-A.    00257000
023226*    MOVE BQVFB21-02-ERR-COD-SEDE                 TO              00257100
023227*                              BQVFD21-02-ERR-COD-SEDE.           00257200
023228*    MOVE BQVFB21-02-ERR-COD-SEDE-A               TO              00257300
023229*                              BQVFD21-02-ERR-COD-SEDE-A.         00257400
023230*    MOVE BQVFB21-02-FLAG-ERR-SEDE                TO              00257500
023231*                              BQVFD21-02-FLAG-ERR-SEDE.          00257600
023232*    MOVE BQVFB21-02-COD-SEDEA                    TO              00257700
023233*                              BQVFD21-02-COD-SEDEA.              00257800
023234*    MOVE BQVFB21-02-FLAG-ERR-CAUSALE             TO              00257900
023235*                              BQVFD21-02-FLAG-ERR-CAUSALE.       00258000
023236*    MOVE BQVFB21-02-ERR-FLAG-ERR-CAU             TO              00258100
023237*                              BQVFD21-02-ERR-FLAG-ERR-CAU.       00258200
023238*    MOVE BQVFB21-02-ERR-FLAG-ERR-CAU-A           TO              00258300
023239*                              BQVFD21-02-ERR-FLAG-ERR-CAU-A.     00258400
023240*    MOVE BQVFB21-02-CAUSALE                      TO              00258500
023241*                              BQVFD21-02-CAUSALE.                00258600
023242*    MOVE BQVFB21-02-ERR-CAUSALE                  TO              00258700
023243*                              BQVFD21-02-ERR-CAUSALE.            00258800
023244*    MOVE BQVFB21-02-ERR-CAUSALE-A                TO              00258900
023245*                              BQVFD21-02-ERR-CAUSALE-A.          00259000
023246*    MOVE BQVFB21-02-FLAG-ERR-MATR                TO              00259100
023247*                              BQVFD21-02-FLAG-ERR-MATR.          00259200
023248*    MOVE BQVFB21-02-ERR-FLAG-ERR-MATR            TO              00259300
023249*                              BQVFD21-02-ERR-FLAG-ERR-MATR.      00259400
023250*    MOVE BQVFB21-02-ERR-FLAG-ERR-MATR-A          TO              00259500
023251*                              BQVFD21-02-ERR-FLAG-ERR-MATR-A.    00259600
023252*    MOVE BQVFB21-02-MATR-INPS                    TO              00259700
023253*                              BQVFD21-02-MATR-INPS.              00259800
023254*    MOVE BQVFB21-02-ERR-MATR-INPS                TO              00259900
023255*                              BQVFD21-02-ERR-MATR-INPS.          00260000
023256*    MOVE BQVFB21-02-ERR-MATR-INPS-A              TO              00260100
023257*                              BQVFD21-02-ERR-MATR-INPS-A.        00260200
023258*    MOVE BQVFB21-02-FLAG-ERR-INIZIO              TO              00260300
023259*                              BQVFD21-02-FLAG-ERR-INIZIO.        00260400
023260*    MOVE BQVFB21-02-ERR-FLAG-ERR-INIZIO          TO              00260500
023261*                              BQVFD21-02-ERR-FLAG-ERR-INIZIO.    00260600
023262*    MOVE BQVFB21-02-ERR-FLAG-ERR-I-A             TO              00260700
023263*                              BQVFD21-02-ERR-FLAG-ERR-I-A.       00260800
023264*    MOVE BQVFB21-02-INIZIO-RIFA                  TO              00260900
023265*                              BQVFD21-02-INIZIO-RIFA.            00261000
023266*    MOVE BQVFB21-02-ERR-INIZIO-RIF               TO              00261100
023267*                              BQVFD21-02-ERR-INIZIO-RIF.         00261200
023268*    MOVE BQVFB21-02-ERR-INIZIO-RIF-A             TO              00261300
023269*                              BQVFD21-02-ERR-INIZIO-RIF-A.       00261400
023270*    MOVE BQVFB21-02-FLAG-ERR-FINE                TO              00261500
023271*                              BQVFD21-02-FLAG-ERR-FINE.          00261600
023272*    MOVE BQVFB21-02-ERR-FLAG-ERR-FINE            TO              00261700
023273*                              BQVFD21-02-ERR-FLAG-ERR-FINE.      00261800
023274*    MOVE BQVFB21-02-ERR-FLAG-ERR-F-A             TO              00261900
023275*                              BQVFD21-02-ERR-FLAG-ERR-F-A.       00262000
023276*    MOVE BQVFB21-02-FINE-RIFA                    TO              00262100
023277*                              BQVFD21-02-FINE-RIFA.              00262200
023278*    MOVE BQVFB21-02-ERR-FINE-RIF                 TO              00262300
023279*                              BQVFD21-02-ERR-FINE-RIF.           00262400
023280*    MOVE BQVFB21-02-ERR-FINE-RIF-A               TO              00262500
023281*                              BQVFD21-02-ERR-FINE-RIF-A.         00262600
023282*    MOVE BQVFB21-02-SEGNO-CONTR                  TO              00262700
023283*                              BQVFD21-02-SEGNO-CONTR.            00262800
023284*    MOVE BQVFB21-02-ERR-SEGNO-CONTR              TO              00262900
023285*                              BQVFD21-02-ERR-SEGNO-CONTR.        00263000
023286*    MOVE BQVFB21-02-ERR-SEGNO-CONTR-A            TO              00263100
023287*                              BQVFD21-02-ERR-SEGNO-CONTR-A.      00263200
023288*    MOVE BQVFB21-02-IMP-CONTRA                   TO              00263300
023289*                              BQVFD21-02-IMP-CONTRA.             00263400
023290*    MOVE BQVFB21-02-ERR-IMP-CONTR                TO              00263500
023291*                              BQVFD21-02-ERR-IMP-CONTR.          00263600
023292*    MOVE BQVFB21-02-ERR-IMP-CONTR-A              TO              00263700
023293*                              BQVFD21-02-ERR-IMP-CONTR-A.        00263800
023294*    MOVE BQVFB21-02-IMP-PAGAMA                   TO              00263900
023295*                              BQVFD21-02-IMP-PAGAMA.             00264000
023296*    MOVE BQVFB21-02-DATA-RISC                    TO              00264100
023297*                              BQVFD21-02-DATA-RISC.              00264200
023298*    MOVE BQVFB21-02-ERR-DATA-RISC                TO              00264300
023299*                              BQVFD21-02-ERR-DATA-RISC.          00264400
023300*    MOVE BQVFB21-02-ERR-IMP-PAGAM                TO              00264500
023301*                              BQVFD21-02-ERR-IMP-PAGAM.          00264600
023302*    MOVE BQVFB21-02-ERR-IMP-PAGAM-A              TO              00264700
023303*                              BQVFD21-02-ERR-IMP-PAGAM-A.        00264800
023304*    MOVE BQVFB21-02-IMP-RIMBA                    TO              00264900
023305*                              BQVFD21-02-IMP-RIMBA.              00265000
023306*    MOVE BQVFB21-02-ERR-IMP-RIMB                 TO              00265100
023307*                              BQVFD21-02-ERR-IMP-RIMB.           00265200
023308*    MOVE BQVFB21-02-ERR-IMP-RIMB-A               TO              00265300
023309*                              BQVFD21-02-ERR-IMP-RIMB-A.         00265400
023310*RY-010-CONC-EX.                                                  00265500
023311*    EXIT.                                                        00265600
023312*---   SI INIZIALIZZANO I CAMPI RELATIVI AGLI ERRORI              00265700
023313 RZ-010-INIZIA.                                                   00265800
023314     MOVE ZERO          TO BQVFB21-02-ERR-CAUSALE-A.              00265900
023315     MOVE ZERO          TO BQVFB21-02-ERR-CAUSALE.                00266000
023316     MOVE ZERO          TO BQVFB21-02-ERR-COD-SEDE-A.             00266100
023317     MOVE ZERO          TO BQVFB21-02-ERR-COD-SEDE.               00266200
023318     MOVE ZERO          TO BQVFB21-02-ERR-FINE-RIF-A.             00266300
023319     MOVE ZERO          TO BQVFB21-02-ERR-FINE-RIF.               00266400
023320     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-CAU-A.         00266500
023321     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-CAU.           00266600
023322     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-F-A.           00266700
023323     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-FINE.          00266800
023324     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-I-A.           00266900
023325     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-INIZIO.        00267000
023326     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-MATR-A.        00267100
023327     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-MATR.          00267200
023328     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-SEDE-A.        00267300
023329     MOVE ZERO          TO BQVFB21-02-ERR-FLAG-ERR-SEDE.          00267400
023330*    MOVE ZERO          TO BQVFB21-02-ERR-IMP-CONTR-A.            00267500
023331*    MOVE ZERO          TO BQVFB21-02-ERR-IMP-CONTR.              00267600
023332     MOVE ZERO          TO BQVFB21-02-ERR-IMP-PAGAM-A.            00267700
023333     MOVE ZERO          TO BQVFB21-02-ERR-IMP-PAGAM.              00267800
023334     MOVE ZERO          TO BQVFB21-02-ERR-IMP-RIMB-A.             00267900
023335     MOVE ZERO          TO BQVFB21-02-ERR-IMP-RIMB.               00268000
023336     MOVE ZERO          TO BQVFB21-02-ERR-INIZIO-RIF-A.           00268100
023337     MOVE ZERO          TO BQVFB21-02-ERR-INIZIO-RIF.             00268200
023338     MOVE ZERO          TO BQVFB21-02-ERR-MATR-INPS-A.            00268300
023339     MOVE ZERO          TO BQVFB21-02-ERR-MATR-INPS.              00268400
023340*    MOVE ZERO          TO BQVFB21-02-ERR-SEGNO-CONTR-A.          00268500
023341*    MOVE ZERO          TO BQVFB21-02-ERR-SEGNO-CONTR.            00268600
023342*    MOVE ZERO          TO BQVFD21-02-ERR-CAUSALE-A.              00268700
023343*    MOVE ZERO          TO BQVFD21-02-ERR-CAUSALE.                00268800
023344*    MOVE ZERO          TO BQVFD21-02-ERR-COD-SEDE-A.             00268900
023345*    MOVE ZERO          TO BQVFD21-02-ERR-COD-SEDE.               00269000
023346*    MOVE ZERO          TO BQVFD21-02-ERR-FINE-RIF-A.             00269100
023347*    MOVE ZERO          TO BQVFD21-02-ERR-FINE-RIF.               00269200
023348*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-CAU-A.         00269300
023349*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-CAU.           00269400
023350*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-F-A.           00269500
023351*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-FINE.          00269600
023352*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-I-A.           00269700
023353*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-INIZIO.        00269800
023354*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-MATR-A.        00269900
023355*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-MATR.          00270000
023356*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-SEDE-A.        00270100
023357*    MOVE ZERO          TO BQVFD21-02-ERR-FLAG-ERR-SEDE.          00270200
023358*    MOVE ZERO          TO BQVFD21-02-ERR-IMP-CONTR-A.            00270300
023359*    MOVE ZERO          TO BQVFD21-02-ERR-IMP-CONTR.              00270400
023360*    MOVE ZERO          TO BQVFD21-02-ERR-IMP-PAGAM-A.            00270500
023361*    MOVE ZERO          TO BQVFD21-02-ERR-IMP-PAGAM.              00270600
023362*    MOVE ZERO          TO BQVFD21-02-ERR-IMP-RIMB-A.             00270700
023363*    MOVE ZERO          TO BQVFD21-02-ERR-IMP-RIMB.               00270800
023364*    MOVE ZERO          TO BQVFD21-02-ERR-INIZIO-RIF-A.           00270900
023365*    MOVE ZERO          TO BQVFD21-02-ERR-INIZIO-RIF.             00271000
023366*    MOVE ZERO          TO BQVFD21-02-ERR-MATR-INPS-A.            00271100
023367*    MOVE ZERO          TO BQVFD21-02-ERR-MATR-INPS.              00271200
023368*    MOVE ZERO          TO BQVFD21-02-ERR-SEGNO-CONTR-A.          00271300
023369*    MOVE ZERO          TO BQVFD21-02-ERR-SEGNO-CONTR.            00271400
023370 RZ-010-INIZIA-EX.                                                00271500
023371     EXIT.                                                        00271600
023372*---                                                              00271700
023373*--- MODIFICA DEL 11/05/2001: INTRODUZIONE FORMALISMO CONTRIBUTI  00271800
023374*--- CASALINGHE: MATRICOLA INPF = SPACE O CODICE FISCALE          00271900
023375*---                                                              00272000
023376 A3-010-CASALINGHE.                                               00272100
023377*---                                                              00272200
023378     IF W-FORMATO-MATR EQUAL '8' AND                              00272300
023379        BQVFB21-02-MATR-INPS EQUAL SPACE                          00272400
023380        MOVE '8'                 TO W-FORMATO-MATR-OK             00272500
023381        GO TO A3-EXIT.                                            00272600
023382 A3-020.                                                          00272700
023383*---                                                              00272800
023384     IF BQVFB21-02-MATR-INPS(17:1) NOT EQUAL SPACE                00272900
023385        MOVE 96                  TO W-ERR                         00273000
023386        GO TO A3-EXIT.                                            00273100
023387 A3-030.                                                          00273200
023388*---                                                              00273300
023389*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE FISCALE               00273400
023390     MOVE ZERO TO W-APPO-CF-11.                                   00273500
023391     MOVE ZERO TO W-FLAG-NO-BQVFB3.                               00273600
023392     MOVE 0 TO W-BQVFB3-COD-RIT.                                  00273700
023393     MOVE BQVFB21-02-MATR-INPS TO W-APPO-CF.                      00273800
023394     IF W-APPO-CF-DX NOT = SPACE     AND                          00273900
023395        W-APPO-CF-DX NOT = LOW-VALUE AND                          00274000
023396        W-APPO-CF-DX NOT = HIGH-VALUE                             00274100
023397        GO TO A3-497.                                             00274200
023398     SKIP1                                                        00274300
023399 A3-470.                                                          00274400
023400*--- CF DI 11 CARATTERI ALLINEATI A SINISTRA: ERRATO              00274500
023401     MOVE 96                     TO W-ERR                         00274600
023402     GO TO A3-EXIT.                                               00274700
023403 A3-497.                                                          00274800
023404*---                                                              00274900
023405*--- CODICE FISCALE DI 16 CARATTERI                               00275000
023406*--- MODIFICATO PERCHE' CONTROLLI ANCHE LA CONGRUENZA FRA         00275100
023407*--- MESE E GIORNO                                                00275200
023408*---                                                              00275300
023409     MOVE W-APPO-CF TO W-CF.                                      00275400
023410     IF W-COD-FISC-CATAST-OK        AND                           00275500
023411        W-APPO-CF-DENOM ALPHABETIC  AND                           00275600
023412                W-APPO-CF-DENOM-L1  NOT EQUAL SPACE AND           00275700
023413                W-APPO-CF-DENOM-L2  NOT EQUAL SPACE AND           00275800
023414                W-APPO-CF-DENOM-L3  NOT EQUAL SPACE AND           00275900
023415                W-APPO-CF-DENOM-L4  NOT EQUAL SPACE AND           00276000
023416                W-APPO-CF-DENOM-L5  NOT EQUAL SPACE AND           00276100
023417                W-APPO-CF-DENOM-L6  NOT EQUAL SPACE AND           00276200
023418        W-APPO-CF-ANNO      NUMERIC AND                           00276300
023419        W-APPO-CF-MESE-OK           AND                           00276400
023420        W-APPO-CF-GIORNO    NUMERIC AND                           00276500
023421        ((((W-APPO-CF-GIORNO   > ZERO AND                         00276600
023422            W-APPO-CF-GIORNO   < 32      ) OR                     00276700
023423           (W-APPO-CF-GIORNO   > 40   AND                         00276800
023424            W-APPO-CF-GIORNO   < 72      )) AND                   00276900
023425            W-CF-MESE-31-OK)                      OR              00277000
023426         (((W-APPO-CF-GIORNO   > ZERO AND                         00277100
023427            W-APPO-CF-GIORNO   < 31      ) OR                     00277200
023428           (W-APPO-CF-GIORNO   > 40   AND                         00277300
023429            W-APPO-CF-GIORNO   < 71      )) AND                   00277400
023430            W-CF-MESE-30-OK)                      OR              00277500
023431         (((W-APPO-CF-GIORNO   > ZERO AND                         00277600
023432            W-APPO-CF-GIORNO   < 30      ) OR                     00277700
023433           (W-APPO-CF-GIORNO   > 40   AND                         00277800
023434            W-APPO-CF-GIORNO   < 70      )) AND                   00277900
023435            W-CF-MESE-28-OK))                                     00278000
023436        MOVE W-APPO-CF TO W-BQVFB3-COD-FISC                       00278100
023437        MOVE 'PF '     TO W-PF-PNF                                00278200
023438        PERFORM R1-010-CATAST THRU R1-010-CATAST-EX               00278300
023439        GO TO A3-499.                                             00278400
023440     SKIP1                                                        00278500
023441 A3-498.                                                          00278600
023442*--- ERRORE DI CORRETTEZZA DEL CODICE FISCALE PER:                00278700
023443*--- BYTE DA 1 A 6 NON TUTTI ALFABETICI O                         00278800
023444*--- BYTE 7 E 8 NON NUMERICI O                                    00278900
023445*--- BYTE 9 NON COMPRESO TRA I VALORI A,B,C,D,E,H,L,M,P,R,S,T O   00279000
023446*--- BYTE 10 E 11 NON NUMERICI O NON COMPRESI TRA I VALORI AMMESSI00279100
023447*--- BYTE 12, CORRISPONDENTE AL CODICE CATASTALE, FUORI SEQUENZA  00279200
023448     MOVE 1 TO W-BQVFB3-COD-RIT.                                  00279300
023449 A3-499.                                                          00279400
023450*---                                                              00279500
023451     IF W-BQVFB3-COD-RIT NOT = ZERO OR                            00279600
023452        W-FLAG-NO-BQVFB3 NOT = ZERO                               00279700
023453        GO TO A3-502.                                             00279800
023454     SKIP1                                                        00279900
023455 A3-500.                                                          00280000
023456     CALL 'BQVFB3' USING W-PARAM-BQVFB3.                          00280100
023457     SKIP1                                                        00280200
023458 A3-502.                                                          00280300
023459     IF W-BQVFB3-COD-RIT = ZERO                                   00280400
023460        MOVE '8'                 TO W-FORMATO-MATR-OK             00280500
023461        GO TO A3-EXIT.                                            00280600
023462 A3-560.                                                          00280700
023463     MOVE 96                   TO W-ERR.                          00280800
023464 A3-EXIT.                                                         00280900
023465     EXIT.                                                        00281000
023466*---                                                              00281100
023467*--- MODIFICA DEL 09/11/2001: INTRODUZIONE FORMALISMO CONTRIBUTI  00281200
023468*--- FORMATO MATRICOLA 9                                          00281300
023469*---                                                              00281400
023470 A4-010-VISITE.                                                   00281500
023471*---                                                              00281600
023472*--- FORMATO MATRICOLA DI TIPO 9                                  00281700
023473*---                                                              00281800
023474     MOVE BQVFB21-02-MATR-INPS TO W-MATR9.                        00281900
023475     IF W-MATR9-1-15 NOT NUMERIC                                  00282000
023476     OR W-MATR9-1-15 EQUAL ZERO                                   00282100
023477           MOVE 96 TO W-ERR                                       00282200
023478           GO TO A4-EXIT.                                         00282300
023479 A4-020.                                                          00282400
023480     MOVE BQVFB21-02-MATR-INPS TO W-MATR9B.                       00282500
023481     MOVE ZERO TO W-SOMMA-UN1.                                    00282600
023482     MOVE ZERO TO W-SOMMA-UN2.                                    00282700
023483     MOVE 1    TO W-IND.                                          00282800
023484     MOVE 2    TO W-IND1.                                         00282900
023485 A4-030.                                                          00283000
023486*--- CICLO PER SOMMARE I CAMPI DI WORKING SEPARATI IN GRUPPI      00283100
023487*--- DI CIFRE 1,3,5,7,9,11,13,15 E 2,4,6,8,10,12,14               00283200
023488     COMPUTE W-SOMMA-UN1 = W-SOMMA-UN1 + W-MATR9B-EL(W-IND).      00283300
023489*---                                                              00283400
023490     IF W-IND1 LESS 15                                            00283500
023491      COMPUTE W-SOMMA-UN2 = W-SOMMA-UN2 + W-MATR9B-EL(W-IND1).    00283600
023492*---                                                              00283700
023493     ADD 2 TO W-IND.                                              00283800
023494     ADD 2 TO W-IND1.                                             00283900
023495     IF W-IND LESS 16                                             00284000
023496        GO TO A4-030.                                             00284100
023497 A4-040.                                                          00284200
023498*--- SI CONTROLLA CHE L'UNITA' DELLA PRIMA SOMMA SIA PARI AL      00284300
023499*--- 1 CARATTERE E CHE L'UNITA' DELLA SECONDA SOMMA UGUALE       00284400
023500*--- AL 2 CARATTERE DEL CONTROCODICE DELLA MATRICOLA             00284500
023501*---                                                              00284600
023502     IF W-SOMMA-UN2 EQUAL W-MATR9-16 AND                          00284700
023503        W-SOMMA-UN1 EQUAL W-MATR9-17                              00284800
023504           GO TO A4-EXIT.                                         00284900
023505 A4-060.                                                          00285000
023506     MOVE 96                   TO W-ERR.                          00285100
023507 A4-EXIT.                                                         00285200
023508     EXIT.                                                        00285300
023509*---                                                              00285400
023510*--- FINE MODIFICA                                                00285500
023511*---                                                              00285600
023512*---                                                              00285700
023513*--- MODIFICA DEL 11/04/2002: INTRODUZIONE FORMALISMO             00285800
023514*--- LAVORATORI DOMESTICI FORMATO MATRICOLA = A                   00285900
023515*---                                                              00286000
023516 A5-010-DOMESTICI.                                                00286100
028620*---                                                              00286200
028621*---   FORMATO MATRICOLA DI TIPO A                                00286300
028622*---                                                              00286400
028623     MOVE BQVFB21-02-MATR-INPS        TO W-MATRA.                 00286500
028624     IF W-MATRA-1-10 NOT NUMERIC      OR                          00286600
028625        W-MATRA-1-10 EQUAL ZERO                                   00286700
028626        MOVE 96                   TO W-ERR                        00286800
028627       GO TO A5-EXIT.                                             00286900
028628 A5-020.                                                          00287000
028629*---                                                              00287100
028630     MOVE BQVFB21-02-MATR-INPS        TO W-MATRAB.                00287200
028631     MOVE ZERO                        TO W-SOMMA-UN1.             00287300
028632     MOVE ZERO                        TO W-SOMMA-UN2.             00287400
028633     MOVE 1                           TO W-IND.                   00287500
028634     MOVE 2                           TO W-IND1.                  00287600
028635 A5-030.                                                          00287700
028636*---   CICLO PER SOMMARE IN CAMPI DI WORKING SEPARATI I GRUPPI    00287800
028637*---   DI CIFRE 1,3,5,7,9  E  2,4,6,8,10                          00287900
028638     COMPUTE W-SOMMA-UN1 = W-SOMMA-UN1 + W-MATRAB-EL(W-IND).      00288000
028639*---                                                              00288100
028640     IF W-IND1 LESS 11                                            00288200
028641       COMPUTE W-SOMMA-UN2 = W-SOMMA-UN2 + W-MATRAB-EL(W-IND1).   00288300
028642*---                                                              00288400
028643     ADD 2                            TO W-IND.                   00288500
028644     ADD 2                            TO W-IND1.                  00288600
028645     IF W-IND LESS 10                                             00288700
028646        GO TO A5-030.                                             00288800
028647 A5-040.                                                          00288900
028648*---   SI CONTROLLA CHE L'UNITA' DELLA PRIMA SOMMA SIA PARI AL    00289000
028649*---   11 CARATTERE E CHE L'UNITA' DELLA SECONDA SOMMA UGUALE    00289100
028650*---   AL 12 CARATTERE DELLA MATRICOLA.                          00289200
028651*---                                                              00289300
028652     IF W-SOMMA-UN1 EQUAL W-MATRA-11 AND                          00289400
028653        W-SOMMA-UN2 EQUAL W-MATRA-12                              00289500
028654       GO TO A5-EXIT.                                             00289600
028655*---                                                              00289700
028656 A5-060.                                                          00289800
028657*F SOLO PER TEST                                                  00289900
028658*F   DISPLAY ' MATRICOLA   ' W-MATRAB.                            00290000
028659*F   DISPLAY ' W-SOMMA-UN1 ' W-SOMMA-UN1.                         00290100
028660*F   DISPLAY ' W-MATRA-11  ' W-MATRA-11.                          00290200
028661*F   DISPLAY ' W-SOMMA-UN2 ' W-SOMMA-UN2.                         00290300
028662*F   DISPLAY ' W-MATRA-12  ' W-MATRA-12.                          00290400
028663*F SOLO PER TEST                                                  00290500
028664*                                                                 00290600
028665*INIZIO MODIFICA 12/12/2002                                       00290700
028666*(CAMBIO CONTROLLI FORMALISMO MATR. TIPO A(9))                    00290800
028667*****MOVE 96                   TO W-ERR.                          00290900
028668*FINE MODIFICA 12/12/2002                                         00291000
028669 A5-EXIT.                                                         00291100
028670     EXIT.                                                        00291200
028671*---                                                              00291300
028672*---   FINE MODIFICA                                              00291400
029123*---                                                              00291500
029124*---                                                              00291600
029125*--- MODIFICA DEL 11/04/2002: INTRODUZIONE FORMALISMO             00291700
029126*--- VERSAMENTI PER CALAMITA' FORMATO MATRICOLA = B               00291800
029127*---                                                              00291900
029128 A6-010-CALAMITA.                                                 00292000
029129*---                                                              00292100
029130*---   FORMATO MATRICOLA DI TIPO A                                00292200
029131*---                                                              00292300
029132     MOVE BQVFB21-02-MATR-INPS        TO W-MATRB.                 00292400
029133     IF W-MATRB-1-2  EQUAL ZERO       OR                          00292500
029134        W-MATRB-1-2  GREATER '95'     OR                          00292600
029135        W-MATRB-3-8  NOT NUMERIC      OR                          00292700
029136        W-MATRB-3-8  EQUAL ZERO                                   00292800
029137        MOVE 96                   TO W-ERR                        00292900
029138       GO TO A6-EXIT.                                             00293000
029139 A6-020.                                                          00293100
029140*---                                                              00293200
029141     MOVE BQVFB21-02-MATR-INPS        TO W-MATRBB.                00293300
029142     MOVE ZERO                        TO W-SOMMA-UN1.             00293400
029143     MOVE ZERO                        TO W-SOMMA-UN2.             00293500
029144     MOVE 1                           TO W-IND.                   00293600
029145     MOVE 2                           TO W-IND1.                  00293700
029146 A6-030.                                                          00293800
029147*---   CICLO PER SOMMARE IN CAMPI DI WORKING SEPARATI I GRUPPI    00293900
029148*---   DI CIFRE 1,3,5,7    E  2,4,6,8                             00294000
029149     COMPUTE W-SOMMA-UN1 = W-SOMMA-UN1 + W-MATRBB-EL(W-IND).      00294100
029150*---                                                              00294200
029151     IF W-IND1 LESS 9                                             00294300
029152       COMPUTE W-SOMMA-UN2 = W-SOMMA-UN2 + W-MATRBB-EL(W-IND1).   00294400
029153*---                                                              00294500
029154     ADD 2                            TO W-IND.                   00294600
029155     ADD 2                            TO W-IND1.                  00294700
029156     IF W-IND LESS 8                                              00294800
029157        GO TO A6-030.                                             00294900
029158 A6-040.                                                          00295000
029159*---   SI CONTROLLA CHE L'UNITA' DELLA PRIMA SOMMA SIA PARI AL    00295100
029160*---    9 CARATTERE E CHE L'UNITA' DELLA SECONDA SOMMA UGUALE    00295200
029161*---   AL 10 CARATTERE DELLA MATRICOLA.                          00295300
029162*---                                                              00295400
029163     IF W-SOMMA-UN1 EQUAL W-MATRB-9  AND                          00295500
029164        W-SOMMA-UN2 EQUAL W-MATRB-10                              00295600
029165       GO TO A6-EXIT.                                             00295700
029166*---                                                              00295800
029167 A6-060.                                                          00295900
029168     MOVE 96                   TO W-ERR.                          00296000
029169 A6-EXIT.                                                         00296100
029170     EXIT.                                                        00296200
029171*---                                                              00296300
029172*---   FINE MODIFICA                                              00296400
029173*---                                                              00296500
029174*---                                                              00296600
029175*--- MODIFICA DEL 29/07/2008: INTRODUZIONE FORMALISMO             00296700
029176*--- FORMATO MATRICOLA = C                                        00296800
029177*---                                                              00296900
029178 A7-010.                                                          00297000
029179*---                                                              00297100
029180*---   FORMATO MATRICOLA DI TIPO C                                00297200
029181*---                                                              00297300
029182 A7-020.                                                          00297400
029183     IF BQVFB21-02-MATR-INPS(17:1) EQUAL SPACE                    00297500
029184       GO TO A7-165.                                              00297600
029185*---                                                              00297700
029186 A7-050.                                                          00297800
029187*---                                                              00297900
029188     MOVE BQVFB21-02-MATR-INPS        TO W-MATR5.                 00298000
029189     IF  W-MATR5-1   NOT NUMERIC  OR                              00298100
029190         W-MATR5-2-8 NOT NUMERIC                                  00298200
029191       GO TO A7-160.                                              00298300
029192 A7-060.                                                          00298400
029193*---                                                              00298500
029194     IF  W-MATR5-9-10 NOT NUMERIC OR                              00298600
029195         W-MATR5-11   NOT NUMERIC                                 00298700
029196       GO TO A7-150.                                              00298800
029197*---                                                              00298900
029198 A7-065.                                                          00299000
029199*---                                                              00299100
029200     IF  W-MATR5-12   NOT NUMERIC                                 00299200
029201       GO TO A7-140.                                              00299300
029202 A7-070.                                                          00299400
029203*---                                                              00299500
029204     IF W-MATR5-13-14  NOT NUMERIC                                00299600
029205           GO TO A7-130.                                          00299700
029206*---                                                              00299800
029207 A7-080.                                                          00299900
029208*---                                                              00300000
029209     MOVE BQVFB21-02-MATR-INPS        TO W-MATR5A.                00300100
029210     MOVE ZERO                        TO W-IND.                   00300200
029211     MOVE ZERO                        TO W-UNITA.                 00300300
029212 A7-085.                                                          00300400
029213*---   SI SOMMANO LE PRIME 14 CIFRE                               00300500
029952*---                                                              00300600
029953     ADD  1                           TO W-IND.                   00300700
029954     COMPUTE W-UNITA = W-UNITA + W-EL-MATR5A(W-IND).              00300800
029955     IF W-IND LESS 14                                             00300900
029956       GO TO A7-085.                                              00301000
029957 A7-090.                                                          00301100
029958*---   L'UNITA' DELLA SOMMA DEV'ESSERE PARI AL 15 CARATTERE      00301200
029959*---                                                              00301300
029960     IF W-MATR5-15 NOT NUMERIC        OR                          00301400
029961        W-UNITA NOT EQUAL W-MATR5-15                              00301500
029962       GO TO A7-120.                                              00301600
029963 A7-100.                                                          00301700
029964*---   SI CONSIDERA LA STRINGA NUMERICA DEI PRIMI 15 CARATTERI,   00301800
029965*---   LA SI DIVIDE PER 93 E SI CONTROLLA CHE IL RESTO SIA PARI   00301900
029966*---   ALLA STRINGA NUMERICA DEL 16/17 BYTE                     00302000
029967*---                                                              00302100
029968     MOVE BQVFB21-02-MATR-INPS        TO W-MATR5B.                00302200
029969     DIVIDE 93 INTO W-EL-MATR5B GIVING W-UNITA                    00302300
029970                                 REMAINDER W-RESTO.               00302400
029971     IF W-MATR5-16-17 NUMERIC            AND                      00302500
029972        W-MATR5-16-17 EQUAL W-RESTO1                              00302600
029973       MOVE '5'                    TO W-FORMATO-MATR-OK           00302700
029974       GO TO A7-EXIT.                                             00302800
029975 A7-110.                                                          00302900
029976*---                                                              00303000
029977     MOVE 96                        TO W-ERR.                     00303100
029978     GO TO A7-EXIT.                                               00303200
029979 A7-120.                                                          00303300
029980*---                                                              00303400
029981     MOVE 96                        TO W-ERR.                     00303500
029982     GO TO A7-EXIT.                                               00303600
029983 A7-130.                                                          00303700
029984*---                                                              00303800
029985     MOVE 96                        TO W-ERR.                     00303900
029986     GO TO A7-EXIT.                                               00304000
029987 A7-140.                                                          00304100
029988*---                                                              00304200
029989     MOVE 96                        TO W-ERR.                     00304300
029990     GO TO A7-EXIT.                                               00304400
029991 A7-150.                                                          00304500
029992*---                                                              00304600
029993     MOVE 96                        TO W-ERR.                     00304700
029994     GO TO A7-EXIT.                                               00304800
029995 A7-160.                                                          00304900
029996*---                                                              00305000
029997     MOVE 96                        TO W-ERR.                     00305100
029998     GO TO A7-EXIT.                                               00305200
030042*---                                                              00305300
030043 A7-165.                                                          00305400
030044*---                                                              00305500
030045     MOVE 'C'                       TO W-FORMATO-MATR-OK.         00305600
030046     GO TO A7-EXIT.                                               00305700
030047 A7-EXIT.                                                         00305800
030048     EXIT.                                                        00305900
030049*---                                                              00306000
030050*--- FORMATO MATRICOLA = E                                        00306100
030051*---                                                              00306200
030052 A8-010.                                                          00306300
030053*---                                                              00306400
030054*---   FORMATO MATRICOLA DI TIPO D                                00306500
030055*---                                                              00306600
030056     MOVE BQVFB21-02-MATR-INPS        TO W-MATRD.                 00306700
030057     IF W-MATRD-1-9  NUMERIC                                      00306800
030058       GO TO A8-EXIT.                                             00306900
030059*---                                                              00307000
030060 A8-060.                                                          00307100
030061     MOVE 96                   TO W-ERR.                          00307200
030062 A8-EXIT.                                                         00307300
030063     EXIT.                                                        00307400
030064*---                                                              00307500
030065*---                                                              00307600
030066*--- FORMATO MATRICOLA = E                                        00307700
030067*---                                                              00307800
030068 A9-010.                                                          00307900
030069*---                                                              00308000
030070*---   FORMATO MATRICOLA DI TIPO E                                00308100
030071*---                                                              00308200
030072     MOVE BQVFB21-02-MATR-INPS        TO W-MATRE.                 00308300
030073     IF W-MATRE-1-13 NOT NUMERIC                                  00308400
030074        MOVE 96                   TO W-ERR                        00308500
030075       GO TO A9-EXIT.                                             00308600
030076 A9-020.                                                          00308700
030077*---                                                              00308800
030078     MOVE BQVFB21-02-MATR-INPS        TO W-MATREB.                00308900
030079     MOVE ZERO                        TO W-SOMMA-DISPARI.         00309000
030080     MOVE ZERO                        TO W-SOMMA-PARI.            00309100
030081     MOVE 1                           TO W-IND.                   00309200
030082     MOVE 2                           TO W-IND1.                  00309300
030083 A9-030.                                                          00309400
030084*---   CICLO PER SOMMARE IN CAMPI DI WORKING SEPARATI I GRUPPI    00309500
030085*---   DI CIFRE 1,3,5,7,9,11,13 E  2,4,6,8,10,12                  00309600
030086     COMPUTE W-SOMMA-DISPARI = W-SOMMA-DISPARI +                  00309700
030087                               W-MATREB-EL(W-IND).                00309800
030088*---                                                              00309900
030089     IF W-IND1 LESS 13                                            00310000
030090       COMPUTE W-SOMMA-PARI  = W-SOMMA-PARI +                     00310100
030091                               W-MATREB-EL(W-IND1).               00310200
030092*---                                                              00310300
030093     ADD 2                            TO W-IND.                   00310400
030094     ADD 2                            TO W-IND1.                  00310500
030095     IF W-IND LESS 14                                             00310600
030096        GO TO A9-030.                                             00310700
030097 A9-040.                                                          00310800
030098*---                                                              00310900
030099     COMPUTE W-PARI-PER-TRE     = W-SOMMA-PARI * 3.               00311000
030100     COMPUTE W-PARI-PIU-DISPARI = W-PARI-PER-TRE +                00311100
030101                                  W-SOMMA-DISPARI.                00311200
030102     COMPUTE W-COD-CONTR-MATRE  = 10 - W-PARI-PIU-DISPARI-3.      00311300
030103     IF W-COD-CONTR-MATRE  EQUAL W-MATRE-14                       00311400
030104       GO TO A9-EXIT.                                             00311500
030105*---                                                              00311600
030106 A9-060.                                                          00311700
030107     MOVE 96                   TO W-ERR.                          00311800
030108 A9-EXIT.                                                         00311900
030109     EXIT.                                                        00312000
030110*                                                                 00312100
030111*                                                                 00312200
030112* IL PRIMO CARATTERE DEL CODICE CATASTALE DEVE ESSERE ALFABETICO E00312300
030113* DEVE ASSUMERE UNO DEI SEGUENTI VALORI: 'Z' O DA 'A' AD 'M' AD   00312400
030114* ESCLUSIONE DI 'J' 'K'; LE TRE CIFRE SUCCESSIVE POSSONO ESSERE   00312500
030115* NUMERICHE (DA 000 A 999), OPPURE E' UNA STRINGA ALFANUMERICA    00312600
030116* CONTENENTE SOLO I CARATTERI L, M, N, P, Q, R, S, T, U, V;       00312700
030117* SE IL PRIMO BYTE E' M, QUELLO SUCCESSIVO PUO' ESSERE O UN       00312800
030118* NUMERO < 4, OPPURE PUO' VALERE SOLO L, M, N, P.                 00312900
030119*                                                                 00313000
030120 R1-010-CATAST.                                                   00313100
030121     MOVE BQVFB21-02-MATR-INPS   TO W-CF-CATAST.                  00313200
030122     IF W-CATAST-SOTTO2 NUMERIC AND                               00313300
030123        W-CATAST-SOTTO2 > '000' AND                               00313400
030124        W-CATAST-SOTTO2 NOT > '999'                               00313500
030125        GO TO R1-040.                                             00313600
030126 R1-020.                                                          00313700
030127     IF (W-CATAST-SOTTO21 NUMERIC OR                              00313800
030128         W-CATAST-SOTTO21-OK)        AND                          00313900
030129        (W-CATAST-SOTTO22 NUMERIC OR                              00314000
030130         W-CATAST-SOTTO22-OK)        AND                          00314100
030131        (W-CATAST-SOTTO23 NUMERIC OR                              00314200
030132         W-CATAST-SOTTO23-OK)                                     00314300
030133        GO TO R1-040.                                             00314400
030134 R1-030.                                                          00314500
030135     MOVE 1 TO W-BQVFB3-COD-RIT.                                  00314600
030136 R1-040.                                                          00314700
030137     IF W-CATAST-SOTTO1 NOT = 'M' OR                              00314800
030138        W-BQVFB3-COD-RIT = 1                                      00314900
030139        GO TO R1-010-CATAST-EX.                                   00315000
030140 R1-050.                                                          00315100
030141     IF W-CATAST-SOTTO21 NUMERIC AND                              00315200
030142        W-CATAST-SOTTO21 < '4'                                    00315300
030143        GO TO R1-010-CATAST-EX.                                   00315400
030144 R1-060.                                                          00315500
030145     IF W-CATAST-SOTTO21 = 'L' OR                                 00315600
030146        W-CATAST-SOTTO21 = 'M' OR                                 00315700
030147        W-CATAST-SOTTO21 = 'N' OR                                 00315800
030148        W-CATAST-SOTTO21 = 'P'                                    00315900
030149        GO TO R1-010-CATAST-EX.                                   00316000
030150 R1-070.                                                          00316100
030151     MOVE 1 TO W-BQVFB3-COD-RIT.                                  00316200
030152 R1-010-CATAST-EX.                                                00316300
030153     EXIT.                                                        00316400
030154     EJECT                                                        00316500
030155*---                                                              00316600
030156 B3-010-NUOVI-PER.                                                00316700
030157*---                                                              00316800
030158     IF W-FORMATO-DAL EQUAL 'I'                                   00316900
030159       GO TO B3-400.                                              00317000
030160*                                                                 00317100
030161* MODIFICA 06/07/2005 - NUOVO FORMALISMO INIZIO RIF 'N'           00317200
030162     IF W-FORMATO-DAL EQUAL 'N'                                   00317300
030163         GO TO B3-100.                                            00317400
030164*                                                                 00317500
030165*F MODIFICA 29/07/2008 - NUOVO FORMALISMO INIZIO RIF 'P'          00317600
030166     IF W-FORMATO-DAL EQUAL 'P'                                   00317700
030167       GO TO B3-200.                                              00317800
030168 B3-020.                                                          00317900
030169*---                                                              00318000
030170*---   CONTROLLO TIPOLOGIA 'L'                                    00318100
031622*---                                                              00318200
031623     IF W-MESE-RIF NUMERIC                     AND                00318300
031624        W-MESE-RIF GREATER ZERO                AND                00318400
031625        W-MESE-RIF LESS '13'                   AND                00318500
031626        W-ANNO-RIF NUMERIC                     AND                00318600
031627        W-ANNO-RIF GREATER ZERO                AND                00318700
031628*GM     W-RIF1 NOT LESS '200101'               AND                00318800
031629        W-RIF1 NOT LESS '200102'               AND                00318900
031630        W-RIF1 NOT GREATER W-DATA-RISC-AAAAMM                     00319000
031631        MOVE 'L'                TO W-FORMATO-DAL-OK               00319100
031632        GO TO B3-EXIT.                                            00319200
031633 B3-030.                                                          00319300
031877*---                                                              00319400
031878     MOVE 55                 TO W-ERR.                            00319500
031879     IF W-RIF1 LESS '200101'               OR                     00319600
031880        W-RIF1 GREATER W-DATA-RISC-AAAAMM                         00319700
031881        MOVE 96                 TO W-ERR                          00319800
031882     END-IF.                                                      00319900
031883     GO TO B3-EXIT.                                               00320000
031884 B3-100.                                                          00320100
031885*---                                                              00320200
031886*---   CONTROLLO TIPOLOGIA 'N'                                    00320300
031887*---                                                              00320400
031888     IF  W-MESE-RIF NUMERIC                     AND               00320500
031889         W-MESE-RIF GREATER ZERO                AND               00320600
031890         W-MESE-RIF LESS '13'                   AND               00320700
031891         W-ANNO-RIF NUMERIC                     AND               00320800
031892         W-ANNO-RIF GREATER ZERO                AND               00320900
031893         W-RIF1 NOT LESS '200501'               AND               00321000
031894         W-RIF1 NOT GREATER W-DATA-RISC-AAAAMM                    00321100
031895        MOVE 'N'                TO W-FORMATO-DAL-OK               00321200
031896        GO TO B3-EXIT.                                            00321300
031897 B3-120.                                                          00321400
031898*---                                                              00321500
031899     MOVE 55                 TO W-ERR.                            00321600
031900     GO TO B3-EXIT.                                               00321700
031901 B3-200.                                                          00321800
031902*---                                                              00321900
031903*---   CONTROLLO TIPOLOGIA 'P'                                    00322000
031904*---                                                              00322100
031905     IF W-MESE-RIF NUMERIC                     AND                00322200
031906        W-MESE-RIF GREATER ZERO                AND                00322300
031907        W-MESE-RIF LESS '13'                   AND                00322400
031908        W-ANNO-RIF NUMERIC                     AND                00322500
031909        W-ANNO-RIF GREATER ZERO                AND                00322600
031910        W-RIF1 EQUAL       W-DATA-RISC-AAAAMM                     00322700
031911        MOVE 'P'                TO W-FORMATO-DAL-OK               00322800
031912        GO TO B3-EXIT.                                            00322900
031913 B3-220.                                                          00323000
031914*---                                                              00323100
031915     MOVE 55                 TO W-ERR.                            00323200
031916     GO TO B3-EXIT.                                               00323300
031917 B3-400.                                                          00323400
031918*---                                                              00323500
031919*---   CONTROLLO TIPOLOGIA 'I'                                    00323600
031920*---                                                              00323700
031921     IF (W-MESE-RIF NUMERIC                     AND               00323800
031922*        W-MESE-RIF EQUAL ZERO                  AND               00323900
031923         W-ANNO-RIF NUMERIC                     AND               00324000
031924         W-ANNO-RIF GREATER '1996')                 OR            00324100
031925        (W-MESE-RIF EQUAL ZERO                  AND               00324200
031926         W-ANNO-RIF EQUAL ZERO)                                   00324300
031927        MOVE 'I'                TO W-FORMATO-DAL-OK               00324400
031928        GO TO B3-EXIT.                                            00324500
031929 B3-420.                                                          00324600
031930*---                                                              00324700
031931     MOVE 55                 TO W-ERR.                            00324800
031932*---                                                              00324900
031933 B3-EXIT.                                                         00325000
031934     EXIT.                                                        00325100
031935*---      ROUTINE DI CONTROLLO MATRICOLA FORMATO 3                00325200
031936*---         (NUOVE CAUSALI)                                      00325300
031937*---                                                              00325400
031938 C3-010-PAG.                                                      00325500
031939*---                                                              00325600
031940     MOVE ZERO               TO W-PAGAM.                          00325700
031941*---                                                              00325800
031942 C3-020.                                                          00325900
032600*---                                                              00326000
032601     IF BQVFB21-02-CAUSALE NOT EQUAL 'AF  ' AND                   00326100
032602                           NOT EQUAL 'CF  ' AND                   00326200
032603                           NOT EQUAL 'AFP ' AND                   00326300
032604                           NOT EQUAL 'CFP ' AND                   00326400
032605                           NOT EQUAL 'ABS ' AND                   00326500
032606                           NOT EQUAL 'CBS '                       00326600
032607        GO TO C3-010-PAG-EX.                                      00326700
032608*---                                                              00326800
032609 C3-030.                                                          00326900
032610*---                                                              00327000
032611     IF BQVFB21-02-IMP-PAGAM GREATER ZERO                         00327100
032612        GO TO C3-050.                                             00327200
032613*---                                                              00327300
032614 C3-040.                                                          00327400
032615*---                                                              00327500
032616     MOVE BQVFB21-02-IMP-RIMBA TO W-PAGAM.                        00327600
032617     IF W-DIVISA = 'EUR'                                          00327700
032618        STRING '00' BQVFB21-02-IMP-RIMBA(1:13)                    00327800
032619        DELIMITED BY SIZE INTO W-PAGAM                            00327900
032620     END-IF.                                                      00328000
032621     GO TO C3-010-PAG-EX.                                         00328100
032622*---                                                              00328200
032623 C3-050.                                                          00328300
032624*---                                                              00328400
032625     MOVE BQVFB21-02-IMP-PAGAMA TO W-PAGAM.                       00328500
032626     IF W-DIVISA = 'EUR'                                          00328600
032627        STRING '00' BQVFB21-02-IMP-PAGAMA(1:13)                   00328700
032628        DELIMITED BY SIZE INTO W-PAGAM                            00328800
032629     END-IF.                                                      00328900
032630 C3-010-PAG-EX.                                                   00329000
032631     EXIT.                                                        00329100
032632*---                                                              00329200
032633*---      ROUTINE DI CONTROLLO PAGAMENTI                          00329300
032634*---         (NUOVE CAUSALI)                                      00329400
032635 D3-010-PAG.                                                      00329500
032636*---   SI CONTROLLA CHE PAGAMENTI SIA NUMERICO                    00329600
032637*---                                                              00329700
032638     IF BQVFB21-02-IMP-PAGAMA NUMERIC                             00329800
032639       GO TO D3-040.                                              00329900
032640 D3-030.                                                          00330000
032641*---   ERRORE BLOCCANTE                                           00330100
032642*---                                                              00330200
032643     ADD 1                    TO W-CTR2.                          00330300
032644     MOVE 33                  TO BQVFB21-02-ERR-IMP-PAGAM.        00330400
032645     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-PAGAM-A.      00330500
032646     GO TO D3-060.                                                00330600
032647 D3-040.                                                          00330700
032648*---   SI CONTROLLA CHE PAGAMENTI SIA UGUALE A ZERO               00330800
032649*---                                                              00330900
032650     IF BQVFB21-02-IMP-PAGAMA EQUAL ZERO                          00331000
032651       GO TO D3-060.                                              00331100
032652 D3-050.                                                          00331200
032653*---   ERRORE NON BLOCCANTE                                       00331300
032654*---                                                              00331400
032655     ADD 1                    TO W-CTR1.                          00331500
032656     MOVE 39                  TO BQVFB21-02-ERR-IMP-PAGAM.        00331600
032657     MOVE 'W'                 TO BQVFB21-02-ERR-IMP-PAGAM-A.      00331700
032658 D3-060.                                                          00331800
032659*---   SI CONTROLLA CHE RIMBORSI SIA NUMERICO                     00331900
032660*---                                                              00332000
032661     IF BQVFB21-02-IMP-RIMBA NUMERIC                              00332100
032662       GO TO D3-080.                                              00332200
032663 D3-070.                                                          00332300
032664*---   ERRORE BLOCCANTE                                           00332400
032665*---                                                              00332500
032666     ADD 1                    TO W-CTR2.                          00332600
032667     MOVE 33                  TO BQVFB21-02-ERR-IMP-RIMB.         00332700
032668     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-RIMB-A.       00332800
032669     GO TO D3-160.                                                00332900
032670 D3-080.                                                          00333000
032671*---                                                              00333100
032672*---   SI CONTROLLA CHE RIMBORSI SIA MAGGIORE DI ZERO             00333200
032673*---                                                              00333300
032674     IF BQVFB21-02-IMP-RIMBA GREATER ZERO                         00333400
032675       GO TO D3-160.                                              00333500
032676 D3-090.                                                          00333600
032677*---   ERRORE NON BLOCCANTE                                       00333700
032678*---                                                              00333800
032679     ADD 1                    TO W-CTR2.                          00333900
032680     MOVE 39                  TO BQVFB21-02-ERR-IMP-RIMB.         00334000
032681     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-RIMB-A.       00334100
032682 D3-160.                                                          00334200
032683     IF BQVFB21-02-IMP-PAGAMA NUMERIC                             00334300
032684        ADD BQVFB21-02-IMP-PAGAM TO W-TAB-EL-PAG(2).              00334400
032685     IF BQVFB21-02-IMP-RIMBA NUMERIC                              00334500
032686        ADD BQVFB21-02-IMP-RIMB TO W-TAB-EL-RIM(2).               00334600
032687 D3-170.                                                          00334700
032688*---   SI CONTROLLA LA DIVISA                                     00334800
032689*---                                                              00334900
032690     IF W-DIVISA EQUAL SPACE                                      00335000
032691       GO TO D3-010-PAG-EX.                                       00335100
032692 D3-180.                                                          00335200
032693*---   SI CONTROLLA CHE LE ULTIME TRE CIFRE DI PAGAMENTI  SIANO   00335300
032694*---   IMPOSTATE A ZERO SE DIVISA = ITL;  LE ULTIME DUE SE EUR    00335400
032695*---                                                              00335500
032696     MOVE BQVFB21-02-IMP-PAGAM     TO W-CIFRE.                    00335600
032697*INIZIO MODIFICA EURO                                             00335700
032698*CB 4/12/2001                                                     00335800
032699     IF W-DATA-RISC <= '20011231'                                 00335900
032700          IF (W-DIVISA EQUAL 'ITL' AND                            00336000
032701              W-CIFRE-TRE EQUAL ZERO)    OR                       00336100
032702             (W-DIVISA EQUAL 'EUR' AND                            00336200
032703             (BQVFB21-DATA-BONIF > '20011231' OR                  00336300
032704              W-CIFRE-DUE EQUAL ZERO))                            00336400
032705              GO TO D3-200                                        00336500
032706          ELSE                                                    00336600
032707              GO TO D3-190                                        00336700
032708          END-IF                                                  00336800
032709     END-IF.                                                      00336900
032710              GO TO D3-200.                                       00337000
032711*CB 4/12/2001                                                     00337100
032712*FINE   MODIFICA EURO                                             00337200
032713 D3-190.                                                          00337300
032714*---   ERRORE NON BLOCCANTE                                       00337400
032715*---                                                              00337500
032716     ADD 1                    TO W-CTR1.                          00337600
032717     MOVE 96                  TO BQVFB21-02-ERR-IMP-PAGAM.        00337700
032718     MOVE 'W'                 TO BQVFB21-02-ERR-IMP-PAGAM-A.      00337800
032719 D3-200.                                                          00337900
032720*---   SI CONTROLLA CHE LE ULTIME TRE CIFRE DI PAGAMENTI  SIANO   00338000
032721*---   IMPOSTATE A ZERO SE DIVISA = ITL;  LE ULTIME DUE SE EUR    00338100
032722*---                                                              00338200
032723     MOVE BQVFB21-02-IMP-RIMB      TO W-CIFRE.                    00338300
032724*INIZIO MODIFICA EURO                                             00338400
032725*CB 4/12/2001                                                     00338500
032726     IF W-DATA-RISC <= '20011231'                                 00338600
032727          IF (W-DIVISA EQUAL 'ITL' AND                            00338700
032728              W-CIFRE-TRE EQUAL ZERO)    OR                       00338800
032729             (W-DIVISA EQUAL 'EUR' AND                            00338900
032730             (BQVFB21-DATA-BONIF > '20011231' OR                  00339000
032731              W-CIFRE-DUE EQUAL ZERO))                            00339100
032732              GO TO D3-010-PAG-EX                                 00339200
032733          ELSE                                                    00339300
032734              GO TO D3-210                                        00339400
032735          END-IF                                                  00339500
032736     END-IF.                                                      00339600
032737              GO TO D3-010-PAG-EX.                                00339700
032738*CB 4/12/2001                                                     00339800
032739*FINE   MODIFICA EURO                                             00339900
032740 D3-210.                                                          00340000
032741*---   ERRORE NON BLOCCANTE                                       00340100
032742*---                                                              00340200
032743     ADD 1                    TO W-CTR2.                          00340300
032744     MOVE 96                  TO BQVFB21-02-ERR-IMP-RIMB.         00340400
032745     MOVE 'E'                 TO BQVFB21-02-ERR-IMP-RIMB-A.       00340500
032746 D3-010-PAG-EX.                                                   00340600
032747     EXIT.                                                        00340700
032748*---                                                              00340800
