000010 IDENTIFICATION DIVISION.                                         00000010
000030 PROGRAM-ID. BQVFB0.                                              00000030
000040 AUTHOR. N9143 - R.D'ELIA.                                        00000040
000050 DATE-WRITTEN. 03/04/2000.                                        00000050
000070******************************************************************00000070
000080*$1 TITOLO - CONTROLLO FLUSSO 'F24' E SEGNALAZIONE ERRORI         00000080
000090*                                                                 00000090
000100******************************************************************00000100
000110                                                                  00000110
000120*$1 FUNZIONI SVOLTE E LOGICA DI ELABORAZIONE                      00000120
000130*                                                                 00000130
000140*   TIPO BATCH                                                    00000140
000150*                                                                 00000150
000160*   IL PROGRAMMA SI INSERISCE NEL PACCHETTO DI CONTROLLO DATI     00000160
000170*   BANCHE E CONCESSIONARI PER MAINFRAME UTENTE.                  00000170
000180*   I DATI DEL FLUSSO SONO REGISTRATI SUL FILE BQVFB1.            00000180
000190*   IL PACCHETTO DI CONTROLLO DATI PER MAINFRAME UTENTE           00000190
000200*   UTILIZZA LA STESSA LOGICA SEGUITA DALLE PROCEDURE DI          00000200
000210*   ACQUISIZIONE DATI E DEGLI ESITI PRESSO LA ANAGRAFE            00000210
000220*   TRIBUTARIA.                                                   00000220
000230*   IL PACCHETTO CONSENTE ALL'UTENTE DI EFFETTUARE PRESSO         00000230
000240*   IL PROPRIO SISTEMA GLI STESSI CONTROLLI CHE VERRANNO          00000240
000250*   SVOLTI DALLA ANAGRAFE TRIBUTARIA DOPO L'INVIO DEI DATI,       00000250
000260*   ANTICIPANDO QUINDI L'INDIVIDUAZIONE DEGLI EVENTUALI           00000260
000270*   ERRORI.                                                       00000270
000280*   IL PRESENTE PROGRAMMA SEGUE LA STESSA LOGICA DELL'ANALOGO     00000280
000290*   BQVX60.                                                       00000290
000300*                                                                 00000300
000310*   IL PROGRAMMA HA LO SCOPO DI CONTROLLARE I FLUSSI PROVENIENTI  00000310
000320*   DALLE BANCHE E DAI CONCESSIONARI RELATIVI ALLE DELEGHE        00000320
000330*   DI PAGAMENTO.                                                 00000330
000340*   IN INPUT IL PROGRAMMA LEGGE L'ARCHIVIO FLUSSO 'F24' COMPOSTO  00000340
000350*   DA INVII INDENTIFICATI DA UN CODICE ABI O CODICE AMBITO,UNA   00000350
000360*   DATA BONIFICO E DA UN PROGRESSIVO TRASMISSIONE E A LORO VOLTA 00000360
000370*   COMPOSTI DA DIVERSI TIPI RECORD CHE INDIVIDUANO L'INVIO STESSO00000370
000380*   PER OGNI TIPO RECORD SI CONTROLLA LA CORRETTA SEQUENZIALITA'  00000380
000390*   E LA CORRETTEZZA DEI DATI RIPORTATI NELLO STESSO.             00000390
000400*   IN OGNI CASO SI SCRIVE IL FILE ESITI CONTROLLI FORMALI        00000400
000410*   A PARTIRE DALL'INPUT CON L'INFORMAZIONE RELATIVA AL CODICE    00000410
000420*   DI ERRORE EVENTUALMENTE RISCONTRATO PER OGNI CAMPO DEL RECORD 00000420
000430*   ED IL FILE INVII RIPORTANTE DATI RIEPILOGATIVI SUL FLUSSO     00000430
000440*   LOGICO LETTO E L'ESITO DEI CONTROLLI.                         00000440
000450*                                                                 00000450
000460*   .ARCHIVI GESTITI                                              00000460
000470*      NOME       DESCRIZIONE                  I/O   ACCESSO      00000470
000480*   *BQVFB1 *     FILE FLUSSO BANCHE/CONCES.  *INP*  SEQ          00000480
000490*   *BQVFAM *     FILE CODICI AMBITI          *INP*  SEQ          00000490
000500*   *BQVFAZ *     FILE CODICI AZIENDE         *INP*  SEQ          00000500
000510*   *BQVFPR *     FILE CODICI PROVINCE        *INP*  SEQ          00000510
000520*   *BQVFRE *     FILE CODICI REGIONE         *INP*  SEQ          00000520
000530*   *BQVFTR *     FILE CODICI TRIBUTI         *INP*  SEQ          00000530
000540*   *BQVFTE *     FILE CODICI ENTI-TRIBUTI    *INP*  SEQ          00000540
000550*   *BQVFSE *     FILE CODICI SEDI INPS       *INP*  SEQ          00000550
000560*   *BQVFMA *     FILE CODICI MATRICOLE INPS  *INP*  SEQ          00000560
000570*   *BQVFEL *     FILE CODICI ENTI LOCALI     *INP*  SEQ          00000570
000580*   *BQVFIN *     FILE CODICI INAIL           *INP*  SEQ          00000580
000590*   *BQVFAE *     FILE CODICI ALTRI ENTI      *INP*  SEQ          00000590
000600*   *BQVFCA *     FILE CAUSALI ALTRI ENTI     *INP*  SEQ          00000600
000610*   *BQVFUF *     FILE UFFICI                 *INP*  SEQ          00000610
000620**** SOSTITUITA DA BQVFTC                                         00000620
000630*   *BQVFCM *     FILE CODICI CATASTALI       *INP*  SEQ          00000630
000640****                                                              00000640
000650*   *BQVFTC *     FILE LINK TRIBUTI-COMUNI    *INP*  SEQ          00000650
000660*A BQVFT3 - NUOVO FILE 02/2006                                    00000660
000670*   *BQVFT3 *     FILE CODICI AMMESSI FORM.TR *INP*  SEQ          00000670
000680*F BQVFIC - NUOVO FILE 03/2006                                    00000680
000690*   *BQVFIC *     FILE INTERESSI/COMMISSIONI  *INP*  SEQ          00000690
000700*   *BQVFCI *     FILE CODICE IDENTIFICATIVO  *INP*  SEQ          00000700
000710*   *BQVFCV *     FILE TIPO VEICOLO           *INP*  SEQ          00000710
000720*   *BQVFPC *     FILE PROV DIRITTI CAMERALI  *INP*  SEQ          00000720
000730*   *BQVFCB *     FILE LIMITE COMPENSAZIONI TRIBUTI  *INP*  SEQ   00000730
000740*   *BQVFB1 *     FILE LIMITE COMPENSAZIONI TIPOLO.  *INP*  SEQ   00000740
000750****                                                              00000750
000760*   *BQVFB2 *     FILE ESITI CONTR. FORMALI   *OUT*  SEQ          00000760
000770*   *BQVFB3 *     FILE INVII BANCHE/CONCES.   *OUT*  SEQ          00000770
000780*   *BQVFB5 *     FILE SQUADRATURE            *OUT*  SEQ          00000780
000790*                                                                 00000790
000800*   .SUBROUTINES RICHIAMATE                                       00000800
000810*      NOME       DESCRIZIONE                                     00000810
000820*   *BQVFSR *     ROUTINE DI ABEND                                00000820
000830*   *BQVFDA  *    CONTROLLO DATE                                  00000830
000840*   *BQVFB1  *    CONTROLLI FORMALI DELEGHE:                      00000840
000850*                 TIPO RECORD 01-FISCO E 03-REGIONI               00000850
000860*   *BQVFB2  *    CONTROLLI FORMALI DELEGHE:                      00000860
000870*                 TIPO RECORD 02-INPS                             00000870
000880*   *BQVFB4  *    CONTROLLI FORMALI DELEGHE:                      00000880
000890*                 TIPO RECORD 14-ANAG. P.F E 15-ANAG. P.N.F.      00000890
000900*   *BQVFB6  *    CONTROLLI FORMALI E DI QUADRATURA DELEGHE:      00000900
000910*                 TIPO RECORD 36-RIEPILOGATIVO                    00000910
000920*   *BQVFB7  *    CONTROLLI FORMALI E DI QUADRATURA PER           00000920
000930*                 PROVINCIA DEGLI ACCREDITAMENTI BANCHE           00000930
000940*   *BQVFB8  *    CONTROLLI FORMALI E DI QUADRATURA PER           00000940
000950*                 FLUSSO DEI BONIFICI BANCHE                      00000950
000960*   *BQVFB9  *    CONTROLLI FORMALI DELEGHE:                      00000960
000970*                 TIPO RECORD 49-ASSEGNI NON ANDATI A BUON FINE   00000970
000980*   *BQVFB3  *    CONTROLLO FORMALE DEL CODICE FISCALE            00000980
000990*   *BQVFE7  *    CONTROLLI FORMALI DELEGHE:                      00000990
001000*                 TIPO RECORD 07-ACCISE                           00001000
001010*   *BQVFE2  *    CONTROLLI FORMALI DELEGHE:                      00001010
001020*                 TIPO RECORD 20-ATM                              00001020
001030*                                                                 00001030
001040                                                                  00001040
001050******************************************************************00001050
001060*                    ENVIRONMENT DIVISION                        *00001060
001070******************************************************************00001070
001080                                                                  00001080
001090 ENVIRONMENT DIVISION.                                            00001090
001100                                                                  00001100
001110 CONFIGURATION SECTION.                                           00001110
001120                                                                  00001120
001130 SPECIAL-NAMES.                                                   00001130
001140     DECIMAL-POINT IS COMMA.                                      00001140
001150                                                                  00001150
001160 INPUT-OUTPUT SECTION.                                            00001160
001170                                                                  00001170
001180 FILE-CONTROL.                                                    00001180
001190                                                                  00001190
001200     SELECT BQVFB1 ASSIGN TO UT-S-BQVFB1.                         00001200
001210                                                                  00001210
001220     SELECT BQVFB2 ASSIGN TO UT-S-BQVFB2.                         00001220
001230                                                                  00001230
001240     SELECT BQVFB3 ASSIGN TO UT-S-BQVFB3.                         00001240
001250                                                                  00001250
001260     SELECT BQVFB5 ASSIGN TO UT-S-BQVFB5.                         00001260
001270* SELECT DEGLI ARCHIVI DI INPUT LETTI PER EFFETTUARE I CONTROLLI  00001270
001280* SELECT DELL' ARCHIVIO AMBITI                                    00001280
001290     SELECT BQVFAM ASSIGN TO UT-S-BQVFAM.                         00001290
001300* SELECT DELL' ARCHIVIO AZIENDE                                   00001300
001310     SELECT BQVFAZ ASSIGN TO UT-S-BQVFAZ.                         00001310
001320** SELECT DELL' ARCHIVIO REGIONI                                  00001320
001330     SELECT BQVFRE ASSIGN TO UT-S-BQVFRE.                         00001330
001340** SELECT DELL' ARCHIVIO PROVINCE                                 00001340
001350     SELECT BQVFPR ASSIGN TO UT-S-BQVFPR.                         00001350
001360** SELECT DELL' ARCHIVIO TRIBUTI                                  00001360
001370     SELECT BQVFTR ASSIGN TO UT-S-BQVFTR.                         00001370
001380** SELECT DELL' ARCHIVIO ENTI-TRIBUTI                             00001380
001390     SELECT BQVFTE ASSIGN TO UT-S-BQVFTE.                         00001390
001400** SELECT DELL' ARCHIVIO MATRICOLE INPS                           00001400
001410     SELECT BQVFMA ASSIGN TO UT-S-BQVFMA.                         00001410
001420** SELECT DELL' ARCHIVIO SEDI INPS                                00001420
001430     SELECT BQVFSE ASSIGN TO UT-S-BQVFSE.                         00001430
001440** SELECT DELL' ARCHIVIO ENTI LOCALI                              00001440
001450     SELECT BQVFEL ASSIGN TO UT-S-BQVFEL.                         00001450
001460** SELECT DELL' ARCHIVIO INAIL                                    00001460
001470     SELECT BQVFIN ASSIGN TO UT-S-BQVFIN.                         00001470
001480** SELECT DELL' ARCHIVIO ALTRI ENTI                               00001480
001490     SELECT BQVFAE ASSIGN TO UT-S-BQVFAE.                         00001490
001500** SELECT DELL' ARCHIVIO CAUSALI ALTRI ENTI                       00001500
001510     SELECT BQVFCA ASSIGN TO UT-S-BQVFCA.                         00001510
001520** SELECT DELL' ARCHIVIO CODICI AMMESSI T3                        00001520
001530     SELECT BQVFT3 ASSIGN TO UT-S-BQVFT3.                         00001530
001540** SELECT DELL' ARCHIVIO INTERESSI/COMMISSIONI                    00001540
001550     SELECT BQVFIC ASSIGN TO UT-S-BQVFIC.                         00001550
001560** SELECT DELL' ARCHIVIO UFFICI                                   00001560
001570     SELECT BQVFUF ASSIGN TO UT-S-BQVFUF.                         00001570
001580** SELECT DELL' ARCHIVIO CODICI CATASTALI (SOSTITUITA)            00001580
001590**** SELECT BQVFCM ASSIGN TO UT-S-BQVFCM.                         00001590
001600** SELECT DELL' ARCHIVIO LINK TRIBUTI - CODICI CATASTALI          00001600
001610     SELECT BQVFTC ASSIGN TO UT-S-BQVFTC.                         00001610
001620** SELECT DELL' ARCHIVIO CODICE IDENTIFICATIVO                    00001620
001630     SELECT BQVFCI ASSIGN TO UT-S-BQVFCI.                         00001630
001640** SELECT DELL' ARCHIVIO TIPO VEICOLO                             00001640
001650     SELECT BQVFCV ASSIGN TO UT-S-BQVFCV.                         00001650
001660** SELECT DELL' ARCHIVIO PROVINCE DIRITTI CAMERALI                00001660
001670     SELECT BQVFPC ASSIGN TO UT-S-BQVFPC.                         00001670
001680** SELECT DELL' ARCHIVIO LIMITE COMPENSAZIONI - TRIBUTI           00001680
001690     SELECT BQVFCB ASSIGN TO UT-S-BQVFCB.                         00001690
001700** SELECT DELL' ARCHIVIO LIMITE COMPENSAZIONI - TIPOLOGIE         00001700
001710     SELECT BQVFCC ASSIGN TO UT-S-BQVFCC.                         00001710
001720                                                                  00001720
001730******************************************************************00001730
001740*                **  DATA DIVISION  **                           *00001740
001750******************************************************************00001750
001760                                                                  00001760
001770 DATA DIVISION.                                                   00001770
001780                                                                  00001780
001790 FILE SECTION.                                                    00001790
001800                                                                  00001800
001810*---                                                              00001810
001820*--- ARCHIVIO DI INPUT FLUSSO BANCHE / CONCESSIONARI              00001820
001830*---                                                              00001830
001840 FD  BQVFB1                                                       00001840
001850     BLOCK CONTAINS 0 RECORDS                                     00001850
001860     LABEL RECORDS STANDARD.                                      00001860
001870 01  BQVFB12                        PIC X(256).                   00001870
001880                                                                  00001880
001890*---                                                              00001890
001900*--- ARCHIVIO DI OUTPUT DEGLI ESITI DEI CONTROLLI FORMALI         00001900
001910*---                                                              00001910
001920 FD  BQVFB2                                                       00001920
001930     BLOCK CONTAINS 0 RECORDS                                     00001930
001940     LABEL RECORDS STANDARD.                                      00001940
001950 01  BQVFB22                        PIC X(512).                   00001950
001960                                                                  00001960
001970*---                                                              00001970
001980*--- ARCHIVIO DI OUTPUT DEGLI INVII BANCHE / CONCESSIONARI        00001980
001990*---                                                              00001990
002000 FD  BQVFB3                                                       00002000
002010     BLOCK CONTAINS 0 RECORDS                                     00002010
002020     LABEL RECORDS STANDARD.                                      00002020
002030 01  BQVFB32                        PIC X(250).                   00002030
002040                                                                  00002040
002050*---                                                              00002050
002060*--- ARCHIVIO DI OUTPUT DELLE SQUADRATURE                         00002060
002070*---                                                              00002070
002080 FD  BQVFB5                                                       00002080
002090     BLOCK CONTAINS 0 RECORDS                                     00002090
002100     LABEL RECORDS STANDARD.                                      00002100
002110 01  BQVFBS2                            PIC X(7290).              00002110
002120                                                                  00002120
002130**   ARCHIVI DI INPUT LETTI PER EFFETTUARE I CONTROLLI            00002130
002140 FD  BQVFAM                                                       00002140
002150     LABEL RECORD IS STANDARD                                     00002150
002160     BLOCK CONTAINS 0 RECORDS.                                    00002160
002170 01  BQVFAM2                        PIC X(047).                   00002170
002180                                                                  00002180
002190 FD  BQVFAZ                                                       00002190
002200     LABEL RECORD IS STANDARD                                     00002200
002210     BLOCK CONTAINS 0 RECORDS.                                    00002210
002220 01  BQVFAZ2                        PIC X(071).                   00002220
002230                                                                  00002230
002240 FD  BQVFRE                                                       00002240
002250     LABEL RECORD IS STANDARD                                     00002250
002260     BLOCK CONTAINS 0 RECORDS.                                    00002260
002270 01  BQVFRE2                        PIC X(043).                   00002270
002280                                                                  00002280
002290 FD  BQVFPR                                                       00002290
002300     LABEL RECORD IS STANDARD                                     00002300
002310     BLOCK CONTAINS 0 RECORDS.                                    00002310
002320 01  BQVFPR2                        PIC X(042).                   00002320
002330                                                                  00002330
002340 FD  BQVFTR                                                       00002340
002350     LABEL RECORD IS STANDARD                                     00002350
002360     BLOCK CONTAINS 0 RECORDS.                                    00002360
002370 01  BQVFTR2                        PIC X(127).                   00002370
002380 FD  BQVFTE                                                       00002380
002390     LABEL RECORD IS STANDARD                                     00002390
002400     BLOCK CONTAINS 0 RECORDS.                                    00002400
002410 01  BQVFTE2                        PIC X(54).                    00002410
002420                                                                  00002420
002430 FD  BQVFMA                                                       00002430
002440     LABEL RECORD IS STANDARD                                     00002440
002450     BLOCK CONTAINS 0 RECORDS.                                    00002450
002460 01  BQVFMA2                        PIC X(084).                   00002460
002470                                                                  00002470
002480 FD  BQVFSE                                                       00002480
002490     LABEL RECORD IS STANDARD                                     00002490
002500     BLOCK CONTAINS 0 RECORDS.                                    00002500
002510 01  BQVFSE2                        PIC X(070).                   00002510
002520 FD  BQVFEL                                                       00002520
002530     LABEL RECORD IS STANDARD                                     00002530
002540     BLOCK CONTAINS 0 RECORDS.                                    00002540
002550 01  BQVFEL2                        PIC X(070).                   00002550
002560 FD  BQVFIN                                                       00002560
002570     LABEL RECORD IS STANDARD                                     00002570
002580     BLOCK CONTAINS 0 RECORDS.                                    00002580
002590 01  BQVFIN2                        PIC X(073).                   00002590
002600 FD  BQVFAE                                                       00002600
002610     LABEL RECORD IS STANDARD                                     00002610
002620     BLOCK CONTAINS 0 RECORDS.                                    00002620
002630 01  BQVFAE2                        PIC X(125).                   00002630
002640 FD  BQVFCA                                                       00002640
002650     LABEL RECORD IS STANDARD                                     00002650
002660     BLOCK CONTAINS 0 RECORDS.                                    00002660
002670 01  BQVFCA2                        PIC X(087).                   00002670
002680 FD  BQVFT3                                                       00002680
002690     LABEL RECORD IS STANDARD                                     00002690
002700     BLOCK CONTAINS 0 RECORDS.                                    00002700
002710 01  BQVFT32                        PIC X(022).                   00002710
002720 FD  BQVFIC                                                       00002720
002730     LABEL RECORD IS STANDARD                                     00002730
002740     BLOCK CONTAINS 0 RECORDS.                                    00002740
002750 01  BQVFIC2                        PIC X(035).                   00002750
002760 FD  BQVFUF                                                       00002760
002770     LABEL RECORD IS STANDARD                                     00002770
002780     BLOCK CONTAINS 0 RECORDS.                                    00002780
002790 01  BQVFUF2                        PIC X(059).                   00002790
002800                                                                  00002800
002810*FD  BQVFCM                                                       00002810
002820*    LABEL RECORD IS STANDARD                                     00002820
002830*    BLOCK CONTAINS 0 RECORDS.                                    00002830
002840*01  BQVFCM2                        PIC X(070).                   00002840
002850 FD  BQVFTC                                                       00002850
002860     LABEL RECORD IS STANDARD                                     00002860
002870     BLOCK CONTAINS 0 RECORDS.                                    00002870
002880 01  BQVFTC2                        PIC X(094).                   00002880
002890 FD  BQVFCI                                                       00002890
002900     LABEL RECORD IS STANDARD                                     00002900
002910     BLOCK CONTAINS 0 RECORDS.                                    00002910
002920 01  BQVFCI2                        PIC X(018).                   00002920
002930                                                                  00002930
002940 FD  BQVFCV                                                       00002940
002950     LABEL RECORD IS STANDARD                                     00002950
002960     BLOCK CONTAINS 0 RECORDS.                                    00002960
002970 01  BQVFCV2                        PIC X(017).                   00002970
002980                                                                  00002980
002990 FD  BQVFPC                                                       00002990
003000     LABEL RECORD IS STANDARD                                     00003000
003010     BLOCK CONTAINS 0 RECORDS.                                    00003010
003020 01  BQVFPC2                        PIC X(038).                   00003020
003030                                                                  00003030
003040 FD  BQVFCB                                                       00003040
003050     LABEL RECORD IS STANDARD                                     00003050
003060     BLOCK CONTAINS 0 RECORDS.                                    00003060
003070 01  BQVFCB2                        PIC X(032).                   00003070
003080                                                                  00003080
003090 FD  BQVFCC                                                       00003090
003100     LABEL RECORD IS STANDARD                                     00003100
003110     BLOCK CONTAINS 0 RECORDS.                                    00003110
003120 01  BQVFCC2                        PIC X(050).                   00003120
003130                                                                  00003130
003140******************************************************************00003140
003150*                       WORKING                                  *00003150
003160******************************************************************00003160
003170 WORKING-STORAGE SECTION.                                         00003170
003180                                                                  00003180
003190 77  ABEND-CODE                     PIC 9(004) VALUE ZERO.        00003190
003200*** MODIFICA PER CALCOLO TOTALE RECORD                            00003200
003210 77  W-FLAG-NUMREC                  PIC 9(001) VALUE ZERO.        00003210
003220*** MODIFICA PER CAMERE DI COMMERCIO                              00003220
003230 01  W-COD-TRIB                     PIC X(4).                     00003230
003240 01  W-DATA-RISC                    PIC X(8).                     00003240
003250 01  W-TIPO-TRIBUTO                 PIC X(1).                     00003250
003260*                                                                 00003260
003270 77  W-FLAG-BANCA                   PIC X(001) VALUE 'B'.         00003270
003280*77  W-APPO-DATA-AVVIO              PIC X(008) VALUE '20000501'.  00003280
003290 77  W-APPO-DATA-AVVIO              PIC X(008) VALUE '20000101'.  00003290
003300 77  W-NUMMAX-V01                   PIC 9(002) VALUE 9.           00003300
003310 77  W-NUMMAX-V02                   PIC 9(002) VALUE 4.           00003310
003320 77  W-NUMMAX-V03                   PIC 9(002) VALUE 4.           00003320
003330 77  W-NUMMAX-V04                   PIC 9(002) VALUE 3.           00003330
003340 77  W-NUMMAX-V05                   PIC 9(002) VALUE 3.           00003340
003350 77  W-NUMMAX-V06                   PIC 9(002) VALUE 3.           00003350
003360 77  W-NUMMAX-V07                   PIC 9(002) VALUE 8.           00003360
003370 77  W-NUMMAX-V20                   PIC 9(002) VALUE 1.           00003370
003380*--- NUMERO MASSIMO DI RIGHE IN PRESENZA DI ICI                   00003380
003390 77  W-NUMMAX-V01-ICI               PIC 9(002) VALUE 6.           00003390
003400 77  W-NUMMAX-V04-ICI               PIC 9(002) VALUE 4.           00003400
003410 77  W-NUMMAX-V06-ICI               PIC 9(002) VALUE 2.           00003410
003420 77  W-NUMMAX-F24S                  PIC 9(002) VALUE 10.          00003420
003430 77  W-NUMMAX-IMU-POSTE             PIC 9(002) VALUE 8.           00003430
003440 77  W-NUMMAX-TARES-POSTE           PIC 9(002) VALUE 3.           00003440
003450 77  W-NUMMAX-TASI-POSTE            PIC 9(002) VALUE 4.           00003450
003460 77  W-NUMMAX-V12                   PIC 9(002) VALUE 28.          00003460
003470*---                                                              00003470
003480 77  W-GIORNI-DIFF                  PIC S9(04) VALUE -5.          00003480
003490** FILE STATUS DI BQVFBS                                          00003490
003500 77  BQVFBS-STATUS               PIC X(2).                        00003500
003510** CODICE AMBITO LETTO DAL FILE                                   00003510
003520 77  W-AMBITO-INP                PIC X(3).                        00003520
003530 77  W-AMBITO-INP-N REDEFINES W-AMBITO-INP PIC 9(3).              00003530
003540** CODICE REGIONE LETTO DAL FILE                                  00003540
003550 77  W-REGIONE-INP               PIC X(2).                        00003550
003560** CODICE PROVINCIA LETTA DAL FILE                                00003560
003570 77  W-PROV-INP                  PIC X(2).                        00003570
003580** CODICE AZIENDA LETTA DAL FILE                                  00003580
003590 77  W-AZIENDA-INP               PIC X(5).                        00003590
003600** CODICE ENTE LOCALE LETTO DAL FILE                              00003600
003610 77  W-ENTE-INP                  PIC X(4).                        00003610
003620** CODICE ALTRO ENTE LETTO DAL FILE                               00003620
003630 77  W-ALTRO-INP                 PIC X(4).                        00003630
003640 77  W-FF                        PIC X(2).                        00003640
003650** FLAG UTILIZZATI NEL CORSO DELLA ELABORAZIONE:                  00003650
003660** W-FLG-ERR-BLOC-37 = 0 INDICA CHE SUL PRIMO RECORD V37 DEL FILE 00003660
003670** LOGICO NON E' STATO TROVATO ALCUN ERRORE BLOCCANTE. PERTANTO SE00003670
003680** NE VIENE RILEVATO UNO IN FASE DI QUADRATURA PUO' ESSERE INCRE- 00003680
003690** MENTATO IL CONTATORE DI RECORD ERRATI                          00003690
003700 77  W-FLG-ERR-BLOC-37           PIC 9(1).                        00003700
003710 77  W-FLG-ERR-NO-BLOC-37        PIC 9(1).                        00003710
003720** W-FLG-ERR-BLOC-38 = 0 INDICA CHE SUL PRIMO RECORD V38 DEL FILE 00003720
003730** LOGICO NON E' STATO TROVATO ALCUN ERRORE BLOCCANTE. PERTANTO SE00003730
003740** NE VIENE RILEVATO UNO IN FASE DI QUADRATURA PUO' ESSERE INCRE- 00003740
003750** MENTATO IL CONTATORE DI RECORD ERRATI                          00003750
003760 77  W-FLG-ERR-BLOC-38           PIC 9(1).                        00003760
003770 77  W-FLG-ERR-NO-BLOC-38        PIC 9(1).                        00003770
003780*---                                                              00003780
003790*---                                                              00003790
003800*--- MODIFICHE MAGGIO 2001                                        00003800
003810*---                                                              00003810
003820 77  W-COMMISSIONI                  PIC 9(012).                   00003820
003830 77  W-COMMISS-ARROT                PIC 9(012)V999.               00003830
003840 77  W-COMM-MIN                     PIC 9(006)V999.               00003840
003850 77  W-COMM-MAX                     PIC 9(006)V999.               00003850
003860*---                                                              00003860
003870 77  W-IMP-CRED-MAX1                PIC 9(015).                   00003870
003880 77  W-IMP-CRED-MAX2                PIC 9(015).                   00003880
003890*---                                                              00003890
003900 01  W-COMM-CALC-NEW                PIC 9(15).                    00003900
003910*---                                                              00003910
003920*---                                                              00003920
003930*--- PARAMETRI PER CHIAMATE A BQVFE7, BQVFB6                      00003930
003940*---                                                              00003940
003950 01  W-UFF-RIF                  PIC X(03).                        00003950
003960 01  W-NUM-RIF                  PIC X(11).                        00003960
003970 01  W-NUM-RIF-04               PIC X(18).                        00003970
003980 01  W-COD-NUM-RIF              PIC X(01).                        00003980
003990 01  W-V20                      PIC X(01).                        00003990
004000 01  W-COD-FISC-KO              PIC X(01).                        00004000
004010 01  W-UFF-RIF-M                PIC X(03).                        00004010
004020 01  W-NUM-RIF-M                PIC X(11).                        00004020
004030 01  W-COD-FISC-KO-M            PIC X(01).                        00004030
004040 01  W-UFF-RIF-ERARIO           PIC X(01).                        00004040
004050 01  W-NUM-RIF-ERARIO           PIC X(01).                        00004050
004060*---                                                              00004060
004070*---                                                              00004070
004080*--- CAMPO DI APPOGIO PER LA GESTIONE DEL RECORD V20              00004080
004090*---                                                              00004090
004100 01  W-APPO-COD-CAB             PIC X(05).                        00004100
004110*---                                                              00004110
004120*--- INTERNET                                                     00004120
004130*---                                                              00004130
004140 01  W-APPO-ESITO-PAGAM         PIC X(01).                        00004140
004150*---                                                              00004150
004160*** MODIFICA CONTRIBUTO UNIFICATO                                 00004160
004170*01  W-APPO-NUM-RIF.                                              00004170
004180***  03  FILLER                 PIC X(9).                         00004180
004190***  03  W-APPO-SETTORE         PIC X(1).                         00004190
004200 01  W-APPO-NUM-RIF.                                              00004200
004210     03  W-APPO-PRIMA-CIFRA         PIC 9(1).                     00004210
004220     03  FILLER                     PIC X(8).                     00004220
004230     03  W-APPO-SETTORE             PIC X(1).                     00004230
004240     03  FILLER                     PIC X(1).                     00004240
004250*** FINE MODIFICA CONTRIBUTO UNIFICATO                            00004250
004260*---                                                              00004260
004270** CAMPI PER LA GESTIONE DELLE SQUADRATURE                        00004270
004280 01  W-IND-S                     PIC 9(3).                        00004280
004290 01  W-FLAG-SQUADR               PIC 9(1).                        00004290
004300 01  W-NUM-SQUADR                PIC 9(3).                        00004300
004310 01  W-DATI-SQUADR               PIC X(74).                       00004310
004320* NEL DETTAGLIO:                                                  00004320
004330*    PROV                  PIC X(002).                            00004330
004340*    SALDO-TOT-DICH        PIC 9(015) COMP-3.                     00004340
004350*    SALDO-TOT-CALC        PIC 9(015) COMP-3.                     00004350
004360*    SALDO-ER-DICH         PIC S9(015) COMP-3.                    00004360
004370*    SALDO-ER-CALC         PIC S9(015) COMP-3.                    00004370
004380*    SALDO-NO-ER-DICH      PIC S9(015) COMP-3.                    00004380
004390*    SALDO-NO-ER-CALC      PIC S9(015) COMP-3.                    00004390
004400*    DELEGHE-ER-DICH       PIC  9(006) COMP-3.                    00004400
004410*    DELEGHE-ER-CALC       PIC  9(006) COMP-3.                    00004410
004420*    DELEGHE-NO-ER-DICH    PIC  9(006) COMP-3.                    00004420
004430*    DELEGHE-NO-ER-CALC    PIC  9(006) COMP-3.                    00004430
004440*---                                                              00004440
004450*--- PARAMETRI PER LA CHIAMATA A BQVFB7                           00004450
004460*---                                                              00004460
004470 01  W-ALTRI-PARAM.                                               00004470
004480     03  W-FLAG-NO-QUAD             PIC 9(01).                    00004480
004490     03  W-COMM-RES                 PIC 9(15).                    00004490
004500     03  W-ACCR-CALC                PIC 9(15).                    00004500
004510     03  W-COMM-CALC                PIC 9(15).                    00004510
004520     03  W-ACCR-BON-COMP            PIC 9(15).                    00004520
004530     03  W-ACCR-BON-COMP-CALC       PIC 9(15).                    00004530
004540     03  W-TOT-COMP                 PIC 9(02).                    00004540
004550     03  W-TOT-COMP-CALC            PIC 9(02).                    00004550
004560     03  W-PRES-ACCR                PIC 9(01).                    00004560
004570*---                                                              00004570
004580*--- CAMPI DI APPOGGIO PER DATE                                   00004580
004590*---                                                              00004590
004600 01  W-DATA-SYS                     PIC X(06).                    00004600
004610 01  W-RED-DATA-SYS REDEFINES W-DATA-SYS.                         00004610
004620     03  W-RED-AA-SYS               PIC X(02).                    00004620
004630     03  W-RED-MM-SYS               PIC X(02).                    00004630
004640     03  W-RED-GG-SYS               PIC X(02).                    00004640
004650 01  W-APPO-DATA-SYS.                                             00004650
004660     03  W-APPO-SEC-SYS             PIC X(02).                    00004660
004670     03  W-APPO-AA-SYS              PIC X(02).                    00004670
004680     03  W-APPO-MM-SYS              PIC X(02).                    00004680
004690     03  W-APPO-GG-SYS              PIC X(02).                    00004690
004700 01  W-CTR-DELEGA                   PIC 9(09).                    00004700
004710 01  W-FLAG-AGEV                    PIC X(01).                    00004710
004720 01  W-SALDO-AGEV                   PIC 9(15).                    00004720
004730 01  W-ABI-CNC                      PIC X(05) VALUE '12936'.      00004730
004740*--    VERSIONE MODELLO F24: PUO' VALERE 'R03' O 'R04', INTRODOTTO00004740
004750*--    PER GESTIRE L'ICI E L'ANTICIPO SUL BONIFICO                00004750
004760 01  W-VERS                         PIC X(003).                   00004760
004770 01  W-ICI                          PIC X(002).                   00004770
004780 01  W-V12                          PIC X(002).                   00004780
004790 01  W-IND-ICI                      PIC 9(002).                   00004790
004800 01  W-TAB-COMUNI.                                                00004800
004810     03  W-ELEM-COMUNI   OCCURS 10.                               00004810
004820         05  W-COD-CATAST           PIC X(004).                   00004820
004830         05  W-PAGAM-ICI            PIC 9(015).                   00004830
004840         05  W-RIMB-ICI             PIC 9(015).                   00004840
004850         05  W-TIPO-TRIB            PIC X(001).                   00004850
004860*--- IMPORTO A CREDITO TRIBUTO 3900                               00004860
004870 01  W-TOT-RIMB-TRIB                PIC 9(015).                   00004870
004880*--- IMU BOLLETTINI POSTE                                         00004880
004890 01  W-TIPO-TRIB-NO-IMU             PIC X(001).                   00004890
004900 01  W-TIPO-TRIB-NO-TARES           PIC X(001).                   00004900
004910 01  W-TIPO-TRIB-NO-TASI            PIC X(001).                   00004910
004920*--    DATA ANTICIPO                                              00004920
004930 01  W-DATA-ANTIC                   PIC X(008).                   00004930
004940*--    ANTICIPO CALCOLATO                                         00004940
004950 01  W-ANTIC-CALC                   PIC S9(015) VALUE ZERO.       00004950
004960*--    ANTICIPO I24 CALCOLATO                                     00004960
004970 01  W-ANTIC-I24-CALC               PIC S9(015) VALUE ZERO.       00004970
004980*---                                                              00004980
004990*---   CONTROLLO COMPENSAZIONI                                    00004990
005000 01  W-FLAG-RIF-V-T                PIC X(001).                    00005000
005010 01  W-FLAG-RIF-V-A                PIC X(001).                    00005010
005020 01  W-TOT-IMP-CRED-CONTR-V        PIC S9(015).                   00005020
005030*                                                                 00005030
005040 01  W-FLAG-RIF-I-T                PIC X(001).                    00005040
005050 01  W-FLAG-RIF-I-A                PIC X(001).                    00005050
005060 01  W-TOT-IMP-CRED-CONTR-I        PIC S9(015).                   00005060
005070*                                                                 00005070
005080 01  W-FLAG-RIF-R-T                PIC X(001).                    00005080
005090 01  W-FLAG-RIF-R-A                PIC X(001).                    00005090
005100 01  W-TOT-IMP-CRED-CONTR-R        PIC S9(015).                   00005100
005110*                                                                 00005110
005120 01  W-FLAG-RIF-M-T                PIC X(001).                    00005120
005130 01  W-FLAG-RIF-M-A                PIC X(001).                    00005130
005140 01  W-TOT-IMP-CRED-CONTR-M        PIC S9(015).                   00005140
005150*                                                                 00005150
005160 01  W-FLAG-RIF-E-T                PIC X(001).                    00005160
005170 01  W-FLAG-RIF-E-A                PIC X(001).                    00005170
005180 01  W-TOT-IMP-CRED-CONTR-E        PIC S9(015).                   00005180
005190*                                                                 00005190
005200 01  W-FLAG-RIF-IRF-T              PIC X(001).                    00005200
005210 01  W-FLAG-RIF-IRF-A              PIC X(001).                    00005210
005220 01  W-TOT-IMP-CRED-CONTR-IRF      PIC S9(015) VALUE ZERO.        00005220
005230*                                                                 00005230
005240 01  W-FLAG-RIF-ADX-T              PIC X(001).                    00005240
005250 01  W-FLAG-RIF-ADX-A              PIC X(001).                    00005250
005260 01  W-TOT-IMP-CRED-CONTR-ADX      PIC S9(015) VALUE ZERO.        00005260
005270*                                                                 00005270
005280 01  W-FLAG-RIF-IIE-T              PIC X(001).                    00005280
005290 01  W-FLAG-RIF-IIE-A              PIC X(001).                    00005290
005300 01  W-TOT-IMP-CRED-CONTR-IIE      PIC S9(015) VALUE ZERO.        00005300
005310*                                                                 00005310
005320 01  W-FLAG-RIF-IFE-T              PIC X(001).                    00005320
005330 01  W-FLAG-RIF-IFE-A              PIC X(001).                    00005330
005340 01  W-TOT-IMP-CRED-CONTR-IFE      PIC S9(015) VALUE ZERO.        00005340
005350*                                                                 00005350
005360 01  W-FLAG-RIF-FF1-T              PIC X(001).                    00005360
005370 01  W-FLAG-RIF-FF1-A              PIC X(001).                    00005370
005380 01  W-TOT-IMP-CRED-CONTR-FF1      PIC S9(015) VALUE ZERO.        00005380
005390*                                                                 00005390
005400 01  W-FLAG-RIF-FF2-T              PIC X(001).                    00005400
005410 01  W-FLAG-RIF-FF2-A              PIC X(001).                    00005410
005420 01  W-TOT-IMP-CRED-CONTR-FF2      PIC S9(015) VALUE ZERO.        00005420
005430*                                                                 00005430
005440 01  W-FLAG-RIF-FF3-T              PIC X(001).                    00005440
005450 01  W-FLAG-RIF-FF3-A              PIC X(001).                    00005450
005460 01  W-TOT-IMP-CRED-CONTR-FF3      PIC S9(015) VALUE ZERO.        00005460
005470*                                                                 00005470
005480 01  W-FLAG-RIF-ORO-T              PIC X(001).                    00005480
005490 01  W-FLAG-RIF-ORO-A              PIC X(001).                    00005490
005500 01  W-TOT-IMP-CRED-CONTR-ORO      PIC S9(015) VALUE ZERO.        00005500
005510*                                                                 00005510
005520 01  W-FLAG-RIF-SEC-T              PIC X(001).                    00005520
005530 01  W-FLAG-RIF-SEC-A              PIC X(001).                    00005530
005540 01  W-TOT-IMP-CRED-CONTR-SEC      PIC S9(015) VALUE ZERO.        00005540
005550*                                                                 00005550
005560 01  W-FLAG-RIF-IEC-T              PIC X(001).                    00005560
005570 01  W-FLAG-RIF-IEC-A              PIC X(001).                    00005570
005580 01  W-TOT-IMP-CRED-CONTR-IEC      PIC S9(015) VALUE ZERO.        00005580
005590*                                                                 00005590
005600 01  W-FLAG-RIF-LEZ-T              PIC X(001).                    00005600
005610 01  W-FLAG-RIF-LEZ-A              PIC X(001).                    00005610
005620 01  W-TOT-IMP-CRED-CONTR-LEZ      PIC S9(015) VALUE ZERO.        00005620
005630*                                                                 00005630
005640 01  W-FLAG-RIF-QR1-T              PIC X(001).                    00005640
005650 01  W-FLAG-RIF-QR1-A              PIC X(001).                    00005650
005660 01  W-TOT-IMP-CRED-CONTR-QR1      PIC S9(015) VALUE ZERO.        00005660
005670*                                                                 00005670
005671 01  W-FLAG-RIF-BTC-T              PIC X(001).                    00005671
005672 01  W-FLAG-RIF-BTC-A              PIC X(001).                    00005672
005673 01  W-TOT-IMP-CRED-CONTR-BTC      PIC S9(015) VALUE ZERO.        00005673
005674*                                                                 00005674
005680*                                                                 00005680
005690 01  W-FLAG-RIF-C                  PIC X(001).                    00005690
005700 01  W-FLAG-RIF-T-AA-MIN           PIC X(001).                    00005700
005710 01  W-FLAG-RIF-A-AA-MIN           PIC X(001).                    00005710
005720*--- CONFERIMENTO F24 I24                                         00005720
005730 01  W-FLAG-CONF-F24                PIC X(001).                   00005730
005740 01  W-FLAG-CONF-I24                PIC X(001).                   00005740
005750*---                                                              00005750
005760 01  W-FLAG-TRIB-CONC              PIC X(001).                    00005760
005770 01  W-FLAG-CRED                   PIC X(001).                    00005770
005780 01  W-FLAG-COMP-IVA               PIC X(001).                    00005780
005790 01  W-FLAG-COMP-IRS               PIC X(001).                    00005790
005800 01  W-FLAG-COMP-IRP               PIC X(001).                    00005800
005810 01  W-FLAG-COMP-IRM               PIC X(001).                    00005810
005820 01  W-FLAG-COMP-ELO               PIC X(001).                    00005820
005830 01  W-FLAG-COMP-IRF               PIC X(001).                    00005830
005840 01  W-FLAG-COMP-ADX               PIC X(001).                    00005840
005850 01  W-FLAG-COMP-IIE               PIC X(001).                    00005850
005860 01  W-FLAG-COMP-IFE               PIC X(001).                    00005860
005870 01  W-FLAG-COMP-FF1               PIC X(001).                    00005870
005880 01  W-FLAG-COMP-FF2               PIC X(001).                    00005880
005890 01  W-FLAG-COMP-FF3               PIC X(001).                    00005890
005900 01  W-FLAG-COMP-ORO               PIC X(001).                    00005900
005910 01  W-FLAG-COMP-SEC               PIC X(001).                    00005910
005920 01  W-FLAG-COMP-IEC               PIC X(001).                    00005920
005930 01  W-FLAG-COMP-LEZ               PIC X(001).                    00005930
005940 01  W-FLAG-COMP-QR1               PIC X(001).                    00005940
005941 01  W-FLAG-COMP-BTC               PIC X(001).                    00005941
005950*---                                                              00005950
005960*--- CAMPO DI APPOGGIO PER IL CONTROLLO DEL TIPO RECORD           00005960
005970*---                                                              00005970
005980 01  W-APPO-TIPO-REC.                                             00005980
005990     03  W-APPO-TIPO-REC-1          PIC X(01).                    00005990
006000     03  W-APPO-TIPO-REC-2          PIC X(02).                    00006000
006010*---                                                              00006010
006020*--- CAMPO DI APPOGGIO PER IL CONTROLLO DEL TIPO RECORD           00006020
006030*--- PRECEDENTEMENTE TRATTATO                                     00006030
006040*---                                                              00006040
006050 01  W-TIPO-REC-PREC                PIC X(03).                    00006050
006060 01  W-REC-PREC-V20                 PIC X(03).                    00006060
006070*---                                                              00006070
006080*--- CAMPO DI APPOGGIO PER IL CONTROLLO DEL NUMERO DI RECORD      00006080
006090*--- 01, 02 O 03 TRATTATI A LIVELLO DI DELEGA                     00006090
006100*---                                                              00006100
006110 01  W-APPO-CTR                     PIC 9(09).                    00006110
006120 01  W-APPO-36-CTR-01               PIC 9(07).                    00006120
006130 01  W-APPO-36-CTR-02               PIC 9(07).                    00006130
006140 01  W-APPO-36-CTR-03               PIC 9(07).                    00006140
006150 01  W-APPO-36-CTR-04               PIC 9(07).                    00006150
006160 01  W-APPO-36-CTR-05               PIC 9(07).                    00006160
006170 01  W-APPO-36-CTR-06               PIC 9(07).                    00006170
006180 01  W-APPO-36-CTR-07               PIC 9(07).                    00006180
006190 01  W-APPO-36-CTR-12               PIC 9(07).                    00006190
006200 01  W-APPO-36-CTR-20               PIC 9(07).                    00006200
006210*                                                                 00006210
006220*** CONTATORI PER CONTROLLO V36/V49 CONTESTUALI                   00006220
006230*                                                                 00006230
006240 01  W-CONT-V36                     PIC 9(06) VALUE ZERO.         00006240
006250 01  W-CONT-V49                     PIC 9(06) VALUE ZERO.         00006250
006260*                                                                 00006260
006270*---                                                              00006270
006280*--- CAMPO DI APPOGGIO PER LA FINE FILE                           00006280
006290*---                                                              00006290
006300 01  W-FINE-BQVFB1                  PIC 9(01).                    00006300
006310*---                                                              00006310
006320*--- CAMPO DI APPOGGIO PER LA DIVISA OPERAZIONE                   00006320
006330*---                                                              00006330
006340 01  W-DIV                          PIC X(03).                    00006340
006350*---                                                              00006350
006360*--- CAMPI DI APPOGGIO PER PERSONA FISICA O GIURIDICA             00006360
006370*--- ('PF ','PNF')                                                00006370
006380*---                                                              00006380
006390 01  W-PF-PNF                       PIC X(03).                    00006390
006400 01  W-APPO-PF-PNF                  PIC X(03).                    00006400
006410*---                                                              00006410
006420*--- CAMPO DI APPOGGIO PER IMPOSTAZIONE INDICE RELATIVO           00006420
006430*--- A PRIMA O SECONDA REGIONE DA PASSARE ALLA ROUTINE            00006430
006440*--- BQVFB1                                                       00006440
006450*---                                                              00006450
006460 01  W-REG                          PIC 9(01).                    00006460
006470*---                                                              00006470
006480*--- CAMPO DI APPOGGIO PER NUMERO MASSIMO DI RIGHE PER            00006480
006490*--- TIPO RECORD V01, V02, V03, V04, V05, V06, V07,               00006490
006500*---             V14, V15 O V36                                   00006500
006510*---                                                              00006510
006520 01  W-PROG-RIGA                    PIC 9(02).                    00006520
006530*---                                                              00006530
006540*--- CAMPO DI APPOGGIO PER INDICE TABELLA ACCREDITAMENTI          00006540
006550*---                                                              00006550
006560 01  W-IND                          PIC 9(02).                    00006560
006570 01  W-IND-MAX                      PIC 9(02).                    00006570
006580*---                                                              00006580
006590*--- CAMPO DI APPOGGIO PER INDICE TABELLA SALDI PER               00006590
006600*--- IMPOSTAZIONE PRIMA VOLTA ELEMENTO DI TABELLA                 00006600
006610*---                                                              00006610
006620 01  W-S                            PIC 9(03).                    00006620
006630*---                                                              00006630
006640*--- CAMPO DI APPOGGIO PER INDICE TABELLA PROVINCE                00006640
006650*--- DI APPOGGIO                                                  00006650
006660*---                                                              00006660
006670 01  W-P                            PIC 9(03).                    00006670
006680*---                                                              00006680
006690*--- CAMPO DI APPOGGIO PER MEMORIZZAZIONE SIGLA PROVINCIA         00006690
006700*--- TRATTATA SU TABELLA SALDI                                    00006700
006710*---                                                              00006710
006720 01  W-MEM-PROV                     PIC X(02).                    00006720
006730*---                                                              00006730
006740*---                                                              00006740
006750*--- CAMPO DI APPOGGIO PER INDICARE IL TIPO DI CHIAMATA           00006750
006760*--- ALLA ROUTINE BQVFB7:                                         00006760
006770*--- Q = CONTROLLO QUADRATURE, ' ' = CONTROLLO RECORD V37         00006770
006780*---                                                              00006780
006790 01  W-TIPO-CHIAMATA                PIC X(01).                    00006790
006800*---                                                              00006800
006810*--- CAMPO DI APPOGGIO PER CONTROLLO PROGRESSIVO ACCRED./BONIF.   00006810
006820*---                                                              00006820
006830 01  W-PROG-ACCR-BON                PIC 9(09).                    00006830
006840*---                                                              00006840
006850*--- CAMPO DI APPOGGIO PER CONTROLLO PRESENZA DELLA PROVINCIA     00006850
006860*--- SU TABELLA SALDI                                             00006860
006870*---                                                              00006870
006880 01  W-CTR-ACCR-BON                 PIC 9(01).                    00006880
006890*---                                                              00006890
006900*--- CAMPO DI APPOGGIO PER TOTALIZZAZIONE RECORD TRATTATI         00006900
006910*---                                                              00006910
006920 01  W-TOT-REC                      PIC 9(09).                    00006920
006930*---                                                              00006930
006940*--- CAMPO DI APPOGGIO PER IL CALCOLO DEI CAMPI TRATTATI ERRATI:  00006940
006950*--- NUMERO ERRORI BLOCCANTI + NUMERO ERRORI NON BLOCCANTI        00006950
006960*---                                                              00006960
006970 01  W-TOT-ERR                      PIC 9(09).                    00006970
006980*---                                                              00006980
006990*--- NUMERO RECORD SCARTATI PER ERRORE KO                         00006990
007000*---                                                              00007000
007010 01  W-CTR-REC-KO                   PIC 9(09).                    00007010
007020*---                                                              00007020
007030*--- FLAG                                                         00007030
007040*---                                                              00007040
007050 01  W-FLAG.                                                      00007050
007060*--- FLAG INDICANTE ERRORE SU CODICE FISCALE CON RELATIVO         00007060
007070*--- FLAG ERRORE IMPOSTATO A '0'                                  00007070
007080     03  W-FLAG-E                   PIC 9(01).                    00007080
007090*--- FLAG PER INIZIALIZZAZIONE DATI RELATIVI ALLA DELEGA          00007090
007100*--- DA PARTE DEL PRIMO RECORD TRATTATO TRA V01, V02 E V03        00007100
007110     03  W-FLAG-NUOVA-DELEGA        PIC 9(01).                    00007110
007120*--- FLAG PER GESTIONE SEARCH                                     00007120
007130     03  W-FLAG-TROVATO             PIC 9(01).                    00007130
007140*--- FLAG PER SEGNALAZIONE ERRORE KO (INSERT SU INVII KO          00007140
007150*--- E SCRITTURA FILE ESITI + LETTURA NUOVO RECORD FINO           00007150
007160*--- A QUANDO E' V00)                                             00007160
007170     03  W-FLAG-KO                  PIC 9(01).                    00007170
007180*--- FLAG PER SEGNALAZIONE ERRORE TIPO RECORD                     00007180
007190     03  W-FLAG-ERR                 PIC 9(01).                    00007190
007200*--- FLAG PER SEGNALAZIONE ERRORE E GESTIONE OMOGENEITA' TRA      00007200
007210*--- CAMPI (REG, CONC. E CF) E RISPETTIVI FLAG ERRORE             00007210
007220     03  W-FLAG-ERR1                PIC 9(01).                    00007220
007230     03  W-FLAG-OK                  PIC 9(01).                    00007230
007240     03  W-FLAG-OK2                 PIC 9(01).                    00007240
007250     03  W-APPO-FLAG-OK2            PIC 9(01).                    00007250
007260*--- FLAG PER SEGNALAZIONE ERRORE DI SEQUENZA TIPO RECORD         00007260
007270     03  W-FLAG-ERR-SEQ             PIC 9(01).                    00007270
007280*--- FLAG PER SEGNALAZIONE ERRORE PER NUOVA DELEGA                00007280
007290     03  W-FLAG-ERR-DELEGA          PIC 9(01).                    00007290
007300*--- FLAG PER SEGNALAZIONE TRATTAMENTO RECORD V37                 00007300
007310     03  W-FLAG-37                  PIC 9(01).                    00007310
007320*--- FLAG PER SEGNALAZIONE DI ERRORE SU REC SUCC                  00007320
007330*--- IN RG-010-QUADR                                              00007330
007340     03  W-FLAG-ERR-SUCC            PIC 9(01).                    00007340
007350*--- FLAG PER SEGNALAZIONE IMPOSTAZIONE ERRORE DI SEQ.            00007350
007360     03  W-FLAG-REC-ERR             PIC 9(01).                    00007360
007370*--- FLAG PER SEGNALAZIONE SALTO CALL ALLA ROUTINE DI             00007370
007380*--- CONTROLLO DEL CHECK DIGIT DEL CF                             00007380
007390     03  W-FLAG-NO-BQVFB3           PIC 9(01).                    00007390
007400*---                                                              00007400
007410*--- CONTATORI                                                    00007410
007420*---                                                              00007420
007430 01  W-CTR.                                                       00007430
007440     03  W-CTR-DISP                     PIC Z(08)9.               00007440
007450     03  W-CTR-APP                      PIC 9(09).                00007450
007460     03  W-CTR-FLUSSI                   PIC 9(04).                00007460
007470     03  W-CTR-LETTI                    PIC 9(09).                00007470
007480     03  W-CTR-SCRITTI                  PIC 9(09).                00007480
007490     03  W-CTR-TOT-NO-BLOC              PIC 9(09).                00007490
007500     03  W-CTR-TOT-BLOC                 PIC 9(09).                00007500
007510     03  W-CTR-SCR-INVII                PIC 9(09).                00007510
007520     03  W-CTR-SCR-SQUADR               PIC 9(09).                00007520
007530     03  W-CTR-TOT                      PIC 9(09).                00007530
007540     03  W-CTR-PROV-DIST                PIC 9(03).                00007540
007550     03  W-CTR-REC.                                               00007550
007560         05  W-CTR-00                   PIC 9(09).                00007560
007570         05  W-CTR-01                   PIC 9(09).                00007570
007580         05  W-MEM-36-CTR-01            PIC 9(09).                00007580
007590         05  W-CTR-02                   PIC 9(09).                00007590
007600         05  W-MEM-36-CTR-02            PIC 9(09).                00007600
007610         05  W-CTR-03                   PIC 9(09).                00007610
007620         05  W-MEM-36-CTR-03            PIC 9(09).                00007620
007630         05  W-CTR-04                   PIC 9(09).                00007630
007640         05  W-MEM-36-CTR-04            PIC 9(09).                00007640
007650         05  W-CTR-05                   PIC 9(09).                00007650
007660         05  W-MEM-36-CTR-05            PIC 9(09).                00007660
007670         05  W-CTR-06                   PIC 9(09).                00007670
007680         05  W-MEM-36-CTR-06            PIC 9(09).                00007680
007690         05  W-CTR-07                   PIC 9(09).                00007690
007700         05  W-MEM-36-CTR-07            PIC 9(09).                00007700
007710         05  W-CTR-12                   PIC 9(09).                00007710
007720         05  W-MEM-36-CTR-12            PIC 9(09).                00007720
007730         05  W-CTR-14                   PIC 9(09).                00007730
007740         05  W-CTR-15                   PIC 9(09).                00007740
007750         05  W-CTR-20                   PIC 9(09).                00007750
007760         05  W-CTR-36                   PIC 9(09).                00007760
007770         05  W-CTR-37                   PIC 9(09).                00007770
007780         05  W-CTR-38                   PIC 9(09).                00007780
007790         05  W-CTR-49                   PIC 9(09).                00007790
007800         05  W-CTR-99                   PIC 9(09).                00007800
007810         05  W-CTR-REC-ERR              PIC 9(09).                00007810
007820         05  W-CTR-NO-BLOC              PIC 9(09).                00007820
007830         05  W-CTR-BLOC                 PIC 9(09).                00007830
007840         05  W-APPO-CTR-NO-BLOC         PIC 9(09).                00007840
007850         05  W-APPO-CTR-BLOC            PIC 9(09).                00007850
007860         05  W-TOT-REC-ERR              PIC 9(09).                00007860
007870         05  W-TOT-REC-ERR-BLOC         PIC 9(09).                00007870
007880*---                                                              00007880
007890*--- CAMPI DI APPOGGIO PER DATI COMUNI DA INIZIALIZZARE           00007890
007900*--- AD OGNI CAMBIO DELEGA A CURA DEL RECORD 00                   00007900
007910*---                                                              00007910
007920 01  W-FLAG-CAMBIO-DELEGA           PIC 9(01).                    00007920
007930 01  W-ERR-DELEGA-PREC              PIC 9(03).                    00007930
007940 01  W-CAMPI-COMUNI.                                              00007940
007950     03  W-MEM-SIGLA-PROV           PIC X(02).                    00007950
007960     03  W-APPO-COD-ABI             PIC 9(05).                    00007960
007970     03  W-APPO-DATA-BON            PIC X(08).                    00007970
007980     03  W-APPO-ERR-PROG-INVIO      PIC 9(03).                    00007980
007990     03  W-APPO-ERR-IDENT-FILE      PIC 9(03).                    00007990
008000     03  W-APPO-ERR-IDENT-FILE-CORR PIC 9(03).                    00008000
008010     03  W-APPO-ERR-DATA-CR-FILE    PIC 9(03).                    00008010
008020     03  W-APPO-ERR-DATA-INVIO-FILE PIC 9(03).                    00008020
008030     03  W-APPO-FLAG-ERR-DATA-INV-F PIC X(01).                    00008030
008040     03  W-APPO-ERR-DIV-OPER        PIC 9(03).                    00008040
008050     03  W-APPO-ERR-ABI-MITT        PIC 9(03).                    00008050
008060     03  W-APPO-ERR-ABI-RICE        PIC 9(03).                    00008060
008070     03  W-APPO-REC-00.                                           00008070
008080         05  FILLER                 PIC X(06).                    00008080
008090         05  W-APPO-PROG-TRASM      PIC 9(02).                    00008090
008100         05  W-APPO-TIPO-INVIO      PIC X(01).                    00008100
008110         05  W-APPO-PROG-INVIO      PIC 9(02).                    00008110
008120         05  W-APPO-IDENT-FILE      PIC X(20).                    00008120
008130         05  W-APPO-IDENT-FILE-CORR PIC X(20).                    00008130
008140         05  W-APPO-DATA-CR-FILE    PIC X(08).                    00008140
008150         05  W-APPO-DATA-INVIO-FILE PIC X(08).                    00008150
008160         05  W-APPO-DIV-OPER        PIC X(03).                    00008160
008170         05  W-APPO-ABI-MITT        PIC X(05).                    00008170
008180         05  W-APPO-ABI-RICE        PIC X(05).                    00008180
008190*--- CAMPI DI APPOGGIO PER DATI COMUNI DA INIZIALIZZARE           00008190
008200*--- AD OGNI CAMBIO DELEGA A CURA DEI RECORD 01,02,03             00008200
008210     03  W-CAMPI-DELEGA.                                          00008210
008220         05  W-FLAG-REC                 PIC 9(02).                00008220
008230         05  W-CTR-RIGA                 PIC 9(03).                00008230
008240         05  W-COD-REG                  PIC 9(02).                00008240
008250         05  W-COD-ENTE                 PIC X(04).                00008250
008260         05  W-COD-ALTRO                PIC X(04).                00008260
008270         05  W-APPO-SIGLA-PROV          PIC X(02).                00008270
008280         05  W-APPO-ERR-SIGLA-PROV      PIC 9(03).                00008280
008290         05  W-APPO-COD-FISC            PIC X(16).                00008290
008300         05  W-APPO-ERR-CF              PIC 9(03).                00008300
008310         05  W-APPO-FLAG-ERR-CF         PIC X.                    00008310
008320         05  W-APPO-ERR-FLAG-ERR-CF     PIC 9(03).                00008320
008330         05  W-APPO-DATA-RISC           PIC X(08).                00008330
008340         05  W-APPO-ERR-DATA-RISC       PIC 9(03).                00008340
008350         05  W-MEM-CTR-01               PIC 9(09).                00008350
008360         05  W-MEM-CTR-02               PIC 9(09).                00008360
008370         05  W-MEM-CTR-03               PIC 9(09).                00008370
008380         05  W-MEM-CTR-04               PIC 9(09).                00008380
008390         05  W-MEM-CTR-05               PIC 9(09).                00008390
008400         05  W-MEM-CTR-06               PIC 9(09).                00008400
008410         05  W-MEM-CTR-07               PIC 9(09).                00008410
008420         05  W-MEM-CTR-12               PIC 9(09).                00008420
008430         05  W-MEM-CTR-20               PIC 9(09).                00008430
008440 01  W-MEM-IDENT-FILE                   PIC X(20).                00008440
008450*---                                                              00008450
008460*--- CAMPI DI APPOGGIO PER IL CODICE FISCALE                      00008460
008470*---                                                              00008470
008480 01  W-APPO-CF.                                                   00008480
008490     03  W-APPO-CF-SX.                                            00008490
008500         05  W-APPO-CF-DENOM.                                     00008500
008510             07 W-APPO-CF-DENOM-L1  PIC X(01).                    00008510
008520             07 W-APPO-CF-DENOM-L2  PIC X(01).                    00008520
008530             07 W-APPO-CF-DENOM-L3  PIC X(01).                    00008530
008540             07 W-APPO-CF-DENOM-L4  PIC X(01).                    00008540
008550             07 W-APPO-CF-DENOM-L5  PIC X(01).                    00008550
008560             07 W-APPO-CF-DENOM-L6  PIC X(01).                    00008560
008570         05  W-APPO-CF-ANNO         PIC X(02).                    00008570
008580         05  W-APPO-CF-MESE         PIC X(01).                    00008580
008590             88  W-APPO-CF-MESE-OK                                00008590
008600                 VALUE 'A' 'B' 'C' 'D' 'E' 'H' 'L'                00008600
008610                       'M' 'P' 'R' 'S' 'T'.                       00008610
008620         05  W-APPO-CF-GIORNO       PIC X(02).                    00008620
008630     03  W-APPO-CF-DX.                                            00008630
008640         05  W-APPO-CF-CATAST       PIC X(01).                    00008640
008650             88  W-COD-FISC-CATAST-OK                             00008650
008660                 VALUE 'A' 'B' 'C' 'D' 'E' 'F' 'G'                00008660
008670                       'H' 'I' 'L' 'M' 'Z'.                       00008670
008680         05  FILLER                 PIC X(04).                    00008680
008690*                                                                 00008690
008700 01  W-CF-CATAST.                                                 00008700
008710     03  FILLER                        PIC X(11).                 00008710
008720     03  W-CATAST.                                                00008720
008730        05  W-CATAST-SOTTO1            PIC X(01).                 00008730
008740        05  W-CATAST-SOTTO2.                                      00008740
008750            07  W-CATAST-SOTTO21       PIC X(01).                 00008750
008760               88  W-CATAST-SOTTO21-OK VALUE                      00008760
008770                   'L' 'M' 'N' 'P'.                               00008770
008771*$ MOD. MANUALE SIA-VEUN REL. 6.20 IN VIGORE DAL 01/01/2024       00008771
008772*$                 'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00008772
008780            07  W-CATAST-SOTTO22       PIC X(01).                 00008780
008790               88  W-CATAST-SOTTO22-OK VALUE                      00008790
008800                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00008800
008810            07  W-CATAST-SOTTO23       PIC X(01).                 00008810
008820               88  W-CATAST-SOTTO23-OK VALUE                      00008820
008830                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00008830
008840*                                                                 00008840
008850 01  W-ANNO.                                                      00008850
008860     03  FILLER                         PIC X(06).                00008860
008870     03  W-CF-ANNO1                     PIC X(01).                00008870
008880                                                                  00008880
008890         88  W-CF-ANNO1-OK  VALUE                                 00008890
008900                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00008900
008910     03  W-CF-ANNO2                     PIC X(01).                00008910
008920                                                                  00008920
008930         88  W-CF-ANNO2-OK  VALUE                                 00008930
008940                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00008940
008950                                                                  00008950
008960*                                                                 00008960
008970 01  W-GIORNO.                                                    00008970
008980     03  FILLER                         PIC X(09).                00008980
008990     03  W-CF-GIORNO1                   PIC X(01).                00008990
009000                                                                  00009000
009010         88  W-CF-GIORNO1-OK  VALUE                               00009010
009020                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00009020
009030     03  W-CF-GIORNO2                   PIC X(01).                00009030
009040                                                                  00009040
009050         88  W-CF-GIORNO2-OK  VALUE                               00009050
009060                   'L' 'M' 'N' 'P' 'Q' 'R' 'S' 'T' 'U' 'V'.       00009060
009070                                                                  00009070
009080*                                                                 00009080
009090 01  W-CF.                                                        00009090
009100     03  FILLER                         PIC X(08).                00009100
009110     03  W-CF-MESE                      PIC X(01).                00009110
009120                                                                  00009120
009130         88  W-CF-MESE-30-OK  VALUE 'D' 'H' 'P' 'S'.              00009130
009140                                                                  00009140
009150*                                                                 00009150
009160         88  W-CF-MESE-31-OK  VALUE 'A' 'C' 'E' 'L' 'M' 'R' 'T'.  00009160
009170                                                                  00009170
009180*                                                                 00009180
009190         88  W-CF-MESE-28-OK  VALUE 'B'.                          00009190
009200                                                                  00009200
009210*                                                                 00009210
009220*01  W-APPO-CF-RED REDEFINES W-APPO-CF.                           00009220
009230*    03  FILLER                     PIC X(05).                    00009230
009240*    03  W-APPO-CF-RED-DX           PIC X(11).                    00009240
009250 01  W-APPO-CF-11.                                                00009250
009260     03  W-APPO-CF-11-PROG          PIC 9(07).                    00009260
009270     03  W-APPO-CF-11-COD-UFF       PIC 9(03).                    00009270
009280     03  FILLER                     PIC X(06).                    00009280
009290 01  W-PARAM-BQVFB3.                                              00009290
009300     03  W-BQVFB3-COD-FISC          PIC X(16).                    00009300
009310     03  W-BQVFB3-COD-RIT           PIC X.                        00009310
009320*---                                                              00009320
009330*--- CAMPI DI APPOGGIO DEI SALDI PER PROVINCIA                    00009330
009340*---                                                              00009340
009350 01  W-APPO-SALDO-FISCO             PIC S9(15).                   00009350
009360*---                                                              00009360
009370*--- MODIFICHE MAGGIO 2001                                        00009370
009380*---                                                              00009380
009390 01  W-APPO-SALDO-FISCO-COMM        PIC S9(15).                   00009390
009400 01  W-APPO-FLAG-NO-FISCO           PIC 9(01).                    00009400
009410 01  W-APPO-SALDO-INPS              PIC S9(15).                   00009410
009420 01  W-APPO-SALDO-REG               PIC S9(15).                   00009420
009430 01  W-APPO-SALDO-ENTEL             PIC S9(15).                   00009430
009440 01  W-APPO-SALDO-INAIL             PIC S9(15).                   00009440
009450 01  W-APPO-SALDO-ALTRI             PIC S9(15).                   00009450
009460 01  W-APPO-SALDO-ACCISE            PIC S9(15).                   00009460
009470 01  W-APPO-TOT-RIMB                PIC 9(15).                    00009470
009480*---                                                              00009480
009490*F INIZIO MODIFICA 13/04/2004 - MONOPOLI                          00009490
009500 01  W-07-COD-DIV                   PIC X(3).                     00009500
009510 01  W-DATA-R05                     PIC X(8) VALUE '20050310'.    00009510
009520*F FINE MODIFICA 13/04/2004 - MONOPOLI                            00009520
009521*---                                                              00009521
009522*$ INIZIO MODIFICA 12/12/2023 - NUOVA REL. 6.20 CTRL CF PER CAPIRE00009522
009523*$                              SE IL CF INDICATO HA CARATTERI    00009523
009524*$                              MAIUSCOLI OPPURE MINUSCOLI.       00009524
009525*$                                                                00009525
009526 01  W-I                            PIC 99    VALUE ZERO.         00009526
009527 01  W-BYTE                         PIC X     VALUE SPACES.       00009527
009528 01  W-COD-FISC                     PIC X(16) VALUE SPACES.       00009528
009529*$                                                                00009529
009530*$ FINE MODIFICA 12/12/2023                                       00009530
009532*---                                                              00009532
009540 01  W-IC-TIPO                      PIC X(3).                     00009540
009550 01  W-IC-ENTE                      PIC X(1).                     00009550
009560 01  W-IC-MOD-CONF                  PIC X(1).                     00009560
009570*---                                                              00009570
009580*--- TABELLA DI APPOGGIO DEI RECORD ESITI                         00009580
009590*---                                                              00009590
009600 01  W-TAB-MEM-BQVFB21.                                           00009600
009610     03  W-MEM-BQVFB21 OCCURS 99.                                 00009610
009620         05  FILLER                       PIC X(268).             00009620
009630         05  W-MEM-BQVFB21-ERR-REC-SUCC   PIC 9(003).             00009630
009640         05  W-MEM-BQVFB21-ERR-REC-SUCC-A PIC X(001).             00009640
009650         05  FILLER                       PIC X(240).             00009650
009660*---                                                              00009660
009670*--- TABELLA DI APPOGGIO DELLE PROVINCE                           00009670
009680*---                                                              00009680
009690 01  W-TAB-APPO-PROV.                                             00009690
009700     03  W-EL-APPO-PROV OCCURS 130 INDEXED BY P.                  00009700
009710         05  W-APPO-PROV            PIC X(02).                    00009710
009720*---                                                              00009720
009730*--- TABELLA DI APPOGGIO DEI SALDI PER PROVINCIA                  00009730
009740*---                                                              00009740
009750 01  W-TAB-SALDI.                                                 00009750
009760     03  W-EL-SALDI OCCURS 130 INDEXED BY S.                      00009760
009770         05  W-PROV                 PIC X(02).                    00009770
009780         05  W-SALDO-FISCO          PIC S9(15).                   00009780
009790         05  W-FLAG-NO-FISCO        PIC 9(01).                    00009790
009800         05  W-SALDO-INPS           PIC S9(15).                   00009800
009810         05  W-SALDO-REG            PIC S9(15).                   00009810
009820         05  W-SALDO-ENTEL          PIC S9(15).                   00009820
009830         05  W-SALDO-INAIL          PIC S9(15).                   00009830
009840         05  W-SALDO-ALTRI          PIC S9(15).                   00009840
009850         05  W-SALDO-ACCISE         PIC S9(15).                   00009850
009860         05  W-FLAG-CONTR           PIC 9(01).                    00009860
009870         05  W-NUM-DELEGHE-F        PIC 9(06).                    00009870
009880         05  W-NUM-DELEGHE-I-R      PIC 9(06).                    00009880
009890*---                                                              00009890
009900*--- TABELLA DI APPOGGIO DEI TOTALI PER DELEGA                    00009900
009910*---                                                              00009910
009920 01  W-TAB-TOT.                                                   00009920
009930     03  W-EL-TOT OCCURS 7.                                       00009930
009940         05  W-TOT-PAGAM            PIC 9(15).                    00009940
009950         05  W-TOT-RIMB             PIC 9(15).                    00009950
009960*---                                                              00009960
009970*--- CAMPO DI APPOGGIO PER I TOTALI COMPENSAZIONI SUL FISCO       00009970
009980*---                                                              00009980
009990 01  W-COMP-FISCO                  PIC 9(18).                     00009990
010000*---                                                              00010000
010010 01  W-COMP-REG                    PIC 9(18).                     00010010
010020*---                                                              00010020
010030 01  W-COMP-EL                      PIC 9(18).                    00010030
010040*---                                                              00010040
010050**TABELLA CONTENENTE I CODICI AMBITI  PRELEVATI DAL FILE BQVFAM   00010050
010060*---                                                              00010060
010070 01  W-TAB-AMBITI.                                                00010070
010080     03 W-TAB-AMBITI-NUM-MAX        PIC 9(003) VALUE 150.         00010080
010090     03 W-TAB-AMBITI-OCC.                                         00010090
010100        05 W-TAB-AMBITI-EL OCCURS   150 TIMES                     00010100
010110                                    ASCENDING W-TAB-AMBITI-COD-ALF00010110
010120                                              W-TAB-AMBITI-INI-VAL00010120
010130                                    INDEXED BY W-PUNT-AMBITI.     00010130
010140           07 W-TAB-AMBITI-KEY.                                   00010140
010150              09 W-TAB-AMBITI-COD-NUM  PIC 9(003).                00010150
010160              09 W-TAB-AMBITI-COD-ALF  REDEFINES                  00010160
010170                  W-TAB-AMBITI-COD-NUM PIC X(003).                00010170
010180              09 W-TAB-AMBITI-INI-VAL  PIC X(008).                00010180
010190           07 W-TAB-AMBITI-FIN-VAL  PIC X(008).                   00010190
010200           07 W-TAB-AMBITI-COD-PROV PIC X(002).                   00010200
010210*---                                                              00010210
010220**TABELLA CONTENENTE I CODICI AZIENDA PRELEVATI DAL FILE SEQ.     00010220
010230**BQVFAZ  (PER I CONTROLLI CUI CODICI ABI)                        00010230
010240*---                                                              00010240
010250 01  W-TAB-AZIENDE.                                               00010250
010260     03 W-TAB-AZIENDE-NUM-MAX    PIC 9(004) VALUE 2000.           00010260
010270     03 W-TAB-AZIENDE-OCC.                                        00010270
010280        05 W-TAB-AZIENDE-EL      OCCURS 2000 TIMES                00010280
010290                                 ASCENDING W-TAB-AZ-COD-NUM       00010290
010300                                 INDEXED BY W-PUNT-AZIENDE.       00010300
010310           07 W-TAB-AZ-COD-NUM   PIC 9(005).                      00010310
010320           07 W-TAB-AZ-COD-ALF   REDEFINES                        00010320
010330              W-TAB-AZ-COD-NUM   PIC X(005).                      00010330
010340*---                                                              00010340
010350**TABELLA CONTENENTE I CODICI REGIONI PRELEVATI DAL FILE BQVFRE   00010350
010360*---                                                              00010360
010370 01  W-TAB-REGIONI.                                               00010370
010380     03 W-TAB-REGIONI-NUM-MAX        PIC 9(002) VALUE  50.        00010380
010390     03 W-TAB-REGIONI-OCC.                                        00010390
010400        05 W-TAB-REGIONI-EL OCCURS    50 TIMES                    00010400
010410                                    ASCENDING W-TAB-REGIONI-COD   00010410
010420                                    INDEXED BY W-PUNT-REGIONI.    00010420
010430           07 W-TAB-REGIONI-COD      PIC X(002).                  00010430
010440*---                                                              00010440
010450**TABELLA CONTENENTE I CODICI PROVINCE PRELEVATI DAL FILE BQVFPR  00010450
010460*---                                                              00010460
010470 01  W-TAB-PROV.                                                  00010470
010480     03 W-TAB-PROV-NUM-MAX        PIC 9(003) VALUE 150.           00010480
010490     03 W-TAB-PROV-OCC.                                           00010490
010500        05 W-TAB-PROV-EL OCCURS   150 TIMES                       00010500
010510                                    ASCENDING W-TAB-PROV-COD      00010510
010520                                    INDEXED BY W-PUNT-PROV.       00010520
010530           07 W-TAB-PROV-COD      PIC X(002).                     00010530
010540*---                                                              00010540
010550**TABELLA CONTENENTE I CODICI TRIBUTI PRELEVATI DAL FILE BQVFTR   00010550
010560*---                                                              00010560
010570 01  W-TAB-TRIBUTI.                                               00010570
010580     03 W-TAB-TRIB-NUM-MAX     PIC 9(004) VALUE 6900.             00010580
010590     03 W-TAB-TRIB-OCC.                                           00010590
010600        05 W-TAB-TRIB-EL OCCURS 6900 TIMES                        00010600
010610                              ASCENDING W-TAB-TRIB-KEY            00010610
010620                              INDEXED BY W-PUNT-TRIB.             00010620
010630           07 W-TAB-TRIB-KEY.                                     00010630
010640              09 W-TAB-TRIB-TIPO-TR  PIC X(001).                  00010640
010650              09 W-TAB-TRIB-COD      PIC X(004).                  00010650
010660              09 W-TAB-TRIB-INI-VAL  PIC X(008).                  00010660
010670           07 W-TAB-TRIB-FIN-VAL  PIC X(008).                     00010670
010680           07 W-TAB-TRIB-TIPO-PE  PIC X(008).                     00010680
010690           07 W-TAB-TRIB-FLAG-COMPEN  PIC X.                      00010690
010700           07 W-TAB-TRIB-FLAG-AGEV    PIC X.                      00010700
010710           07 W-TAB-TRIB-FLAG-CONC    PIC X.                      00010710
010720           07 W-TAB-TRIB-ELEM-IDENT   PIC X.                      00010720
010730           07 W-TAB-TRIB-COD-ATTO     PIC X(002).                 00010730
010740           07 W-TAB-TRIB-COD-UFF      PIC X(002).                 00010740
010750           07 W-TAB-TRIB-ANNO-RIF     PIC 9(002).                 00010750
010760           07 W-TAB-TRIB-IDENT-OPER   PIC X(002).                 00010760
010770           07 W-TAB-TRIB-TAB-ENTE-COMUNE-1 PIC X(002).            00010770
010780           07 W-TAB-TRIB-TAB-ENTE-COMUNE-2 PIC X(002).            00010780
010790           07 W-TAB-TRIB-TAB-ENTE-COMUNE-3 PIC X(002).            00010790
010800**TABELLA CONTENENTE LE MATRICOLE INPS PRELEVATE DAL FILE BQVFMA  00010800
010810**MODIFICA 13/03/2006                                             00010810
010820**AGGIUNTO DESCR E FLAG-COMPEN                                    00010820
010830 01  W-TAB-MATR.                                                  00010830
010840     03 W-TAB-MATR-NUM-MAX        PIC 9(004) VALUE 1500.          00010840
010850     03 W-TAB-MATR-OCC.                                           00010850
010860        05 W-TAB-MATR-EL OCCURS  1500 TIMES                       00010860
010870                                    ASCENDING W-TAB-MATR-KEY      00010870
010880                                    INDEXED BY W-PUNT-MATR.       00010880
010890           07 W-TAB-MATR-KEY.                                     00010890
010900              09 W-TAB-MATR-COD      PIC X(004).                  00010900
010910              09 W-TAB-MATR-INI-VAL  PIC X(008).                  00010910
010920           07 W-TAB-MATR-FIN-VAL  PIC X(008).                     00010920
010930           07 W-TAB-MATR-FORM     PIC X(001).                     00010930
010940           07 W-TAB-MATR-TIPO-INI PIC X(001).                     00010940
010950           07 W-TAB-MATR-TIPO-FIN PIC X(001).                     00010950
010960           07 W-TAB-MATR-DESR     PIC X(060).                     00010960
010970           07 W-TAB-MATR-FL-COMP  PIC X(001).                     00010970
010980**TABELLA CONTENENTE I CODICI SEDI INPS PRELEVATI DAL FILE BQVFSE 00010980
010990 01  W-TAB-SEDE.                                                  00010990
011000     03 W-TAB-SEDE-NUM-MAX        PIC 9(003) VALUE 500.           00011000
011010     03 W-TAB-SEDE-OCC.                                           00011010
011020        05 W-TAB-SEDE-EL OCCURS   500 TIMES                       00011020
011030                                    ASCENDING W-TAB-SEDE-COD      00011030
011040                                    INDEXED BY W-PUNT-SEDE.       00011040
011050           07 W-TAB-SEDE-COD      PIC X(004).                     00011050
011060**TABELLA CONTENENTE CODICI ENTI LOCALI PRELEVATI DAL FILE BQVFEL 00011060
011070 01  W-TAB-ENTE.                                                  00011070
011080     03 W-TAB-ENTE-NUM-MAX        PIC 9(004) VALUE 100.           00011080
011090     03 W-TAB-ENTE-OCC.                                           00011090
011100        05 W-TAB-ENTE-EL OCCURS    100 TIMES                      00011100
011110                                    ASCENDING W-TAB-ENTE-KEY      00011110
011120                                    INDEXED BY W-PUNT-ENTE.       00011120
011130           07 W-TAB-ENTE-KEY.                                     00011130
011140              09 W-TAB-ENTE-COD      PIC X(004).                  00011140
011150              09 W-TAB-ENTE-INIZ     PIC X(008).                  00011150
011160           07 W-TAB-ENTE-FINE        PIC X(008).                  00011160
011170*                                                                 00011170
011180*AN INIZIO MODIFICA 30 APRILE 2004 - MONOPOLI                     00011180
011190*                                                                 00011190
011200**TABELLA CONTENENTE CODICI ENTI-TRIBUTI PRELEVATI DAL FILE BQVFTE00011200
011210 01  W-TAB-ENTI-TRIB.                                             00011210
011220     03 W-TAB-ENTI-TRIB-NUM-MAX        PIC 9(004) VALUE 2000.     00011220
011230     03 W-TAB-ENTI-TRIB-OCC.                                      00011230
011240        05 W-TAB-ENTI-TRIB-EL OCCURS   2000 TIMES                 00011240
011250                              ASCENDING W-TAB-ENTI-TRIB-KEY       00011250
011260                              INDEXED BY W-PUNT-ENTI-TRIB.        00011260
011270           07 W-TAB-ENTI-TRIB-KEY.                                00011270
011280              09 W-TAB-ENTI-TRIB-COD-ENTE       PIC X(2).         00011280
011290              09 W-TAB-ENTI-TRIB-COD-TRIB       PIC X(4).         00011290
011300              09 W-TAB-ENTI-TRIB-INIZIO-VAL     PIC X(8).         00011300
011310           07 W-TAB-ENTI-TRIB-FINE-VAL        PIC X(8).           00011310
011320           07 W-TAB-ENTI-TRIB-DESCR           PIC X(20).          00011320
011330           07 W-TAB-ENTI-TRIB-PR              PIC X.              00011330
011340           07 W-TAB-ENTI-TRIB-COD-IDENT       PIC 9(2).           00011340
011350           07 W-TAB-ENTI-TRIB-RIFER-TRIB      PIC X(6).           00011350
011360           07 W-TAB-ENTI-TRIB-COD-UFF         PIC X(1).           00011360
011370           07 W-TAB-ENTI-TRIB-COD-ATTO        PIC X(1).           00011370
011380           07 W-TAB-ENTI-TRIB-RATEAZIONE      PIC X(1).           00011380
011390*                                                                 00011390
011400*AN   FINE MODIFICA 30 APRILE 2004 - MONOPOLI                     00011400
011410*                                                                 00011410
011420 01  W-TAB-CAT-TRIB.                                              00011420
011430     03 W-TAB-CAT-TRIB-NUM-MAX        PIC 9(005) VALUE 25000.     00011430
011440     03 W-TAB-CAT-TRIB-OCC.                                       00011440
011450        05 W-TAB-CAT-TRIB-EL OCCURS  25000 TIMES                  00011450
011460                        ASCENDING W-TAB-CAT-TRIB-KEY              00011460
011470                        INDEXED BY W-PUNT-CAT-TRIB.               00011470
011480           07 W-TAB-CAT-TRIB-KEY.                                 00011480
011490              09 W-TAB-CAT-TRIB-ENTE     PIC X(004).              00011490
011500              09 W-TAB-CAT-TRIB-TRIBUTO  PIC X(004).              00011500
011510              09 W-TAB-CAT-TRIB-INIZ     PIC X(008).              00011510
011520           07 W-TAB-CAT-TRIB-FINE        PIC X(008).              00011520
011530           07 W-TAB-CAT-TRIB-TIPO-IMP    PIC X(010).              00011530
011540**TABELLA CONTENENTE I CODICI INAIL PRELEVATI DAL FILE BQVFIN     00011540
011550 01  W-TAB-INAIL.                                                 00011550
011560     03 W-TAB-INAIL-NUM-MAX        PIC 9(003) VALUE 400.          00011560
011570     03 W-TAB-INAIL-OCC.                                          00011570
011580        05 W-TAB-INAIL-EL OCCURS   400 TIMES                      00011580
011590                                    ASCENDING W-TAB-INAIL-KEY     00011590
011600                                    INDEXED BY W-PUNT-INAIL.      00011600
011610           07 W-TAB-INAIL-KEY.                                    00011610
011620              09 W-TAB-INAIL-COD     PIC 9(005).                  00011620
011630              09 W-TAB-INAIL-COD-ALF REDEFINES                    00011630
011640                 W-TAB-INAIL-COD     PIC X(005).                  00011640
011650              09 W-TAB-INAIL-INIZ    PIC X(008).                  00011650
011660           07 W-TAB-INAIL-FINE       PIC X(008).                  00011660
011670**TABELLA CONTENENTE I CODICI ALTRI ENTI PRELEVATI DAL FILE BQVFAE00011670
011680 01  W-TAB-ALTRO.                                                 00011680
011690     03 W-TAB-ALTRO-NUM-MAX        PIC 9(003) VALUE 500.          00011690
011700     03 W-TAB-ALTRO-OCC.                                          00011700
011710        05 W-TAB-ALTRO-EL OCCURS 500 TIMES                        00011710
011720                                    ASCENDING W-TAB-ALTRO-KEY     00011720
011730                                    INDEXED BY W-PUNT-ALTRO.      00011730
011740           07 W-TAB-ALTRO-KEY.                                    00011740
011750              09 W-TAB-ALTRO-COD     PIC 9(004).                  00011750
011760              09 W-TAB-ALTRO-COD-ALF REDEFINES                    00011760
011770                 W-TAB-ALTRO-COD     PIC X(004).                  00011770
011780              09 W-TAB-ALTRO-SEDE    PIC X(005).                  00011780
011790              09 W-TAB-ALTRO-INIZ    PIC X(008).                  00011790
011800           07 W-TAB-ALTRO-FINE       PIC X(008).                  00011800
011810**TABELLA CONTENENTE CAUSALI ALTRI ENTI PRELEVATE DAL FILE BQVFCA 00011810
011820 01  W-TAB-CAUS.                                                  00011820
011830     03 W-TAB-CAUS-NUM-MAX        PIC 9(004) VALUE 1500.          00011830
011840     03 W-TAB-CAUS-OCC.                                           00011840
011850        05 W-TAB-CAUS-EL OCCURS 1500 TIMES                        00011850
011860                                    ASCENDING W-TAB-CAUS-KEY      00011860
011870                                    INDEXED BY W-PUNT-CAUS.       00011870
011880           07 W-TAB-CAUS-KEY.                                     00011880
011890              09 W-TAB-CAUS-COD     PIC X(004).                   00011890
011900              09 W-TAB-CAUS-CAU     PIC X(004).                   00011900
011910              09 W-TAB-CAUS-INIZ    PIC X(008).                   00011910
011920           07 W-TAB-CAUS-FINE       PIC X(008).                   00011920
011930           07 W-TAB-CAUS-TIPO-INIZ  PIC X(001).                   00011930
011940           07 W-TAB-CAUS-TIPO-FINE  PIC X(001).                   00011940
011950**MODIFICA 3/2/2006                                               00011950
011960**TABELLA CONTENETE I VALORI AMMESSI PER I FORMALISMI TR (DA T3)  00011960
011970**PRELEVATI DAL FILE BQVFT3                                       00011970
011980 01  W-TAB-COD-T3.                                                00011980
011990     03 W-TAB-COD-T3-NUM-MAX            PIC 9(004) VALUE 1000.    00011990
012000     03 W-TAB-COD-T3-OCC.                                         00012000
012010        05 W-TAB-COD-T3-EL OCCURS  1000 TIMES                     00012010
012020                                    ASCENDING W-TAB-T3-KEY        00012020
012030                                    INDEXED BY W-PUNT-T3.         00012030
012040           07 W-TAB-T3-KEY.                                       00012040
012050              09 W-TAB-T3-COD-FORMAL  PIC X(002).                 00012050
012060              09 W-TAB-T3-CODICE      PIC X(004).                 00012060
012070              09 W-TAB-T3-INIZIO-VAL  PIC X(008).                 00012070
012080           07 W-TAB-T3-FINE-VAL       PIC X(008).                 00012080
012090**MODIFICA 13/03/2006                                             00012090
012100**TABELLA CONTENENTE I VALORI PER IL CALCOLO DI INTERESSI E       00012100
012110**COMMISSIONI PRELEVATI DAL FILE BQVFIC                           00012110
012120 01  W-TAB-IC.                                                    00012120
012130     03 W-TAB-IC-NUM-MAX            PIC 9(003) VALUE 200.         00012130
012140     03 W-TAB-IC-OCC.                                             00012140
012150        05 W-TAB-IC-EL OCCURS 200 TIMES                           00012150
012160                                    ASCENDING W-TAB-IC-KEY        00012160
012170                                    INDEXED BY W-PUNT-IC.         00012170
012180           07 W-TAB-IC-KEY.                                       00012180
012190              09 W-TAB-IC-TIPO        PIC X(003).                 00012190
012200              09 W-TAB-IC-ENTE        PIC X(001).                 00012200
012210              09 W-TAB-IC-MOD-CONF    PIC X(001).                 00012210
012220              09 W-TAB-IC-INIZIO-VAL  PIC X(008).                 00012220
012230           07 W-TAB-IC-FINE-VAL       PIC X(008).                 00012230
012240           07 W-TAB-IC-COMM           PIC 9(6)V9(2).              00012240
012250           07 W-TAB-IC-INTER          PIC 9(2)V9(4).              00012250
012260**TABELLA CONTENETE GLI UFFICI PRELEVATI DA FILE BQVFUF           00012260
012270 01  W-TAB-UFFICIO.                                               00012270
012280     03 W-TAB-UFF-NUM-MAX              PIC 9(004) VALUE 3000.     00012280
012290     03 W-TAB-UFF-OCC.                                            00012290
012300        05 W-TAB-UFF-EL OCCURS 3000 TIMES                         00012300
012310                                    ASCENDING W-TAB-UFF-KEY       00012310
012320                                    INDEXED BY W-PUNT-UFF.        00012320
012330           07 W-TAB-UFF-KEY.                                      00012330
012340              09 W-TAB-UFF-COD         PIC X(003).                00012340
012350              09 W-TAB-UFF-INIZIO-VAL  PIC X(008).                00012350
012360           07 W-TAB-UFF-SETTORE        PIC X(001).                00012360
012370           07 W-TAB-UFF-DENOM          PIC X(039).                00012370
012380           07 W-TAB-UFF-FINE-VAL       PIC X(008).                00012380
012390*---                                                              00012390
012400*--- TABELLA DEI CODICI IDENTIFICATIVI                            00012400
012410*---                                                              00012410
012420 01  W-TAB-IDENT.                                                 00012420
012430     03  W-TAB-IDENT-NUM-MAX PIC 9(003) VALUE 100.                00012430
012440     03  W-TAB-IDENT-OCC.                                         00012440
012450        05  W-TAB-IDENT-EL OCCURS 100                             00012450
012460                            ASCENDING W-TAB-IDENT-COD             00012460
012470                                      W-TAB-IDENT-INIZIO-VAL      00012470
012480                            INDEXED BY W-PUNT-IDENT.              00012480
012490            07  W-TAB-IDENT-KEY.                                  00012490
012500                09  W-TAB-IDENT-COD            PIC X(002).        00012500
012510                09  W-TAB-IDENT-INIZIO-VAL      PIC X(008).       00012510
012520            07  W-TAB-IDENT-FINE-VAL   PIC X(008).                00012520
012530*                                                                 00012530
012540*---                                                              00012540
012550*--- TABELLA DEI TIPI VEICOLO                                     00012550
012560*---                                                              00012560
012570 01  W-TAB-VEIC.                                                  00012570
012580     03  W-TAB-VEIC-NUM-MAX PIC 9(003) VALUE 100.                 00012580
012590     03  W-TAB-VEIC-OCC.                                          00012590
012600        05  W-TAB-VEIC-EL OCCURS 100                              00012600
012610                            ASCENDING W-TAB-VEIC-TIPO             00012610
012620                                      W-TAB-VEIC-INIZIO-VAL       00012620
012630                            INDEXED BY W-PUNT-VEIC.               00012630
012640            07  W-TAB-VEIC-KEY.                                   00012640
012650                09  W-TAB-VEIC-TIPO            PIC X(001).        00012650
012660                09  W-TAB-VEIC-INIZIO-VAL       PIC X(008).       00012660
012670            07  W-TAB-VEIC-FINE-VAL    PIC X(008).                00012670
012680*---                                                              00012680
012690**TABELLA CONTENENTE I CODICI PROV. DIRITTI CAMER. FILE BQVFPC    00012690
012700*---                                                              00012700
012710 01  W-TAB-PRPC.                                                  00012710
012720     03 W-TAB-PRPC-NUM-MAX        PIC 9(003) VALUE 150.           00012720
012730     03 W-TAB-PRPC-OCC.                                           00012730
012740        05 W-TAB-PRPC-EL OCCURS   150 TIMES                       00012740
012750                                    ASCENDING W-TAB-PRPC-COD      00012750
012760                                    INDEXED BY W-PUNT-PRPC.       00012760
012770           07 W-TAB-PRPC-COD      PIC X(002).                     00012770
012780*---                                                              00012780
012790**TABELLA CONTENENTE I LIMITI DELLE COMPENSAZIONI  FILE BQVF**    00012790
012800*---                                                              00012800
012810 01  W-TAB-COMP-TRIB.                                             00012810
012820     03 W-TAB-COMP-TRIB-NUM-MAX        PIC 9(004) VALUE 1000.     00012820
012830     03 W-TAB-COMP-TRIB-OCC.                                      00012830
012840        05 W-TAB-COMP-TRIB-EL OCCURS   1000 TIMES                 00012840
012850                                    ASCENDING W-TAB-COMP-TRIB-KEY 00012850
012860                                    INDEXED BY W-PUNT-COTR.       00012860
012870           07 W-TAB-COMP-TRIB-KEY.                                00012870
012880               09 W-TAB-COMP-TRIB-COD-COMP    PIC X(003).         00012880
012890               09 W-TAB-COMP-TRIB-COD-TRIB    PIC X(004).         00012890
012900               09 W-TAB-COMP-TRIB-ESP-TRIB    PIC X(001).         00012900
012910               09 W-TAB-COMP-TRIB-INIZIO-VAL  PIC X(008).         00012910
012920           07 W-TAB-COMP-TRIB-FINE-VAL        PIC X(008).         00012920
012930           07 W-TAB-COMP-TRIB-ANNO-RIF        PIC X(004).         00012930
012940           07 W-TAB-COMP-TRIB-INIZ-INTERV     PIC 9(002).         00012940
012950           07 W-TAB-COMP-TRIB-FINE-INTERV     PIC 9(002).         00012950
012960*---                                                              00012960
012970**TABELLA CONTENENTE I LIMITI DELLE COMPENSAZIONI  FILE BQVF**    00012970
012980*---                                                              00012980
012990 01  W-TAB-COMP-TIPO.                                             00012990
013000     03 W-TAB-COMP-TIPO-NUM-MAX        PIC 9(004) VALUE 1000.     00013000
013010     03 W-TAB-COMP-TIPO-OCC.                                      00013010
013020        05 W-TAB-COMP-TIPO-EL OCCURS   1000 TIMES                 00013020
013030                                    ASCENDING W-TAB-COMP-TIPO-KEY 00013030
013040                                    INDEXED BY W-PUNT-COTI.       00013040
013050           07 W-TAB-COMP-TIPO-KEY.                                00013050
013060               09 W-TAB-COMP-TIPO-COD-COMP    PIC X(003).         00013060
013070               09 W-TAB-COMP-TIPO-INIZIO-VAL  PIC X(008).         00013070
013080           07 W-TAB-COMP-TIPO-FINE-VAL        PIC X(008).         00013080
013090           07 W-TAB-COMP-TIPO-SEZIONE         PIC X(001).         00013090
013100           07 W-TAB-COMP-TIPO-IMPORTO-1       PIC 9(015).         00013100
013110           07 W-TAB-COMP-TIPO-IMPORTO-2       PIC 9(015).         00013110
013120*---                                                              00013120
013130*--- COPY CATALOGATA PER L'ARCHIVIO BQVFB1                        00013130
013140*---                                                              00013140
013150     COPY FBQVFB11.                                               00013150
013160*---                                                              00013160
013170*--- COPY CATALOGATA PER L'ARCHIVIO BQVFB2                        00013170
013180*---                                                              00013180
013190     COPY FBQVFB21.                                               00013190
013200*---                                                              00013200
013210*--- COPY CATALOGATA PER L'ARCHIVIO BQVFB3                        00013210
013220*---                                                              00013220
013230     COPY FBQVFB31.                                               00013230
013240*---                                                              00013240
013250*--- COPY CATALOGATA PER L'ARCHIVIO BQVFB5                        00013250
013260*---                                                              00013260
013270     COPY FBQVFBS1.                                               00013270
013280*---                                                              00013280
013290*--- COPY CATALOGATA PER L'ARCHIVIO BQVFAM                        00013290
013300*---                                                              00013300
013310     COPY FBQVFAM1.                                               00013310
013320*---                                                              00013320
013330*--- COPY CATALOGATA PER L'ARCHIVIO BQVFAZ                        00013330
013340*---                                                              00013340
013350     COPY FBQVFAZ1.                                               00013350
013360*---                                                              00013360
013370*--- COPY CATALOGATA PER L'ARCHIVIO BQVFRE                        00013370
013380*---                                                              00013380
013390     COPY FBQVFRE1.                                               00013390
013400*---                                                              00013400
013410*--- COPY CATALOGATA PER L'ARCHIVIO BQVFPR                        00013410
013420*---                                                              00013420
013430     COPY FBQVFPR1.                                               00013430
013440*---                                                              00013440
013450*--- COPY CATALOGATA PER L'ARCHIVIO BQVFTR                        00013450
013460*---                                                              00013460
013470     COPY FBQVFTR1.                                               00013470
013480*---                                                              00013480
013490*--- COPY CATALOGATA PER L'ARCHIVIO BQVFTE                        00013490
013500*---                                                              00013500
013510     COPY FBQVFTE1.                                               00013510
013520*---                                                              00013520
013530*--- COPY CATALOGATA PER L'ARCHIVIO BQVFMA                        00013530
013540*---                                                              00013540
013550     COPY FBQVFMA1.                                               00013550
013560*---                                                              00013560
013570*--- COPY CATALOGATA PER L'ARCHIVIO BQVFSE                        00013570
013580*---                                                              00013580
013590     COPY FBQVFSE1.                                               00013590
013600*---                                                              00013600
013610*--- COPY CATALOGATA PER L'ARCHIVIO BQVFEL                        00013610
013620*---                                                              00013620
013630     COPY FBQVFEL1.                                               00013630
013640*---                                                              00013640
013650*--- COPY CATALOGATA PER L'ARCHIVIO BQVFIN                        00013650
013660*---                                                              00013660
013670     COPY FBQVFIN1.                                               00013670
013680*---                                                              00013680
013690*--- COPY CATALOGATA PER L'ARCHIVIO BQVFAE                        00013690
013700*---                                                              00013700
013710     COPY FBQVFAE1.                                               00013710
013720*---                                                              00013720
013730*--- COPY CATALOGATA PER L'ARCHIVIO BQVFCA                        00013730
013740*---                                                              00013740
013750     COPY FBQVFCA1.                                               00013750
013760*---                                                              00013760
013770*--- COPY CATALOGATA PER L'ARCHIVIO BQVFT3                        00013770
013780*---                                                              00013780
013790     COPY FBQVFT31.                                               00013790
013800*---                                                              00013800
013810*--- COPY CATALOGATA PER L'ARCHIVIO BQVFIC                        00013810
013820*---                                                              00013820
013830     COPY FBQVFIC1.                                               00013830
013840*---                                                              00013840
013850*--- COPY CATALOGATA PER L'ARCHIVIO BQVFUF                        00013850
013860*---                                                              00013860
013870     COPY FBQVFUF1.                                               00013870
013880*---                                                              00013880
013890*--- COPY CATALOGATA PER L'ARCHIVIO BQVFCM (TOLTO)                00013890
013900*---                                                              00013900
013910**** COPY FBQVFCM1.                                               00013910
013920*---                                                              00013920
013930*---                                                              00013930
013940*--- COPY CATALOGATA PER L'ARCHIVIO BQVFTC (NEW)                  00013940
013950*---                                                              00013950
013960     COPY FBQVFTC1.                                               00013960
013970*---                                                              00013970
013980*--- COPY CATALOGATA PER LE CONVERSIONI LIRE/EURO                 00013980
013990*---                                                              00013990
014000     COPY FBQVFCO1.                                               00014000
014010*---                                                              00014010
014020*--- COPY CATALOGATA PER LA CALL A BQVFDA                         00014020
014030*---                                                              00014030
014040     COPY 'FBQVFDA1'.                                             00014040
014050*---                                                              00014050
014060*--- COPY CATALOGATA PER L'ARCHIVIO BQVFCI                        00014060
014070*---                                                              00014070
014080     COPY 'FBQVFCI1'.                                             00014080
014090*---                                                              00014090
014100*--- COPY CATALOGATA PER L'ARCHIVIO BQVFCV                        00014100
014110*---                                                              00014110
014120     COPY 'FBQVFCV1'.                                             00014120
014130                                                                  00014130
014140*---                                                              00014140
014150*--- COPY CATALOGATA PER L'ARCHIVIO BQVFPC                        00014150
014160*---                                                              00014160
014170     COPY FBQVFPC1.                                               00014170
014180*---                                                              00014180
014190*--- COPY CATALOGATA PER L'ARCHIVIO BQVFCB                        00014190
014200*---                                                              00014200
014210     COPY FBQVFCB1.                                               00014210
014220*---                                                              00014220
014230*--- COPY CATALOGATA PER L'ARCHIVIO BQVFCC                        00014230
014240*---                                                              00014240
014250     COPY FBQVFCC1.                                               00014250
014260*---                                                              00014260
014270******************************************************************00014270
014280*                LINKAGE SECTION                                 *00014280
014290******************************************************************00014290
014300 LINKAGE SECTION.                                                 00014300
014310                                                                  00014310
014320******************************************************************00014320
014330*                PROCEDURE   DIVISION.                           *00014330
014340******************************************************************00014340
014350                                                                  00014350
014360 PROCEDURE DIVISION.                                              00014360
014370                                                                  00014370
014380 ML-010.                                                          00014380
014390     MOVE ZERO TO W-FINE-BQVFB1.                                  00014390
014400*---                                                              00014400
014410*--- MODIFICHE MAGGIO 2001                                        00014410
014420*---                                                              00014420
014430     MOVE ZERO TO W-COMM-CALC-NEW.                                00014430
014440*****DISPLAY DI INIZIO PROGRAMMA                                  00014440
014450     DISPLAY '************************************************'   00014450
014460     DISPLAY '*                                              *'   00014460
014470     DISPLAY '*         -    VERSAMENTI UNIFICATI   -        *'   00014470
014480     DISPLAY '*                                              *'   00014480
014490     DISPLAY '*              CONTROLLO FLUSSI F24            *'   00014490
014500     DISPLAY '*                                              *'   00014500
014510     DISPLAY '************************************************'   00014510
014520     DISPLAY '*            INIZIO PROGRAMMA BQVFB0           *'   00014520
014530     DISPLAY '************************************************'.  00014530
014540*                                                                 00014540
014550     MOVE ZERO TO W-FLAG-RIF-V-T.                                 00014550
014560     MOVE ZERO TO W-FLAG-RIF-V-A.                                 00014560
014570     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-V.                         00014570
014580     MOVE ZERO TO W-FLAG-RIF-I-T.                                 00014580
014590     MOVE ZERO TO W-FLAG-RIF-I-A.                                 00014590
014600     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-I.                         00014600
014610     MOVE ZERO TO W-FLAG-RIF-R-T.                                 00014610
014620     MOVE ZERO TO W-FLAG-RIF-R-A.                                 00014620
014630     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-R.                         00014630
014640     MOVE ZERO TO W-FLAG-RIF-M-T.                                 00014640
014650     MOVE ZERO TO W-FLAG-RIF-M-A.                                 00014650
014660     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-M.                         00014660
014670     MOVE ZERO TO W-FLAG-RIF-E-T.                                 00014670
014680     MOVE ZERO TO W-FLAG-RIF-E-A.                                 00014680
014690     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-E.                         00014690
014700     MOVE ZERO TO W-FLAG-RIF-IRF-T.                               00014700
014710     MOVE ZERO TO W-FLAG-RIF-IRF-A.                               00014710
014720     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-IRF.                       00014720
014730     MOVE ZERO TO W-FLAG-RIF-ADX-T.                               00014730
014740     MOVE ZERO TO W-FLAG-RIF-ADX-A.                               00014740
014750     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-ADX.                       00014750
014760     MOVE ZERO TO W-FLAG-RIF-IIE-T.                               00014760
014770     MOVE ZERO TO W-FLAG-RIF-IIE-A.                               00014770
014780     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-IIE.                       00014780
014790     MOVE ZERO TO W-FLAG-RIF-IFE-T.                               00014790
014800     MOVE ZERO TO W-FLAG-RIF-IFE-A.                               00014800
014810     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-IFE.                       00014810
014820     MOVE ZERO TO W-FLAG-RIF-FF1-T.                               00014820
014830     MOVE ZERO TO W-FLAG-RIF-FF1-A.                               00014830
014840     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-FF1.                       00014840
014850     MOVE ZERO TO W-FLAG-RIF-FF2-T.                               00014850
014860     MOVE ZERO TO W-FLAG-RIF-FF2-A.                               00014860
014870     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-FF2.                       00014870
014880     MOVE ZERO TO W-FLAG-RIF-FF3-T.                               00014880
014890     MOVE ZERO TO W-FLAG-RIF-FF3-A.                               00014890
014900     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-FF3.                       00014900
014910     MOVE ZERO TO W-FLAG-RIF-ORO-T.                               00014910
014920     MOVE ZERO TO W-FLAG-RIF-ORO-A.                               00014920
014930     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-ORO.                       00014930
014940     MOVE ZERO TO W-FLAG-RIF-SEC-T.                               00014940
014950     MOVE ZERO TO W-FLAG-RIF-SEC-A.                               00014950
014960     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-SEC.                       00014960
014970     MOVE ZERO TO W-FLAG-RIF-IEC-T.                               00014970
014980     MOVE ZERO TO W-FLAG-RIF-IEC-A.                               00014980
014990     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-IEC.                       00014990
015000     MOVE ZERO TO W-FLAG-RIF-LEZ-T.                               00015000
015010     MOVE ZERO TO W-FLAG-RIF-LEZ-A.                               00015010
015020     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-LEZ.                       00015020
015030     MOVE ZERO TO W-FLAG-RIF-QR1-T.                               00015030
015040     MOVE ZERO TO W-FLAG-RIF-QR1-A.                               00015040
015050     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-QR1.                       00015050
015051     MOVE ZERO TO W-FLAG-RIF-BTC-T.                               00015051
015052     MOVE ZERO TO W-FLAG-RIF-BTC-A.                               00015052
015053     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-BTC.                       00015053
015060     MOVE ZERO TO W-FLAG-RIF-C.                                   00015060
015070     MOVE ZERO TO W-FLAG-RIF-T-AA-MIN.                            00015070
015080     MOVE ZERO TO W-FLAG-RIF-A-AA-MIN.                            00015080
015090*                                                                 00015090
015100*--- INIZIALIZZAZIONE DEI CONTATORI                               00015100
015110*                                                                 00015110
015120     MOVE ZERO TO W-CTR.                                          00015120
015130     MOVE ZERO TO W-CTR-RIGA.                                     00015130
015140     MOVE ZERO TO W-CTR-DELEGA.                                   00015140
015150*                                                                 00015150
015160*--- INIZIALIZZAZIONE DEI FLAG                                    00015160
015170*                                                                 00015170
015180     MOVE ZERO TO W-FLAG.                                         00015180
015190     MOVE 'NO'  TO W-V12.                                         00015190
015200     MOVE ZERO TO W-NUM-SQUADR.                                   00015200
015210*                                                                 00015210
015220*--- INIZIALIZZAZIONE DELLE TABELLE                               00015220
015230*                                                                 00015230
015240     MOVE ZERO TO W-COMP-FISCO.                                   00015240
015250     MOVE ZERO TO W-COMP-REG.                                     00015250
015260     MOVE ZERO TO W-COMP-EL.                                      00015260
015270     INITIALIZE W-TAB-TOT.                                        00015270
015280*--- ICI                                                          00015280
015290     INITIALIZE W-TAB-COMUNI.                                     00015290
015300     MOVE ZERO TO W-IND-ICI.                                      00015300
015310     MOVE ZERO TO W-TOT-RIMB-TRIB.                                00015310
015320     MOVE ZERO TO W-TIPO-TRIB-NO-IMU.                             00015320
015330     MOVE ZERO TO W-TIPO-TRIB-NO-TARES.                           00015330
015340     MOVE ZERO TO W-TIPO-TRIB-NO-TASI.                            00015340
015350     MOVE ZERO TO W-FLAG-TRIB-CONC.                               00015350
015360     MOVE ZERO TO W-FLAG-CRED.                                    00015360
015370     MOVE ZERO TO W-FLAG-COMP-IVA.                                00015370
015380     MOVE ZERO TO W-FLAG-COMP-IRS.                                00015380
015390     MOVE ZERO TO W-FLAG-COMP-IRP.                                00015390
015400     MOVE ZERO TO W-FLAG-COMP-IRM.                                00015400
015410     MOVE ZERO TO W-FLAG-COMP-ELO.                                00015410
015420     MOVE ZERO TO W-FLAG-COMP-IRF.                                00015420
015430     MOVE ZERO TO W-FLAG-COMP-ADX.                                00015430
015440     MOVE ZERO TO W-FLAG-COMP-IIE.                                00015440
015450     MOVE ZERO TO W-FLAG-COMP-IFE.                                00015450
015460     MOVE ZERO TO W-FLAG-COMP-FF1.                                00015460
015470     MOVE ZERO TO W-FLAG-COMP-FF2.                                00015470
015480     MOVE ZERO TO W-FLAG-COMP-FF3.                                00015480
015490     MOVE ZERO TO W-FLAG-COMP-ORO.                                00015490
015500     MOVE ZERO TO W-FLAG-COMP-SEC.                                00015500
015510     MOVE ZERO TO W-FLAG-COMP-IEC.                                00015510
015520     MOVE ZERO TO W-FLAG-COMP-LEZ.                                00015520
015530     MOVE ZERO TO W-FLAG-COMP-QR1.                                00015530
015531     MOVE ZERO TO W-FLAG-COMP-BTC.                                00015531
015540*---                                                              00015540
015550     INITIALIZE W-TAB-SALDI.                                      00015550
015560*                                                                 00015560
015570*--- INIZIALIZZAZIONE DEGLI INVII                                 00015570
015580*                                                                 00015580
015590     INITIALIZE BQVFB31.                                          00015590
015600*                                                                 00015600
015610*--- ACQUISIZIONE DELLA DATA DI SISTEMA                           00015610
015620*                                                                 00015620
015630     ACCEPT W-DATA-SYS FROM DATE.                                 00015630
015640     IF W-RED-AA-SYS < 60                                         00015640
015650        GO TO ML-014.                                             00015650
015660                                                                  00015660
015670 ML-012.                                                          00015670
015680     MOVE 19           TO W-APPO-SEC-SYS.                         00015680
015690     GO TO ML-020.                                                00015690
015700                                                                  00015700
015710 ML-014.                                                          00015710
015720     MOVE 20           TO W-APPO-SEC-SYS.                         00015720
015730                                                                  00015730
015740 ML-020.                                                          00015740
015750*                                                                 00015750
015760*--- SI IMPOSTA LA DATA SISTEMA IN FORMATO AAAAMMGG               00015760
015770*                                                                 00015770
015780     MOVE W-RED-AA-SYS TO W-APPO-AA-SYS.                          00015780
015790     MOVE W-RED-MM-SYS TO W-APPO-MM-SYS.                          00015790
015800     MOVE W-RED-GG-SYS TO W-APPO-GG-SYS.                          00015800
015810*                                                                 00015810
015820*                                                                 00015820
015830*--- APERTURA DEGLI ARCHIVI                                       00015830
015840*                                                                 00015840
015850     OPEN INPUT BQVFB1.                                           00015850
015860     OPEN OUTPUT BQVFB2.                                          00015860
015870     OPEN OUTPUT BQVFB3.                                          00015870
015880     OPEN OUTPUT BQVFB5.                                          00015880
015890     MOVE ZERO   TO W-IND.                                        00015890
015900     MOVE SPACE  TO W-TAB-MEM-BQVFB21.                            00015900
015910 ML-022.                                                          00015910
015920     ADD 1 TO W-IND.                                              00015920
015930     MOVE ZERO TO W-MEM-BQVFB21-ERR-REC-SUCC(W-IND).              00015930
015940     IF W-IND < 99                                                00015940
015950        GO TO ML-022.                                             00015950
015960                                                                  00015960
015970 ML-024.                                                          00015970
015980*                                                                 00015980
015990*--- LETTURA DELL'ARCHIVIO FLUSSI BANCHE / CONCESSIONARI          00015990
016000*                                                                 00016000
016010     READ BQVFB1 INTO BQVFB11 AT END                              00016010
016020          GO TO ML-130.                                           00016020
016030                                                                  00016030
016040 ML-030.                                                          00016040
016050     ADD 1 TO W-CTR-LETTI.                                        00016050
016060*                                                                 00016060
016070*--- SI RICHIAMA LA PERFORM PER IL CARICAMENTO DELLE TABELLE      00016070
016080*--- DEI CODICI DI CONTROLLO                                      00016080
016090*                                                                 00016090
016100     PERFORM Z1-010-CAR-TAB THRU Z1-990-CAR-TAB-EX.               00016100
016110*                                                                 00016110
016120*--- SI IMPOSTA IL RECORD DEGLI ESITI PER LA PARTE RELATIVA       00016120
016130*--- AL RECORD LETTO IN INPUT E SI INIZIALIZZANO LE AREE          00016130
016140*--- PER LA SEGNALAZIONE DEGLI ERRORI RISCONTRATI                 00016140
016150*                                                                 00016150
016160     MOVE BQVFB11 TO BQVFB21.                                     00016160
016170     MOVE ZERO TO BQVFB21-ERR-DATI-COMUNI.                        00016170
016180     MOVE ZERO TO BQVFB21-ANNO-TRASM.                             00016180
016190     MOVE ZERO TO BQVFB21-PROT-TRASM.                             00016190
016200     MOVE ZERO TO BQVFB21-PROG-REC.                               00016200
016210*                                                                 00016210
016220*--- SI VERIFICA CHE, PER IL TIPO RECORD IL VALORE LETTO SIA 'V00'00016220
016230*                                                                 00016230
016240     IF BQVFB11-TIPO-RECORD = 'V00'                               00016240
016250        GO TO ML-038.                                             00016250
016260                                                                  00016260
016270 ML-032.                                                          00016270
016280*                                                                 00016280
016290*--- SI VERIFICA CHE IL TIPO RECORD LETTO SIA TRA QUELLI AMMESSI  00016290
016300     MOVE BQVFB11-TIPO-RECORD TO W-APPO-TIPO-REC.                 00016300
016310     IF W-APPO-TIPO-REC-1 = 'V'           AND                     00016310
016320        W-APPO-TIPO-REC-2 NUMERIC         AND                     00016320
016330        ((W-APPO-TIPO-REC-2 > ZERO AND                            00016330
016340         W-APPO-TIPO-REC-2 < '08'    ) OR                         00016340
016350         W-APPO-TIPO-REC-2 = '12'      OR                         00016350
016360         W-APPO-TIPO-REC-2 = '14'      OR                         00016360
016370         W-APPO-TIPO-REC-2 = '15'      OR                         00016370
016380         W-APPO-TIPO-REC-2 = '20'      OR                         00016380
016390         W-APPO-TIPO-REC-2 = '36'      OR                         00016390
016400         W-APPO-TIPO-REC-2 = '37'      OR                         00016400
016410         W-APPO-TIPO-REC-2 = '38'      OR                         00016410
016420         W-APPO-TIPO-REC-2 = '49'      OR                         00016420
016430         W-APPO-TIPO-REC-2 = '99'        )                        00016430
016440        GO TO ML-036.                                             00016440
016450                                                                  00016450
016460 ML-034.                                                          00016460
016470*                                                                 00016470
016480*--- IL TIPO RECORD LETTO E' ERRATO:                              00016480
016490*--- SI INSERISCE SULLA TABELLA INVII KO E SI LEGGE IL FILE       00016490
016500*--- DI INPUT SCRIVENDO OGNI RECORD SU ESITI, FINO A QUANDO       00016500
016510*--- NON TROVO IL PRIMO RECORD DI TESTA                           00016510
016520*                                                                 00016520
016530     MOVE ZERO TO BQVFB21-ERR-RECORD-00.                          00016530
016540     MOVE 1 TO W-FLAG-KO.                                         00016540
016550     MOVE 4 TO BQVFB21-ERR-TIPO-RECORD.                           00016550
016560     MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                       00016560
016570     ADD 1 TO W-CTR-BLOC.                                         00016570
016580     MOVE '01' TO BQVFB31-FLAG-TIPO-ERR.                          00016580
016590     PERFORM RB-010-KO THRU RB-990-KO-EX.                         00016590
016600     GO TO ML-040.                                                00016600
016610                                                                  00016610
016620 ML-036.                                                          00016620
016630*                                                                 00016630
016640*--- IL TIPO RECORD LETTO E' CORRETTO MA NON E' QUELLO GIUSTO:    00016640
016650*--- SI INSERISCE SULLA TABELLA INVII KO E SI LEGGE IL FILE       00016650
016660*--- DI INPUT SCRIVENDO OGNI RECORD SU ESITI, FINO A QUANDO       00016660
016670*--- NON TROVO IL PRIMO RECORD DI TESTA                           00016670
016680*                                                                 00016680
016690     MOVE ZERO TO BQVFB21-ERR-RECORD-00.                          00016690
016700     MOVE 1 TO W-FLAG-KO.                                         00016700
016710     MOVE 505 TO BQVFB21-ERR-TIPO-RECORD.                         00016710
016720     MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                       00016720
016730     ADD 1 TO W-CTR-BLOC.                                         00016730
016740     MOVE '01' TO BQVFB31-FLAG-TIPO-ERR.                          00016740
016750     PERFORM RB-010-KO THRU RB-990-KO-EX.                         00016750
016760     GO TO ML-040.                                                00016760
016770                                                                  00016770
016780 ML-038.                                                          00016780
016790*                                                                 00016790
016800*--- SI MEMORIZZA IL TIPO RECORD LETTO PER I SUCCESSIVI CONTROLLI 00016800
016810*--- DI SEQUENZA                                                  00016810
016820*                                                                 00016820
016830     MOVE BQVFB11-TIPO-RECORD TO W-TIPO-REC-PREC.                 00016830
016840*                                                                 00016840
016850*--- SI CONTROLLA IL RECORD LETTO DI TIPO 00                      00016850
016860*                                                                 00016860
016870     PERFORM A1-010-CONTR-00 THRU A1-990-CONTR-00-EX.             00016870
016880*                                                                 00016880
016890*--- PER ERRORE KO SI INSERISCE SU INVII KO, SI SCRIVE SU ESITI   00016890
016900*--- E SI LEGGE L'INPUT, SCRIVENDOLO SU ESITI, FINO A QUANDO      00016900
016910*--- SI INCONTRA RECORD DI TESTA V00                              00016910
016920*                                                                 00016920
016930     IF W-FLAG-KO = 1                                             00016930
016940        PERFORM RB-010-KO THRU RB-990-KO-EX                       00016940
016950        GO TO ML-040.                                             00016950
016960                                                                  00016960
016970 ML-039.                                                          00016970
016980*                                                                 00016980
016990*--- SI LEGGE IL RECORD SUCCESSIVO E SI SCRIVE SU ESITI           00016990
017000*--- SUCCESSIVAMENTE IL RECORD LETTO IN PRECEDENZA PER            00017000
017010*--- SEGNALARE L'EVENTUALE FINE FILE TROVATA                      00017010
017020*                                                                 00017020
017030     READ BQVFB1 INTO BQVFB11 AT END                              00017030
017040          INITIALIZE BQVFB11                                      00017040
017050          MOVE 1 TO W-FINE-BQVFB1.                                00017050
017060     PERFORM RA-010-WRITE THRU RA-990-WRITE-EX.                   00017060
017070                                                                  00017070
017080 ML-040.                                                          00017080
017090     IF W-FINE-BQVFB1 = 1                                         00017090
017100        GO TO ML-120.                                             00017100
017110                                                                  00017110
017120 ML-050.                                                          00017120
017130     ADD 1 TO W-CTR-LETTI.                                        00017130
017140     MOVE 0 TO W-FLAG-ERR.                                        00017140
017150*                                                                 00017150
017160*--- SI IMPOSTA IL RECORD DEGLI ESITI PER LA PARTE RELATIVA       00017160
017170*--- AL RECORD LETTO IN INPUT E SI INIZIALIZZANO LE AREE          00017170
017180*--- PER LA SEGNALAZIONE DEGLI ERRORI RISCONTRATI                 00017180
017190*                                                                 00017190
017200     MOVE BQVFB11 TO BQVFB21.                                     00017200
017210     MOVE ZERO TO BQVFB21-ERR-DATI-COMUNI.                        00017210
017220     MOVE ZERO TO BQVFB21-ANNO-TRASM.                             00017220
017230     MOVE ZERO TO BQVFB21-PROT-TRASM.                             00017230
017240     MOVE ZERO TO BQVFB21-PROG-REC.                               00017240
017250*                                                                 00017250
017260*--- SI VERIFICA CHE IL TIPO RECORD LETTO SIA TRA QUELLI AMMESSI  00017260
017270     MOVE BQVFB11-TIPO-RECORD TO W-APPO-TIPO-REC.                 00017270
017280     IF W-APPO-TIPO-REC-1 = 'V'           AND                     00017280
017290        W-APPO-TIPO-REC-2 NUMERIC         AND                     00017290
017300        ((W-APPO-TIPO-REC-2 NOT < '00' AND                        00017300
017310         W-APPO-TIPO-REC-2 NOT > '07'    ) OR                     00017310
017320         W-APPO-TIPO-REC-2 = '12'          OR                     00017320
017330         W-APPO-TIPO-REC-2 = '14'          OR                     00017330
017340         W-APPO-TIPO-REC-2 = '15'          OR                     00017340
017350         W-APPO-TIPO-REC-2 = '20'          OR                     00017350
017360         W-APPO-TIPO-REC-2 = '36'          OR                     00017360
017370         W-APPO-TIPO-REC-2 = '37'          OR                     00017370
017380         W-APPO-TIPO-REC-2 = '38'          OR                     00017380
017390         W-APPO-TIPO-REC-2 = '49'          OR                     00017390
017400         W-APPO-TIPO-REC-2 = '99'            )                    00017400
017410        GO TO ML-070.                                             00017410
017420                                                                  00017420
017430 ML-060.                                                          00017430
017440*                                                                 00017440
017450*--- IL TIPO RECORD LETTO E' ERRATO                               00017450
017460*                                                                 00017460
017470     MOVE ZERO TO BQVFB21-ERR-RECORD-49.                          00017470
017480     MOVE 1 TO W-FLAG-ERR.                                        00017480
017490     MOVE 1 TO W-FLAG-ERR-SEQ.                                    00017490
017500     MOVE 4 TO BQVFB21-ERR-TIPO-RECORD.                           00017500
017510     MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                       00017510
017520     ADD 1 TO W-CTR-BLOC.                                         00017520
017530     ADD 1 TO W-CTR-REC-ERR.                                      00017530
017540     IF W-TIPO-REC-PREC = 'V99'                                   00017540
017550        MOVE '01' TO BQVFB31-FLAG-TIPO-ERR                        00017550
017560        MOVE 1 TO W-FLAG-KO.                                      00017560
017570     GO TO ML-090.                                                00017570
017580                                                                  00017580
017590 ML-070.                                                          00017590
017600*                                                                 00017600
017610*--- SI CONTROLLA CHE IN PRECEDENZA NON CI SIA STATO UN           00017610
017620*--- ERRORE DI SEQUENZA O DI DELEGA                               00017620
017630*                                                                 00017630
017640     IF W-FLAG-ERR-SEQ    = 1    OR                               00017640
017650        W-FLAG-ERR-DELEGA = 1                                     00017650
017660        GO TO ML-090.                                             00017660
017670                                                                  00017670
017680 ML-072.                                                          00017680
017690*                                                                 00017690
017700*--- SI CONTROLLA CHE IL TIPO DI RECORD LETTO SIA QUELLO          00017700
017710*--- CHE CI SI ASPETTA SECONDO LA SEQUENZA CORRETTA               00017710
017720*                                                                 00017720
017730     PERFORM RD-010-CONTR-SEQ THRU RD-990-CONTR-SEQ-EX.           00017730
017740     IF W-FLAG-ERR-SEQ = ZERO                                     00017740
017750        GO TO ML-090.                                             00017750
017760                                                                  00017760
017770 ML-080.                                                          00017770
017780*--- IL TIPO RECORD LETTO E' CORRETTO MA NON E' QUELLO GIUSTO     00017780
017790     MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                       00017790
017800     MOVE 1 TO W-FLAG-REC-ERR.                                    00017800
017810     ADD 1 TO W-CTR-BLOC.                                         00017810
017820     ADD 1 TO W-TOT-REC-ERR.                                      00017820
017830     ADD 1 TO W-TOT-REC-ERR-BLOC.                                 00017830
017840     IF W-TIPO-REC-PREC     = 'V36' AND                           00017840
017850        BQVFB11-TIPO-RECORD = 'V36' AND                           00017850
017860        BQVFB11-36-PROG-DELEGAA IS NUMERIC AND                    00017860
017870        BQVFB11-36-PROG-DELEGA = W-CTR-DELEGA                     00017870
017880        GO TO ML-084.                                             00017880
017890                                                                  00017890
017900 ML-082.                                                          00017900
017910     MOVE 508 TO BQVFB21-ERR-TIPO-RECORD.                         00017910
017920     GO TO ML-090.                                                00017920
017930 ML-084.                                                          00017930
017940*--- NON CI POSSONO ESSERE PIU' RECORD DI TIPO 6 SULLA STESSA     00017940
017950*--- DELEGA                                                       00017950
017960     MOVE 505 TO BQVFB21-ERR-TIPO-RECORD.                         00017960
017970 ML-090.                                                          00017970
017980     MOVE ZERO TO W-FLAG-ERR-DELEGA.                              00017980
017990*--- IL TIPO RECORD NON E' CORRETTO PER CUI NON POSSO CONTROLLARLO00017990
018000     IF W-FLAG-ERR = 1                                            00018000
018010        GO TO ML-100.                                             00018010
018020                                                                  00018020
018030 ML-092.                                                          00018030
018040     ADD 1 TO W-CTR-RIGA.                                         00018040
018050*                                                                 00018050
018060*--- SI MEMORIZZA IL TIPO RECORD LETTO PER I SUCCESSIVI CONTROLLI 00018060
018070*--- DI SEQUENZA                                                  00018070
018080*                                                                 00018080
018090     MOVE W-TIPO-REC-PREC     TO W-REC-PREC-V20.                  00018090
018100     MOVE BQVFB11-TIPO-RECORD TO W-TIPO-REC-PREC.                 00018100
018110*                                                                 00018110
018120*--- SI RICHIAMA LA PERFORM PER I CONTROLLI SUL RECORD LETTO      00018120
018130*--- A SECONDO DEL TIPO RECORD                                    00018130
018140*                                                                 00018140
018150     PERFORM RC-010-TIPO-REC THRU RC-990-TIPO-REC-EX.             00018150
018160                                                                  00018160
018170 ML-100.                                                          00018170
018180     IF W-FLAG-KO = 1                                             00018180
018190        PERFORM RB-010-KO THRU RB-990-KO-EX                       00018190
018200        GO TO ML-110.                                             00018200
018210                                                                  00018210
018220 ML-102.                                                          00018220
018230*                                                                 00018230
018240*--- SI LEGGE IL RECORD SUCCESSIVO E SI SCRIVE SU ESITI           00018240
018250*--- SUCCESSIVAMENTE IL RECORD LETTO IN PRECEDENZA PER            00018250
018260*--- SEGNALARE L'EVENTUALE FINE FILE TROVATA                      00018260
018270*                                                                 00018270
018280     READ BQVFB1 INTO BQVFB11 AT END                              00018280
018290          INITIALIZE BQVFB11                                      00018290
018300          MOVE 1 TO W-FINE-BQVFB1.                                00018300
018310     PERFORM RA-010-WRITE THRU RA-990-WRITE-EX.                   00018310
018320     IF W-FLAG-KO = 1                                             00018320
018330        PERFORM RF-010-SCR-INVII THRU RF-990-SCR-INVII-EX         00018330
018340        ADD 1             TO W-CTR-LETTI                          00018340
018350        MOVE BQVFB11      TO BQVFB21                              00018350
018360        MOVE ZERO         TO BQVFB21-ERR-DATI-COMUNI              00018360
018370        MOVE ZERO         TO BQVFB21-ANNO-TRASM                   00018370
018380        MOVE ZERO         TO BQVFB21-PROT-TRASM                   00018380
018390        MOVE ZERO         TO BQVFB21-PROG-REC                     00018390
018400        MOVE ZERO         TO BQVFB21-ERR-RECORD-49                00018400
018410        MOVE 508          TO BQVFB21-ERR-TIPO-RECORD              00018410
018420        MOVE 'E'          TO BQVFB21-ERR-TIPO-RECORD-A            00018420
018430        ADD 1             TO W-CTR-BLOC                           00018430
018440        MOVE '01'         TO BQVFB31-FLAG-TIPO-ERR                00018440
018450        PERFORM RB-010-KO THRU RB-990-KO-EX.                      00018450
018460                                                                  00018460
018470 ML-110.                                                          00018470
018480*                                                                 00018480
018490*--- SI CICLA SULLA PERFORM PER I CONTROLLI SUL RECORD            00018490
018500*--- SUCCESSIVO SENZA CONTROLLARNE LA CORRETTA SEQUENZIALITA'     00018500
018510*--- SE C'E' GIA' STATA UNA INTERRUZIONE DELLA NORMALE            00018510
018520*--- SEQUENZA                                                     00018520
018530*                                                                 00018530
018540     IF W-FINE-BQVFB1 = ZERO                                      00018540
018550        GO TO ML-050.                                             00018550
018560                                                                  00018560
018570 ML-120.                                                          00018570
018580*                                                                 00018580
018590*--- PER FINE FILE SI TERMINA L'ELABORAZIONE CON LA CLOSE         00018590
018600*--- DEGLI ARCHIVI E LA VISUALIZZAZIONE DEI CONTATORI STATISTICI  00018600
018610*--- DOPO AVER INSERITO SU INVII BANCHE / CONCESSIONARI.          00018610
018620                                                                  00018620
018630*                                                                 00018630
018640     IF W-FLAG-KO = 0                                             00018640
018650        PERFORM RF-010-SCR-INVII THRU RF-990-SCR-INVII-EX.        00018650
018660     ADD W-CTR-NO-BLOC TO W-CTR-TOT-NO-BLOC.                      00018660
018670     ADD W-CTR-BLOC    TO W-CTR-TOT-BLOC.                         00018670
018680     GO TO ML-140.                                                00018680
018690                                                                  00018690
018700 ML-130.                                                          00018700
018710*                                                                 00018710
018720*--- ARCHIVIO FLUSSI BANCHE / CONCESSIONARI VUOTO;                00018720
018730*--- SI TERMINA L'ELABORAZIONE IN ABEND                           00018730
018740*                                                                 00018740
018750     DISPLAY '*** BQVFB0-ML-130'.                                 00018750
018760     DISPLAY '*** ARCHIVIO FLUSSO -F24- BQVFB1 VUOTO'.            00018760
018770     MOVE 0001                TO ABEND-CODE.                      00018770
018780     CALL 'BQVFSR' USING ABEND-CODE.                              00018780
018790                                                                  00018790
018800 ML-140.                                                          00018800
018810*                                                                 00018810
018820*--- CHIUSURA DEGLI ARCHIVI                                       00018820
018830*                                                                 00018830
018840     CLOSE BQVFB1.                                                00018840
018850     CLOSE BQVFB2.                                                00018850
018860     CLOSE BQVFB3.                                                00018860
018870     CLOSE BQVFB5.                                                00018870
018880*                                                                 00018880
018890*--- SI VISUALIZZANO I DISPLAY DI FINE PROGRAMMA                  00018890
018900                                                                  00018900
018910     MOVE W-CTR-FLUSSI TO W-CTR-DISP.                             00018910
018920     DISPLAY '* NUMERO FLUSSI LOGICI ELABORATI  : '               00018920
018930                                              W-CTR-DISP  '  *'.  00018930
018940     MOVE W-CTR-TOT-NO-BLOC TO W-CTR-DISP.                        00018940
018950     DISPLAY '* TOTALE ERRORI NON BLOCCANTI     : '               00018950
018960                                              W-CTR-DISP  '  *'.  00018960
018970     MOVE W-CTR-TOT-BLOC TO W-CTR-DISP.                           00018970
018980     DISPLAY '* TOTALE ERRORI BLOCCANTI         : '               00018980
018990                                              W-CTR-DISP  '  *'.  00018990
019000     DISPLAY '*                                              *'.  00019000
019010     DISPLAY '* RIEPILOGO FINALE NUMERO RECORD               *'.  00019010
019020     MOVE W-CTR-LETTI TO W-CTR-DISP.                              00019020
019030     DISPLAY '* LETTI   DA BANCHE/CONCESSIONARI : '               00019030
019040                                              W-CTR-DISP  '  *'   00019040
019050     MOVE W-CTR-SCRITTI TO W-CTR-DISP.                            00019050
019060     DISPLAY '* SCRITTI SU FLUSSO CONTROLLATI   : '               00019060
019070                                              W-CTR-DISP  '  *'.  00019070
019080     MOVE W-CTR-SCR-INVII TO W-CTR-DISP.                          00019080
019090     DISPLAY '* SCRITTI SU FLUSSO INVII         : '               00019090
019100                                              W-CTR-DISP  '  *'.  00019100
019110     MOVE W-CTR-SCR-SQUADR TO W-CTR-DISP.                         00019110
019120     DISPLAY '* SCRITTI SU FLUSSO SQUADRATURE   : '               00019120
019130                                              W-CTR-DISP  '  *'.  00019130
019140     DISPLAY '************************************************'   00019140
019150     DISPLAY '*             FINE PROGRAMMA BQVFB0            *'   00019150
019160     DISPLAY '************************************************'.  00019160
019170*                                                                 00019170
019180                                                                  00019180
019190 ML-990.                                                          00019190
019200     STOP RUN.                                                    00019200
019210                                                                  00019210
019220*---                                                              00019220
019230*--- PERFORM RC-010-TIPO-REC - RICHIAMO PERFORM RELATIVA          00019230
019240*---                           AL TIPO RECORD LETTO               00019240
019250*---                                                              00019250
019260 RC-010-TIPO-REC.                                                 00019260
019270     IF BQVFB11-TIPO-RECORD = 'V00'                               00019270
019280        GO TO RC-190.                                             00019280
019290                                                                  00019290
019300 RC-020.                                                          00019300
019310     IF BQVFB11-TIPO-RECORD = 'V01'                               00019310
019320        GO TO RC-180.                                             00019320
019330                                                                  00019330
019340 RC-030.                                                          00019340
019350     IF BQVFB11-TIPO-RECORD = 'V02'                               00019350
019360        GO TO RC-170.                                             00019360
019370                                                                  00019370
019380 RC-040.                                                          00019380
019390     IF BQVFB11-TIPO-RECORD = 'V03'                               00019390
019400        GO TO RC-160.                                             00019400
019410                                                                  00019410
019420 RC-042.                                                          00019420
019430     IF BQVFB11-TIPO-RECORD = 'V04'                               00019430
019440        GO TO RC-158.                                             00019440
019450                                                                  00019450
019460 RC-044.                                                          00019460
019470     IF BQVFB11-TIPO-RECORD = 'V05'                               00019470
019480        GO TO RC-156.                                             00019480
019490                                                                  00019490
019500 RC-046.                                                          00019500
019510     IF BQVFB11-TIPO-RECORD = 'V06'                               00019510
019520        GO TO RC-154.                                             00019520
019530                                                                  00019530
019540 RC-048.                                                          00019540
019550     IF BQVFB11-TIPO-RECORD = 'V07'                               00019550
019560        GO TO RC-152.                                             00019560
019570                                                                  00019570
019580 RC-049.                                                          00019580
019590     IF BQVFB11-TIPO-RECORD = 'V12'                               00019590
019600        MOVE 'SI'  TO W-V12                                       00019600
019610        GO TO RC-151.                                             00019610
019620                                                                  00019620
019630 RC-050.                                                          00019630
019640     IF BQVFB11-TIPO-RECORD = 'V14' OR                            00019640
019650        BQVFB11-TIPO-RECORD = 'V15'                               00019650
019660        GO TO RC-150.                                             00019660
019670                                                                  00019670
019680 RC-055.                                                          00019680
019690     IF BQVFB11-TIPO-RECORD = 'V20'                               00019690
019700        GO TO RC-145.                                             00019700
019710                                                                  00019710
019720 RC-060.                                                          00019720
019730     IF BQVFB11-TIPO-RECORD = 'V36'                               00019730
019740        GO TO RC-140.                                             00019740
019750                                                                  00019750
019760 RC-070.                                                          00019760
019770     IF BQVFB11-TIPO-RECORD = 'V37'                               00019770
019780        GO TO RC-130.                                             00019780
019790                                                                  00019790
019800 RC-080.                                                          00019800
019810     IF BQVFB11-TIPO-RECORD = 'V38'                               00019810
019820        GO TO RC-120.                                             00019820
019830                                                                  00019830
019840 RC-090.                                                          00019840
019850     IF BQVFB11-TIPO-RECORD = 'V49'                               00019850
019860        GO TO RC-110.                                             00019860
019870                                                                  00019870
019880 RC-100.                                                          00019880
019890     PERFORM L1-010-CONTR-99 THRU L1-990-CONTR-99-EX.             00019890
019900     GO TO RC-990-TIPO-REC-EX.                                    00019900
019910                                                                  00019910
019920 RC-110.                                                          00019920
019930     PERFORM I1-010-CONTR-49 THRU I1-990-CONTR-49-EX.             00019930
019940     GO TO RC-990-TIPO-REC-EX.                                    00019940
019950                                                                  00019950
019960 RC-120.                                                          00019960
019970     PERFORM H1-010-CONTR-38 THRU H1-990-CONTR-38-EX.             00019970
019980     GO TO RC-990-TIPO-REC-EX.                                    00019980
019990                                                                  00019990
020000 RC-130.                                                          00020000
020010     PERFORM G1-010-CONTR-37 THRU G1-990-CONTR-37-EX.             00020010
020020     GO TO RC-990-TIPO-REC-EX.                                    00020020
020030                                                                  00020030
020040 RC-140.                                                          00020040
020050     PERFORM F1-010-CONTR-36 THRU F1-990-CONTR-36-EX.             00020050
020060     MOVE 'NO'  TO W-V12.                                         00020060
020070     GO TO RC-990-TIPO-REC-EX.                                    00020070
020080                                                                  00020080
020090 RC-145.                                                          00020090
020100     PERFORM R4-010-CONTR-20 THRU R4-990-CONTR-20-EX.             00020100
020110     GO TO RC-990-TIPO-REC-EX.                                    00020110
020120                                                                  00020120
020130 RC-150.                                                          00020130
020140     PERFORM E1-010-CONTR-CF THRU E1-990-CONTR-CF-EX.             00020140
020150     GO TO RC-990-TIPO-REC-EX.                                    00020150
020160                                                                  00020160
020170 RC-151.                                                          00020170
020180     PERFORM Q1-010-CONTR-12 THRU Q1-990-CONTR-12-EX.             00020180
020190     GO TO RC-990-TIPO-REC-EX.                                    00020190
020200                                                                  00020200
020210 RC-152.                                                          00020210
020220     PERFORM P1-010-CONTR-07 THRU P1-990-CONTR-07-EX.             00020220
020230     GO TO RC-990-TIPO-REC-EX.                                    00020230
020240                                                                  00020240
020250 RC-154.                                                          00020250
020260     PERFORM O1-010-CONTR-06 THRU O1-990-CONTR-06-EX.             00020260
020270     GO TO RC-990-TIPO-REC-EX.                                    00020270
020280                                                                  00020280
020290 RC-156.                                                          00020290
020300     PERFORM N1-010-CONTR-05 THRU N1-990-CONTR-05-EX.             00020300
020310     GO TO RC-990-TIPO-REC-EX.                                    00020310
020320                                                                  00020320
020330 RC-158.                                                          00020330
020340     PERFORM M1-010-CONTR-04 THRU M1-990-CONTR-04-EX.             00020340
020350     GO TO RC-990-TIPO-REC-EX.                                    00020350
020360                                                                  00020360
020370 RC-160.                                                          00020370
020380     PERFORM D1-010-CONTR-03 THRU D1-990-CONTR-03-EX.             00020380
020390     GO TO RC-990-TIPO-REC-EX.                                    00020390
020400                                                                  00020400
020410 RC-170.                                                          00020410
020420     PERFORM C1-010-CONTR-02 THRU C1-990-CONTR-02-EX.             00020420
020430     GO TO RC-990-TIPO-REC-EX.                                    00020430
020440                                                                  00020440
020450 RC-180.                                                          00020450
020460     PERFORM B1-010-CONTR-01 THRU B1-990-CONTR-01-EX.             00020460
020470     IF W-UFF-RIF NOT EQUAL SPACE AND                             00020470
020480        W-UFF-RIF NOT EQUAL ZERO                                  00020480
020490           MOVE '1' TO W-UFF-RIF-ERARIO.                          00020490
020500     IF W-NUM-RIF NOT EQUAL SPACE AND                             00020500
020510        W-NUM-RIF NOT EQUAL ZERO                                  00020510
020520           MOVE '1' TO W-NUM-RIF-ERARIO.                          00020520
020530     GO TO RC-990-TIPO-REC-EX.                                    00020530
020540                                                                  00020540
020550 RC-190.                                                          00020550
020560     IF W-FLAG-KO EQUAL 0                                         00020560
020570       PERFORM RF-010-SCR-INVII THRU RF-990-SCR-INVII-EX.         00020570
020580*--- SI RICHIAMA LA PERFORM PER IL CONTROLLO DEL RECORD DI TESTA  00020580
020590     PERFORM A1-010-CONTR-00 THRU A1-990-CONTR-00-EX.             00020590
020600                                                                  00020600
020610 RC-990-TIPO-REC-EX.                                              00020610
020620     EXIT.                                                        00020620
020630                                                                  00020630
020640*---                                                              00020640
020650*--- PERFORM A1-010-CONTR-00 - CONTROLLI SUL RECORD DI TESTA      00020650
020660*---                                                              00020660
020670 A1-010-CONTR-00.                                                 00020670
020680*---                                                              00020680
020690*--- SI IMPOSTANO ED INIZIALIZZANO LE AREE RELATIVE AD UN         00020690
020700*--- NUOVO INVIO E QUINDI AD UNA NUOVA DELEGA                     00020700
020710*---                                                              00020710
020720*                                                                 00020720
020730*** MODIFICA PER V36/V49 CONTESTUALI                              00020730
020740*                                                                 00020740
020750     MOVE ZERO TO W-CONT-V36.                                     00020750
020760     MOVE ZERO TO W-CONT-V49.                                     00020760
020770*                                                                 00020770
020780     MOVE ZERO TO W-FLAG-CONF-F24.                                00020780
020790     MOVE ZERO TO W-FLAG-CONF-I24.                                00020790
020800*                                                                 00020800
020810*---                                                              00020810
020820*--- MODIFICHE MAGGIO 2001                                        00020820
020830*---                                                              00020830
020840     MOVE ZERO          TO W-COMM-CALC-NEW.                       00020840
020850     MOVE ZERO          TO W-IND-S.                               00020850
020860     MOVE ZERO          TO W-FLAG-SQUADR.                         00020860
020870     MOVE ZERO          TO W-CTR-PROV-DIST.                       00020870
020880     INITIALIZE BQVFBS1.                                          00020880
020890     MOVE ZERO          TO W-FLG-ERR-BLOC-37.                     00020890
020900     MOVE ZERO          TO W-FLG-ERR-NO-BLOC-37.                  00020900
020910     MOVE ZERO          TO W-FLG-ERR-BLOC-38.                     00020910
020920     MOVE ZERO          TO W-FLG-ERR-NO-BLOC-38.                  00020920
020930     ADD W-CTR-NO-BLOC  TO W-CTR-TOT-NO-BLOC.                     00020930
020940     ADD W-CTR-BLOC     TO W-CTR-TOT-BLOC.                        00020940
020950     MOVE W-CTR-BLOC    TO W-APPO-CTR-BLOC.                       00020950
020960     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00020960
020970     MOVE ZERO TO W-FLAG-KO.                                      00020970
020980     MOVE '9'  TO W-FLAG-AGEV.                                    00020980
020990     MOVE ZERO TO W-SALDO-AGEV.                                   00020990
021000     MOVE ZERO TO W-NUM-RIF.                                      00021000
021010     MOVE ZERO TO W-NUM-RIF-04.                                   00021010
021020     MOVE ZERO TO W-UFF-RIF.                                      00021020
021030     MOVE ZERO TO W-COD-NUM-RIF.                                  00021030
021040     MOVE ZERO TO W-COD-FISC-KO.                                  00021040
021050     MOVE ZERO TO W-CTR-REC.                                      00021050
021060     MOVE ZERO TO W-ERR-DELEGA-PREC.                              00021060
021070     MOVE ZERO TO W-UFF-RIF-M.                                    00021070
021080     MOVE ZERO TO W-NUM-RIF-M.                                    00021080
021090     MOVE ZERO TO W-COD-FISC-KO-M.                                00021090
021100     MOVE ZERO TO W-UFF-RIF-ERARIO.                               00021100
021110     MOVE ZERO TO W-NUM-RIF-ERARIO.                               00021110
021120     MOVE 1    TO W-FLAG-CAMBIO-DELEGA.                           00021120
021130     MOVE 1    TO W-CTR-DELEGA.                                   00021130
021140     INITIALIZE W-CAMPI-COMUNI.                                   00021140
021150     MOVE ZERO TO W-APPO-FLAG-ERR-DATA-INV-F.                     00021150
021160     MOVE ZERO TO W-COD-ENTE.                                     00021160
021170     MOVE ZERO TO W-COD-ALTRO.                                    00021170
021180     INITIALIZE W-TAB-TOT.                                        00021180
021190*--- ICI                                                          00021190
021200     INITIALIZE W-TAB-COMUNI.                                     00021200
021210     MOVE ZERO TO W-IND-ICI.                                      00021210
021220     MOVE ZERO TO W-TOT-RIMB-TRIB.                                00021220
021230     MOVE ZERO TO W-TIPO-TRIB-NO-IMU.                             00021230
021240     MOVE ZERO TO W-TIPO-TRIB-NO-TARES.                           00021240
021250     MOVE ZERO TO W-TIPO-TRIB-NO-TASI.                            00021250
021260     MOVE ZERO TO W-FLAG-TRIB-CONC.                               00021260
021270     MOVE ZERO TO W-FLAG-CRED.                                    00021270
021280     MOVE ZERO TO W-FLAG-COMP-IVA.                                00021280
021290     MOVE ZERO TO W-FLAG-COMP-IRS.                                00021290
021300     MOVE ZERO TO W-FLAG-COMP-IRP.                                00021300
021310     MOVE ZERO TO W-FLAG-COMP-IRM.                                00021310
021320     MOVE ZERO TO W-FLAG-COMP-ELO.                                00021320
021330     MOVE ZERO TO W-FLAG-COMP-IRF.                                00021330
021340     MOVE ZERO TO W-FLAG-COMP-ADX.                                00021340
021350     MOVE ZERO TO W-FLAG-COMP-IIE.                                00021350
021360     MOVE ZERO TO W-FLAG-COMP-IFE.                                00021360
021370     MOVE ZERO TO W-FLAG-COMP-FF1.                                00021370
021380     MOVE ZERO TO W-FLAG-COMP-FF2.                                00021380
021390     MOVE ZERO TO W-FLAG-COMP-FF3.                                00021390
021400     MOVE ZERO TO W-FLAG-COMP-ORO.                                00021400
021410     MOVE ZERO TO W-FLAG-COMP-SEC.                                00021410
021420     MOVE ZERO TO W-FLAG-COMP-IEC.                                00021420
021430     MOVE ZERO TO W-FLAG-COMP-LEZ.                                00021430
021440     MOVE ZERO TO W-FLAG-COMP-QR1.                                00021440
021441     MOVE ZERO TO W-FLAG-COMP-BTC.                                00021441
021450*---                                                              00021450
021460     MOVE ZERO TO W-COMP-FISCO.                                   00021460
021470     MOVE ZERO TO W-COMP-REG.                                     00021470
021480     MOVE ZERO TO W-COMP-EL.                                      00021480
021490     MOVE SPACE TO W-TAB-APPO-PROV.                               00021490
021500     MOVE ZERO  TO W-S.                                           00021500
021510     MOVE ZERO  TO W-P.                                           00021510
021520     INITIALIZE W-TAB-SALDI.                                      00021520
021530     MOVE ZERO  TO W-ALTRI-PARAM.                                 00021530
021540     MOVE ZERO  TO W-FLAG-NUOVA-DELEGA.                           00021540
021550     MOVE ZERO  TO W-FLAG-E.                                      00021550
021560     MOVE ZERO  TO W-FLAG-37.                                     00021560
021570     MOVE ZERO  TO W-PRES-ACCR.                                   00021570
021580     MOVE ZERO  TO W-IND.                                         00021580
021590     MOVE ZERO  TO W-IND-MAX.                                     00021590
021600     MOVE ZERO  TO W-FLAG-ERR-SUCC.                               00021600
021610     MOVE ZERO  TO W-FLAG-NO-QUAD.                                00021610
021620     MOVE 0     TO W-PROG-ACCR-BON.                               00021620
021630     MOVE 0     TO W-COMM-RES.                                    00021630
021640*---                                                              00021640
021650     ADD 1      TO W-CTR-00.                                      00021650
021660*     ADD 1      TO W-CTR-FLUSSI.                                 00021660
021670     MOVE ZERO  TO W-FLAG-ERR-SEQ.                                00021670
021680     MOVE ZERO  TO BQVFB21-ERR-RECORD-00.                         00021680
021690*---                                                              00021690
021700     MOVE ZERO  TO W-DATA-ANTIC.                                  00021700
021710*---                                                              00021710
021720*--- SI CONTROLLA LA RELEASE                                      00021720
021730*---                                                              00021730
021740*---                                                              00021740
021750*--- SI CONTROLLA LA RELEASE PER TRATTAMENTO ICI E ANTICIPO       00021750
021760*---                                                              00021760
021770*F INIZIO MODIFICA 13/04/2004 - MONOPOLI                          00021770
021780*    IF BQVFB11-00-RELEASE = 'R03' OR 'R04'                       00021780
021790*       MOVE BQVFB11-00-RELEASE TO W-VERS                         00021790
021800*       GO TO A1-014.                                             00021800
021810     IF BQVFB11-00-RELEASE = 'R03' OR 'R04' OR 'R05' OR 'R06'     00021810
021820        MOVE BQVFB11-00-RELEASE TO W-VERS                         00021820
021830        GO TO A1-014.                                             00021830
021840*F FINE MODIFICA 13/04/2004 - MONOPOLI                            00021840
021850                                                                  00021850
021860 A1-012.                                                          00021860
021870*--- ERRORE DI RELEASE                                            00021870
021880     MOVE 55 TO BQVFB21-00-ERR-RELEASE.                           00021880
021890     MOVE 'E' TO BQVFB21-00-ERR-RELEASE-A.                        00021890
021900     MOVE 1 TO W-FLAG-KO.                                         00021900
021910     ADD 1 TO W-CTR-BLOC.                                         00021910
021920     MOVE '07' TO BQVFB31-FLAG-TIPO-ERR.                          00021920
021930     GO TO A1-990-CONTR-00-EX.                                    00021930
021940                                                                  00021940
021950 A1-014.                                                          00021950
021960*---                                                              00021960
021970*--- SI CONTROLLA IL CODICE ABI                                   00021970
021980*---                                                              00021980
021990     IF BQVFB11-COD-ABIA NUMERIC                                  00021990
022000        GO TO A1-030.                                             00022000
022010                                                                  00022010
022020 A1-020.                                                          00022020
022030*--- ERRORE DI NUMERICITA' DEL CODICE ABI                         00022030
022040     MOVE 33 TO BQVFB21-ERR-COD-ABI.                              00022040
022050     MOVE 'E' TO BQVFB21-ERR-COD-ABI-A.                           00022050
022060     MOVE 1 TO W-FLAG-KO.                                         00022060
022070     ADD 1 TO W-CTR-BLOC.                                         00022070
022080     MOVE '02' TO BQVFB31-FLAG-TIPO-ERR.                          00022080
022090     GO TO A1-990-CONTR-00-EX.                                    00022090
022100                                                                  00022100
022110 A1-030.                                                          00022110
022120*--- SI CONTROLLA IL TIPO ENTE                                    00022120
022130     IF BQVFB11-00-TIPO-ENTE = '1'                                00022130
022140     GO TO A1-034.                                                00022140
022150                                                                  00022150
022160 A1-032.                                                          00022160
022170*--- SI CONTROLLA L'ESISTENZA DEL CODICE ABI IN ARCHIVIO          00022170
022180     MOVE BQVFB11-COD-ABI TO W-APPO-COD-ABI.                      00022180
022190     MOVE BQVFB11-COD-ABI TO W-AZIENDA-INP.                       00022190
022200     PERFORM RP-010-RIC-AZIENDE THRU RP-990-RIC-AZIENDE-EX.       00022200
022210     GO TO A1-036.                                                00022210
022220                                                                  00022220
022230 A1-034.                                                          00022230
022240*--- SI CONTROLLA L'ESISTENZA DEL CODICE AMBITO IN ARCHIVIO       00022240
022250     MOVE BQVFB11-COD-ABI TO W-APPO-COD-ABI.                      00022250
022260     MOVE BQVFB11-COD-ABI TO W-AMBITO-INP-N.                      00022260
022270     PERFORM RO-010-RIC-AMBITI THRU RO-990-RIC-AMBITI-EX.         00022270
022280 A1-036.                                                          00022280
022290     IF W-FLAG-TROVATO = 1                                        00022290
022300        GO TO A1-070.                                             00022300
022310                                                                  00022310
022320 A1-040.                                                          00022320
022330*--- ERRORE DI ESISTENZA DEL CODICE ABI                           00022330
022340     MOVE 146 TO BQVFB21-ERR-COD-ABI.                             00022340
022350     MOVE 'E' TO BQVFB21-ERR-COD-ABI-A.                           00022350
022360     MOVE 1 TO W-FLAG-KO.                                         00022360
022370     ADD 1 TO W-CTR-BLOC.                                         00022370
022380     MOVE '02' TO BQVFB31-FLAG-TIPO-ERR.                          00022380
022390     GO TO A1-990-CONTR-00-EX.                                    00022390
022400                                                                  00022400
022410 A1-070.                                                          00022410
022420*--- SI CONTROLLA LA CORRETTEZZA E LA VALIDITA'                   00022420
022430*--- DELLA DATA DI BONIFICO                                       00022430
022440     MOVE BQVFB11-DATA-BONIF TO BQVFDA1-DAT1.                     00022440
022450     MOVE W-APPO-DATA-SYS    TO BQVFDA1-DAT2.                     00022450
022460     CALL 'BQVFDA' USING BQVFDA1.                                 00022460
022470     IF BQVFDA1-OK = 0                                            00022470
022480        GO TO A1-090.                                             00022480
022490                                                                  00022490
022500 A1-080.                                                          00022500
022510*--- ERRORE DI CORRETTEZZA DELLA DATA BONIFICO                    00022510
022520     MOVE 96  TO BQVFB21-ERR-DATA-BONIF.                          00022520
022530     MOVE 'E' TO BQVFB21-ERR-DATA-BONIF-A.                        00022530
022540     MOVE 1 TO W-FLAG-KO.                                         00022540
022550     ADD 1 TO W-CTR-BLOC.                                         00022550
022560     MOVE '03' TO BQVFB31-FLAG-TIPO-ERR.                          00022560
022570     GO TO A1-990-CONTR-00-EX.                                    00022570
022580                                                                  00022580
022590 A1-090.                                                          00022590
022600     IF BQVFDA1-SETTIMANA     < 6 AND                             00022600
022610        BQVFDA1-FESTIVO       = 0 AND                             00022610
022620        BQVFDA1-GIORNI    NOT < W-GIORNI-DIFF                     00022620
022630        GO TO A1-110.                                             00022630
022640                                                                  00022640
022650 A1-100.                                                          00022650
022660*--- ERRORE DI VALIDITA' DELLA DATA BONIFICO                      00022660
022670     MOVE 45  TO BQVFB21-ERR-DATA-BONIF.                          00022670
022680     MOVE 'E' TO BQVFB21-ERR-DATA-BONIF-A.                        00022680
022690     MOVE 1 TO W-FLAG-KO.                                         00022690
022700     ADD 1 TO W-CTR-BLOC.                                         00022700
022710     MOVE '03' TO BQVFB31-FLAG-TIPO-ERR.                          00022710
022720     GO TO A1-990-CONTR-00-EX.                                    00022720
022730                                                                  00022730
022740 A1-110.                                                          00022740
022750*---                                                              00022750
022760*--- ICI E ANTICIPO: SI CONTROLLA CHE CON VERSIONE 'R04' SIANO    00022760
022770*--- INVIATI SOLO FLUSSI CON DATA BONIFICO > '20020610'           00022770
022780*---                                                              00022780
022790     IF BQVFB11-DATA-BONIF < '20020610' AND                       00022790
022800        BQVFB11-00-RELEASE = 'R04'                                00022800
022810*--- ERRORE DI COERENZA DELLA DATA BONIFICO CON LA RELEASE        00022810
022820        MOVE 55 TO BQVFB21-00-ERR-RELEASE                         00022820
022830        MOVE 'E' TO BQVFB21-00-ERR-RELEASE-A                      00022830
022840        MOVE 1 TO W-FLAG-KO                                       00022840
022850        ADD 1 TO W-CTR-BLOC                                       00022850
022860        MOVE '07' TO BQVFB31-FLAG-TIPO-ERR                        00022860
022870        GO TO A1-990-CONTR-00-EX.                                 00022870
022880*---                                                              00022880
022890*--- SI MEMORIZZA LA DATA BONIFICO DEL RECORD DI TESTA            00022890
022900     MOVE BQVFB11-DATA-BONIF TO W-APPO-DATA-BON.                  00022900
022910*--- SI CONTROLLA IL PROGRESSIVO TRASMISSIONE                     00022910
022920     IF BQVFB11-00-PROG-TRASMA NUMERIC                            00022920
022930        GO TO A1-130.                                             00022930
022940                                                                  00022940
022950 A1-120.                                                          00022950
022960*--- ERRORE DI NUMERICITA' DEL PROGRESSIVO TRASMISSIONE           00022960
022970     MOVE 33 TO BQVFB21-00-ERR-PROG-TRASM.                        00022970
022980     MOVE 'E' TO BQVFB21-00-ERR-PROG-TRASM-A.                     00022980
022990     MOVE 1 TO W-FLAG-KO.                                         00022990
023000     ADD 1 TO W-CTR-BLOC.                                         00023000
023010     MOVE '04' TO BQVFB31-FLAG-TIPO-ERR.                          00023010
023020     GO TO A1-990-CONTR-00-EX.                                    00023020
023030                                                                  00023030
023040 A1-130.                                                          00023040
023050*--- SI CONTROLLA LA VALIDITA' DEL PROGRESSIVO TRASMISSIONE       00023050
023060     IF BQVFB11-00-PROG-TRASMA > ZERO                             00023060
023070        GO TO A1-150.                                             00023070
023080                                                                  00023080
023090 A1-140.                                                          00023090
023100*--- ERRORE DI VALIDITA' DEL PROGRESSIVO TRASMISSIONE             00023100
023110     MOVE 39 TO BQVFB21-00-ERR-PROG-TRASM.                        00023110
023120     MOVE 'E' TO BQVFB21-00-ERR-PROG-TRASM-A.                     00023120
023130     MOVE 1 TO W-FLAG-KO.                                         00023130
023140     ADD 1 TO W-CTR-BLOC.                                         00023140
023150     MOVE '04' TO BQVFB31-FLAG-TIPO-ERR.                          00023150
023160     GO TO A1-990-CONTR-00-EX.                                    00023160
023170                                                                  00023170
023180 A1-150.                                                          00023180
023190*--- SI MEMORIZZA IL PROGRESSIVO TRASMISSIONE DEL RECORD DI TESTA 00023190
023200     MOVE BQVFB11-00-PROG-TRASM TO W-APPO-PROG-TRASM.             00023200
023210*--- SI CONTROLLA LA CORRETTEZZA DEL TIPO INVIO                   00023210
023220     IF BQVFB11-00-TIPO-INVIO NOT = 'O' AND                       00023220
023230        BQVFB11-00-TIPO-INVIO NOT = 'C' AND                       00023230
023240        BQVFB11-00-TIPO-INVIO NOT = 'A'                           00023240
023250        MOVE 55 TO BQVFB21-00-ERR-TIPO-INVIO                      00023250
023260        MOVE 'E' TO BQVFB21-00-ERR-TIPO-INVIO-A                   00023260
023270        MOVE 1  TO W-FLAG-KO                                      00023270
023280        ADD 1 TO W-CTR-BLOC                                       00023280
023290        MOVE '05' TO BQVFB31-FLAG-TIPO-ERR                        00023290
023300        GO TO A1-990-CONTR-00-EX.                                 00023300
023310                                                                  00023310
023320 A1-160.                                                          00023320
023330*--- SI CONTROLLA LA NUMERICITA' DEL PROGRESSIVO INVIO            00023330
023340     IF BQVFB11-00-PROG-INVIOA NUMERIC                            00023340
023350        GO TO A1-250.                                             00023350
023360                                                                  00023360
023370 A1-240.                                                          00023370
023380*--- ERRORE DI NUMERICITA' DEL PROGRESSIVO INVIO                  00023380
023390     MOVE 33 TO BQVFB21-00-ERR-PROG-INVIO.                        00023390
023400     MOVE 33 TO W-APPO-ERR-PROG-INVIO.                            00023400
023410     MOVE 'E' TO BQVFB21-00-ERR-PROG-INVIO-A.                     00023410
023420     ADD 1 TO W-CTR-BLOC.                                         00023420
023430     MOVE '06' TO BQVFB31-FLAG-TIPO-ERR.                          00023430
023440     MOVE 1  TO W-FLAG-KO.                                        00023440
023450     GO TO A1-270.                                                00023450
023460                                                                  00023460
023470 A1-250.                                                          00023470
023480*--- SI CONTROLLA LA CORRETTEZZA DEL PROGRESSIVO INVIO            00023480
023490     IF (BQVFB11-00-PROG-INVIO = ZERO AND                         00023490
023500         BQVFB11-00-TIPO-INVIO = 'O'     ) OR                     00023500
023510        (BQVFB11-00-PROG-INVIO > ZERO AND                         00023510
023520         BQVFB11-00-TIPO-INVIO = 'C'     ) OR                     00023520
023530        (BQVFB11-00-PROG-INVIO > ZERO AND                         00023530
023540         BQVFB11-00-TIPO-INVIO = 'A'     )                        00023540
023550        GO TO A1-270.                                             00023550
023560                                                                  00023560
023570 A1-260.                                                          00023570
023580*--- ERRORE DI CORRETTEZZA DEL PROGRESSIVO INVIO                  00023580
023590     MOVE 24  TO BQVFB21-00-ERR-PROG-INVIO.                       00023590
023600     MOVE 24  TO W-APPO-ERR-PROG-INVIO.                           00023600
023610     IF  BQVFB11-00-TIPO-INVIO NOT = 'O'                          00023610
023620       MOVE 39  TO BQVFB21-00-ERR-PROG-INVIO                      00023620
023630       MOVE 39  TO W-APPO-ERR-PROG-INVIO.                         00023630
023640     MOVE 1  TO W-FLAG-KO.                                        00023640
023650     MOVE 'E' TO BQVFB21-00-ERR-PROG-INVIO-A.                     00023650
023660     ADD 1 TO W-CTR-BLOC.                                         00023660
023670     MOVE '06' TO BQVFB31-FLAG-TIPO-ERR.                          00023670
023680                                                                  00023680
023690 A1-270.                                                          00023690
023700     IF W-FLAG-KO = 1                                             00023700
023710        GO TO A1-990-CONTR-00-EX.                                 00023710
023720                                                                  00023720
023730 A1-280.                                                          00023730
023740*--- SI MEMORIZZA IL RECORD TESTA                                 00023740
023750     MOVE BQVFB11-DATI-RECORD-00 TO W-APPO-REC-00.                00023750
023760*--- SI CONTROLLA LA VALIDITA' DEL PROGRESSIVO DELEGA             00023760
023770     IF BQVFB11-00-PROG-DELEGAA NOT NUMERIC OR                    00023770
023780        BQVFB11-00-PROG-DELEGA  NOT = ZERO                        00023780
023790        MOVE 55 TO BQVFB21-00-ERR-PROG-DELEGA                     00023790
023800        MOVE 'E' TO BQVFB21-00-ERR-PROG-DELEGA-A                  00023800
023810        ADD 1 TO W-CTR-BLOC.                                      00023810
023820     IF BQVFB21-00-ERR-PROG-DELEGA = ZERO OR                      00023820
023830        BQVFB21-ERR-TIPO-RECORD-A  = 'E'                          00023830
023840        GO TO A1-360.                                             00023840
023850                                                                  00023850
023860 A1-290.                                                          00023860
023870     IF BQVFB21-ERR-TIPO-RECORD-A  = 'W'                          00023870
023880        SUBTRACT 1 FROM W-CTR-NO-BLOC.                            00023880
023890     MOVE 508 TO BQVFB21-ERR-TIPO-RECORD.                         00023890
023900     MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                       00023900
023910     ADD 1 TO W-CTR-BLOC.                                         00023910
023920                                                                  00023920
023930 A1-360.                                                          00023930
023940*--- SI CONTROLLA LA VALIDITA' DELL'IDENTIFICATIVO DEL FILE       00023940
023950     IF BQVFB11-00-IDENT-FILE = SPACE                             00023950
023960        MOVE 39 TO BQVFB21-00-ERR-IDENT-FILE                      00023960
023970        MOVE 'E' TO BQVFB21-00-ERR-IDENT-FILE-A                   00023970
023980        MOVE 39 TO W-APPO-ERR-IDENT-FILE                          00023980
023990        ADD 1 TO W-CTR-BLOC.                                      00023990
024000                                                                  00024000
024010 A1-370.                                                          00024010
024020     IF BQVFB11-00-TIPO-INVIO NOT = 'O'                           00024020
024030        GO TO A1-390.                                             00024030
024040                                                                  00024040
024050 A1-380.                                                          00024050
024060*--- SI CONTROLLA LA VALIDITA' DELL'IDENTIFICATIVO DEL FILE       00024060
024070*--- DA CORREGGERE PER INVIO ORDINARIO                            00024070
024080     IF BQVFB11-00-IDENT-FILE-CORR NOT = SPACE                    00024080
024090        MOVE 15 TO BQVFB21-00-ERR-IDENT-FILE-CORR                 00024090
024100        MOVE 'E' TO BQVFB21-00-ERR-IDENT-FILE-C-A                 00024100
024110        MOVE 15 TO W-APPO-ERR-IDENT-FILE-CORR                     00024110
024120        ADD 1 TO W-CTR-BLOC.                                      00024120
024130     GO TO A1-410.                                                00024130
024140                                                                  00024140
024150 A1-390.                                                          00024150
024160*--- SI CONTROLLA LA VALIDITA' DELL'IDENTIFICATIVO DEL FILE       00024160
024170*--- DA CORREGGERE PER INVIO CORRETTIVO                           00024170
024180     IF BQVFB11-00-IDENT-FILE-CORR NOT = SPACE                    00024180
024190        GO TO A1-410.                                             00024190
024200                                                                  00024200
024210 A1-400.                                                          00024210
024220*--- ERRORE DI VALIDITA' DELL'IDENTIFICATIVO DEL FILE             00024220
024230     MOVE 39 TO BQVFB21-00-ERR-IDENT-FILE-CORR.                   00024230
024240     MOVE 'E' TO BQVFB21-00-ERR-IDENT-FILE-C-A.                   00024240
024250     MOVE 39 TO W-APPO-ERR-IDENT-FILE-CORR.                       00024250
024260     ADD 1 TO W-CTR-BLOC.                                         00024260
024270                                                                  00024270
024280 A1-410.                                                          00024280
024290*--- SI CONTROLLA LA DATA DI CREAZIONE DEL FILE                   00024290
024300     IF BQVFB11-00-DATA-CR-FILE NUMERIC                           00024300
024310        GO TO A1-440.                                             00024310
024320                                                                  00024320
024330 A1-430.                                                          00024330
024340*--- ERRORE DI NUMERICITA' DELLA DATA DI CREAZIONE DEL FILE       00024340
024350     MOVE 33 TO BQVFB21-00-ERR-DATA-CR-FILE.                      00024350
024360     MOVE 'W' TO BQVFB21-00-ERR-DATA-CR-FILE-A.                   00024360
024370     MOVE 33 TO W-APPO-ERR-DATA-CR-FILE.                          00024370
024380     ADD 1 TO W-CTR-NO-BLOC.                                      00024380
024390     GO TO A1-470.                                                00024390
024400                                                                  00024400
024410 A1-440.                                                          00024410
024420*--- SI CONTROLLA LA CORRETTEZZA DELLA DATA DI CREAZIONE DEL FILE 00024420
024430     MOVE BQVFB11-00-DATA-CR-FILE TO BQVFDA1-DAT1.                00024430
024440     MOVE SPACE                   TO BQVFDA1-DAT2.                00024440
024450     CALL 'BQVFDA' USING BQVFDA1.                                 00024450
024460     IF BQVFDA1-OK = ZERO                                         00024460
024470        GO TO A1-460.                                             00024470
024480                                                                  00024480
024490 A1-450.                                                          00024490
024500*--- ERRORE DI AMMISSIBILITA' DELLA DATA DI CREAZIONE DEL FILE    00024500
024510     MOVE 96 TO BQVFB21-00-ERR-DATA-CR-FILE.                      00024510
024520     MOVE 'W' TO BQVFB21-00-ERR-DATA-CR-FILE-A.                   00024520
024530     MOVE 96 TO W-APPO-ERR-DATA-CR-FILE.                          00024530
024540     ADD 1 TO W-CTR-NO-BLOC.                                      00024540
024550     GO TO A1-470.                                                00024550
024560                                                                  00024560
024570 A1-460.                                                          00024570
024580*--- SI CONTROLLA LA VALIDITA' DELLA DATA DI CREAZIONE DEL FILE   00024580
024590     IF BQVFB11-00-DATA-CR-FILE > W-APPO-DATA-SYS                 00024590
024600        MOVE 45 TO BQVFB21-00-ERR-DATA-CR-FILE                    00024600
024610        MOVE 'W' TO BQVFB21-00-ERR-DATA-CR-FILE-A                 00024610
024620        MOVE 45 TO W-APPO-ERR-DATA-CR-FILE                        00024620
024630        ADD 1 TO W-CTR-NO-BLOC.                                   00024630
024640                                                                  00024640
024650 A1-470.                                                          00024650
024660*--- SI CONTROLLA LA DATA DI INVIO DEL FILE                       00024660
024670     IF BQVFB11-00-DATA-INVIO-FILE NUMERIC                        00024670
024680        GO TO A1-490.                                             00024680
024690                                                                  00024690
024700 A1-480.                                                          00024700
024710*--- ERRORE DI NUMERICITA' DELLA DATA DI INVIO DEL FILE           00024710
024720     MOVE 33 TO BQVFB21-00-ERR-DATA-INVIO-FILE.                   00024720
024730     MOVE 'E' TO BQVFB21-00-ERR-DATA-INVIO-F-A.                   00024730
024740     MOVE 33 TO W-APPO-ERR-DATA-INVIO-FILE.                       00024740
024750     MOVE 'E' TO W-APPO-FLAG-ERR-DATA-INV-F.                      00024750
024760     ADD 1 TO W-CTR-BLOC.                                         00024760
024770     GO TO A1-520.                                                00024770
024780                                                                  00024780
024790 A1-490.                                                          00024790
024800*--- SI CONTROLLA LA CORRETTEZZA DELLA DATA DI INVIO DEL FILE     00024800
024810     MOVE BQVFB11-00-DATA-INVIO-FILE TO BQVFDA1-DAT1.             00024810
024820     MOVE SPACE                   TO BQVFDA1-DAT2.                00024820
024830     CALL 'BQVFDA' USING BQVFDA1.                                 00024830
024840     IF BQVFDA1-OK = ZERO                                         00024840
024850        GO TO A1-510.                                             00024850
024860                                                                  00024860
024870 A1-500.                                                          00024870
024880*--- ERRORE DI AMMISSIBILITA' DELLA DATA DI INVIO DEL FILE        00024880
024890     MOVE 96 TO BQVFB21-00-ERR-DATA-INVIO-FILE.                   00024890
024900     MOVE 'W' TO BQVFB21-00-ERR-DATA-INVIO-F-A.                   00024900
024910     MOVE 96 TO W-APPO-ERR-DATA-INVIO-FILE.                       00024910
024920     MOVE 'W' TO W-APPO-FLAG-ERR-DATA-INV-F.                      00024920
024930     ADD 1 TO W-CTR-NO-BLOC.                                      00024930
024940     GO TO A1-520.                                                00024940
024950                                                                  00024950
024960 A1-510.                                                          00024960
024970*--- SI CONTROLLA LA VALIDITA' DELLA DATA DI INVIO DEL FILE       00024970
024980     IF BQVFB11-00-DATA-INVIO-FILE > W-APPO-DATA-SYS              00024980
024990        MOVE 45 TO BQVFB21-00-ERR-DATA-INVIO-FILE                 00024990
025000        MOVE 'W' TO BQVFB21-00-ERR-DATA-INVIO-F-A                 00025000
025010        MOVE 45 TO W-APPO-ERR-DATA-INVIO-FILE                     00025010
025020        MOVE 'W' TO W-APPO-FLAG-ERR-DATA-INV-F                    00025020
025030        ADD 1 TO W-CTR-NO-BLOC.                                   00025030
025040                                                                  00025040
025050 A1-520.                                                          00025050
025060*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA OPERAZIONE     00025060
025070* INIZIO MODIFICA EURO                                            00025070
025080*                                                                 00025080
025090     IF (    BQVFB11-00-DIV-OPER NOT = 'ITL'                      00025090
025100         AND BQVFB11-00-DIV-OPER NOT = 'EUR' )                    00025100
025110*                                                                 00025110
025120******** AND W-APPO-DATA-SYS < BQVFCO1-DATA-EUR ) OR              00025120
025130******* (BQVFB11-00-DIV-OPER NOT = 'EUR' AND                      00025130
025140******** W-APPO-DATA-SYS NOT < BQVFCO1-DATA-EUR )                 00025140
025150* FINE MODIFICA EURO                                              00025150
025160        MOVE 55 TO BQVFB21-00-ERR-DIV-OPER                        00025160
025170        MOVE 55 TO W-APPO-ERR-DIV-OPER                            00025170
025180        MOVE 'E' TO BQVFB21-00-ERR-DIV-OPER-A                     00025180
025190        ADD 1 TO W-CTR-BLOC.                                      00025190
025200                                                                  00025200
025210 A1-530.                                                          00025210
025220*--- SI CONTROLLA IL CODICE ABI MITTENTE                          00025220
025230     IF BQVFB11-00-ABI-MITTA NUMERIC                              00025230
025240        GO TO A1-550.                                             00025240
025250                                                                  00025250
025260 A1-540.                                                          00025260
025270*--- ERRORE DI NUMERICITA' DEL CODICE ABI                         00025270
025280     MOVE 33 TO BQVFB21-00-ERR-ABI-MITT.                          00025280
025290     MOVE 'W' TO BQVFB21-00-ERR-ABI-MITT-A.                       00025290
025300     MOVE 33 TO W-APPO-ERR-ABI-MITT.                              00025300
025310     ADD 1 TO W-CTR-NO-BLOC.                                      00025310
025320     GO TO A1-590.                                                00025320
025330                                                                  00025330
025340 A1-550.                                                          00025340
025350     IF BQVFB21-00-TIPO-ENTE = '1'                                00025350
025360           GO TO A1-585.                                          00025360
025370 A1-555.                                                          00025370
025380*--- SI CONTROLLA L'ESISTENZA DEL CODICE ABI IN ARCHIVIO          00025380
025390     MOVE BQVFB11-00-ABI-MITT TO W-AZIENDA-INP.                   00025390
025400     PERFORM RP-010-RIC-AZIENDE THRU RP-990-RIC-AZIENDE-EX.       00025400
025410     IF W-FLAG-TROVATO = 1                                        00025410
025420        GO TO A1-590.                                             00025420
025430                                                                  00025430
025440 A1-560.                                                          00025440
025450*--- ERRORE DI ESISTENZA DEL CODICE ABI                           00025450
025460     MOVE 55  TO BQVFB21-00-ERR-ABI-MITT.                         00025460
025470     MOVE 'W' TO BQVFB21-00-ERR-ABI-MITT-A.                       00025470
025480     MOVE 55  TO W-APPO-ERR-ABI-MITT.                             00025480
025490     ADD 1 TO W-CTR-NO-BLOC.                                      00025490
025500     GO TO A1-590.                                                00025500
025510                                                                  00025510
025520 A1-585.                                                          00025520
025530*--- ERRORE DI CORRETTEZZA DEL MITTENTE                           00025530
025540     IF BQVFB11-00-ABI-MITT NOT = BQVFB11-COD-ABI                 00025540
025550        MOVE 55 TO BQVFB21-00-ERR-ABI-MITT                        00025550
025560        MOVE 'W' TO BQVFB21-00-ERR-ABI-MITT-A                     00025560
025570        MOVE 55 TO W-APPO-ERR-ABI-MITT                            00025570
025580        ADD 1 TO W-CTR-NO-BLOC.                                   00025580
025590                                                                  00025590
025600 A1-590.                                                          00025600
025610*--- ERRORE DI CORRETTEZZA DEL CODICE ABI RICEVENTE               00025610
025620     IF BQVFB11-00-ABI-RICEA NOT = W-ABI-CNC                      00025620
025630        MOVE 55 TO BQVFB21-00-ERR-ABI-RICE                        00025630
025640        MOVE 'W' TO BQVFB21-00-ERR-ABI-RICE-A                     00025640
025650        MOVE 55 TO W-APPO-ERR-ABI-RICE                            00025650
025660        ADD 1 TO W-CTR-NO-BLOC.                                   00025660
025670                                                                  00025670
025680*--- CONTROLLO TIPO ENTE                                          00025680
025690     MOVE 'B' TO W-FLAG-BANCA.                                    00025690
025700     IF BQVFB11-00-TIPO-ENTE = '1'                                00025700
025710        MOVE 'C' TO W-FLAG-BANCA.                                 00025710
025720     IF BQVFB11-00-TIPO-ENTE NOT = '1'                            00025720
025730                         AND NOT = '0'                            00025730
025740        MOVE 55  TO BQVFB21-00-ERR-TIPO-ENTE                      00025740
025750        MOVE 'E' TO BQVFB21-00-ERR-TIPO-ENTE-A                    00025750
025760        ADD 1 TO W-CTR-BLOC.                                      00025760
025770                                                                  00025770
025780 A1-990-CONTR-00-EX.                                              00025780
025790     EXIT.                                                        00025790
025800                                                                  00025800
025810*---                                                              00025810
025820*--- PERFORM B1-010-CONTR-01 - CONTROLLI SUL RECORD 01            00025820
025830*---                                                              00025830
025840 B1-010-CONTR-01.                                                 00025840
025850     MOVE ZERO TO BQVFB21-ERR-RECORD-01.                          00025850
025860     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00025860
025870     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00025870
025880*---                                                              00025880
025890*--- SI INIZIALIZZANO I CAMPI PER NUOVA DELEGA SE SI PROVIENE     00025890
025900*--- PER LA PRIMA VOLTA DA UN RECORD CHE NON SIA 01, 02 O 03      00025900
025910*---                                                              00025910
025920     IF W-FLAG-NUOVA-DELEGA = 1                                   00025920
025930        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00025930
025940     ADD 1 TO W-CTR-01.                                           00025940
025950*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00025950
025960*--- COMUNI TRA PIU' RECORD                                       00025960
025970*    MOVE 9 TO W-PROG-RIGA.                                       00025970
025980     COMPUTE W-APPO-CTR = W-CTR-01 - W-MEM-CTR-01.                00025980
025990     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00025990
026000                                                                  00026000
026010 B1-020.                                                          00026010
026020* INIZIO MODIFICA EURO                                            00026020
026030*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00026030
026040*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00026040
026050* SI ESEGUE LO STESSO CONTROLLO ANCHE PER DIVISE UGUALI           00026050
026060     IF (BQVFB11-01-DIV-OPER NOT = W-APPO-DIV-OPER AND            00026060
026070         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00026070
026080     OR BQVFB11-01-DIV-OPER = W-APPO-DIV-OPER                     00026080
026090        GO TO B1-060.                                             00026090
026100                                                                  00026100
026110 B1-030.                                                          00026110
026120*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00026120
026130**** IF BQVFB11-01-DIV-OPER NOT = W-APPO-DIV-OPER AND             00026130
026140******* W-APPO-ERR-DIV-OPER = ZERO                                00026140
026150******* GO TO B1-050.                                             00026150
026160****                                                              00026160
026170*B1-040.                                                          00026170
026180*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00026180
026190**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-01-ERR-DIV-OPER.         00026190
026200**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00026200
026210******* MOVE 'E' TO BQVFB21-01-ERR-DIV-OPER-A                     00026210
026220******* ADD 1 TO W-CTR-BLOC.                                      00026220
026230**** GO TO B1-080.                                                00026230
026240****                                                              00026240
026250*B1-050.                                                          00026250
026260* FINE MODIFICA EURO                                              00026260
026270*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00026270
026280     MOVE 502 TO BQVFB21-01-ERR-DIV-OPER.                         00026280
026290     MOVE 'E' TO BQVFB21-01-ERR-DIV-OPER-A.                       00026290
026300     ADD 1 TO W-CTR-BLOC.                                         00026300
026310     GO TO B1-080.                                                00026310
026320                                                                  00026320
026330 B1-060.                                                          00026330
026340* INIZIO MODIFICA EURO                                            00026340
026350*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00026350
026360*--- E CODICE DIVISA DEL RECORD DI TESTA ERRATO                   00026360
026370     IF  BQVFB11-01-DIV-OPER = W-APPO-DIV-OPER                    00026370
026380     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00026380
026390        MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-01-ERR-DIV-OPER       00026390
026400        MOVE 'E' TO BQVFB21-01-ERR-DIV-OPER-A                     00026400
026410        ADD 1 TO W-CTR-BLOC                                       00026410
026420        GO TO B1-080                                              00026420
026430     END-IF.                                                      00026430
026440*                                                                 00026440
026450 B1-065.                                                          00026450
026460*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00026460
026470     IF BQVFB11-01-DIV-OPER = 'EUR'                               00026470
026480     OR (    BQVFB11-01-DIV-OPER = 'ITL'                          00026480
026490         AND BQVFB11-01-DATA-RISC < BQVFCO1-DATA-EUR )            00026490
026500* FINE MODIFICA EURO                                              00026500
026510        GO TO B1-080.                                             00026510
026520                                                                  00026520
026530 B1-070.                                                          00026530
026540*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00026540
026550     MOVE 55 TO BQVFB21-01-ERR-DIV-OPER.                          00026550
026560     MOVE 'E' TO BQVFB21-01-ERR-DIV-OPER-A.                       00026560
026570     ADD 1 TO W-CTR-BLOC.                                         00026570
026580                                                                  00026580
026590 B1-080.                                                          00026590
026600*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00026600
026610*--- SUL RECORD 01                                                00026610
026614*                                                                 00026614
026620     MOVE SPACE TO W-DIV.                                         00026620
026630     IF W-APPO-ERR-DIV-OPER = ZERO                                00026630
026640        MOVE W-APPO-DIV-OPER TO W-DIV.                            00026640
026650*A MODIFICA 3/02/2006 - T3: AGGIUNTA TABELLA W-TAB-COD-T3         00026650
026660*F INIZIO MODIFICA 13/04/2004 - MONOPOLI: AGGIUNTO W-VERS         00026660
026670     CALL 'BQVFB1' USING   W-FLAG-BANCA                           00026670
026680                           W-FLAG-AGEV                            00026680
026690                           BQVFB21                                00026690
026700                           W-TAB-TOT                              00026700
026710                           W-REG                                  00026710
026720                           W-PF-PNF                               00026720
026730                           W-DIV                                  00026730
026740                           W-CTR-NO-BLOC                          00026740
026750                           W-CTR-BLOC                             00026750
026760                           W-TAB-TRIBUTI                          00026760
026770                           W-TAB-UFFICIO                          00026770
026780                           W-TAB-REGIONI                          00026780
026790                           W-TAB-ENTE                             00026790
026800                           W-TAB-PROV                             00026800
026810                           W-COMP-FISCO                           00026810
026820                           W-COMP-REG                             00026820
026830                           W-UFF-RIF                              00026830
026840                           W-NUM-RIF                              00026840
026850                           W-COD-FISC-KO                          00026850
026860                           W-VERS                                 00026860
026870                           W-TAB-COD-T3                           00026870
026880                           W-FLAG-RIF-V-T                         00026880
026890                           W-FLAG-RIF-V-A                         00026890
026900                           W-TOT-IMP-CRED-CONTR-V                 00026900
026910                           W-TAB-CAT-TRIB                         00026910
026920                           W-FLAG-RIF-C                           00026920
026930                           W-FLAG-RIF-T-AA-MIN                    00026930
026940                           W-FLAG-RIF-A-AA-MIN                    00026940
026950                           W-FLAG-TRIB-CONC                       00026950
026960                           W-FLAG-CRED                            00026960
026970                           W-TAB-COMP-TRIB                        00026970
026980                           W-FLAG-COMP-IVA                        00026980
026990                           W-FLAG-RIF-I-T                         00026990
027000                           W-FLAG-RIF-I-A                         00027000
027010                           W-TOT-IMP-CRED-CONTR-I                 00027010
027020                           W-FLAG-COMP-IRS                        00027020
027030                           W-FLAG-RIF-R-T                         00027030
027040                           W-FLAG-RIF-R-A                         00027040
027050                           W-TOT-IMP-CRED-CONTR-R                 00027050
027060                           W-FLAG-COMP-IRP                        00027060
027070                           W-FLAG-RIF-M-T                         00027070
027080                           W-FLAG-RIF-M-A                         00027080
027090                           W-TOT-IMP-CRED-CONTR-M                 00027090
027100                           W-FLAG-COMP-IRM                        00027100
027110                           W-FLAG-RIF-IRF-T                       00027110
027120                           W-FLAG-RIF-IRF-A                       00027120
027130                           W-TOT-IMP-CRED-CONTR-IRF               00027130
027140                           W-FLAG-COMP-IRF                        00027140
027150                           W-FLAG-RIF-ADX-T                       00027150
027160                           W-FLAG-RIF-ADX-A                       00027160
027170                           W-TOT-IMP-CRED-CONTR-ADX               00027170
027180                           W-FLAG-COMP-ADX                        00027180
027190                           W-FLAG-RIF-IIE-T                       00027190
027200                           W-FLAG-RIF-IIE-A                       00027200
027210                           W-TOT-IMP-CRED-CONTR-IIE               00027210
027220                           W-FLAG-COMP-IIE                        00027220
027230                           W-FLAG-RIF-IFE-T                       00027230
027240                           W-FLAG-RIF-IFE-A                       00027240
027250                           W-TOT-IMP-CRED-CONTR-IFE               00027250
027260                           W-FLAG-COMP-IFE                        00027260
027270                           W-FLAG-RIF-FF1-T                       00027270
027280                           W-FLAG-RIF-FF1-A                       00027280
027290                           W-TOT-IMP-CRED-CONTR-FF1               00027290
027300                           W-FLAG-COMP-FF1                        00027300
027310                           W-FLAG-RIF-FF2-T                       00027310
027320                           W-FLAG-RIF-FF2-A                       00027320
027330                           W-TOT-IMP-CRED-CONTR-FF2               00027330
027340                           W-FLAG-COMP-FF2                        00027340
027350                           W-FLAG-RIF-FF3-T                       00027350
027360                           W-FLAG-RIF-FF3-A                       00027360
027370                           W-TOT-IMP-CRED-CONTR-FF3               00027370
027380                           W-FLAG-COMP-FF3                        00027380
027390                           W-FLAG-RIF-ORO-T                       00027390
027400                           W-FLAG-RIF-ORO-A                       00027400
027410                           W-TOT-IMP-CRED-CONTR-ORO               00027410
027420                           W-FLAG-COMP-ORO                        00027420
027430                           W-FLAG-RIF-SEC-T                       00027430
027440                           W-FLAG-RIF-SEC-A                       00027440
027450                           W-TOT-IMP-CRED-CONTR-SEC               00027450
027460                           W-FLAG-COMP-SEC                        00027460
027470                           W-FLAG-RIF-IEC-T                       00027470
027480                           W-FLAG-RIF-IEC-A                       00027480
027490                           W-TOT-IMP-CRED-CONTR-IEC               00027490
027500                           W-FLAG-COMP-IEC                        00027500
027510                           W-FLAG-RIF-LEZ-T                       00027510
027520                           W-FLAG-RIF-LEZ-A                       00027520
027530                           W-TOT-IMP-CRED-CONTR-LEZ               00027530
027540                           W-FLAG-COMP-LEZ                        00027540
027550                           W-FLAG-RIF-QR1-T                       00027550
027560                           W-FLAG-RIF-QR1-A                       00027560
027570                           W-TOT-IMP-CRED-CONTR-QR1               00027570
027580                           W-FLAG-COMP-QR1                        00027580
027581                           W-FLAG-RIF-BTC-T                       00027581
027582                           W-FLAG-RIF-BTC-A                       00027582
027583                           W-TOT-IMP-CRED-CONTR-BTC               00027583
027584                           W-FLAG-COMP-BTC.                       00027584
027590*                                                                 00027590
027600     IF W-FLAG-RIF-C        = '1'                                 00027600
027610         MOVE 96                 TO BQVFB21-01-ERR-IMP-RIMB       00027610
027620         ADD 1                   TO W-CTR-BLOC                    00027620
027630         MOVE 'E'                TO BQVFB21-01-ERR-IMP-RIMB-A     00027630
027640     END-IF.                                                      00027640
027650     IF W-FLAG-RIF-T-AA-MIN = '1' OR                              00027650
027660        W-FLAG-RIF-A-AA-MIN = '1'                                 00027660
027670         MOVE 96                 TO BQVFB21-01-ERR-PERIODO-RIF    00027670
027680         ADD 1                   TO W-CTR-BLOC                    00027680
027690         MOVE 'E'                TO BQVFB21-01-ERR-PERIODO-RIF-A  00027690
027700     END-IF.                                                      00027700
027710     MOVE ZERO TO W-FLAG-RIF-C.                                   00027710
027720     MOVE ZERO TO W-FLAG-RIF-T-AA-MIN.                            00027720
027730     MOVE ZERO TO W-FLAG-RIF-A-AA-MIN.                            00027730
027740*                                                                 00027740
027750*F FINE MODIFICA 13/04/2004 - MONOPOLI: AGGIUNTO W-VERS           00027750
027760     IF BQVFB21-01-ERR-NUM-RIFER = 888 AND                        00027760
027770        BQVFB21-01-ERR-CODICE-FISC-A = 'W'                        00027770
027780        SUBTRACT 1       FROM W-CTR-NO-BLOC                       00027780
027790        ADD      1         TO W-CTR-BLOC.                         00027790
027800     IF BQVFB21-01-ERR-NUM-RIFER = 888 AND                        00027800
027810        BQVFB21-01-ERR-CODICE-FISC-A = '0'                        00027810
027820        ADD      1         TO W-CTR-BLOC.                         00027820
027830     IF BQVFB21-01-ERR-NUM-RIFER = 888                            00027830
027840        MOVE 55            TO BQVFB21-01-ERR-NUM-RIFER            00027840
027850        MOVE 55            TO BQVFB21-01-ERR-CODICE-FISC          00027850
027860        MOVE 'E'           TO BQVFB21-01-ERR-CODICE-FISC-A.       00027860
027870                                                                  00027870
027880 B1-990-CONTR-01-EX.                                              00027880
027890     EXIT.                                                        00027890
027900                                                                  00027900
027910*---                                                              00027910
027920*--- PERFORM C1-010-CONTR-02 - CONTROLLI SUL RECORD 02            00027920
027930*---                                                              00027930
027940 C1-010-CONTR-02.                                                 00027940
027950     MOVE ZERO TO BQVFB21-ERR-RECORD-02.                          00027950
027960     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00027960
027970     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00027970
027980*---                                                              00027980
027990*--- SI INIZIALIZZANO I CAMPI PER NUOVA DELEGA SE SI PROVIENE     00027990
028000*--- PER LA PRIMA VOLTA DA UN RECORD CHE NON SIA 01, 02 O 03      00028000
028010*---                                                              00028010
028020     IF W-FLAG-NUOVA-DELEGA = 1                                   00028020
028030        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00028030
028040     ADD 1 TO W-CTR-02.                                           00028040
028050*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00028050
028060*--- COMUNI TRA PIU' RECORD                                       00028060
028070*    MOVE 4 TO W-PROG-RIGA.                                       00028070
028080     COMPUTE W-APPO-CTR = W-CTR-02 - W-MEM-CTR-02.                00028080
028090     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00028090
028100                                                                  00028100
028110 C1-020.                                                          00028110
028120* INIZIO MODIFICA EURO                                            00028120
028130*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00028130
028140*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00028140
028150*--- (STESSO CONTROLLO ANCHE PER DIVISE UGUALI)                   00028150
028160     IF (BQVFB11-02-DIV-OPER NOT = W-APPO-DIV-OPER AND            00028160
028170         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00028170
028180     OR BQVFB11-02-DIV-OPER = W-APPO-DIV-OPER                     00028180
028190        GO TO C1-060.                                             00028190
028200                                                                  00028200
028210 C1-030.                                                          00028210
028220*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00028220
028230**** IF BQVFB11-02-DIV-OPER NOT = W-APPO-DIV-OPER AND             00028230
028240******* W-APPO-ERR-DIV-OPER = ZERO                                00028240
028250******* GO TO C1-050.                                             00028250
028260****                                                              00028260
028270*C1-040.                                                          00028270
028280*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00028280
028290**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-02-ERR-DIV-OPER.         00028290
028300**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00028300
028310******* MOVE 'E' TO BQVFB21-02-ERR-DIV-OPER-A                     00028310
028320******* ADD 1 TO W-CTR-BLOC.                                      00028320
028330**** GO TO C1-080.                                                00028330
028340****                                                              00028340
028350*C1-050.                                                          00028350
028360* FINE MODIFICA EURO                                              00028360
028370*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00028370
028380     MOVE 502 TO BQVFB21-02-ERR-DIV-OPER.                         00028380
028390     MOVE 'E' TO BQVFB21-02-ERR-DIV-OPER-A.                       00028390
028400     ADD 1 TO W-CTR-BLOC.                                         00028400
028410     GO TO C1-080.                                                00028410
028420                                                                  00028420
028430 C1-060.                                                          00028430
028440* INIZIO MODIFICA EURO                                            00028440
028450*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00028450
028460*--- E CODICE DIVISA DEL RECORD DI TESTA ERRATO                   00028460
028470     IF  BQVFB11-02-DIV-OPER     = W-APPO-DIV-OPER                00028470
028480     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00028480
028490         MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-02-ERR-DIV-OPER      00028490
028500         MOVE 'E' TO BQVFB21-02-ERR-DIV-OPER-A                    00028500
028510         ADD 1 TO W-CTR-BLOC                                      00028510
028520         GO TO C1-080                                             00028520
028530     END-IF.                                                      00028530
028540*                                                                 00028540
028550 C1-065.                                                          00028550
028560*                                                                 00028560
028570*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00028570
028580     IF BQVFB11-02-DIV-OPER = 'EUR'                               00028580
028590     OR (    BQVFB11-02-DIV-OPER  =  'ITL'                        00028590
028600         AND BQVFB11-02-DATA-RISC < BQVFCO1-DATA-EUR  )           00028600
028610* FINE MODIFICA EURO                                              00028610
028620        GO TO C1-080.                                             00028620
028630                                                                  00028630
028640 C1-070.                                                          00028640
028650*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00028650
028660     MOVE 55 TO BQVFB21-02-ERR-DIV-OPER.                          00028660
028670     MOVE 'E' TO BQVFB21-02-ERR-DIV-OPER-A.                       00028670
028680     ADD 1 TO W-CTR-BLOC.                                         00028680
028690                                                                  00028690
028700 C1-080.                                                          00028700
028710*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00028710
028720*--- SUL RECORD 02                                                00028720
028730     MOVE SPACE TO W-DIV.                                         00028730
028740     IF W-APPO-ERR-DIV-OPER = ZERO                                00028740
028750        MOVE W-APPO-DIV-OPER TO W-DIV.                            00028750
028760     CALL 'BQVFB2' USING W-FLAG-BANCA                             00028760
028770                           BQVFB21                                00028770
028780                           W-TAB-TOT                              00028780
028790                           W-PF-PNF                               00028790
028800                           W-DIV                                  00028800
028810                           W-CTR-NO-BLOC                          00028810
028820                           W-CTR-BLOC                             00028820
028830                           W-TAB-MATR                             00028830
028840                           W-TAB-SEDE                             00028840
028850                           W-FLAG-CRED.                           00028850
028860                                                                  00028860
028870 C1-990-CONTR-02-EX.                                              00028870
028880     EXIT.                                                        00028880
028890                                                                  00028890
028900*---                                                              00028900
028910*--- PERFORM D1-010-CONTR-03 - CONTROLLI SUL RECORD 03            00028910
028920*---                                                              00028920
028930 D1-010-CONTR-03.                                                 00028930
028940     MOVE ZERO TO BQVFB21-ERR-RECORD-03.                          00028940
028950     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00028950
028960     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00028960
028970*---                                                              00028970
028980*--- SI INIZIALIZZANO I CAMPI PER NUOVA DELEGA SE SI PROVIENE     00028980
028990*--- PER LA PRIMA VOLTA DA UN RECORD CHE NON SIA 01, 02 O 03      00028990
029000*---                                                              00029000
029010     IF W-FLAG-NUOVA-DELEGA = 1                                   00029010
029020        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00029020
029030     ADD 1 TO W-CTR-03.                                           00029030
029040*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00029040
029050*--- COMUNI TRA PIU' RECORD                                       00029050
029060*    MOVE 4 TO W-PROG-RIGA.                                       00029060
029070     COMPUTE W-APPO-CTR = W-CTR-03 - W-MEM-CTR-03.                00029070
029080     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00029080
029090                                                                  00029090
029100 D1-012.                                                          00029100
029110*--- SI CONTROLLA SE IL CODICE REGIONE E' IMPOSTATO               00029110
029120     IF BQVFB11-03-COD-REGA NOT NUMERIC OR                        00029120
029130        BQVFB11-03-COD-REG = ZERO                                 00029130
029140        GO TO D1-130.                                             00029140
029150                                                                  00029150
029160 D1-040.                                                          00029160
029170*--- SI IMPOSTA LA REGIONE                                        00029170
029180     MOVE BQVFB11-03-COD-REG TO W-COD-REG.                        00029180
029190     MOVE 1 TO W-REG.                                             00029190
029200*--- SI CONTROLLA L'ESISTENZA DEL CODICE IN ARCHIVIO              00029200
029210     MOVE BQVFB11-03-COD-REG TO W-REGIONE-INP.                    00029210
029220     PERFORM RQ-010-RIC-REGIONI   THRU RQ-990-RIC-REGIONI-EX.     00029220
029230     IF W-FLAG-TROVATO = 1                                        00029230
029240        GO TO D1-140.                                             00029240
029250                                                                  00029250
029260 D1-080.                                                          00029260
029270*--- REGIONE NON TROVATA                                          00029270
029280     MOVE ZERO TO W-REG.                                          00029280
029290     MOVE 504 TO BQVFB21-03-ERR-COD-REG.                          00029290
029300     MOVE 'E' TO BQVFB21-03-ERR-COD-REG-A.                        00029300
029310     ADD 1 TO W-CTR-BLOC.                                         00029310
029320     GO TO D1-140.                                                00029320
029330                                                                  00029330
029340 D1-130.                                                          00029340
029350*--- REGIONE NON IMPOSTATA                                        00029350
029360     MOVE 504 TO BQVFB21-03-ERR-COD-REG.                          00029360
029370     MOVE 'E' TO BQVFB21-03-ERR-COD-REG-A.                        00029370
029380     ADD 1 TO W-CTR-BLOC.                                         00029380
029390     MOVE ZERO TO W-REG.                                          00029390
029400                                                                  00029400
029410 D1-140.                                                          00029410
029420*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00029420
029430*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00029430
029440* INIZIO MODIFICA EURO                                            00029440
029450     IF (BQVFB11-03-DIV-OPER NOT = W-APPO-DIV-OPER AND            00029450
029460         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00029460
029470     OR BQVFB11-03-DIV-OPER = W-APPO-DIV-OPER                     00029470
029480        GO TO D1-220.                                             00029480
029490                                                                  00029490
029500 D1-190.                                                          00029500
029510*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00029510
029520**** IF BQVFB11-03-DIV-OPER NOT = W-APPO-DIV-OPER AND             00029520
029530******* W-APPO-ERR-DIV-OPER = ZERO                                00029530
029540******* GO TO D1-210.                                             00029540
029550****                                                              00029550
029560*D1-200.                                                          00029560
029570*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00029570
029580**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-03-ERR-DIV-OPER.         00029580
029590**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00029590
029600******* MOVE 'E' TO BQVFB21-03-ERR-DIV-OPER-A                     00029600
029610******* ADD 1 TO W-CTR-BLOC.                                      00029610
029620**** GO TO D1-240.                                                00029620
029630****                                                              00029630
029640*D1-210.                                                          00029640
029650*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00029650
029660* FINE MODIFICA EURO                                              00029660
029670     MOVE 502 TO BQVFB21-03-ERR-DIV-OPER.                         00029670
029680     MOVE 'E' TO BQVFB21-03-ERR-DIV-OPER-A.                       00029680
029690     ADD 1 TO W-CTR-BLOC.                                         00029690
029700     GO TO D1-240.                                                00029700
029710                                                                  00029710
029720 D1-220.                                                          00029720
029730*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00029730
029740* INIZIO MODIFICA EURO                                            00029740
029750     IF  BQVFB11-03-DIV-OPER     = W-APPO-DIV-OPER                00029750
029760     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00029760
029770        MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-03-ERR-DIV-OPER       00029770
029780        MOVE 'E' TO BQVFB21-03-ERR-DIV-OPER-A                     00029780
029790        ADD 1 TO W-CTR-BLOC                                       00029790
029800        GO TO D1-240                                              00029800
029810     END-IF.                                                      00029810
029820*                                                                 00029820
029830 D1-225.                                                          00029830
029840*                                                                 00029840
029850     IF BQVFB11-03-DIV-OPER = 'EUR'                               00029850
029860     OR (    BQVFB11-03-DIV-OPER  = 'ITL'                         00029860
029870         AND BQVFB11-03-DATA-RISC < BQVFCO1-DATA-EUR  )           00029870
029880* FINE MODIFICA EURO                                              00029880
029890        GO TO D1-240.                                             00029890
029900                                                                  00029900
029910 D1-230.                                                          00029910
029920*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00029920
029930     MOVE 55 TO BQVFB21-03-ERR-DIV-OPER.                          00029930
029940     MOVE 'E' TO BQVFB21-03-ERR-DIV-OPER-A.                       00029940
029950     ADD 1 TO W-CTR-BLOC.                                         00029950
029960                                                                  00029960
029970 D1-240.                                                          00029970
029980*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00029980
029990*--- SUL RECORD 03                                                00029990
030000     MOVE SPACE TO W-DIV.                                         00030000
030010     IF W-APPO-ERR-DIV-OPER = ZERO                                00030010
030020        MOVE W-APPO-DIV-OPER TO W-DIV.                            00030020
030030*A MODIFICA 3/02/2006 - T3: AGGIUNTA TABELLA W-TAB-COD-T3         00030030
030040*F INIZIO MODIFICA 13/04/2004 - MONOPOLI: AGGIUNTO W-VERS         00030040
030050     CALL 'BQVFB1' USING   W-FLAG-BANCA                           00030050
030060                           W-FLAG-AGEV                            00030060
030070                           BQVFB21                                00030070
030080                           W-TAB-TOT                              00030080
030090                           W-REG                                  00030090
030100                           W-PF-PNF                               00030100
030110                           W-DIV                                  00030110
030120                           W-CTR-NO-BLOC                          00030120
030130                           W-CTR-BLOC                             00030130
030140                           W-TAB-TRIBUTI                          00030140
030150                           W-TAB-UFFICIO                          00030150
030160                           W-TAB-REGIONI                          00030160
030170                           W-TAB-ENTE                             00030170
030180                           W-TAB-PROV                             00030180
030190                           W-COMP-FISCO                           00030190
030200                           W-COMP-REG                             00030200
030210                           W-UFF-RIF                              00030210
030220                           W-NUM-RIF                              00030220
030230                           W-COD-FISC-KO                          00030230
030240                           W-VERS                                 00030240
030250                           W-TAB-COD-T3                           00030250
030260                           W-FLAG-RIF-V-T                         00030260
030270                           W-FLAG-RIF-V-A                         00030270
030280                           W-TOT-IMP-CRED-CONTR-V                 00030280
030290                           W-TAB-CAT-TRIB                         00030290
030300                           W-FLAG-RIF-C                           00030300
030310                           W-FLAG-RIF-T-AA-MIN                    00030310
030320                           W-FLAG-RIF-A-AA-MIN                    00030320
030330                           W-FLAG-TRIB-CONC                       00030330
030340                           W-FLAG-CRED                            00030340
030350                           W-TAB-COMP-TRIB                        00030350
030360                           W-FLAG-COMP-IVA                        00030360
030370                           W-FLAG-RIF-I-T                         00030370
030380                           W-FLAG-RIF-I-A                         00030380
030390                           W-TOT-IMP-CRED-CONTR-I                 00030390
030400                           W-FLAG-COMP-IRS                        00030400
030410                           W-FLAG-RIF-R-T                         00030410
030420                           W-FLAG-RIF-R-A                         00030420
030430                           W-TOT-IMP-CRED-CONTR-R                 00030430
030440                           W-FLAG-COMP-IRP                        00030440
030450                           W-FLAG-RIF-M-T                         00030450
030460                           W-FLAG-RIF-M-A                         00030460
030470                           W-TOT-IMP-CRED-CONTR-M                 00030470
030480                           W-FLAG-COMP-IRM                        00030480
030490                           W-FLAG-RIF-IRF-T                       00030490
030500                           W-FLAG-RIF-IRF-A                       00030500
030510                           W-TOT-IMP-CRED-CONTR-IRF               00030510
030520                           W-FLAG-COMP-IRF                        00030520
030530                           W-FLAG-RIF-ADX-T                       00030530
030540                           W-FLAG-RIF-ADX-A                       00030540
030550                           W-TOT-IMP-CRED-CONTR-ADX               00030550
030560                           W-FLAG-COMP-ADX                        00030560
030570                           W-FLAG-RIF-IIE-T                       00030570
030580                           W-FLAG-RIF-IIE-A                       00030580
030590                           W-TOT-IMP-CRED-CONTR-IIE               00030590
030600                           W-FLAG-COMP-IIE                        00030600
030610                           W-FLAG-RIF-IFE-T                       00030610
030620                           W-FLAG-RIF-IFE-A                       00030620
030630                           W-TOT-IMP-CRED-CONTR-IFE               00030630
030640                           W-FLAG-COMP-IFE                        00030640
030650                           W-FLAG-RIF-FF1-T                       00030650
030660                           W-FLAG-RIF-FF1-A                       00030660
030670                           W-TOT-IMP-CRED-CONTR-FF1               00030670
030680                           W-FLAG-COMP-FF1                        00030680
030690                           W-FLAG-RIF-FF2-T                       00030690
030700                           W-FLAG-RIF-FF2-A                       00030700
030710                           W-TOT-IMP-CRED-CONTR-FF2               00030710
030720                           W-FLAG-COMP-FF2                        00030720
030730                           W-FLAG-RIF-FF3-T                       00030730
030740                           W-FLAG-RIF-FF3-A                       00030740
030750                           W-TOT-IMP-CRED-CONTR-FF3               00030750
030760                           W-FLAG-COMP-FF3                        00030760
030770                           W-FLAG-RIF-ORO-T                       00030770
030780                           W-FLAG-RIF-ORO-A                       00030780
030790                           W-TOT-IMP-CRED-CONTR-ORO               00030790
030800                           W-FLAG-COMP-ORO                        00030800
030810                           W-FLAG-RIF-SEC-T                       00030810
030820                           W-FLAG-RIF-SEC-A                       00030820
030830                           W-TOT-IMP-CRED-CONTR-SEC               00030830
030840                           W-FLAG-COMP-SEC                        00030840
030850                           W-FLAG-RIF-IEC-T                       00030850
030860                           W-FLAG-RIF-IEC-A                       00030860
030870                           W-TOT-IMP-CRED-CONTR-IEC               00030870
030880                           W-FLAG-COMP-IEC                        00030880
030890                           W-FLAG-RIF-LEZ-T                       00030890
030900                           W-FLAG-RIF-LEZ-A                       00030900
030910                           W-TOT-IMP-CRED-CONTR-LEZ               00030910
030920                           W-FLAG-COMP-LEZ                        00030920
030930                           W-FLAG-RIF-QR1-T                       00030930
030940                           W-FLAG-RIF-QR1-A                       00030940
030950                           W-TOT-IMP-CRED-CONTR-QR1               00030950
030960                           W-FLAG-COMP-QR1                        00030960
030961                           W-FLAG-RIF-BTC-T                       00030961
030962                           W-FLAG-RIF-BTC-A                       00030962
030963                           W-TOT-IMP-CRED-CONTR-BTC               00030963
030964                           W-FLAG-COMP-BTC.                       00030964
030970*                                                                 00030970
030980     IF W-FLAG-RIF-C        = '1'                                 00030980
030990         MOVE 96                 TO BQVFB21-03-ERR-IMP-RIMB       00030990
031000         ADD 1                   TO W-CTR-BLOC                    00031000
031010         MOVE 'E'                TO BQVFB21-03-ERR-IMP-RIMB-A     00031010
031020     END-IF.                                                      00031020
031030     IF W-FLAG-RIF-T-AA-MIN = '1' OR                              00031030
031040        W-FLAG-RIF-A-AA-MIN = '1'                                 00031040
031050         MOVE 96                 TO BQVFB21-03-ERR-PERIODO-RIF    00031050
031060         ADD 1                   TO W-CTR-BLOC                    00031060
031070         MOVE 'E'                TO BQVFB21-03-ERR-PERIODO-RIF-A  00031070
031080     END-IF.                                                      00031080
031090     MOVE ZERO TO W-FLAG-RIF-C.                                   00031090
031100     MOVE ZERO TO W-FLAG-RIF-T-AA-MIN.                            00031100
031110     MOVE ZERO TO W-FLAG-RIF-A-AA-MIN.                            00031110
031120*                                                                 00031120
031130*F FINE MODIFICA 13/04/2004 - MONOPOLI: AGGIUNTO W-VERS           00031130
031140                                                                  00031140
031150 D1-990-CONTR-03-EX.                                              00031150
031160     EXIT.                                                        00031160
031170                                                                  00031170
031180*---                                                              00031180
031190*--- PERFORM M1-010-CONTR-04 - CONTROLLI SUL RECORD 04            00031190
031200*---                                                              00031200
031210 M1-010-CONTR-04.                                                 00031210
031220     MOVE ZERO TO BQVFB21-ERR-RECORD-04.                          00031220
031230     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00031230
031240     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00031240
031250*---                                                              00031250
031260*--- SI INIZIALIZZANO I CAMPI PER NUOVA DELEGA SE SI PROVIENE     00031260
031270*--- PER LA PRIMA VOLTA DA UN RECORD CHE NON SIA 01, 02 O 03      00031270
031280*---                                                              00031280
031290     IF W-FLAG-NUOVA-DELEGA = 1                                   00031290
031300        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00031300
031310     ADD 1 TO W-CTR-04.                                           00031310
031320*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00031320
031330*--- COMUNI TRA PIU' RECORD                                       00031330
031340*    MOVE 3 TO W-PROG-RIGA.                                       00031340
031350     COMPUTE W-APPO-CTR = W-CTR-04 - W-MEM-CTR-04.                00031350
031360     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00031360
031370                                                                  00031370
031380*M1-012.                                                          00031380
031390*--- SI CONTROLLA SE IL CODICE ENTE E' IMPOSTATO                  00031390
031400*    IF BQVFB11-04-COD-ENTE = SPACE OR                            00031400
031410*       BQVFB11-04-COD-ENTE = ZERO                                00031410
031420*       GO TO M1-130.                                             00031420
031430*                                                                 00031430
031440*M1-020.                                                          00031440
031450*** MODIFICA PER CAMERE DI COMMERCIO: RICERCA PRELIMINARE         00031450
031460*** NELLA TABELLA DEI TRIBUTI PER IMPOSTARE LA RICERCA DEL        00031460
031470*** CODICE ENTE (PROVINCIE O ENTI LOCALI)                         00031470
031480*                                                                 00031480
031490*    MOVE BQVFB11-04-DATA-RISC        TO W-DATA-RISC.             00031490
031500*    MOVE BQVFB11-04-COD-TRIB         TO W-COD-TRIB.              00031500
031510*    MOVE SPACE                       TO W-TIPO-TRIBUTO.          00031510
031520*    SET W-PUNT-TRIB TO 1.                                        00031520
031530*    SEARCH W-TAB-TRIB-EL                                         00031530
031540*           AT END MOVE ZERO TO W-FLAG-TROVATO                    00031540
031550*    WHEN (W-TAB-TRIB-TIPO-TR(W-PUNT-TRIB) = 'A'  OR              00031550
031560*          W-TAB-TRIB-TIPO-TR(W-PUNT-TRIB) = 'P')           AND   00031560
031570*         W-TAB-TRIB-COD(W-PUNT-TRIB)     = W-COD-TRIB      AND   00031570
031580*         W-TAB-TRIB-INI-VAL(W-PUNT-TRIB) NOT > W-DATA-RISC AND   00031580
031590*         W-TAB-TRIB-FIN-VAL(W-PUNT-TRIB) NOT < W-DATA-RISC       00031590
031600*    MOVE W-TAB-TRIB-TIPO-TR(W-PUNT-TRIB) TO W-TIPO-TRIBUTO       00031600
031610*    MOVE 1                               TO W-FLAG-TROVATO.      00031610
031620*** SE IL TIPO TRIBUTO E' 'P' SI INTENDE CAMERE DI COMMERCIO      00031620
031630*** SE E' 'A' OPPURE NON E' STATO TROVATO: ENTE LOCALE            00031630
031640*    IF W-TIPO-TRIBUTO = 'P' THEN                                 00031640
031650*       GO TO M1-050                                              00031650
031660*    END-IF.                                                      00031660
031670*M1-040.                                                          00031670
031680*--- SI IMPOSTA L'ENTE                                            00031680
031690*    MOVE BQVFB11-04-COD-ENTE TO W-COD-ENTE.                      00031690
031700*--- SI CONTROLLA L'ESISTENZA DEL CODICE IN ARCHIVIO              00031700
031710*    MOVE BQVFB11-04-COD-ENTE TO W-ENTE-INP.                      00031710
031720*    PERFORM RK-010-RIC-ENTE THRU RK-990-RIC-ENTE-EX.             00031720
031730*    GO TO M1-080.                                                00031730
031740*                                                                 00031740
031750*M1-050.                                                          00031750
031760*--- SI IMPOSTA LA PROVINCIA                                      00031760
031770*    MOVE BQVFB11-04-COD-ENTE TO W-PROV-INP.                      00031770
031780*--- SI CONTROLLA L'ESISTENZA DEL CODICE IN ARCHIVIO              00031780
031790*    PERFORM RR-010-RIC-PROV THRU RR-990-RIC-PROV-EX.             00031790
031800*                                                                 00031800
031810*M1-080.                                                          00031810
031820*--- ENTE NON TROVATA                                             00031820
031830*    IF W-FLAG-TROVATO = 1                                        00031830
031840*       GO TO M1-140.                                             00031840
031850*    MOVE 504 TO BQVFB21-04-ERR-COD-ENTE.                         00031850
031860*    MOVE 'E' TO BQVFB21-04-ERR-COD-ENTE-A.                       00031860
031870*    ADD 1 TO W-CTR-BLOC.                                         00031870
031880*    GO TO M1-140.                                                00031880
031890*                                                                 00031890
031900*M1-130.                                                          00031900
031910*--- ENTE NON IMPOSTATO                                           00031910
031920*    MOVE 504 TO BQVFB21-04-ERR-COD-ENTE.                         00031920
031930*    MOVE 'E' TO BQVFB21-04-ERR-COD-ENTE-A.                       00031930
031940*    ADD 1 TO W-CTR-BLOC.                                         00031940
031950*                                                                 00031950
031960 M1-140.                                                          00031960
031970*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00031970
031980*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00031980
031990* INIZIO MODIFICA EURO                                            00031990
032000     IF (BQVFB11-04-DIV-OPER NOT = W-APPO-DIV-OPER AND            00032000
032010         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00032010
032020     OR BQVFB11-04-DIV-OPER = W-APPO-DIV-OPER                     00032020
032030        GO TO M1-220.                                             00032030
032040                                                                  00032040
032050 M1-190.                                                          00032050
032060*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00032060
032070**** IF BQVFB11-04-DIV-OPER NOT = W-APPO-DIV-OPER AND             00032070
032080******* W-APPO-ERR-DIV-OPER = ZERO                                00032080
032090******* GO TO M1-210.                                             00032090
032100****                                                              00032100
032110*M1-200.                                                          00032110
032120*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00032120
032130**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-04-ERR-DIV-OPER.         00032130
032140**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00032140
032150******* MOVE 'E' TO BQVFB21-04-ERR-DIV-OPER-A                     00032150
032160******* ADD 1 TO W-CTR-BLOC.                                      00032160
032170**** GO TO M1-240.                                                00032170
032180****                                                              00032180
032190*M1-210.                                                          00032190
032200* FINE MODIFICA EURO                                              00032200
032210*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00032210
032220     MOVE 502 TO BQVFB21-04-ERR-DIV-OPER.                         00032220
032230     MOVE 'E' TO BQVFB21-04-ERR-DIV-OPER-A.                       00032230
032240     ADD 1 TO W-CTR-BLOC.                                         00032240
032250     GO TO M1-240.                                                00032250
032260                                                                  00032260
032270 M1-220.                                                          00032270
032280*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00032280
032290* INIZIO MODIFICA EURO                                            00032290
032300     IF  BQVFB11-04-DIV-OPER     = W-APPO-DIV-OPER                00032300
032310     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00032310
032320        MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-04-ERR-DIV-OPER       00032320
032330        MOVE 'E' TO BQVFB21-04-ERR-DIV-OPER-A                     00032330
032340        ADD 1 TO W-CTR-BLOC                                       00032340
032350        GO TO M1-240                                              00032350
032360     END-IF.                                                      00032360
032370*                                                                 00032370
032380 M1-225.                                                          00032380
032390*                                                                 00032390
032400     IF BQVFB11-04-DIV-OPER = 'EUR'                               00032400
032410     OR (    BQVFB11-04-DIV-OPER  = 'ITL'                         00032410
032420         AND BQVFB11-04-DATA-RISC < BQVFCO1-DATA-EUR  )           00032420
032430* FINE MODIFICA EURO                                              00032430
032440        GO TO M1-240.                                             00032440
032450                                                                  00032450
032460 M1-230.                                                          00032460
032470*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00032470
032480     MOVE 55 TO BQVFB21-04-ERR-DIV-OPER.                          00032480
032490     MOVE 'E' TO BQVFB21-04-ERR-DIV-OPER-A.                       00032490
032500     ADD 1 TO W-CTR-BLOC.                                         00032500
032510                                                                  00032510
032520 M1-240.                                                          00032520
032530*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00032530
032540*--- SUL RECORD 04                                                00032540
032550     MOVE SPACE TO W-DIV.                                         00032550
032560     IF W-APPO-ERR-DIV-OPER = ZERO                                00032560
032570        MOVE W-APPO-DIV-OPER TO W-DIV.                            00032570
032580     CALL 'BQVFE1' USING W-FLAG-BANCA                             00032580
032590                           BQVFB21                                00032590
032600                           W-TAB-TOT                              00032600
032610                           W-PF-PNF                               00032610
032620                           W-DIV                                  00032620
032630                           W-CTR-NO-BLOC                          00032630
032640                           W-CTR-BLOC                             00032640
032650*--- ICI                                                          00032650
032660                           W-TAB-COMUNI                           00032660
032670                           W-IND-ICI                              00032670
032680                           W-VERS                                 00032680
032690*** MODIFICA GIUGNO 2003: LINK COMUNE TRIBUTO                     00032690
032700*************************  W-TAB-CAT                              00032700
032710                           W-TAB-CAT-TRIB                         00032710
032720***                                                               00032720
032730                           W-TAB-REGIONI                          00032730
032740                           W-TAB-ENTE                             00032740
032750*F                         W-TAB-PROV                             00032750
032760                           W-TAB-PRPC                             00032760
032770*--- ICI                                                          00032770
032780                           W-TAB-TRIBUTI                          00032780
032790                           W-TOT-RIMB-TRIB                        00032790
032800                           W-TIPO-TRIB-NO-IMU                     00032800
032810                           W-TIPO-TRIB-NO-TARES                   00032810
032820                           W-NUM-RIF-04                           00032820
032830                           W-TIPO-TRIB-NO-TASI                    00032830
032840                           W-FLAG-CRED                            00032840
032850                           W-COMP-EL                              00032850
032860                           W-TAB-COMP-TRIB                        00032860
032870                           W-FLAG-RIF-E-T                         00032870
032880                           W-FLAG-RIF-E-A                         00032880
032890                           W-TOT-IMP-CRED-CONTR-E                 00032890
032900                           W-FLAG-RIF-C                           00032900
032910                           W-FLAG-RIF-T-AA-MIN                    00032910
032920                           W-FLAG-RIF-A-AA-MIN                    00032920
032930                           W-FLAG-COMP-ELO                        00032930
032940                           W-TAB-PROV.                            00032940
032950*                                                                 00032950
032960     IF W-FLAG-RIF-C        = '1'                                 00032960
032970         MOVE 96                 TO BQVFB21-04-ERR-IMP-RIMB       00032970
032980         ADD 1                   TO W-CTR-BLOC                    00032980
032990         MOVE 'E'                TO BQVFB21-04-ERR-IMP-RIMB-A     00032990
033000     END-IF.                                                      00033000
033010     IF W-FLAG-RIF-T-AA-MIN = '1' OR                              00033010
033020        W-FLAG-RIF-A-AA-MIN = '1'                                 00033020
033030         MOVE 96                 TO BQVFB21-04-ERR-PERIODO-RIF    00033030
033040         ADD 1                   TO W-CTR-BLOC                    00033040
033050         MOVE 'E'                TO BQVFB21-04-ERR-PERIODO-RIF-A  00033050
033060     END-IF.                                                      00033060
033070     MOVE ZERO TO W-FLAG-RIF-C.                                   00033070
033080     MOVE ZERO TO W-FLAG-RIF-T-AA-MIN.                            00033080
033090     MOVE ZERO TO W-FLAG-RIF-A-AA-MIN.                            00033090
033100                                                                  00033100
033110 M1-990-CONTR-04-EX.                                              00033110
033120     EXIT.                                                        00033120
033130                                                                  00033130
033140*---                                                              00033140
033150*--- PERFORM N1-010-CONTR-05 - CONTROLLI SUL RECORD 05            00033150
033160*---                                                              00033160
033170 N1-010-CONTR-05.                                                 00033170
033180     MOVE ZERO TO BQVFB21-ERR-RECORD-05.                          00033180
033190     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00033190
033200     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00033200
033210*---                                                              00033210
033220*--- SI INIZIALIZZANO I CAMPI PER NUOVA DELEGA SE SI PROVIENE     00033220
033230*--- PER LA PRIMA VOLTA DA UN RECORD CHE NON SIA 01, 02 O 03      00033230
033240*---                                                              00033240
033250     IF W-FLAG-NUOVA-DELEGA = 1                                   00033250
033260        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00033260
033270     ADD 1 TO W-CTR-05.                                           00033270
033280*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00033280
033290*--- COMUNI TRA PIU' RECORD                                       00033290
033300*    MOVE 3 TO W-PROG-RIGA.                                       00033300
033310     COMPUTE W-APPO-CTR = W-CTR-05 - W-MEM-CTR-05.                00033310
033320     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00033320
033330                                                                  00033330
033340 N1-020.                                                          00033340
033350*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00033350
033360*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00033360
033370* INIZIO MODIFICA EURO                                            00033370
033380     IF (BQVFB11-05-DIV-OPER NOT = W-APPO-DIV-OPER AND            00033380
033390         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00033390
033400     OR BQVFB11-05-DIV-OPER = W-APPO-DIV-OPER                     00033400
033410        GO TO N1-060.                                             00033410
033420                                                                  00033420
033430 N1-030.                                                          00033430
033440*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00033440
033450**** IF BQVFB11-05-DIV-OPER NOT = W-APPO-DIV-OPER AND             00033450
033460******* W-APPO-ERR-DIV-OPER = ZERO                                00033460
033470******* GO TO N1-050.                                             00033470
033480****                                                              00033480
033490*N1-040.                                                          00033490
033500*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00033500
033510**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-05-ERR-DIV-OPER.         00033510
033520**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00033520
033530******* MOVE 'E' TO BQVFB21-05-ERR-DIV-OPER-A                     00033530
033540******* ADD 1 TO W-CTR-BLOC.                                      00033540
033550**** GO TO N1-080.                                                00033550
033560****                                                              00033560
033570*N1-050.                                                          00033570
033580* FINE MODIFICA EURO                                              00033580
033590*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00033590
033600     MOVE 502 TO BQVFB21-05-ERR-DIV-OPER.                         00033600
033610     MOVE 'E' TO BQVFB21-05-ERR-DIV-OPER-A.                       00033610
033620     ADD 1 TO W-CTR-BLOC.                                         00033620
033630     GO TO N1-080.                                                00033630
033640                                                                  00033640
033650 N1-060.                                                          00033650
033660* INIZIO MODIFICA EURO                                            00033660
033670     IF  BQVFB11-05-DIV-OPER     = W-APPO-DIV-OPER                00033670
033680     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00033680
033690        MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-05-ERR-DIV-OPER       00033690
033700        MOVE 'E' TO BQVFB21-05-ERR-DIV-OPER-A                     00033700
033710        ADD 1 TO W-CTR-BLOC                                       00033710
033720        GO TO N1-080                                              00033720
033730     END-IF.                                                      00033730
033740*                                                                 00033740
033750 N1-065.                                                          00033750
033760*                                                                 00033760
033770*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00033770
033780     IF BQVFB11-05-DIV-OPER = 'EUR'                               00033780
033790     OR (    BQVFB11-05-DIV-OPER  = 'ITL'                         00033790
033800         AND BQVFB11-05-DATA-RISC < BQVFCO1-DATA-EUR  )           00033800
033810* FINE MODIFICA EURO                                              00033810
033820        GO TO N1-080.                                             00033820
033830                                                                  00033830
033840 N1-070.                                                          00033840
033850*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00033850
033860     MOVE 55 TO BQVFB21-05-ERR-DIV-OPER.                          00033860
033870     MOVE 'E' TO BQVFB21-05-ERR-DIV-OPER-A.                       00033870
033880     ADD 1 TO W-CTR-BLOC.                                         00033880
033890                                                                  00033890
033900 N1-080.                                                          00033900
033910*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00033910
033920*--- SUL RECORD 05                                                00033920
033930     MOVE SPACE TO W-DIV.                                         00033930
033940     IF W-APPO-ERR-DIV-OPER = ZERO                                00033940
033950        MOVE W-APPO-DIV-OPER TO W-DIV.                            00033950
033960     CALL 'BQVFE5' USING W-FLAG-BANCA                             00033960
033970                         BQVFB21                                  00033970
033980                         W-TAB-TOT                                00033980
033990                         W-PF-PNF                                 00033990
034000                         W-DIV                                    00034000
034010                         W-CTR-NO-BLOC                            00034010
034020                         W-CTR-BLOC                               00034020
034030                         W-TAB-INAIL                              00034030
034040                         W-FLAG-CRED.                             00034040
034050                                                                  00034050
034060 N1-990-CONTR-05-EX.                                              00034060
034070     EXIT.                                                        00034070
034080                                                                  00034080
034090*---                                                              00034090
034100*--- PERFORM O1-010-CONTR-06 - CONTROLLI SUL RECORD 06            00034100
034110*---                                                              00034110
034120 O1-010-CONTR-06.                                                 00034120
034130     MOVE ZERO TO BQVFB21-ERR-RECORD-06.                          00034130
034140     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00034140
034150     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00034150
034160*---                                                              00034160
034170*--- SI INIZIALIZZANO I CAMPI PER NUOVA DELEGA SE SI PROVIENE     00034170
034180*--- PER LA PRIMA VOLTA DA UN RECORD CHE NON SIA 01, 02 O 03      00034180
034190*---                                                              00034190
034200     IF W-FLAG-NUOVA-DELEGA = 1                                   00034200
034210        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00034210
034220     ADD 1 TO W-CTR-06.                                           00034220
034230*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00034230
034240*--- COMUNI TRA PIU' RECORD                                       00034240
034250*    MOVE 3 TO W-PROG-RIGA.                                       00034250
034260     COMPUTE W-APPO-CTR = W-CTR-06 - W-MEM-CTR-06.                00034260
034270     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00034270
034280                                                                  00034280
034290 O1-012.                                                          00034290
034300*--- SI CONTROLLA SE IL CODICE ENTE E' IMPOSTATO                  00034300
034310     IF BQVFB11-06-COD-ENTEA NOT NUMERIC OR                       00034310
034320        BQVFB11-06-COD-ENTE = ZERO                                00034320
034330        GO TO O1-130.                                             00034330
034340                                                                  00034340
034350 O1-020.                                                          00034350
034360*--- SI CONTROLLA SE L'ENTE E' STATO GIA' TRATTATO                00034360
034370     IF BQVFB11-06-COD-ENTE = W-COD-ALTRO                         00034370
034380        GO TO O1-140.                                             00034380
034390                                                                  00034390
034400 O1-030.                                                          00034400
034410*--- SI CONTROLLA SE E' STATO TRATTATO L'ENTE                     00034410
034420     IF W-COD-ALTRO NOT = ZERO                                    00034420
034430        GO TO O1-110.                                             00034430
034440                                                                  00034440
034450 O1-040.                                                          00034450
034460*--- SI IMPOSTA L'ENTE                                            00034460
034470     MOVE BQVFB11-06-COD-ENTE TO W-COD-ALTRO.                     00034470
034480*--- SI CONTROLLA L'ESISTENZA DEL CODICE IN ARCHIVIO              00034480
034490     MOVE BQVFB11-06-COD-ENTE TO W-ALTRO-INP.                     00034490
034500     PERFORM RJ-010-RIC-ALTRO THRU RJ-990-RIC-ALTRO-EX.           00034500
034510     IF W-FLAG-TROVATO = 1                                        00034510
034520        GO TO O1-140.                                             00034520
034530                                                                  00034530
034540 O1-080.                                                          00034540
034550*--- ENTE NON TROVATO                                             00034550
034560     MOVE 504 TO BQVFB21-06-ERR-COD-ENTE.                         00034560
034570     MOVE 'E' TO BQVFB21-06-ERR-COD-ENTE-A.                       00034570
034580     ADD 1 TO W-CTR-BLOC.                                         00034580
034590     GO TO O1-140.                                                00034590
034600                                                                  00034600
034610 O1-110.                                                          00034610
034620*--- ENTE DIVERSO DA QUELLO GIA' TRATTATO                         00034620
034630     MOVE 509 TO BQVFB21-06-ERR-COD-ENTE.                         00034630
034640     MOVE 'E' TO BQVFB21-06-ERR-COD-ENTE-A.                       00034640
034650     ADD 1 TO W-CTR-BLOC.                                         00034650
034660     GO TO O1-140.                                                00034660
034670                                                                  00034670
034680 O1-130.                                                          00034680
034690*--- ENTE NON IMPOSTATO                                           00034690
034700     MOVE 504 TO BQVFB21-06-ERR-COD-ENTE.                         00034700
034710     MOVE 'E' TO BQVFB21-06-ERR-COD-ENTE-A.                       00034710
034720     ADD 1 TO W-CTR-BLOC.                                         00034720
034730                                                                  00034730
034740 O1-140.                                                          00034740
034750*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00034750
034760*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00034760
034770* INIZIO MODIFICA EURO                                            00034770
034780     IF (BQVFB11-06-DIV-OPER NOT = W-APPO-DIV-OPER AND            00034780
034790         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00034790
034800     OR BQVFB11-06-DIV-OPER = W-APPO-DIV-OPER                     00034800
034810        GO TO O1-220.                                             00034810
034820                                                                  00034820
034830 O1-190.                                                          00034830
034840*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00034840
034850**** IF BQVFB11-06-DIV-OPER NOT = W-APPO-DIV-OPER AND             00034850
034860******* W-APPO-ERR-DIV-OPER = ZERO                                00034860
034870******* GO TO O1-210.                                             00034870
034880****                                                              00034880
034890*O1-200.                                                          00034890
034900*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00034900
034910**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-06-ERR-DIV-OPER.         00034910
034920**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00034920
034930******* MOVE 'E' TO BQVFB21-06-ERR-DIV-OPER-A                     00034930
034940******* ADD 1 TO W-CTR-BLOC.                                      00034940
034950**** GO TO O1-240.                                                00034950
034960****                                                              00034960
034970*O1-210.                                                          00034970
034980* FINE MODIFICA EURO                                              00034980
034990*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00034990
035000     MOVE 502 TO BQVFB21-06-ERR-DIV-OPER.                         00035000
035010     MOVE 'E' TO BQVFB21-06-ERR-DIV-OPER-A.                       00035010
035020     ADD 1 TO W-CTR-BLOC.                                         00035020
035030     GO TO O1-240.                                                00035030
035040                                                                  00035040
035050 O1-220.                                                          00035050
035060*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00035060
035070* INIZIO MODIFICA EURO                                            00035070
035080     IF  BQVFB11-06-DIV-OPER     = W-APPO-DIV-OPER                00035080
035090     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00035090
035100         MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-06-ERR-DIV-OPER      00035100
035110         MOVE 'E' TO BQVFB21-06-ERR-DIV-OPER-A                    00035110
035120         ADD 1 TO W-CTR-BLOC                                      00035120
035130         GO TO O1-240                                             00035130
035140     END-IF.                                                      00035140
035150*                                                                 00035150
035160 O1-225.                                                          00035160
035170*                                                                 00035170
035180     IF BQVFB11-06-DIV-OPER = 'EUR'                               00035180
035190     OR (    BQVFB11-06-DIV-OPER  = 'ITL'                         00035190
035200         AND BQVFB11-06-DATA-RISC < BQVFCO1-DATA-EUR  )           00035200
035210* FINE MODIFICA EURO                                              00035210
035220        GO TO O1-240.                                             00035220
035230                                                                  00035230
035240 O1-230.                                                          00035240
035250*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00035250
035260     MOVE 55 TO BQVFB21-06-ERR-DIV-OPER.                          00035260
035270     MOVE 'E' TO BQVFB21-06-ERR-DIV-OPER-A.                       00035270
035280     ADD 1 TO W-CTR-BLOC.                                         00035280
035290                                                                  00035290
035300 O1-240.                                                          00035300
035310*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00035310
035320*--- SUL RECORD 06                                                00035320
035330     MOVE SPACE TO W-DIV.                                         00035330
035340     IF W-APPO-ERR-DIV-OPER = ZERO                                00035340
035350        MOVE W-APPO-DIV-OPER TO W-DIV.                            00035350
035360     CALL 'BQVFE6' USING W-FLAG-BANCA                             00035360
035370                         BQVFB21                                  00035370
035380                         W-TAB-TOT                                00035380
035390                         W-PF-PNF                                 00035390
035400                         W-DIV                                    00035400
035410                         W-CTR-NO-BLOC                            00035410
035420                         W-CTR-BLOC                               00035420
035430                         W-TAB-ALTRO                              00035430
035440                         W-TAB-CAUS                               00035440
035450                         W-TAB-PROV                               00035450
035460                         W-FLAG-CRED.                             00035460
035470                                                                  00035470
035480 O1-990-CONTR-06-EX.                                              00035480
035490     EXIT.                                                        00035490
035500                                                                  00035500
035510*---                                                              00035510
035520*--- PERFORM P1-010-CONTR-07 - CONTROLLI SUL RECORD 07            00035520
035530*---                                                              00035530
035540 P1-010-CONTR-07.                                                 00035540
035550     MOVE ZERO          TO BQVFB21-ERR-RECORD-07.                 00035550
035560     MOVE W-CTR-BLOC    TO W-APPO-CTR-BLOC.                       00035560
035570     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00035570
035580*---                                                              00035580
035590*--- SI INIZIALIZZANO I CAMPI PER NUOVA DELEGA SE SI PROVIENE     00035590
035600*--- PER LA PRIMA VOLTA DA UN RECORD CHE NON SIA 01, 02 O 03      00035600
035610*---                                                              00035610
035620     IF W-FLAG-NUOVA-DELEGA = 1                                   00035620
035630        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00035630
035640     ADD 1 TO W-CTR-07.                                           00035640
035650*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00035650
035660*--- COMUNI TRA PIU' RECORD                                       00035660
035670*    MOVE 8 TO W-PROG-RIGA.                                       00035670
035680     COMPUTE W-APPO-CTR = W-CTR-07 - W-MEM-CTR-07.                00035680
035690     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00035690
035700                                                                  00035700
035710 P1-020.                                                          00035710
035720*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00035720
035730*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00035730
035740* INIZIO MODIFICA EURO                                            00035740
035750*F INIZIO MODIFICA 13/04/2004 - MONOPOLI                          00035750
035760*F   IF (BQVFB11-07-DIV-OPER NOT = W-APPO-DIV-OPER AND            00035760
035770*F       W-APPO-ERR-DIV-OPER NOT = ZERO)                          00035770
035780*F   OR BQVFB11-07-DIV-OPER = W-APPO-DIV-OPER                     00035780
035790*F      GO TO P1-060.                                             00035790
035800     IF W-VERS < 'R05'                                            00035800
035810        MOVE BQVFB11-07-DIV-OPER TO W-07-COD-DIV                  00035810
035820           ELSE                                                   00035820
035830        MOVE BQVFB11-07-DIVISA-OPER TO W-07-COD-DIV.              00035830
035840     IF (W-07-COD-DIV        NOT = W-APPO-DIV-OPER AND            00035840
035850         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00035850
035860     OR  W-07-COD-DIV       = W-APPO-DIV-OPER                     00035860
035870        GO TO P1-060.                                             00035870
035880*F FINE MODIFICA 13/04/2004 - MONOPOLI                            00035880
035890                                                                  00035890
035900 P1-030.                                                          00035900
035910*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00035910
035920**** IF BQVFB11-07-DIV-OPER NOT = W-APPO-DIV-OPER AND             00035920
035930******* W-APPO-ERR-DIV-OPER = ZERO                                00035930
035940******* GO TO P1-050.                                             00035940
035950****                                                              00035950
035960*P1-040.                                                          00035960
035970*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00035970
035980**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-07-ERR-DIV-OPER.         00035980
035990**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00035990
036000******* MOVE 'E' TO BQVFB21-07-ERR-DIV-OPER-A                     00036000
036010******* ADD 1 TO W-CTR-BLOC.                                      00036010
036020**** GO TO P1-080.                                                00036020
036030****                                                              00036030
036040*P1-050.                                                          00036040
036050* FINE MODIFICA EURO                                              00036050
036060*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00036060
036070     MOVE 502 TO BQVFB21-07-ERR-DIV-OPER.                         00036070
036080     MOVE 'E' TO BQVFB21-07-ERR-DIV-OPER-A.                       00036080
036090     ADD 1 TO W-CTR-BLOC.                                         00036090
036100     GO TO P1-080.                                                00036100
036110                                                                  00036110
036120 P1-060.                                                          00036120
036130*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00036130
036140* INIZIO MODIFICA EURO                                            00036140
036150*F INIZIO MODIFICA 13/04/2004 - MONOPOLI                          00036150
036160*F   IF  BQVFB11-07-DIV-OPER     = W-APPO-DIV-OPER                00036160
036170*F   AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00036170
036180*F       MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-07-ERR-DIV-OPER      00036180
036190*F       MOVE 'E' TO BQVFB21-07-ERR-DIV-OPER-A                    00036190
036200*F       ADD 1 TO W-CTR-BLOC                                      00036200
036210*F       GO TO P1-080                                             00036210
036220*F   END-IF.                                                      00036220
036230     IF  W-07-COD-DIV            = W-APPO-DIV-OPER                00036230
036240     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00036240
036250         MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-07-ERR-DIV-OPER      00036250
036260         MOVE 'E' TO BQVFB21-07-ERR-DIV-OPER-A                    00036260
036270         ADD 1 TO W-CTR-BLOC                                      00036270
036280         GO TO P1-080                                             00036280
036290     END-IF.                                                      00036290
036300*F FINE MODIFICA 13/04/2004 - MONOPOLI                            00036300
036310*                                                                 00036310
036320 P1-065.                                                          00036320
036330*                                                                 00036330
036340*F INIZIO MODIFICA 13/04/2004 - MONOPOLI                          00036340
036350*F   IF BQVFB11-07-DIV-OPER = 'EUR'                               00036350
036360*F   OR (    BQVFB11-07-DIV-OPER  = 'ITL'                         00036360
036370*F       AND BQVFB11-07-DATA-RISC < BQVFCO1-DATA-EUR  )           00036370
036380     IF W-07-COD-DIV        = 'EUR'                               00036380
036390     OR (    W-07-COD-DIV         = 'ITL'                         00036390
036400         AND BQVFB11-07-DATA-RISC < BQVFCO1-DATA-EUR  )           00036400
036410*F FINE MODIFICA 13/04/2004 - MONOPOLI                            00036410
036420* FINE MODIFICA EURO                                              00036420
036430        GO TO P1-080.                                             00036430
036440                                                                  00036440
036450 P1-070.                                                          00036450
036460*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00036460
036470     MOVE 55 TO BQVFB21-07-ERR-DIV-OPER.                          00036470
036480     MOVE 'E' TO BQVFB21-07-ERR-DIV-OPER-A.                       00036480
036490     ADD 1 TO W-CTR-BLOC.                                         00036490
036500                                                                  00036500
036510 P1-080.                                                          00036510
036520*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00036520
036530*--- SUL RECORD 07                                                00036530
036540     MOVE SPACE TO W-DIV.                                         00036540
036550     IF W-APPO-ERR-DIV-OPER = ZERO                                00036550
036560        MOVE W-APPO-DIV-OPER TO W-DIV.                            00036560
036570*AN INIZIO MODIFICA 30/04/2004 - MONOPOLI                         00036570
036580     IF W-VERS LESS 'R05'                                         00036580
036590        CALL 'BQVFE7' USING W-FLAG-BANCA                          00036590
036600                         BQVFB21                                  00036600
036610                         W-TAB-TOT                                00036610
036620                         W-DIV                                    00036620
036630                         W-CTR-NO-BLOC                            00036630
036640                         W-CTR-BLOC                               00036640
036650                         W-TAB-REGIONI                            00036650
036660                         W-TAB-TRIBUTI                            00036660
036670                         W-TAB-PROV                               00036670
036680           ELSE                                                   00036680
036690        CALL 'BQVFE8' USING W-FLAG-BANCA                          00036690
036700                         BQVFB21                                  00036700
036710                         W-TAB-TOT                                00036710
036720                         W-DIV                                    00036720
036730                         W-CTR-NO-BLOC                            00036730
036740                         W-CTR-BLOC                               00036740
036750                         W-TAB-TRIBUTI                            00036750
036760                         W-TAB-PROV                               00036760
036770                         W-TAB-ENTI-TRIB                          00036770
036780                         W-TAB-UFFICIO                            00036780
036790                         W-UFF-RIF-M                              00036790
036800                         W-NUM-RIF-M                              00036800
036810                         W-COD-FISC-KO-M                          00036810
036820                         W-UFF-RIF-ERARIO                         00036820
036830                         W-NUM-RIF-ERARIO                         00036830
036840     END-IF.                                                      00036840
036850*AN FINE MODIFICA 30/04/2004 - MONOPOLI                           00036850
036860     IF BQVFB21-07-ERR-NUM-RIFER = 888 AND                        00036860
036870        BQVFB21-07-ERR-CODICE-FISC-A = 'W'                        00036870
036880        SUBTRACT 1       FROM W-CTR-NO-BLOC                       00036880
036890        ADD      1         TO W-CTR-BLOC.                         00036890
036900     IF BQVFB21-07-ERR-NUM-RIFER = 888 AND                        00036900
036910        BQVFB21-07-ERR-CODICE-FISC-A = '0'                        00036910
036920        ADD      1         TO W-CTR-BLOC.                         00036920
036930     IF BQVFB21-07-ERR-NUM-RIFER = 888                            00036930
036940        MOVE 55            TO BQVFB21-07-ERR-NUM-RIFER            00036940
036950        MOVE 55            TO BQVFB21-07-ERR-CODICE-FISC          00036950
036960        MOVE 'E'           TO BQVFB21-07-ERR-CODICE-FISC-A.       00036960
036970                                                                  00036970
036980 P1-990-CONTR-07-EX.                                              00036980
036990     EXIT.                                                        00036990
037000                                                                  00037000
037010*---                                                              00037010
037020*--- PERFORM R4-010-CONTR-20 - CONTROLLI SUL RECORD 20            00037020
037030*---                                                              00037030
037040 R4-010-CONTR-20.                                                 00037040
037050     MOVE ZERO          TO BQVFB21-ERR-RECORD-20.                 00037050
037060     MOVE W-CTR-BLOC    TO W-APPO-CTR-BLOC.                       00037060
037070     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00037070
037080*---                                                              00037080
037090*--- SI INIZIALIZZANO I CAMPI PER NUOVA DELEGA SE SI PROVIENE     00037090
037100*--- PER LA PRIMA VOLTA DA UN RECORD CHE NON SIA 01, 02 O 03      00037100
037110*---                                                              00037110
037120     IF W-FLAG-NUOVA-DELEGA = 1                                   00037120
037130        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00037130
037140     ADD 1 TO W-CTR-20.                                           00037140
037150*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00037150
037160*--- COMUNI TRA PIU' RECORD                                       00037160
037170*    MOVE 1 TO W-PROG-RIGA.                                       00037170
037180     COMPUTE W-APPO-CTR = W-CTR-20 - W-MEM-CTR-20.                00037180
037190     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00037190
037200                                                                  00037200
037210 R4-020.                                                          00037210
037220*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00037220
037230*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00037230
037240* INIZIO MODIFICA EURO                                            00037240
037250     IF (BQVFB11-20-DIV-OPER NOT = W-APPO-DIV-OPER AND            00037250
037260         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00037260
037270     OR BQVFB11-20-DIV-OPER = W-APPO-DIV-OPER                     00037270
037280        GO TO R4-060.                                             00037280
037290                                                                  00037290
037300 R4-030.                                                          00037300
037310*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00037310
037320**** IF BQVFB11-20-DIV-OPER NOT = W-APPO-DIV-OPER AND             00037320
037330******* W-APPO-ERR-DIV-OPER = ZERO                                00037330
037340******* GO TO R4-050.                                             00037340
037350****                                                              00037350
037360*R4-040.                                                          00037360
037370*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00037370
037380**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-20-ERR-DIV-OPER.         00037380
037390**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00037390
037400******* MOVE 'E' TO BQVFB21-20-ERR-DIV-OPER-A                     00037400
037410******* ADD 1 TO W-CTR-BLOC.                                      00037410
037420**** GO TO R4-080.                                                00037420
037430****                                                              00037430
037440*R4-050.                                                          00037440
037450* FINE MODIFICA EURO                                              00037450
037460*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00037460
037470     MOVE 502 TO BQVFB21-20-ERR-DIV-OPER.                         00037470
037480     MOVE 'E' TO BQVFB21-20-ERR-DIV-OPER-A.                       00037480
037490     ADD 1 TO W-CTR-BLOC.                                         00037490
037500     GO TO R4-080.                                                00037500
037510                                                                  00037510
037520 R4-060.                                                          00037520
037530*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00037530
037540* INIZIO MODIFICA EURO                                            00037540
037550     IF  BQVFB11-20-DIV-OPER     = W-APPO-DIV-OPER                00037550
037560     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00037560
037570         MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-20-ERR-DIV-OPER      00037570
037580         MOVE 'E' TO BQVFB21-20-ERR-DIV-OPER-A                    00037580
037590         ADD 1 TO W-CTR-BLOC                                      00037590
037600         GO TO R4-080                                             00037600
037610     END-IF.                                                      00037610
037620*                                                                 00037620
037630 R4-065.                                                          00037630
037640*                                                                 00037640
037650     IF BQVFB11-20-DIV-OPER = 'EUR'                               00037650
037660     OR (    BQVFB11-20-DIV-OPER  = 'ITL'                         00037660
037670         AND BQVFB11-20-DATA-RISC < BQVFCO1-DATA-EUR  )           00037670
037680* FINE MODIFICA EURO                                              00037680
037690        GO TO R4-080.                                             00037690
037700                                                                  00037700
037710 R4-070.                                                          00037710
037720*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00037720
037730     MOVE 55 TO BQVFB21-20-ERR-DIV-OPER.                          00037730
037740     MOVE 'E' TO BQVFB21-20-ERR-DIV-OPER-A.                       00037740
037750     ADD 1 TO W-CTR-BLOC.                                         00037750
037760                                                                  00037760
037770 R4-080.                                                          00037770
037780*--- INTERNET                                                     00037780
037790*--- SI MEMORIZZA IL VALORE DEL CAB E DELL'ESITO PAGAMENTO        00037790
037800*--- DEL RECORD DI TIPO 20                                        00037800
037810     MOVE BQVFB11-20-ESITO-PAGAM TO W-APPO-ESITO-PAGAM.           00037810
037820     IF BQVFB11-20-CAB-DIPA NUMERIC                               00037820
037830        MOVE BQVFB11-20-CAB-DIPA TO W-APPO-COD-CAB.               00037830
037840*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00037840
037850*--- SUL RECORD 20                                                00037850
037860     MOVE SPACE TO W-DIV.                                         00037860
037870     IF W-APPO-ERR-DIV-OPER = ZERO                                00037870
037880        MOVE W-APPO-DIV-OPER TO W-DIV.                            00037880
037890     CALL 'BQVFE2' USING W-FLAG-BANCA                             00037890
037900                         BQVFB21                                  00037900
037910                         W-TAB-TOT                                00037910
037920                         W-DIV                                    00037920
037930                         W-CTR-NO-BLOC                            00037930
037940                         W-CTR-BLOC.                              00037940
037950                                                                  00037950
037960 R4-990-CONTR-20-EX.                                              00037960
037970     EXIT.                                                        00037970
037980                                                                  00037980
037990*---                                                              00037990
038000*--- PERFORM E1-010-CONTR-CF - CONTROLLI SUI RECORD 14 E 15       00038000
038010*---                                                              00038010
038020 E1-010-CONTR-CF.                                                 00038020
038030     MOVE 1 TO W-FLAG-NUOVA-DELEGA.                               00038030
038040     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00038040
038050     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00038050
038060*--- SI CONTROLLA SE IL FLAG DI ERRORE DEL CF NON E' CORRETTO     00038060
038070     IF W-APPO-ERR-FLAG-ERR-CF = 55                               00038070
038080        GO TO E1-040.                                             00038080
038090                                                                  00038090
038100 E1-020.                                                          00038100
038110*--- SI CONTROLLA LA CORRETTEZZA DEL CF                           00038110
038120     IF (W-APPO-ERR-FLAG-ERR-CF = ZERO AND                        00038120
038130         W-APPO-FLAG-ERR-CF     = '1'     ) OR                    00038130
038140        (W-APPO-ERR-FLAG-ERR-CF NOT = ZERO AND                    00038140
038150         W-APPO-FLAG-ERR-CF     = '0'     )                       00038150
038160        GO TO E1-040.                                             00038160
038170                                                                  00038170
038180 E1-030.                                                          00038180
038190*--- PER CF CORRETTO ERRORE DI PRESENZA RECORD DATI ANAGRAFICI    00038190
038200     IF BQVFB21-ERR-TIPO-RECORD = ZERO                            00038200
038210        MOVE 'W' TO BQVFB21-ERR-TIPO-RECORD-A                     00038210
038220        MOVE 505 TO BQVFB21-ERR-TIPO-RECORD                       00038220
038230        ADD 1 TO W-CTR-NO-BLOC.                                   00038230
038240                                                                  00038240
038250 E1-040.                                                          00038250
038260     IF BQVFB11-TIPO-RECORD = 'V14'                               00038260
038270        GO TO E1-044.                                             00038270
038280                                                                  00038280
038290 E1-042.                                                          00038290
038300     ADD 1 TO W-CTR-15.                                           00038300
038310     MOVE ZERO TO BQVFB21-ERR-RECORD-15.                          00038310
038320     MOVE 15 TO W-FLAG-REC.                                       00038320
038330     GO TO E1-046.                                                00038330
038340                                                                  00038340
038350 E1-044.                                                          00038350
038360     ADD 1 TO W-CTR-14.                                           00038360
038370     MOVE ZERO TO BQVFB21-ERR-RECORD-14.                          00038370
038380     MOVE 14 TO W-FLAG-REC.                                       00038380
038390                                                                  00038390
038400 E1-046.                                                          00038400
038410*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00038410
038420*--- COMUNI TRA PIU' RECORD                                       00038420
038430     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00038430
038440                                                                  00038440
038450 E1-050.                                                          00038450
038460*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00038460
038470*--- SUL RECORD 14 O 15                                           00038470
038480     CALL 'BQVFB4' USING W-FLAG-BANCA                             00038480
038490                           BQVFB21                                00038490
038500                           W-CTR-NO-BLOC                          00038500
038510                           W-TAB-PROV.                            00038510
038520                                                                  00038520
038530 E1-990-CONTR-CF-EX.                                              00038530
038540     EXIT.                                                        00038540
038550                                                                  00038550
038560*---                                                              00038560
038570*--- PERFORM F1-010-CONTR-36 - CONTROLLI SUL RECORD 36            00038570
038580*---                                                              00038580
038590 F1-010-CONTR-36.                                                 00038590
038600*---                                                              00038600
038610*--- SI CONTROLLA IL NUMERO DI RIGHE V04, LA RELEASE E LA PRESENZA00038610
038620*--- DI TRIBUTI ICI PER IMPOSTARE IL CAMPO W-ICI, UTILIZZATO IN   00038620
038630*--- SEGUITO                                                      00038630
038640*---                                                              00038640
038650     MOVE 'NO'  TO W-ICI                                          00038650
038660*    IF W-VERS > 'R03'                                            00038660
038670*       MOVE 'SI'  TO W-ICI                                       00038670
038680*    END-IF.                                                      00038680
038690     IF BQVFB11-36-NUMRIG-ENTI > 3                                00038690
038700        MOVE 'SI'  TO W-ICI                                       00038700
038710     END-IF.                                                      00038710
038720     IF W-COD-CATAST(1) NOT = SPACE AND                           00038720
038730        W-COD-CATAST(1) NOT = ZERO                                00038730
038740        MOVE 'SI'  TO W-ICI                                       00038740
038750     END-IF.                                                      00038750
038760*---                                                              00038760
038770     MOVE 1 TO W-FLAG-NUOVA-DELEGA.                               00038770
038780     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00038780
038790     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00038790
038800     MOVE ZERO TO BQVFB21-ERR-RECORD-36.                          00038800
038810*--- SI CONTROLLA LA PRESENZA DI RECORD 14 O 15 A FRONTE DI       00038810
038820*--- FLAG ERRORE CF IMPOSTATO AD 1 O CF ERRATO                    00038820
038830     IF W-FLAG-REC = 14 OR                                        00038830
038840        W-FLAG-REC = 15                                           00038840
038850        GO TO F1-016.                                             00038850
038860                                                                  00038860
038870 F1-012.                                                          00038870
038880*--- IN ASSENZA DI RECORD 14 E 15 RELATIVI AI DATI ANAGRAFICI     00038880
038890*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE FISCALE TRATTATO      00038890
038900     IF (W-APPO-ERR-CF NOT = ZERO  OR                             00038900
038910         W-APPO-PF-PNF     = SPACE   ) AND                        00038910
038920        W-APPO-FLAG-ERR-CF = 1         AND                        00038920
038930        BQVFB21-ERR-TIPO-RECORD-A     = 'W'                       00038930
038940        SUBTRACT 1 FROM W-CTR-NO-BLOC.                            00038940
038950     IF (W-APPO-ERR-CF NOT = ZERO  OR                             00038950
038960         W-APPO-PF-PNF     = SPACE   ) AND                        00038960
038970        W-APPO-FLAG-ERR-CF = 1         AND                        00038970
038980        BQVFB21-ERR-TIPO-RECORD-A NOT = 'E'                       00038980
038990        MOVE 505 TO BQVFB21-ERR-TIPO-RECORD                       00038990
039000        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00039000
039010        ADD 1 TO W-CTR-BLOC.                                      00039010
039020                                                                  00039020
039030 F1-016.                                                          00039030
039040     ADD 1 TO W-CTR-36.                                           00039040
039050*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00039050
039060*--- COMUNI TRA PIU' RECORD                                       00039060
039070     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00039070
039080                                                                  00039080
039090 F1-020.                                                          00039090
039100*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00039100
039110*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00039110
039120* INIZIO MODIFICA EURO                                            00039120
039130     IF (BQVFB11-36-DIV-OPER NOT = W-APPO-DIV-OPER AND            00039130
039140         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00039140
039150     OR BQVFB11-36-DIV-OPER = W-APPO-DIV-OPER                     00039150
039160        GO TO F1-060.                                             00039160
039170                                                                  00039170
039180 F1-030.                                                          00039180
039190*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00039190
039200**** IF BQVFB11-36-DIV-OPER NOT = W-APPO-DIV-OPER AND             00039200
039210******* W-APPO-ERR-DIV-OPER = ZERO                                00039210
039220******* GO TO F1-050.                                             00039220
039230****                                                              00039230
039240*F1-040.                                                          00039240
039250*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00039250
039260**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-36-ERR-DIV-OPER.         00039260
039270**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00039270
039280******* MOVE 'E' TO BQVFB21-36-ERR-DIV-OPER-A                     00039280
039290******* ADD 1 TO W-CTR-BLOC.                                      00039290
039300**** GO TO F1-080.                                                00039300
039310****                                                              00039310
039320*F1-050.                                                          00039320
039330* FINE MODIFICA EURO                                              00039330
039340*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00039340
039350     MOVE 502 TO BQVFB21-36-ERR-DIV-OPER.                         00039350
039360     MOVE 'E' TO BQVFB21-36-ERR-DIV-OPER-A.                       00039360
039370     ADD 1 TO W-CTR-BLOC.                                         00039370
039380     GO TO F1-080.                                                00039380
039390                                                                  00039390
039400 F1-060.                                                          00039400
039410* INIZIO MODIFICA EURO                                            00039410
039420     IF  BQVFB11-36-DIV-OPER     = W-APPO-DIV-OPER                00039420
039430     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00039430
039440         MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-36-ERR-DIV-OPER      00039440
039450         MOVE 'E' TO BQVFB21-36-ERR-DIV-OPER-A                    00039450
039460         ADD 1 TO W-CTR-BLOC                                      00039460
039470         GO TO F1-080                                             00039470
039480     END-IF.                                                      00039480
039490*                                                                 00039490
039500 F1-065.                                                          00039500
039510*                                                                 00039510
039520*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00039520
039530     IF BQVFB11-36-DIV-OPER = 'EUR'                               00039530
039540     OR (    BQVFB11-36-DIV-OPER  = 'ITL'                         00039540
039550         AND BQVFB11-36-DATA-RISC < BQVFCO1-DATA-EUR  )           00039550
039560* FINE MODIFICA EURO                                              00039560
039570        GO TO F1-080.                                             00039570
039580                                                                  00039580
039590 F1-070.                                                          00039590
039600*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00039600
039610     MOVE 55 TO BQVFB21-36-ERR-DIV-OPER.                          00039610
039620     MOVE 'E' TO BQVFB21-36-ERR-DIV-OPER-A.                       00039620
039630     ADD 1 TO W-CTR-BLOC.                                         00039630
039640                                                                  00039640
039650 F1-080.                                                          00039650
039660*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE ALTRO ENTE:           00039660
039670*---                                                              00039670
039680     IF BQVFB11-36-COD-ALTROA = SPACE                             00039680
039690          MOVE ZERO TO BQVFB11-36-COD-ALTRO                       00039690
039700          MOVE ZERO TO BQVFB21-36-COD-ALTRO.                      00039700
039710     IF BQVFB11-36-COD-ALTROA NUMERIC AND                         00039710
039720        BQVFB11-36-COD-ALTRO = W-COD-ALTRO                        00039720
039730        GO TO F1-160.                                             00039730
039740                                                                  00039740
039750 F1-130.                                                          00039750
039760*--- IL CODICE ALTRO ENTE DEL RECORD 6 NON CORRISPONDE            00039760
039770*--- CON IL CODICE ALTRO ENTE DEL RECORD 36                       00039770
039780     IF W-COD-ALTRO = ZERO                                        00039780
039790        GO TO F1-150.                                             00039790
039800                                                                  00039800
039810 F1-140.                                                          00039810
039820*--- ERRORE DI CONGRUENZA DEL CODICE ALTRO ENTE                   00039820
039830     MOVE 506 TO BQVFB21-36-ERR-COD-ALTRO.                        00039830
039840     MOVE 'E' TO BQVFB21-36-ERR-COD-ALTRO-A.                      00039840
039850     ADD 1 TO W-CTR-BLOC.                                         00039850
039860     GO TO F1-160.                                                00039860
039870                                                                  00039870
039880 F1-150.                                                          00039880
039890*--- ERRORE DI CORRETTEZZA DEL CODICE ALTRO ENTE                  00039890
039900     MOVE 55  TO BQVFB21-36-ERR-COD-ALTRO.                        00039900
039910     MOVE 'E' TO BQVFB21-36-ERR-COD-ALTRO-A.                      00039910
039920     ADD 1 TO W-CTR-BLOC.                                         00039920
039930 F1-160.                                                          00039930
039940     IF W-REC-PREC-V20 NOT = 'V20'                                00039940
039950        GO TO F1-168.                                             00039950
039960 F1-162.                                                          00039960
039970*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE CAB                   00039970
039980     IF (BQVFB11-36-COD-CABA NUMERIC AND                          00039980
039990         BQVFB11-36-COD-CAB = W-APPO-COD-CAB) OR                  00039990
040000        W-FLAG-BANCA = 'C'                                        00040000
040010        GO TO F1-164.                                             00040010
040020 F1-163.                                                          00040020
040030*--- ERRORE DI OMOGENEITA' DEL CODICE CAB                         00040030
040040     MOVE 506 TO BQVFB21-36-ERR-COD-CAB.                          00040040
040050     MOVE 'E' TO BQVFB21-36-ERR-COD-CAB-A.                        00040050
040060     ADD 1 TO W-CTR-BLOC.                                         00040060
040070                                                                  00040070
040080 F1-164.                                                          00040080
040090*--- INTERNET                                                     00040090
040100*--- SI CONTROLLA LA CORRETTEZZA DELL'ESITO PAGAMENTO             00040100
040110     IF BQVFB21-36-ESITO-PAGAM = W-APPO-ESITO-PAGAM               00040110
040120        GO TO F1-168.                                             00040120
040130 F1-166.                                                          00040130
040140*--- ERRORE DI OMOGENEITA' DELL'ESITO PAGAMENTO                   00040140
040150     MOVE 506 TO BQVFB21-36-ERR-ESITO-PAGAM.                      00040150
040160     MOVE 'E' TO BQVFB21-36-ERR-ESITO-PAGAM-A.                    00040160
040170     ADD 1 TO W-CTR-BLOC.                                         00040170
040180                                                                  00040180
040190 F1-168.                                                          00040190
040200     COMPUTE W-APPO-CTR = W-CTR-01 - W-MEM-36-CTR-01.             00040200
040210     MOVE W-APPO-CTR TO W-APPO-36-CTR-01.                         00040210
040220     MOVE W-CTR-01 TO W-MEM-36-CTR-01.                            00040220
040230*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO DEI RECORD FISCO (V01)00040230
040240     IF BQVFB11-36-NUMRIG-ERARIOA NUMERIC                         00040240
040250        GO TO F1-180.                                             00040250
040260                                                                  00040260
040270 F1-170.                                                          00040270
040280*--- ERRORE DI NUMERICITA' DEL NUMERO DEI RECORD FISCO            00040280
040290     MOVE 33 TO BQVFB21-36-ERR-NUMRIG-ERARIO.                     00040290
040300     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ERARIO-A.                  00040300
040310     ADD 1 TO W-CTR-BLOC.                                         00040310
040320     GO TO F1-220.                                                00040320
040330                                                                  00040330
040340 F1-180.                                                          00040340
040350*--- SI CONTROLLA LA CORRETTEZZA DEL NUMERO DEI RECORD FISCO (V01)00040350
040360*--- A SECONDA CHE CI SIA ICI O MENO                              00040360
040370     IF (W-APPO-CTR               NOT > W-NUMMAX-V01 AND          00040370
040380         W-ICI = 'NO')                                       OR   00040380
040390        (W-APPO-CTR               NOT > W-NUMMAX-V01-ICI AND      00040390
040400         W-ICI = 'SI')                                       OR   00040400
040410        (W-APPO-CTR               NOT > W-NUMMAX-V12 AND          00040410
040420         W-V12 = 'SI')                                       OR   00040420
040430        (W-APPO-CTR               NOT > W-NUMMAX-F24S AND         00040430
040440         BQVFB11-36-TIPO-MODELLO = '1')             OR            00040440
040450         BQVFB11-36-MOD-CONFER    NOT = '0'                       00040450
040460        GO TO F1-200.                                             00040460
040470                                                                  00040470
040480 F1-190.                                                          00040480
040490*--- ERRORE DI CORRETTEZZA DEL NUMERO DEI RECORD FISCO            00040490
040500     MOVE 96 TO BQVFB21-36-ERR-NUMRIG-ERARIO.                     00040500
040510     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ERARIO-A.                  00040510
040520     ADD 1 TO W-CTR-BLOC.                                         00040520
040530     IF BQVFB21-ERR-TIPO-RECORD EQUAL ZERO                        00040530
040540        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00040540
040550        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00040550
040560        ADD 1 TO W-CTR-BLOC.                                      00040560
040570     GO TO F1-220.                                                00040570
040580                                                                  00040580
040590 F1-200.                                                          00040590
040600*--- SI FORZA AD 1 IL CTR PER DELEGA ATM (V20)                    00040600
040610     IF W-REC-PREC-V20 = 'V20'                                    00040610
040620        MOVE W-NUMMAX-V20 TO W-APPO-CTR.                          00040620
040630     MOVE ZERO TO W-APPO-36-CTR-12.                               00040630
040640     IF W-V12 = 'SI'                                              00040640
040650        COMPUTE W-APPO-CTR = W-CTR-12 - W-MEM-36-CTR-12           00040650
040660        MOVE W-APPO-CTR TO W-APPO-36-CTR-12                       00040660
040670        MOVE W-CTR-12 TO W-MEM-36-CTR-12.                         00040670
040680*--- SI CONTROLLA L'OMOGENEITA' DEL NUMERO DEI RECORD FISCO (V01) 00040680
040690     IF BQVFB11-36-NUMRIG-ERARIO = W-APPO-CTR OR                  00040690
040700        BQVFB11-36-TIPO-MODELLO  = '1'                            00040700
040710        GO TO F1-220.                                             00040710
040720                                                                  00040720
040730 F1-210.                                                          00040730
040740*--- ERRORE DI OMOGENEITA' DEL NUMERO DEI RECORD FISCO            00040740
040750     MOVE 503 TO BQVFB21-36-ERR-NUMRIG-ERARIO.                    00040750
040760     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ERARIO-A.                  00040760
040770     ADD 1 TO W-CTR-BLOC.                                         00040770
040780                                                                  00040780
040790 F1-220.                                                          00040790
040800     COMPUTE W-APPO-CTR = W-CTR-02 - W-MEM-36-CTR-02.             00040800
040810     MOVE W-APPO-CTR TO W-APPO-36-CTR-02.                         00040810
040820     MOVE W-CTR-02 TO W-MEM-36-CTR-02.                            00040820
040830*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO DEI RECORD INPS (V02) 00040830
040840     IF BQVFB11-36-NUMRIG-INPSA NUMERIC                           00040840
040850        GO TO F1-224.                                             00040850
040860                                                                  00040860
040870 F1-222.                                                          00040870
040880*--- ERRORE DI NUMERICITA' DEL NUMERO DEI RECORD INPS             00040880
040890     MOVE 33 TO BQVFB21-36-ERR-NUMRIG-INPS.                       00040890
040900     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-INPS-A.                    00040900
040910     ADD 1 TO W-CTR-BLOC.                                         00040910
040920     GO TO F1-240.                                                00040920
040930                                                                  00040930
040940 F1-224.                                                          00040940
040950*--- SI CONTROLLA LA CORRETTEZZA DEL NUMERO DEI RECORD INPS (V02) 00040950
040960     IF BQVFB11-36-NUMRIG-INPS NOT > W-NUMMAX-V02 OR              00040960
040970        BQVFB11-36-MOD-CONFER  NOT = '0'                          00040970
040980        GO TO F1-228.                                             00040980
040990                                                                  00040990
041000 F1-226.                                                          00041000
041010*--- ERRORE DI CORRETTEZZA DEL NUMERO DEI RECORD INPS             00041010
041020     MOVE 96 TO BQVFB21-36-ERR-NUMRIG-INPS.                       00041020
041030     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-INPS-A.                    00041030
041040     ADD 1 TO W-CTR-BLOC.                                         00041040
041050     IF BQVFB21-ERR-TIPO-RECORD EQUAL ZERO                        00041050
041060        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00041060
041070        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00041070
041080        ADD 1 TO W-CTR-BLOC.                                      00041080
041090     GO TO F1-240.                                                00041090
041100                                                                  00041100
041110 F1-228.                                                          00041110
041120*--- SI CONTROLLA L'OMOGENEITA' DEL NUMERO DEI RECORD INPS (V02)  00041120
041130     IF BQVFB11-36-NUMRIG-INPS = W-APPO-CTR OR                    00041130
041140        BQVFB11-36-TIPO-MODELLO  = '1'                            00041140
041150        GO TO F1-240.                                             00041150
041160                                                                  00041160
041170 F1-230.                                                          00041170
041180*--- ERRORE DI OMOGENEITA' DEL NUMERO DEI RECORD INPS             00041180
041190     MOVE 503 TO BQVFB21-36-ERR-NUMRIG-INPS.                      00041190
041200     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-INPS-A.                    00041200
041210     ADD 1 TO W-CTR-BLOC.                                         00041210
041220                                                                  00041220
041230 F1-240.                                                          00041230
041240     COMPUTE W-APPO-CTR = W-CTR-03 - W-MEM-36-CTR-03.             00041240
041250     MOVE W-APPO-CTR TO W-APPO-36-CTR-03.                         00041250
041260     MOVE W-CTR-03 TO W-MEM-36-CTR-03.                            00041260
041270*--- SI CONTROLLA LA NUMERICITA' DEL NUM. DEI RECORD REGIONI (V03)00041270
041280     IF BQVFB11-36-NUMRIG-REGIONIA NUMERIC                        00041280
041290        GO TO F1-244.                                             00041290
041300                                                                  00041300
041310 F1-242.                                                          00041310
041320*--- ERRORE DI NUMERICITA' DEL NUMERO DEI RECORD REGIONI          00041320
041330     MOVE 33 TO BQVFB21-36-ERR-NUMRIG-REGIONI.                    00041330
041340     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-REG-A.                     00041340
041350     ADD 1 TO W-CTR-BLOC.                                         00041350
041360     GO TO F1-260.                                                00041360
041370                                                                  00041370
041380 F1-244.                                                          00041380
041390*--- SI CONTROLLA LA CORRETTEZZA DEL NUM. DEI RECORD REGIONI (V03)00041390
041400     IF W-APPO-CTR                NOT > W-NUMMAX-V03 OR           00041400
041410        (W-APPO-CTR               NOT > W-NUMMAX-F24S AND         00041410
041420         BQVFB11-36-TIPO-MODELLO = '1')          OR               00041420
041430        BQVFB11-36-MOD-CONFER     NOT = '0'                       00041430
041440        GO TO F1-248.                                             00041440
041450                                                                  00041450
041460 F1-246.                                                          00041460
041470*--- ERRORE DI CORRETTEZZA DEL NUMERO DEI RECORD REGIONI          00041470
041480     MOVE 96 TO BQVFB21-36-ERR-NUMRIG-REGIONI.                    00041480
041490     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-REG-A.                     00041490
041500     ADD 1 TO W-CTR-BLOC.                                         00041500
041510     IF BQVFB21-ERR-TIPO-RECORD EQUAL ZERO                        00041510
041520        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00041520
041530        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00041530
041540        ADD 1 TO W-CTR-BLOC.                                      00041540
041550     GO TO F1-260.                                                00041550
041560                                                                  00041560
041570 F1-248.                                                          00041570
041580*--- SI CONTROLLA L'OMOGENEITA' DEL NUM. DEI RECORD REGIONI (V03) 00041580
041590     IF BQVFB11-36-NUMRIG-REGIONI = W-APPO-CTR OR                 00041590
041600        BQVFB11-36-TIPO-MODELLO  = '1'                            00041600
041610        GO TO F1-260.                                             00041610
041620                                                                  00041620
041630 F1-250.                                                          00041630
041640*--- ERRORE DI OMOGENEITA' DEL NUMERO DEI RECORD REGIONI          00041640
041650     MOVE 503 TO BQVFB21-36-ERR-NUMRIG-REGIONI.                   00041650
041660     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-REG-A.                     00041660
041670     ADD 1 TO W-CTR-BLOC.                                         00041670
041680                                                                  00041680
041690 F1-260.                                                          00041690
041700     COMPUTE W-APPO-CTR = W-CTR-04 - W-MEM-36-CTR-04.             00041700
041710     MOVE W-APPO-CTR TO W-APPO-36-CTR-04.                         00041710
041720     MOVE W-CTR-04 TO W-MEM-36-CTR-04.                            00041720
041730*--- SI CONTROLLA LA NUMERICITA' DEL NUM. DEI REC ENTI LOC (V04)  00041730
041740     IF BQVFB11-36-NUMRIG-ENTIA NUMERIC                           00041740
041750        GO TO F1-264.                                             00041750
041760                                                                  00041760
041770 F1-262.                                                          00041770
041780*--- ERRORE DI NUMERICITA' DEL NUMERO DEI RECORD ENTI LOCALI      00041780
041790     MOVE 33 TO BQVFB21-36-ERR-NUMRIG-ENTI.                       00041790
041800     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ENTI-A.                    00041800
041810     ADD 1 TO W-CTR-BLOC.                                         00041810
041820     GO TO F1-290.                                                00041820
041830                                                                  00041830
041840 F1-264.                                                          00041840
041850*--- SI CONTROLLA LA CORRETTEZZA DEL NUMERO DEI RECORD ENTI (V04) 00041850
041860*--- A SECONDA CHE CI SIA ICI O MENO                              00041860
041870     IF (W-APPO-CTR             NOT > W-NUMMAX-V04 AND            00041870
041880         BQVFB11-36-TIPO-MODELLO NOT = '2' AND                    00041880
041890         BQVFB11-36-TIPO-MODELLO NOT = '3' AND                    00041890
041900         BQVFB11-36-TIPO-MODELLO NOT = '4' AND                    00041900
041910         W-ICI = 'NO')                                       OR   00041910
041920        (W-APPO-CTR             NOT > W-NUMMAX-V04-ICI AND        00041920
041930         BQVFB11-36-TIPO-MODELLO NOT = '2' AND                    00041930
041940         BQVFB11-36-TIPO-MODELLO NOT = '3' AND                    00041940
041950         BQVFB11-36-TIPO-MODELLO NOT = '4' AND                    00041950
041960         W-ICI = 'SI')                                       OR   00041960
041970        (W-APPO-CTR               NOT > W-NUMMAX-F24S AND         00041970
041980         BQVFB11-36-TIPO-MODELLO = '1')          OR               00041980
041990        (W-APPO-CTR               NOT > W-NUMMAX-IMU-POSTE AND    00041990
042000         BQVFB11-36-TIPO-MODELLO = '2')          OR               00042000
042010        (W-APPO-CTR             NOT > W-NUMMAX-TARES-POSTE AND    00042010
042020         BQVFB11-36-TIPO-MODELLO = '3')                      OR   00042020
042030        (W-APPO-CTR             NOT > W-NUMMAX-TASI-POSTE AND     00042030
042040         BQVFB11-36-TIPO-MODELLO = '4')                      OR   00042040
042050        (BQVFB11-36-MOD-CONFER  NOT = '0' AND                     00042050
042060         BQVFB11-36-MOD-CONFER  NOT = '5' AND                     00042060
042070         BQVFB11-36-MOD-CONFER  NOT = '6' AND                     00042070
042080         BQVFB11-36-MOD-CONFER  NOT = '7')                        00042080
042090        GO TO F1-268.                                             00042090
042100                                                                  00042100
042110 F1-266.                                                          00042110
042120*--- ERRORE DI CORRETTEZZA DEL NUMERO DEI RECORD ENTI LOCALI      00042120
042130     MOVE 96 TO BQVFB21-36-ERR-NUMRIG-ENTI.                       00042130
042140     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ENTI-A.                    00042140
042150     ADD 1 TO W-CTR-BLOC.                                         00042150
042160     IF BQVFB21-ERR-TIPO-RECORD EQUAL ZERO                        00042160
042170        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00042170
042180        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00042180
042190        ADD 1 TO W-CTR-BLOC.                                      00042190
042200     GO TO F1-290.                                                00042200
042210                                                                  00042210
042220 F1-268.                                                          00042220
042230*--- SI CONTROLLA L'OMOGENEITA' DEL NUM. DEI ENTI LOCALI (V04)    00042230
042240     IF BQVFB11-36-NUMRIG-ENTI = W-APPO-CTR OR                    00042240
042250        BQVFB11-36-TIPO-MODELLO  = '1'                            00042250
042260        GO TO F1-290.                                             00042260
042270                                                                  00042270
042280 F1-270.                                                          00042280
042290*--- ERRORE DI OMOGENEITA' DEL NUMERO DEI RECORD ENTI             00042290
042300     MOVE 503 TO BQVFB21-36-ERR-NUMRIG-ENTI.                      00042300
042310     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ENTI-A.                    00042310
042320     ADD 1 TO W-CTR-BLOC.                                         00042320
042330                                                                  00042330
042340 F1-290.                                                          00042340
042350     COMPUTE W-APPO-CTR = W-CTR-05 - W-MEM-36-CTR-05.             00042350
042360     MOVE W-APPO-CTR TO W-APPO-36-CTR-05.                         00042360
042370     MOVE W-CTR-05 TO W-MEM-36-CTR-05.                            00042370
042380*--- SI CONTROLLA LA NUMERICITA' DEL NUM. DEI RECORD INAIL (V05)  00042380
042390     IF BQVFB11-36-NUMRIG-INAILA NUMERIC                          00042390
042400        GO TO F1-294.                                             00042400
042410                                                                  00042410
042420 F1-292.                                                          00042420
042430*--- ERRORE DI NUMERICITA' DEL NUMERO DEI RECORD INAIL            00042430
042440     MOVE 33 TO BQVFB21-36-ERR-NUMRIG-INAIL.                      00042440
042450     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-INAIL-A.                   00042450
042460     ADD 1 TO W-CTR-BLOC.                                         00042460
042470     GO TO F1-310.                                                00042470
042480                                                                  00042480
042490 F1-294.                                                          00042490
042500*--- SI CONTROLLA LA CORRETTEZZA DEL NUM. DEI RECORD INAIL (V05)  00042500
042510     IF BQVFB11-36-NUMRIG-INAIL NOT > W-NUMMAX-V05 OR             00042510
042520        BQVFB11-36-MOD-CONFER   NOT = '0'                         00042520
042530        GO TO F1-298.                                             00042530
042540                                                                  00042540
042550 F1-296.                                                          00042550
042560*--- ERRORE DI CORRETTEZZA DEL NUMERO DEI RECORD INAIL            00042560
042570     MOVE 96 TO BQVFB21-36-ERR-NUMRIG-INAIL.                      00042570
042580     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-INAIL-A.                   00042580
042590     ADD 1 TO W-CTR-BLOC.                                         00042590
042600     IF BQVFB21-ERR-TIPO-RECORD EQUAL ZERO                        00042600
042610        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00042610
042620        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00042620
042630        ADD 1 TO W-CTR-BLOC.                                      00042630
042640     GO TO F1-310.                                                00042640
042650                                                                  00042650
042660 F1-298.                                                          00042660
042670*--- SI CONTROLLA L'OMOGENEITA' DEL NUM. DEI RECORD INAIL (V05)   00042670
042680     IF BQVFB11-36-NUMRIG-INAIL = W-APPO-CTR OR                   00042680
042690        BQVFB11-36-TIPO-MODELLO  = '1'                            00042690
042700        GO TO F1-310.                                             00042700
042710                                                                  00042710
042720 F1-300.                                                          00042720
042730*--- ERRORE DI OMOGENEITA' DEL NUMERO DEI RECORD INAIL            00042730
042740     MOVE 503 TO BQVFB21-36-ERR-NUMRIG-INAIL.                     00042740
042750     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-INAIL-A.                   00042750
042760     ADD 1 TO W-CTR-BLOC.                                         00042760
042770                                                                  00042770
042780 F1-310.                                                          00042780
042790     COMPUTE W-APPO-CTR = W-CTR-06 - W-MEM-36-CTR-06.             00042790
042800     MOVE W-APPO-CTR TO W-APPO-36-CTR-06.                         00042800
042810     MOVE W-CTR-06 TO W-MEM-36-CTR-06.                            00042810
042820*--- SI CONTROLLA LA NUMERICITA' DEL NUM. DEI REC ALTRI ENTI (V06)00042820
042830     IF BQVFB11-36-NUMRIG-ALTRIA NUMERIC                          00042830
042840        GO TO F1-314.                                             00042840
042850                                                                  00042850
042860 F1-312.                                                          00042860
042870*--- ERRORE DI NUMERICITA' DEL NUMERO DEI RECORD ALTRI ENTI       00042870
042880     MOVE 33 TO BQVFB21-36-ERR-NUMRIG-ALTRI.                      00042880
042890     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ALTRI-A.                   00042890
042900     ADD 1 TO W-CTR-BLOC.                                         00042900
042910     GO TO F1-330.                                                00042910
042920                                                                  00042920
042930 F1-314.                                                          00042930
042940*--- SI CONTROLLA LA CORRETTEZZA DEL NUMERO DEI RECORD ALTRI (V06)00042940
042950*--- A SECONDA CHE CI SIA ICI O MENO                              00042950
042960     IF (BQVFB11-36-NUMRIG-ALTRI NOT > W-NUMMAX-V06 AND           00042960
042970         W-ICI = 'NO')                                       OR   00042970
042980        (BQVFB11-36-NUMRIG-ALTRI NOT > W-NUMMAX-V06-ICI AND       00042980
042990         W-ICI = 'SI')                                       OR   00042990
043000         BQVFB11-36-MOD-CONFER   NOT = '0'                        00043000
043010        GO TO F1-318.                                             00043010
043020                                                                  00043020
043030 F1-316.                                                          00043030
043040*--- ERRORE DI CORRETTEZZA DEL NUMERO DEI RECORD ALTRI ENTI       00043040
043050     MOVE 96 TO BQVFB21-36-ERR-NUMRIG-ALTRI.                      00043050
043060     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ALTRI-A.                   00043060
043070     ADD 1 TO W-CTR-BLOC.                                         00043070
043080     IF BQVFB21-ERR-TIPO-RECORD EQUAL ZERO                        00043080
043090        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00043090
043100        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00043100
043110        ADD 1 TO W-CTR-BLOC.                                      00043110
043120     GO TO F1-330.                                                00043120
043130                                                                  00043130
043140 F1-318.                                                          00043140
043150*--- SI CONTROLLA L'OMOGENEITA' DEL NUM. DEI REC ALTRI ENTI (V06) 00043150
043160     IF BQVFB11-36-NUMRIG-ALTRI = W-APPO-CTR OR                   00043160
043170        BQVFB11-36-TIPO-MODELLO  = '1'                            00043170
043180        GO TO F1-330.                                             00043180
043190                                                                  00043190
043200 F1-320.                                                          00043200
043210*--- ERRORE DI OMOGENEITA' DEL NUMERO DEI RECORD ALTRI ENTI       00043210
043220     MOVE 503 TO BQVFB21-36-ERR-NUMRIG-ALTRI.                     00043220
043230     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ALTRI-A.                   00043230
043240     ADD 1 TO W-CTR-BLOC.                                         00043240
043250                                                                  00043250
043260 F1-330.                                                          00043260
043270     COMPUTE W-APPO-CTR = W-CTR-07 - W-MEM-36-CTR-07.             00043270
043280     MOVE W-APPO-CTR TO W-APPO-36-CTR-07.                         00043280
043290     MOVE W-CTR-07 TO W-MEM-36-CTR-07.                            00043290
043300*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO DEI RECORD ACCISE(V07)00043300
043310     IF BQVFB11-36-NUMRIG-ACCISEA NUMERIC                         00043310
043320        GO TO F1-334.                                             00043320
043330                                                                  00043330
043340 F1-332.                                                          00043340
043350*--- ERRORE DI NUMERICITA' DEL NUMERO DEI RECORD ACCISE ENTI      00043350
043360     MOVE 33 TO BQVFB21-36-ERR-NUMRIG-ACCISE.                     00043360
043370     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ACCISE-A.                  00043370
043380     ADD 1 TO W-CTR-BLOC.                                         00043380
043390     GO TO F1-344.                                                00043390
043400                                                                  00043400
043410 F1-334.                                                          00043410
043420*--- SI CONTROLLA LA CORRETTEZZA DEL NUM DEI RECORD ACCISE (V07)  00043420
043430     IF BQVFB11-36-NUMRIG-ACCISE NOT > W-NUMMAX-V07  OR           00043430
043440        BQVFB11-36-MOD-CONFER   NOT = '0'                         00043440
043450        GO TO F1-338.                                             00043450
043460                                                                  00043460
043470 F1-336.                                                          00043470
043480*--- ERRORE DI CORRETTEZZA DEL NUMERO DEI RECORD ACCISE           00043480
043490     MOVE 96 TO BQVFB21-36-ERR-NUMRIG-ACCISE.                     00043490
043500     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ACCISE-A.                  00043500
043510     ADD 1 TO W-CTR-BLOC.                                         00043510
043520     IF BQVFB21-ERR-TIPO-RECORD EQUAL ZERO                        00043520
043530        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00043530
043540        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00043540
043550        ADD 1 TO W-CTR-BLOC.                                      00043550
043560     GO TO F1-344.                                                00043560
043570                                                                  00043570
043580 F1-338.                                                          00043580
043590*--- SI CONTROLLA L'OMOGENEITA' DEL NUMERO DEI RECORD ACCISE (V07)00043590
043600     IF BQVFB11-36-NUMRIG-ACCISE = W-APPO-CTR OR                  00043600
043610        BQVFB11-36-TIPO-MODELLO  = '1'                            00043610
043620        GO TO F1-342.                                             00043620
043630                                                                  00043630
043640 F1-340.                                                          00043640
043650*--- ERRORE DI OMOGENEITA' DEL NUMERO DEI RECORD ACCISE           00043650
043660     MOVE 503 TO BQVFB21-36-ERR-NUMRIG-ACCISE.                    00043660
043670     MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ACCISE-A.                  00043670
043680     ADD 1 TO W-CTR-BLOC.                                         00043680
043690     GO TO F1-344.                                                00043690
043700                                                                  00043700
043710 F1-342.                                                          00043710
043720*--- ERRORE DI PRESENZA SIMULTANEA SUL MODELLO CARTACEO           00043720
043730*--- DEI TIPI RECORD 5, 6 E 7                                     00043730
043740     IF ( W-APPO-36-CTR-05        > ZERO OR                       00043740
043750          W-APPO-36-CTR-06        > ZERO    ) AND                 00043750
043760          W-APPO-36-CTR-07        > ZERO                          00043760
043770        MOVE  55 TO BQVFB21-36-ERR-NUMRIG-ACCISE                  00043770
043780        MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ACCISE-A                00043780
043790        ADD 1 TO W-CTR-BLOC.                                      00043790
043800                                                                  00043800
043810 F1-344.                                                          00043810
043820*--- ERRORE DI PRESENZA DI PIU' RECORD DI TIPO 20                 00043820
043830*     IF W-APPO-36-CTR-20 > 1                                     00043830
043840*        MOVE  55 TO BQVFB21-36-ERR-NUMRIG-ERARIO                 00043840
043850*        MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ERARIO-A               00043850
043860*        ADD 1 TO W-CTR-BLOC                                      00043860
043870*        GO TO F1-358.                                            00043870
043880*                                                                 00043880
043890 F1-346.                                                          00043890
043900     MOVE 0 TO W-APPO-36-CTR-20.                                  00043900
043910*--- SI FORZA AD 1 IL CTR PER DELEGA ATM (V20)                    00043910
043920     IF W-REC-PREC-V20 = 'V20'                                    00043920
043930        MOVE 1 TO W-APPO-36-CTR-20.                               00043930
043940*--- ERRORE DI PRESENZA SIMULTANEA                                00043940
043950*--- DEI TIPI RECORD 20/12 E 1,2,3,4,5,6 E 7                      00043950
043960*                                                                 00043960
043970     IF ( W-APPO-36-CTR-20        > ZERO AND                      00043970
043980         (W-APPO-36-CTR-01        > ZERO OR                       00043980
043990          W-APPO-36-CTR-02        > ZERO OR                       00043990
044000          W-APPO-36-CTR-03        > ZERO OR                       00044000
044010          W-APPO-36-CTR-04        > ZERO OR                       00044010
044020          W-APPO-36-CTR-05        > ZERO OR                       00044020
044030          W-APPO-36-CTR-06        > ZERO OR                       00044030
044040          W-APPO-36-CTR-07        > ZERO OR                       00044040
044050          W-APPO-36-CTR-12        > ZERO)) OR                     00044050
044060        ( W-APPO-36-CTR-12        > ZERO AND                      00044060
044070         (W-APPO-36-CTR-01        > ZERO OR                       00044070
044080          W-APPO-36-CTR-02        > ZERO OR                       00044080
044090          W-APPO-36-CTR-03        > ZERO OR                       00044090
044100          W-APPO-36-CTR-04        > ZERO OR                       00044100
044110          W-APPO-36-CTR-05        > ZERO OR                       00044110
044120          W-APPO-36-CTR-06        > ZERO OR                       00044120
044130          W-APPO-36-CTR-07        > ZERO OR                       00044130
044140          W-APPO-36-CTR-20        > ZERO))                        00044140
044150             IF BQVFB21-36-ERR-NUMRIG-ERARIO NOT = 0 AND          00044150
044160                BQVFB21-36-ERR-NUMRIG-ERARIO-A = 'E'              00044160
044170                   SUBTRACT 1 FROM W-CTR-BLOC                     00044170
044180             END-IF                                               00044180
044190        MOVE  55 TO BQVFB21-36-ERR-NUMRIG-ERARIO                  00044190
044200        MOVE 'E' TO BQVFB21-36-ERR-NUMRIG-ERARIO-A                00044200
044210        ADD 1 TO W-CTR-BLOC.                                      00044210
044220*                                                                 00044220
044230        IF (W-APPO-36-CTR-02        > ZERO OR                     00044230
044240            W-APPO-36-CTR-05        > ZERO OR                     00044240
044250            W-APPO-36-CTR-06        > ZERO OR                     00044250
044260            W-APPO-36-CTR-07        > ZERO OR                     00044260
044270            W-APPO-36-CTR-12        > ZERO OR                     00044270
044280            W-APPO-36-CTR-20        > ZERO) AND                   00044280
044290           BQVFB21-36-TIPO-MODELLO = '1'                          00044290
044300             MOVE  55 TO BQVFB21-36-ERR-TIPO-MODELLO              00044300
044310             MOVE 'E' TO BQVFB21-36-ERR-TIPO-MODELLO-A            00044310
044320             ADD 1 TO W-CTR-BLOC.                                 00044320
044330*                                                                 00044330
044340        IF (W-APPO-36-CTR-01        > ZERO OR                     00044340
044350            W-APPO-36-CTR-02        > ZERO OR                     00044350
044360            W-APPO-36-CTR-03        > ZERO OR                     00044360
044370            W-APPO-36-CTR-05        > ZERO OR                     00044370
044380            W-APPO-36-CTR-06        > ZERO OR                     00044380
044390            W-APPO-36-CTR-07        > ZERO OR                     00044390
044400            W-APPO-36-CTR-12        > ZERO OR                     00044400
044410            W-APPO-36-CTR-20        > ZERO) AND                   00044410
044420           (BQVFB21-36-TIPO-MODELLO = '2' OR                      00044420
044430            BQVFB21-36-TIPO-MODELLO = '3' OR                      00044430
044440            BQVFB21-36-TIPO-MODELLO = '4') AND                    00044440
044450           BQVFB21-36-ERR-TIPO-MODELLO = ZERO                     00044450
044460             MOVE  55 TO BQVFB21-36-ERR-TIPO-MODELLO              00044460
044470             MOVE 'E' TO BQVFB21-36-ERR-TIPO-MODELLO-A            00044470
044480             ADD 1 TO W-CTR-BLOC.                                 00044480
044490                                                                  00044490
044500 F1-358.                                                          00044500
044510*--- SI CONTROLLA LA CORRETTEZZA DEL FLAG TARDIVITA'              00044510
044520     IF BQVFB11-36-FLAG-TARD NOT = '0' AND                        00044520
044530        BQVFB11-36-FLAG-TARD NOT = '1' AND                        00044530
044540        BQVFB11-36-FLAG-TARD NOT = '2'                            00044540
044550        MOVE 55  TO BQVFB21-36-ERR-FLAG-TARD                      00044550
044560        MOVE 'W' TO BQVFB21-36-ERR-FLAG-TARD-A                    00044560
044570        ADD 1 TO W-CTR-NO-BLOC                                    00044570
044580        GO TO F1-366.                                             00044580
044590                                                                  00044590
044600 F1-359.                                                          00044600
044610     IF BQVFB11-36-FLAG-TARD = '0'                                00044610
044620        GO TO F1-365.                                             00044620
044630                                                                  00044630
044640 F1-360.                                                          00044640
044650*--- SE LA DATA RISCOSSIONE NON E' ERRATA SI CONTROLLA,           00044650
044660*--- PER FLAG TARDIVITA' IMPOSTATO, CHE SIA MINORE DEI            00044660
044670*--- 4 GIORNI PRECEDENTI AL BONIFICO                              00044670
044680     IF BQVFB21-36-ERR-DATA-RISC-A NOT = ZERO                     00044680
044690        GO TO F1-366.                                             00044690
044700                                                                  00044700
044710 F1-361.                                                          00044710
044720     MOVE BQVFB11-36-DATA-RISC TO BQVFDA1-DAT1.                   00044720
044730     MOVE BQVFB11-DATA-BONIF   TO BQVFDA1-DAT2.                   00044730
044740     CALL 'BQVFDA' USING BQVFDA1.                                 00044740
044750     IF BQVFDA1-OK         = 0 AND                                00044750
044760        BQVFDA1-GIORNI > 5                                        00044760
044770        GO TO F1-366.                                             00044770
044780                                                                  00044780
044790 F1-362.                                                          00044790
044800*--- ERRORE DI VALIDITA' DELLA DATA RISCOSSIONE                   00044800
044810     MOVE 24  TO BQVFB21-36-ERR-DATA-RISC.                        00044810
044820     MOVE 'W' TO BQVFB21-36-ERR-DATA-RISC-A.                      00044820
044830     ADD 1 TO W-CTR-NO-BLOC.                                      00044830
044840     GO TO F1-366.                                                00044840
044850                                                                  00044850
044860 F1-365.                                                          00044860
044870     IF BQVFB21-36-ERR-DATA-RISC-A = ZERO                         00044870
044880             PERFORM FX-010-TARD THRU FX-010-TARD-EX.             00044880
044890                                                                  00044890
044900 F1-366.                                                          00044900
044910*                                                                 00044910
044920*** MODIFICA PER V36/V49 CONTESTUALI                              00044920
044930*                                                                 00044930
044940     IF BQVFB11-36-FLAG-TARD = 2 THEN                             00044940
044950        ADD 1 TO W-CONT-V36                                       00044950
044960     END-IF.                                                      00044960
044970*                                                                 00044970
044980*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00044980
044990*--- SUL RECORD 36                                                00044990
045000     MOVE SPACE TO W-DIV.                                         00045000
045010     MOVE ZERO  TO W-V20.                                         00045010
045020     IF W-REC-PREC-V20 = 'V20' OR                                 00045020
045030        W-V12 = 'SI'                                              00045030
045040        MOVE '1' TO W-V20.                                        00045040
045050*                                                                 00045050
045060     IF W-APPO-ERR-DIV-OPER = ZERO                                00045060
045070        MOVE W-APPO-DIV-OPER TO W-DIV.                            00045070
045080     CALL 'BQVFB6' USING   W-FLAG-BANCA                           00045080
045090                           W-FLAG-AGEV                            00045090
045100                           W-SALDO-AGEV                           00045100
045110                           BQVFB21                                00045110
045120                           W-TAB-TOT                              00045120
045130                           W-DIV                                  00045130
045140                           W-CTR-NO-BLOC                          00045140
045150                           W-CTR-BLOC                             00045150
045160                           W-COMP-FISCO                           00045160
045170                           W-COMP-REG                             00045170
045180                           W-V20                                  00045180
045190*ICI                                                              00045190
045200                           W-TAB-COMUNI                           00045200
045210*ICI                                                              00045210
045220                           W-TAB-AZIENDE                          00045220
045230                           W-TAB-AMBITI                           00045230
045240                           W-TAB-IDENT                            00045240
045250                           W-TOT-RIMB-TRIB                        00045250
045260                           W-TIPO-TRIB-NO-IMU                     00045260
045270                           W-TIPO-TRIB-NO-TARES                   00045270
045280                           W-FLAG-CONF-F24                        00045280
045290                           W-FLAG-CONF-I24                        00045290
045300                           W-TIPO-TRIB-NO-TASI                    00045300
045310                           W-FLAG-TRIB-CONC                       00045310
045320                           W-FLAG-CRED                            00045320
045330                           W-COMP-EL                              00045330
045340                           W-TOT-IMP-CRED-CONTR-E                 00045340
045350                           W-TOT-IMP-CRED-CONTR-IRF               00045350
045360                           W-TOT-IMP-CRED-CONTR-ADX               00045360
045370                           W-TOT-IMP-CRED-CONTR-IIE               00045370
045380                           W-TOT-IMP-CRED-CONTR-IFE               00045380
045390                           W-TOT-IMP-CRED-CONTR-FF1               00045390
045400                           W-TOT-IMP-CRED-CONTR-FF2               00045400
045410                           W-TOT-IMP-CRED-CONTR-FF3               00045410
045420                           W-TOT-IMP-CRED-CONTR-ORO               00045420
045430                           W-TOT-IMP-CRED-CONTR-SEC               00045430
045440                           W-TOT-IMP-CRED-CONTR-IEC               00045440
045441                           W-TOT-IMP-CRED-CONTR-QR1               00045441
045442                           W-TOT-IMP-CRED-CONTR-BTC.              00045442
045450                                                                  00045450
045460 F1-367.                                                          00045460
045470*--- IN CASO DI SEQUENZA RECORD ERRATA NON SI IMPOSTA LA          00045470
045480*--- TABELLA DEI TOTALI PER PROVINCIA TRATTATA (O DELEGA)         00045480
045490     IF W-FLAG-ERR-SEQ = 1                                        00045490
045500        GO TO F1-990-CONTR-36-EX.                                 00045500
045510                                                                  00045510
045520 F1-368.                                                          00045520
045530*---                                                              00045530
045540*---                                                              00045540
045550*--- IVA                                                          00045550
045560     MOVE ZERO TO W-IMP-CRED-MAX1.                                00045560
045570     MOVE ZERO TO W-IMP-CRED-MAX2.                                00045570
045580     IF W-FLAG-COMP-IVA = '1'                                     00045580
045590        PERFORM F5-010 THRU F5-EXIT.                              00045590
045600     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00045600
045610        IF ((W-FLAG-RIF-V-T = '1' AND                             00045610
045620             W-FLAG-RIF-V-A = '0') OR                             00045620
045630           (W-FLAG-RIF-V-T = '0' AND                              00045630
045640            W-FLAG-RIF-V-A = '1')) AND                            00045640
045650           W-TOT-IMP-CRED-CONTR-V GREATER W-IMP-CRED-MAX1         00045650
045660                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00045660
045670                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00045670
045680                 ADD 1 TO W-CTR-BLOC                              00045680
045690        END-IF                                                    00045690
045700        IF W-FLAG-RIF-V-T = '1' AND                               00045700
045710           W-FLAG-RIF-V-A = '1' AND                               00045710
045720           W-TOT-IMP-CRED-CONTR-V GREATER W-IMP-CRED-MAX2         00045720
045730                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00045730
045740                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00045740
045750                ADD 1 TO W-CTR-BLOC                               00045750
045760        END-IF                                                    00045760
045770     END-IF.                                                      00045770
045780*---                                                              00045780
045790*--- IRS                                                          00045790
045800     MOVE ZERO TO W-IMP-CRED-MAX1.                                00045800
045810     MOVE ZERO TO W-IMP-CRED-MAX2.                                00045810
045820     IF W-FLAG-COMP-IRS = '1'                                     00045820
045830        PERFORM F6-010 THRU F6-EXIT.                              00045830
045840     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00045840
045850        IF ((W-FLAG-RIF-I-T = '1' AND                             00045850
045860             W-FLAG-RIF-I-A = '0') OR                             00045860
045870           (W-FLAG-RIF-I-T = '0' AND                              00045870
045880            W-FLAG-RIF-I-A = '1')) AND                            00045880
045890           W-TOT-IMP-CRED-CONTR-I GREATER W-IMP-CRED-MAX1         00045890
045900                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00045900
045910                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00045910
045920                 ADD 1 TO W-CTR-BLOC                              00045920
045930        END-IF                                                    00045930
045940        IF W-FLAG-RIF-I-T = '1' AND                               00045940
045950           W-FLAG-RIF-I-A = '1' AND                               00045950
045960           W-TOT-IMP-CRED-CONTR-I GREATER W-IMP-CRED-MAX2         00045960
045970                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00045970
045980                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00045980
045990                ADD 1 TO W-CTR-BLOC                               00045990
046000        END-IF                                                    00046000
046010     END-IF.                                                      00046010
046020*---                                                              00046020
046030*--- IRM                                                          00046030
046040     MOVE ZERO TO W-IMP-CRED-MAX1.                                00046040
046050     MOVE ZERO TO W-IMP-CRED-MAX2.                                00046050
046060     IF W-FLAG-COMP-IRM = '1'                                     00046060
046070        PERFORM F8-010 THRU F8-EXIT.                              00046070
046080     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00046080
046090        IF ((W-FLAG-RIF-M-T = '1' AND                             00046090
046100             W-FLAG-RIF-M-A = '0') OR                             00046100
046110           (W-FLAG-RIF-M-T = '0' AND                              00046110
046120            W-FLAG-RIF-M-A = '1')) AND                            00046120
046130           W-TOT-IMP-CRED-CONTR-M GREATER W-IMP-CRED-MAX1         00046130
046140                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00046140
046150                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00046150
046160                 ADD 1 TO W-CTR-BLOC                              00046160
046170        END-IF                                                    00046170
046180        IF W-FLAG-RIF-M-T = '1' AND                               00046180
046190           W-FLAG-RIF-M-A = '1' AND                               00046190
046200           W-TOT-IMP-CRED-CONTR-M GREATER W-IMP-CRED-MAX2         00046200
046210                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00046210
046220                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00046220
046230                ADD 1 TO W-CTR-BLOC                               00046230
046240        END-IF                                                    00046240
046250     END-IF.                                                      00046250
046260*---                                                              00046260
046270*--- IRP                                                          00046270
046280     MOVE ZERO TO W-IMP-CRED-MAX1.                                00046280
046290     MOVE ZERO TO W-IMP-CRED-MAX2.                                00046290
046300     IF W-FLAG-COMP-IRP = '1'                                     00046300
046310        PERFORM F7-010 THRU F7-EXIT.                              00046310
046320     IF BQVFB21-36-ERR-SALDO-REG-A  NOT EQUAL 'E'                 00046320
046330        IF ((W-FLAG-RIF-R-T = '1' AND                             00046330
046340             W-FLAG-RIF-R-A = '0') OR                             00046340
046350           (W-FLAG-RIF-R-T = '0' AND                              00046350
046360            W-FLAG-RIF-R-A = '1')) AND                            00046360
046370           W-TOT-IMP-CRED-CONTR-R GREATER W-IMP-CRED-MAX1         00046370
046380                 MOVE  96 TO BQVFB21-36-ERR-SALDO-REG             00046380
046390                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-REG-A           00046390
046400                 ADD 1 TO W-CTR-BLOC                              00046400
046410        END-IF                                                    00046410
046420        IF W-FLAG-RIF-R-T = '1' AND                               00046420
046430           W-FLAG-RIF-R-A = '1' AND                               00046430
046440           W-TOT-IMP-CRED-CONTR-R GREATER W-IMP-CRED-MAX2         00046440
046450                 MOVE  96 TO BQVFB21-36-ERR-SALDO-REG             00046450
046460                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-REG-A           00046460
046470                ADD 1 TO W-CTR-BLOC                               00046470
046480        END-IF                                                    00046480
046490     END-IF.                                                      00046490
046500*---                                                              00046500
046510*--- ELO                                                          00046510
046520     MOVE ZERO TO W-IMP-CRED-MAX1.                                00046520
046530     MOVE ZERO TO W-IMP-CRED-MAX2.                                00046530
046540     IF W-FLAG-COMP-ELO = '1'                                     00046540
046550        PERFORM F9-010 THRU F9-EXIT.                              00046550
046560     IF BQVFB21-36-ERR-SALDO-ENTE-A NOT EQUAL 'E'                 00046560
046570        IF ((W-FLAG-RIF-E-T = '1' AND                             00046570
046580             W-FLAG-RIF-E-A = '0') OR                             00046580
046590           (W-FLAG-RIF-E-T = '0' AND                              00046590
046600            W-FLAG-RIF-E-A = '1')) AND                            00046600
046610           W-TOT-IMP-CRED-CONTR-E GREATER W-IMP-CRED-MAX1         00046610
046620                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ENTE            00046620
046630                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ENTE-A          00046630
046640                 ADD 1 TO W-CTR-BLOC                              00046640
046650        END-IF                                                    00046650
046660        IF W-FLAG-RIF-E-T = '1' AND                               00046660
046670           W-FLAG-RIF-E-A = '1' AND                               00046670
046680           W-TOT-IMP-CRED-CONTR-E GREATER W-IMP-CRED-MAX2         00046680
046690                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ENTE            00046690
046700                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ENTE-A          00046700
046710                ADD 1 TO W-CTR-BLOC                               00046710
046720        END-IF                                                    00046720
046730     END-IF.                                                      00046730
046740*---                                                              00046740
046750*--- IRF                                                          00046750
046760     MOVE ZERO TO W-IMP-CRED-MAX1.                                00046760
046770     MOVE ZERO TO W-IMP-CRED-MAX2.                                00046770
046780     IF W-FLAG-COMP-IRF = '1'                                     00046780
046790        PERFORM F10-010 THRU F10-EXIT.                            00046790
046800     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00046800
046810        IF ((W-FLAG-RIF-IRF-T = '1' AND                           00046810
046820             W-FLAG-RIF-IRF-A = '0') OR                           00046820
046830           (W-FLAG-RIF-IRF-T = '0' AND                            00046830
046840            W-FLAG-RIF-IRF-A = '1')) AND                          00046840
046850           W-TOT-IMP-CRED-CONTR-IRF GREATER W-IMP-CRED-MAX1       00046850
046860                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00046860
046870                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00046870
046880                 ADD 1 TO W-CTR-BLOC                              00046880
046890        END-IF                                                    00046890
046900        IF W-FLAG-RIF-IRF-T = '1' AND                             00046900
046910           W-FLAG-RIF-IRF-A = '1' AND                             00046910
046920           W-TOT-IMP-CRED-CONTR-IRF GREATER W-IMP-CRED-MAX2       00046920
046930                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00046930
046940                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00046940
046950                ADD 1 TO W-CTR-BLOC                               00046950
046960        END-IF                                                    00046960
046970     END-IF.                                                      00046970
046980*---                                                              00046980
046990*--- ADX                                                          00046990
047000     MOVE ZERO TO W-IMP-CRED-MAX1.                                00047000
047010     MOVE ZERO TO W-IMP-CRED-MAX2.                                00047010
047020     IF W-FLAG-COMP-ADX = '1'                                     00047020
047030        PERFORM F11-010 THRU F11-EXIT.                            00047030
047040     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00047040
047050        IF ((W-FLAG-RIF-ADX-T = '1' AND                           00047050
047060             W-FLAG-RIF-ADX-A = '0') OR                           00047060
047070           (W-FLAG-RIF-ADX-T = '0' AND                            00047070
047080            W-FLAG-RIF-ADX-A = '1')) AND                          00047080
047090           W-TOT-IMP-CRED-CONTR-ADX GREATER W-IMP-CRED-MAX1       00047090
047100                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00047100
047110                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00047110
047120                 ADD 1 TO W-CTR-BLOC                              00047120
047130        END-IF                                                    00047130
047140        IF W-FLAG-RIF-ADX-T = '1' AND                             00047140
047150           W-FLAG-RIF-ADX-A = '1' AND                             00047150
047160           W-TOT-IMP-CRED-CONTR-ADX GREATER W-IMP-CRED-MAX2       00047160
047170                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00047170
047180                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00047180
047190                ADD 1 TO W-CTR-BLOC                               00047190
047200        END-IF                                                    00047200
047210     END-IF.                                                      00047210
047220*---                                                              00047220
047230*--- IIE                                                          00047230
047240     MOVE ZERO TO W-IMP-CRED-MAX1.                                00047240
047250     MOVE ZERO TO W-IMP-CRED-MAX2.                                00047250
047260     IF W-FLAG-COMP-IIE = '1'                                     00047260
047270        PERFORM F12-010 THRU F12-EXIT.                            00047270
047280     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00047280
047290        IF ((W-FLAG-RIF-IIE-T = '1' AND                           00047290
047300             W-FLAG-RIF-IIE-A = '0') OR                           00047300
047310           (W-FLAG-RIF-IIE-T = '0' AND                            00047310
047320            W-FLAG-RIF-IIE-A = '1')) AND                          00047320
047330           W-TOT-IMP-CRED-CONTR-IIE GREATER W-IMP-CRED-MAX1       00047330
047340                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00047340
047350                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00047350
047360                 ADD 1 TO W-CTR-BLOC                              00047360
047370        END-IF                                                    00047370
047380        IF W-FLAG-RIF-IIE-T = '1' AND                             00047380
047390           W-FLAG-RIF-IIE-A = '1' AND                             00047390
047400           W-TOT-IMP-CRED-CONTR-IIE GREATER W-IMP-CRED-MAX2       00047400
047410                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00047410
047420                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00047420
047430                ADD 1 TO W-CTR-BLOC                               00047430
047440        END-IF                                                    00047440
047450     END-IF.                                                      00047450
047460*---                                                              00047460
047470*--- IFE                                                          00047470
047480     MOVE ZERO TO W-IMP-CRED-MAX1.                                00047480
047490     MOVE ZERO TO W-IMP-CRED-MAX2.                                00047490
047500     IF W-FLAG-COMP-IFE = '1'                                     00047500
047510        PERFORM F13-010 THRU F13-EXIT.                            00047510
047520     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00047520
047530        IF ((W-FLAG-RIF-IFE-T = '1' AND                           00047530
047540             W-FLAG-RIF-IFE-A = '0') OR                           00047540
047550           (W-FLAG-RIF-IFE-T = '0' AND                            00047550
047560            W-FLAG-RIF-IFE-A = '1')) AND                          00047560
047570           W-TOT-IMP-CRED-CONTR-IFE GREATER W-IMP-CRED-MAX1       00047570
047580                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00047580
047590                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00047590
047600                 ADD 1 TO W-CTR-BLOC                              00047600
047610        END-IF                                                    00047610
047620        IF W-FLAG-RIF-IFE-T = '1' AND                             00047620
047630           W-FLAG-RIF-IFE-A = '1' AND                             00047630
047640           W-TOT-IMP-CRED-CONTR-IFE GREATER W-IMP-CRED-MAX2       00047640
047650                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00047650
047660                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00047660
047670                ADD 1 TO W-CTR-BLOC                               00047670
047680        END-IF                                                    00047680
047690     END-IF.                                                      00047690
047700*---                                                              00047700
047710*---                                                              00047710
047720*--- FF1                                                          00047720
047730     MOVE ZERO TO W-IMP-CRED-MAX1.                                00047730
047740     MOVE ZERO TO W-IMP-CRED-MAX2.                                00047740
047750     IF W-FLAG-COMP-FF1 = '1'                                     00047750
047760        PERFORM F14-010 THRU F14-EXIT.                            00047760
047770     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00047770
047780        IF ((W-FLAG-RIF-FF1-T = '1' AND                           00047780
047790             W-FLAG-RIF-FF1-A = '0') OR                           00047790
047800           (W-FLAG-RIF-FF1-T = '0' AND                            00047800
047810            W-FLAG-RIF-FF1-A = '1')) AND                          00047810
047820           W-TOT-IMP-CRED-CONTR-FF1 GREATER W-IMP-CRED-MAX1       00047820
047830                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00047830
047840                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00047840
047850                 ADD 1 TO W-CTR-BLOC                              00047850
047860        END-IF                                                    00047860
047870        IF W-FLAG-RIF-FF1-T = '1' AND                             00047870
047880           W-FLAG-RIF-FF1-A = '1' AND                             00047880
047890           W-TOT-IMP-CRED-CONTR-FF1 GREATER W-IMP-CRED-MAX2       00047890
047900                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00047900
047910                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00047910
047920                ADD 1 TO W-CTR-BLOC                               00047920
047930        END-IF                                                    00047930
047940     END-IF.                                                      00047940
047950*---                                                              00047950
047960*--- FF2                                                          00047960
047970     MOVE ZERO TO W-IMP-CRED-MAX1.                                00047970
047980     MOVE ZERO TO W-IMP-CRED-MAX2.                                00047980
047990     IF W-FLAG-COMP-FF2 = '1'                                     00047990
048000        PERFORM F15-010 THRU F15-EXIT.                            00048000
048010     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00048010
048020        IF ((W-FLAG-RIF-FF2-T = '1' AND                           00048020
048030             W-FLAG-RIF-FF2-A = '0') OR                           00048030
048040           (W-FLAG-RIF-FF2-T ='0' AND                             00048040
048050            W-FLAG-RIF-FF2-A = '1')) AND                          00048050
048060           W-TOT-IMP-CRED-CONTR-FF2 GREATER W-IMP-CRED-MAX1       00048060
048070                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00048070
048080                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00048080
048090                 ADD 1 TO W-CTR-BLOC                              00048090
048100        END-IF                                                    00048100
048110        IF W-FLAG-RIF-FF2-T = '1' AND                             00048110
048120           W-FLAG-RIF-FF2-A = '1' AND                             00048120
048130           W-TOT-IMP-CRED-CONTR-FF2 GREATER W-IMP-CRED-MAX2       00048130
048140                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00048140
048150                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00048150
048160                ADD 1 TO W-CTR-BLOC                               00048160
048170        END-IF                                                    00048170
048180     END-IF.                                                      00048180
048190*---                                                              00048190
048200*--- FF3                                                          00048200
048210     MOVE ZERO TO W-IMP-CRED-MAX1.                                00048210
048220     MOVE ZERO TO W-IMP-CRED-MAX2.                                00048220
048230     IF W-FLAG-COMP-FF3 = '1'                                     00048230
048240        PERFORM F16-010 THRU F16-EXIT.                            00048240
048250     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00048250
048260        IF ((W-FLAG-RIF-FF3-T = '1' AND                           00048260
048270             W-FLAG-RIF-FF3-A = '0') OR                           00048270
048280           (W-FLAG-RIF-FF3-T = '0' AND                            00048280
048290            W-FLAG-RIF-FF3-A = '1')) AND                          00048290
048300           W-TOT-IMP-CRED-CONTR-FF3 GREATER W-IMP-CRED-MAX1       00048300
048310                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00048310
048320                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00048320
048330                 ADD 1 TO W-CTR-BLOC                              00048330
048340        END-IF                                                    00048340
048350        IF W-FLAG-RIF-FF3-T = '1' AND                             00048350
048360           W-FLAG-RIF-FF3-A = '1' AND                             00048360
048370           W-TOT-IMP-CRED-CONTR-FF3 GREATER W-IMP-CRED-MAX2       00048370
048380                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00048380
048390                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00048390
048400                ADD 1 TO W-CTR-BLOC                               00048400
048410        END-IF                                                    00048410
048420     END-IF.                                                      00048420
048430*---                                                              00048430
048440*--- ORO                                                          00048440
048450     MOVE ZERO TO W-IMP-CRED-MAX1.                                00048450
048460     MOVE ZERO TO W-IMP-CRED-MAX2.                                00048460
048470     IF W-FLAG-COMP-ORO = '1'                                     00048470
048480        PERFORM F17-010 THRU F17-EXIT.                            00048480
048490     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00048490
048500        IF ((W-FLAG-RIF-ORO-T = '1' AND                           00048500
048510             W-FLAG-RIF-ORO-A = '0') OR                           00048510
048520           (W-FLAG-RIF-ORO-T = '0' AND                            00048520
048530            W-FLAG-RIF-ORO-A = '1')) AND                          00048530
048540           W-TOT-IMP-CRED-CONTR-ORO GREATER W-IMP-CRED-MAX1       00048540
048550                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00048550
048560                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00048560
048570                 ADD 1 TO W-CTR-BLOC                              00048570
048580        END-IF                                                    00048580
048590        IF W-FLAG-RIF-ORO-T = '1' AND                             00048590
048600           W-FLAG-RIF-ORO-A = '1' AND                             00048600
048610           W-TOT-IMP-CRED-CONTR-ORO GREATER W-IMP-CRED-MAX2       00048610
048620                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00048620
048630                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00048630
048640                ADD 1 TO W-CTR-BLOC                               00048640
048650        END-IF                                                    00048650
048660     END-IF.                                                      00048660
048670*---                                                              00048670
048680*--- SEC                                                          00048680
048690     MOVE ZERO TO W-IMP-CRED-MAX1.                                00048690
048700     MOVE ZERO TO W-IMP-CRED-MAX2.                                00048700
048710     IF W-FLAG-COMP-SEC = '1'                                     00048710
048720        PERFORM F18-010 THRU F18-EXIT.                            00048720
048730     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00048730
048740        IF ((W-FLAG-RIF-SEC-T = '1' AND                           00048740
048750             W-FLAG-RIF-SEC-A = '0') OR                           00048750
048760           (W-FLAG-RIF-SEC-T = '0' AND                            00048760
048770            W-FLAG-RIF-SEC-A = '1')) AND                          00048770
048780           W-TOT-IMP-CRED-CONTR-SEC GREATER W-IMP-CRED-MAX1       00048780
048790                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00048790
048800                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00048800
048810                 ADD 1 TO W-CTR-BLOC                              00048810
048820        END-IF                                                    00048820
048830        IF W-FLAG-RIF-SEC-T = '1' AND                             00048830
048840           W-FLAG-RIF-SEC-A = '1' AND                             00048840
048850           W-TOT-IMP-CRED-CONTR-SEC GREATER W-IMP-CRED-MAX2       00048850
048860                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00048860
048870                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00048870
048880                ADD 1 TO W-CTR-BLOC                               00048880
048890        END-IF                                                    00048890
048900     END-IF.                                                      00048900
048910*---                                                              00048910
048920*--- IEC                                                          00048920
048930     MOVE ZERO TO W-IMP-CRED-MAX1.                                00048930
048940     MOVE ZERO TO W-IMP-CRED-MAX2.                                00048940
048950     IF W-FLAG-COMP-IEC = '1'                                     00048950
048960        PERFORM F19-010 THRU F19-EXIT.                            00048960
048970     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00048970
048980        IF ((W-FLAG-RIF-IEC-T = '1' AND                           00048980
048990             W-FLAG-RIF-IEC-A = '0') OR                           00048990
049000           (W-FLAG-RIF-IEC-T = '0' AND                            00049000
049010            W-FLAG-RIF-IEC-A = '1')) AND                          00049010
049020           W-TOT-IMP-CRED-CONTR-IEC GREATER W-IMP-CRED-MAX1       00049020
049030                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00049030
049040                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00049040
049050                 ADD 1 TO W-CTR-BLOC                              00049050
049060        END-IF                                                    00049060
049070        IF W-FLAG-RIF-IEC-T = '1' AND                             00049070
049080           W-FLAG-RIF-IEC-A = '1' AND                             00049080
049090           W-TOT-IMP-CRED-CONTR-IEC GREATER W-IMP-CRED-MAX2       00049090
049100                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00049100
049110                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00049110
049120                ADD 1 TO W-CTR-BLOC                               00049120
049130        END-IF                                                    00049130
049140     END-IF.                                                      00049140
049150*---                                                              00049150
049160*---                                                              00049160
049170*--- LEZ                                                          00049170
049180     MOVE ZERO TO W-IMP-CRED-MAX1.                                00049180
049190     MOVE ZERO TO W-IMP-CRED-MAX2.                                00049190
049200     IF W-FLAG-COMP-LEZ = '1'                                     00049200
049210        PERFORM F20-010 THRU F20-EXIT.                            00049210
049220     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00049220
049230        IF ((W-FLAG-RIF-LEZ-T = '1' AND                           00049230
049240             W-FLAG-RIF-LEZ-A = '0') OR                           00049240
049250           (W-FLAG-RIF-LEZ-T = '0' AND                            00049250
049260            W-FLAG-RIF-LEZ-A = '1')) AND                          00049260
049270           W-TOT-IMP-CRED-CONTR-LEZ GREATER W-IMP-CRED-MAX1       00049270
049280                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00049280
049290                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00049290
049300                 ADD 1 TO W-CTR-BLOC                              00049300
049310        END-IF                                                    00049310
049320        IF W-FLAG-RIF-LEZ-T = '1' AND                             00049320
049330           W-FLAG-RIF-LEZ-A = '1' AND                             00049330
049340           W-TOT-IMP-CRED-CONTR-LEZ GREATER W-IMP-CRED-MAX2       00049340
049350                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00049350
049360                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00049360
049370                ADD 1 TO W-CTR-BLOC                               00049370
049380        END-IF                                                    00049380
049390     END-IF.                                                      00049390
049420*---                                                              00049420
049430*--- QR1                                                          00049430
049440     MOVE ZERO TO W-IMP-CRED-MAX1.                                00049440
049450     MOVE ZERO TO W-IMP-CRED-MAX2.                                00049450
049460     IF W-FLAG-COMP-QR1 = '1'                                     00049460
049470        PERFORM F21-010 THRU F21-EXIT.                            00049470
049480     IF BQVFB21-36-ERR-SALDO-REG-A  NOT EQUAL 'E'                 00049480
049490        IF ((W-FLAG-RIF-QR1-T = '1' AND                           00049490
049500             W-FLAG-RIF-QR1-A = '0') OR                           00049500
049510           (W-FLAG-RIF-QR1-T = '0' AND                            00049510
049520            W-FLAG-RIF-QR1-A = '1')) AND                          00049520
049530           W-TOT-IMP-CRED-CONTR-QR1 GREATER W-IMP-CRED-MAX1       00049530
049540                 MOVE  96 TO BQVFB21-36-ERR-SALDO-REG             00049540
049550                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-REG-A           00049550
049560                 ADD 1 TO W-CTR-BLOC                              00049560
049570        END-IF                                                    00049570
049580        IF W-FLAG-RIF-QR1-T = '1' AND                             00049580
049590           W-FLAG-RIF-QR1-A = '1' AND                             00049590
049600           W-TOT-IMP-CRED-CONTR-QR1 GREATER W-IMP-CRED-MAX2       00049600
049610                 MOVE  96 TO BQVFB21-36-ERR-SALDO-REG             00049610
049620                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-REG-A           00049620
049630                ADD 1 TO W-CTR-BLOC                               00049630
049640        END-IF                                                    00049640
049650     END-IF.                                                      00049650
049651*---                                                              00049651
049652 F1-369.                                                          00049652
049653*---                                                              00049653
049654*--- BTC                                                          00049654
049655*---                                                              00049655
049656     MOVE ZERO TO W-IMP-CRED-MAX1.                                00049656
049657     MOVE ZERO TO W-IMP-CRED-MAX2.                                00049657
049658     IF W-FLAG-COMP-BTC = '1'                                     00049658
049659        PERFORM F22-010 THRU F22-EXIT.                            00049659
049660     IF BQVFB21-36-ERR-SALDO-ERARIO-A  NOT EQUAL 'E'              00049660
049661        IF ((W-FLAG-RIF-BTC-T = '1' AND                           00049661
049662             W-FLAG-RIF-BTC-A = '0') OR                           00049662
049663           (W-FLAG-RIF-BTC-T = '0' AND                            00049663
049664            W-FLAG-RIF-BTC-A = '1')) AND                          00049664
049665           W-TOT-IMP-CRED-CONTR-BTC GREATER W-IMP-CRED-MAX1       00049665
049666                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00049666
049667                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00049667
049668                 ADD 1 TO W-CTR-BLOC                              00049668
049669        END-IF                                                    00049669
049670        IF W-FLAG-RIF-BTC-T = '1' AND                             00049670
049671           W-FLAG-RIF-BTC-A = '1' AND                             00049671
049672           W-TOT-IMP-CRED-CONTR-BTC GREATER W-IMP-CRED-MAX2       00049672
049673                 MOVE  96 TO BQVFB21-36-ERR-SALDO-ERARIO          00049673
049674                 MOVE 'E' TO BQVFB21-36-ERR-SALDO-ERARIO-A        00049674
049675                ADD 1 TO W-CTR-BLOC                               00049675
049676        END-IF                                                    00049676
049677     END-IF.                                                      00049677
049678*---                                                              00049678
049679*---                                                              00049679
049680     MOVE ZERO TO W-FLAG-RIF-V-T.                                 00049680
049681     MOVE ZERO TO W-FLAG-RIF-V-A.                                 00049681
049690     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-V.                         00049690
049700     MOVE ZERO TO W-FLAG-RIF-I-T.                                 00049700
049710     MOVE ZERO TO W-FLAG-RIF-I-A.                                 00049710
049720     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-I.                         00049720
049730     MOVE ZERO TO W-FLAG-RIF-R-T.                                 00049730
049740     MOVE ZERO TO W-FLAG-RIF-R-A.                                 00049740
049750     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-R.                         00049750
049760     MOVE ZERO TO W-FLAG-RIF-M-T.                                 00049760
049770     MOVE ZERO TO W-FLAG-RIF-M-A.                                 00049770
049780     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-M.                         00049780
049790     MOVE ZERO TO W-FLAG-RIF-E-T.                                 00049790
049800     MOVE ZERO TO W-FLAG-RIF-E-A.                                 00049800
049810     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-E.                         00049810
049820     MOVE ZERO TO W-FLAG-RIF-IRF-T.                               00049820
049830     MOVE ZERO TO W-FLAG-RIF-IRF-A.                               00049830
049840     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-IRF.                       00049840
049850     MOVE ZERO TO W-FLAG-RIF-ADX-T.                               00049850
049860     MOVE ZERO TO W-FLAG-RIF-ADX-A.                               00049860
049870     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-ADX.                       00049870
049880     MOVE ZERO TO W-FLAG-RIF-IIE-T.                               00049880
049890     MOVE ZERO TO W-FLAG-RIF-IIE-A.                               00049890
049900     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-IIE.                       00049900
049910     MOVE ZERO TO W-FLAG-RIF-IFE-T.                               00049910
049920     MOVE ZERO TO W-FLAG-RIF-IFE-A.                               00049920
049930     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-IFE.                       00049930
049940     MOVE ZERO TO W-FLAG-RIF-FF1-T.                               00049940
049950     MOVE ZERO TO W-FLAG-RIF-FF1-A.                               00049950
049960     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-FF1.                       00049960
049970     MOVE ZERO TO W-FLAG-RIF-FF2-T.                               00049970
049980     MOVE ZERO TO W-FLAG-RIF-FF2-A.                               00049980
049990     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-FF2.                       00049990
050000     MOVE ZERO TO W-FLAG-RIF-FF3-T.                               00050000
050010     MOVE ZERO TO W-FLAG-RIF-FF3-A.                               00050010
050020     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-FF3.                       00050020
050030     MOVE ZERO TO W-FLAG-RIF-ORO-T.                               00050030
050040     MOVE ZERO TO W-FLAG-RIF-ORO-A.                               00050040
050050     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-ORO.                       00050050
050060     MOVE ZERO TO W-FLAG-RIF-SEC-T.                               00050060
050070     MOVE ZERO TO W-FLAG-RIF-SEC-A.                               00050070
050080     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-SEC.                       00050080
050090     MOVE ZERO TO W-FLAG-RIF-IEC-T.                               00050090
050100     MOVE ZERO TO W-FLAG-RIF-IEC-A.                               00050100
050110     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-IEC.                       00050110
050120     MOVE ZERO TO W-FLAG-RIF-LEZ-T.                               00050120
050130     MOVE ZERO TO W-FLAG-RIF-LEZ-A.                               00050130
050140     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-LEZ.                       00050140
050150     MOVE ZERO TO W-FLAG-RIF-QR1-T.                               00050150
050160     MOVE ZERO TO W-FLAG-RIF-QR1-A.                               00050160
050170     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-QR1.                       00050170
050171     MOVE ZERO TO W-FLAG-RIF-BTC-T.                               00050171
050172     MOVE ZERO TO W-FLAG-RIF-BTC-A.                               00050172
050173     MOVE ZERO TO W-TOT-IMP-CRED-CONTR-BTC.                       00050173
050180     MOVE ZERO TO W-FLAG-RIF-C.                                   00050180
050190     MOVE ZERO TO W-FLAG-RIF-T-AA-MIN.                            00050190
050200     MOVE ZERO TO W-FLAG-RIF-A-AA-MIN.                            00050200
050210     MOVE ZERO TO W-FLAG-RIF-C.                                   00050210
050220     MOVE ZERO TO W-FLAG-RIF-T-AA-MIN.                            00050220
050230     MOVE ZERO TO W-FLAG-RIF-A-AA-MIN.                            00050230
050240*---                                                              00050240
050250*--- SI SCARICA LA TABELLA DEI TOTALI NELLA TABELLA PER PROV.     00050250
050260     MOVE 0 TO W-APPO-FLAG-NO-FISCO.                              00050260
050270     COMPUTE W-APPO-SALDO-FISCO = W-TOT-PAGAM(1) - W-TOT-RIMB(1). 00050270
050280*---                                                              00050280
050290*--- MODIFICHE MAGGIO 2001                                        00050290
050300*---                                                              00050300
050310     MOVE W-APPO-SALDO-FISCO TO W-APPO-SALDO-FISCO-COMM.          00050310
050320*---                                                              00050320
050330*--- SI CALCOLA LA COMMISSIONE PER DELEGA                         00050330
050340     PERFORM F2-010-CALC-COMM THRU F2-010-CALC-COMM-EX.           00050340
050350*---                                                              00050350
050360*--- INTERNET                                                     00050360
050370*---                                                              00050370
050380*--- SE LA DELEGA E' STATA INVIATA VIA INTERNET E L'ESITO DEL     00050380
050390*--- PAGAMENTO E' NEGATIVO (ESITO-PAGAM <> ZERO), NON SI TOTALIZZA00050390
050400*--- L'IMPORTO A LIVELLO DI PROVINCIA                             00050400
050410*---                                                              00050410
050420     IF BQVFB21-36-MOD-CONFER      = '3'        AND               00050420
050430        BQVFB21-36-ESITO-PAGAM NOT = ZERO                         00050430
050440               MOVE ZERO TO W-APPO-SALDO-FISCO.                   00050440
050450*---                                                              00050450
050460*--- SI IMPOSTA IL FLAG PER SEGNALARE CHE NON CI SONO STATI       00050460
050470*--- RECORD RELATI ALLA PARTE FISCO (V01)                         00050470
050480     IF W-TOT-PAGAM(1) = ZERO AND                                 00050480
050490        W-TOT-RIMB(1)  = ZERO                                     00050490
050500        MOVE 1 TO W-APPO-FLAG-NO-FISCO.                           00050500
050510     COMPUTE W-APPO-SALDO-INPS   = W-TOT-PAGAM(2) - W-TOT-RIMB(2).00050510
050520     COMPUTE W-APPO-SALDO-REG    = W-TOT-PAGAM(3) - W-TOT-RIMB(3).00050520
050530     COMPUTE W-APPO-SALDO-ENTEL  = W-TOT-PAGAM(4) - W-TOT-RIMB(4).00050530
050540     COMPUTE W-APPO-SALDO-INAIL  = W-TOT-PAGAM(5) - W-TOT-RIMB(5).00050540
050550     COMPUTE W-APPO-SALDO-ALTRI  = W-TOT-PAGAM(6) - W-TOT-RIMB(6).00050550
050560     COMPUTE W-APPO-SALDO-ACCISE = W-TOT-PAGAM(7) - W-TOT-RIMB(7).00050560
050570     COMPUTE W-APPO-TOT-RIMB   = W-TOT-RIMB(1) + W-TOT-RIMB(2) +  00050570
050580                                 W-TOT-RIMB(3) + W-TOT-RIMB(4) +  00050580
050590                                 W-TOT-RIMB(5) + W-TOT-RIMB(6) +  00050590
050600                                 W-TOT-RIMB(7).                   00050600
050610*---                                                              00050610
050620     MOVE 0 TO W-FLAG-TROVATO.                                    00050620
050630     SET S TO 1.                                                  00050630
050640     SEARCH W-EL-SALDI                                            00050640
050650     WHEN W-PROV(S) = W-APPO-SIGLA-PROV                           00050650
050660          MOVE 1 TO W-FLAG-TROVATO.                               00050660
050670     IF W-FLAG-TROVATO = 1                                        00050670
050680        GO TO F1-380.                                             00050680
050690                                                                  00050690
050700 F1-370.                                                          00050700
050710     ADD 1 TO W-S.                                                00050710
050720     MOVE W-APPO-SIGLA-PROV    TO W-PROV(W-S).                    00050720
050730     MOVE W-APPO-SALDO-FISCO   TO W-SALDO-FISCO(W-S).             00050730
050740     MOVE W-APPO-SALDO-INPS    TO W-SALDO-INPS(W-S).              00050740
050750     MOVE W-APPO-SALDO-REG     TO W-SALDO-REG(W-S).               00050750
050760     MOVE W-APPO-SALDO-ENTEL   TO W-SALDO-ENTEL(W-S).             00050760
050770     MOVE W-APPO-SALDO-INAIL   TO W-SALDO-INAIL(W-S).             00050770
050780     MOVE W-APPO-SALDO-ALTRI   TO W-SALDO-ALTRI(W-S).             00050780
050790     MOVE W-APPO-SALDO-ACCISE  TO W-SALDO-ACCISE(W-S).            00050790
050800     MOVE W-APPO-FLAG-NO-FISCO TO W-FLAG-NO-FISCO(W-S).           00050800
050810     MOVE ZERO                 TO W-FLAG-CONTR(W-S).              00050810
050820     IF W-APPO-FLAG-NO-FISCO = 1                                  00050820
050830        ADD 1                  TO W-NUM-DELEGHE-I-R(W-S).         00050830
050840     IF W-APPO-FLAG-NO-FISCO = 0                                  00050840
050850        ADD 1                  TO W-NUM-DELEGHE-F(W-S).           00050850
050860     GO TO F1-990-CONTR-36-EX.                                    00050860
050870                                                                  00050870
050880 F1-380.                                                          00050880
050890     ADD W-APPO-SALDO-FISCO  TO W-SALDO-FISCO(S).                 00050890
050900     ADD W-APPO-SALDO-INPS   TO W-SALDO-INPS(S).                  00050900
050910     ADD W-APPO-SALDO-REG    TO W-SALDO-REG(S).                   00050910
050920     ADD W-APPO-SALDO-ENTEL  TO W-SALDO-ENTEL(S).                 00050920
050930     ADD W-APPO-SALDO-INAIL  TO W-SALDO-INAIL(S).                 00050930
050940     ADD W-APPO-SALDO-ALTRI  TO W-SALDO-ALTRI(S).                 00050940
050950     ADD W-APPO-SALDO-ACCISE TO W-SALDO-ACCISE(S).                00050950
050960     MOVE ZERO               TO W-FLAG-CONTR(S).                  00050960
050970     IF W-APPO-FLAG-NO-FISCO = 1                                  00050970
050980        ADD 1                TO W-NUM-DELEGHE-I-R(S).             00050980
050990     IF W-APPO-FLAG-NO-FISCO = 0                                  00050990
051000        ADD 1                TO W-NUM-DELEGHE-F(S).               00051000
051010*--- PER PROVINCIA GIA' TRATTATA SE NON C'ERANO STATI             00051010
051020*--- RECORD PER IL FISCO IN PRECEDENZA IL FLAG SI IMPOSTA         00051020
051030*--- CON IL VALORE APPENA IMPOSTATO                               00051030
051040     IF W-FLAG-NO-FISCO(S) = 1                                    00051040
051050        MOVE W-APPO-FLAG-NO-FISCO TO W-FLAG-NO-FISCO(S).          00051050
051060                                                                  00051060
051070 F1-990-CONTR-36-EX.                                              00051070
051080     EXIT.                                                        00051080
051090                                                                  00051090
051100*---                                                              00051100
051110*--- PERFORM G1-010-CONTR-37 - CONTROLLI SUL RECORD 37            00051110
051120*---                                                              00051120
051130 G1-010-CONTR-37.                                                 00051130
051140     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00051140
051150     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00051150
051160     MOVE ZERO TO BQVFB21-ERR-RECORD-37.                          00051160
051170     ADD 1 TO W-CTR-37.                                           00051170
051180     MOVE 1 TO W-FLAG-NUOVA-DELEGA.                               00051180
051190     MOVE 1 TO W-FLAG-37.                                         00051190
051200     MOVE 1 TO W-PRES-ACCR.                                       00051200
051210*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00051210
051220*--- COMUNI TRA PIU' RECORD                                       00051220
051230     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00051230
051240                                                                  00051240
051250 G1-020.                                                          00051250
051260*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00051260
051270*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00051270
051280     IF BQVFB11-37-DIV-OPER NOT = W-APPO-DIV-OPER AND             00051280
051290        W-APPO-ERR-DIV-OPER NOT = ZERO                            00051290
051300        GO TO G1-060.                                             00051300
051310                                                                  00051310
051320 G1-030.                                                          00051320
051330*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00051330
051340     IF BQVFB11-37-DIV-OPER NOT = W-APPO-DIV-OPER AND             00051340
051350        W-APPO-ERR-DIV-OPER = ZERO                                00051350
051360        GO TO G1-050.                                             00051360
051370                                                                  00051370
051380 G1-040.                                                          00051380
051390*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00051390
051400     MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-37-ERR-DIV-OPER.         00051400
051410     IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00051410
051420        MOVE 'E' TO BQVFB21-37-ERR-DIV-OPER-A                     00051420
051430        ADD 1 TO W-CTR-BLOC.                                      00051430
051440     GO TO G1-080.                                                00051440
051450                                                                  00051450
051460 G1-050.                                                          00051460
051470*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00051470
051480     MOVE 502 TO BQVFB21-37-ERR-DIV-OPER.                         00051480
051490     MOVE 'E' TO BQVFB21-37-ERR-DIV-OPER-A.                       00051490
051500     ADD 1 TO W-CTR-BLOC.                                         00051500
051510     GO TO G1-080.                                                00051510
051520                                                                  00051520
051530 G1-060.                                                          00051530
051540*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00051540
051550* INIZIO MODIFICA EURO                                            00051550
051560     IF BQVFB11-37-DIV-OPER = 'ITL'                               00051560
051570     OR BQVFB11-37-DIV-OPER = 'EUR'                               00051570
051580* FINE MODIFICA EURO                                              00051580
051590        GO TO G1-080.                                             00051590
051600                                                                  00051600
051610 G1-070.                                                          00051610
051620*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00051620
051630     MOVE 55 TO BQVFB21-37-ERR-DIV-OPER.                          00051630
051640     MOVE 'E' TO BQVFB21-37-ERR-DIV-OPER-A.                       00051640
051650     ADD 1 TO W-CTR-BLOC.                                         00051650
051660                                                                  00051660
051670 G1-080.                                                          00051670
051680*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00051680
051690*--- SUL RECORD 37                                                00051690
051700     MOVE SPACE TO W-DIV.                                         00051700
051710     IF W-APPO-ERR-DIV-OPER = ZERO                                00051710
051720        MOVE W-APPO-DIV-OPER TO W-DIV.                            00051720
051730     IF W-FLAG-ERR-SEQ = 1                                        00051730
051740        MOVE 1 TO W-FLAG-NO-QUAD.                                 00051740
051750     MOVE SPACE TO W-TIPO-CHIAMATA.                               00051750
051760*F   CALL 'BQVFB7' USING                                          00051760
051770*F                         W-FLAG-BANCA                           00051770
051780*F                         W-TIPO-CHIAMATA                        00051780
051790*F                         BQVFB21                                00051790
051800*F                         W-TAB-SALDI                            00051800
051810*F                         W-DIV                                  00051810
051820*F                         W-CTR-NO-BLOC                          00051820
051830*F                         W-CTR-BLOC                             00051830
051840*F                         W-FLAG-NO-QUAD                         00051840
051850*F                         W-NUM-SQUADR                           00051850
051860*F                         W-DATI-SQUADR.                         00051860
051870                                                                  00051870
051880 G1-090.                                                          00051880
051890*--- SI MEMORIZZA L'ESITO IMPOSTATO PER SCRIVERLO AL CAMBIO DI    00051890
051900*--- PROVINCIA DOPO LE QUADRATURE                                 00051900
051910     ADD 1 TO W-IND.                                              00051910
051920     ADD 1 TO W-IND-MAX.                                          00051920
051930     MOVE BQVFB21 TO W-MEM-BQVFB21(W-IND).                        00051930
051940 G1-990-CONTR-37-EX.                                              00051940
051950     EXIT.                                                        00051950
051960                                                                  00051960
051970*---                                                              00051970
051980*--- PERFORM H1-010-CONTR-38 - CONTROLLI SUL RECORD 38            00051980
051990*---                                                              00051990
052000 H1-010-CONTR-38.                                                 00052000
052010     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00052010
052020     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00052020
052030     ADD 1 TO W-CTR-38.                                           00052030
052040     MOVE ZERO TO BQVFB21-ERR-RECORD-38.                          00052040
052050     MOVE 1 TO W-FLAG-NUOVA-DELEGA.                               00052050
052060*--- SI IMPOSTA LA PRIMA VOLTA AD 1 IL PROGRESSIVO ACCR/BON       00052060
052070*--- PER POI INCREMENTARLO DI 1 PER OGNI ALTRO RECORD V38         00052070
052080     IF W-PROG-ACCR-BON NOT < 1 AND                               00052080
052090        W-FLAG-37           = 0                                   00052090
052100        GO TO H1-014.                                             00052100
052110                                                                  00052110
052120 H1-012.                                                          00052120
052130     MOVE 1 TO W-PROG-ACCR-BON.                                   00052130
052140     MOVE 0 TO W-FLAG-37.                                         00052140
052150     GO TO H1-016.                                                00052150
052160                                                                  00052160
052170 H1-014.                                                          00052170
052180     ADD 1 TO W-PROG-ACCR-BON.                                    00052180
052190                                                                  00052190
052200 H1-016.                                                          00052200
052210*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00052210
052220*--- COMUNI TRA PIU' RECORD                                       00052220
052230     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00052230
052240                                                                  00052240
052250 H1-020.                                                          00052250
052260*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00052260
052270*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00052270
052280     IF BQVFB11-38-DIV-OPER NOT = W-APPO-DIV-OPER AND             00052280
052290        W-APPO-ERR-DIV-OPER NOT = ZERO                            00052290
052300        GO TO H1-060.                                             00052300
052310                                                                  00052310
052320 H1-030.                                                          00052320
052330*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00052330
052340     IF BQVFB11-38-DIV-OPER NOT = W-APPO-DIV-OPER AND             00052340
052350        W-APPO-ERR-DIV-OPER = ZERO                                00052350
052360        GO TO H1-050.                                             00052360
052370                                                                  00052370
052380 H1-040.                                                          00052380
052390*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00052390
052400     MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-38-ERR-DIV-OPER.         00052400
052410     IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00052410
052420        MOVE 'E' TO BQVFB21-38-ERR-DIV-OPER-A                     00052420
052430        ADD 1 TO W-CTR-BLOC.                                      00052430
052440     GO TO H1-080.                                                00052440
052450                                                                  00052450
052460 H1-050.                                                          00052460
052470*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00052470
052480     MOVE 502 TO BQVFB21-38-ERR-DIV-OPER.                         00052480
052490     MOVE 'E' TO BQVFB21-38-ERR-DIV-OPER-A.                       00052490
052500     ADD 1 TO W-CTR-BLOC.                                         00052500
052510     GO TO H1-080.                                                00052510
052520                                                                  00052520
052530 H1-060.                                                          00052530
052540*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00052540
052550* INIZIO MODIFICA EURO                                            00052550
052560     IF BQVFB11-38-DIV-OPER = 'ITL'                               00052560
052570     OR BQVFB11-38-DIV-OPER = 'EUR'                               00052570
052580* FINE MODIFICA EURO                                              00052580
052590        GO TO H1-080.                                             00052590
052600                                                                  00052600
052610 H1-070.                                                          00052610
052620*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00052620
052630     MOVE 55 TO BQVFB21-38-ERR-DIV-OPER.                          00052630
052640     MOVE 'E' TO BQVFB21-38-ERR-DIV-OPER-A.                       00052640
052650     ADD 1 TO W-CTR-BLOC.                                         00052650
052660                                                                  00052660
052670 H1-080.                                                          00052670
052680*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00052680
052690*--- SUL RECORD 38                                                00052690
052700     MOVE SPACE TO W-DIV.                                         00052700
052710     IF W-APPO-ERR-DIV-OPER = ZERO                                00052710
052720        MOVE W-APPO-DIV-OPER TO W-DIV.                            00052720
052730     IF W-FLAG-ERR-SEQ = 1                                        00052730
052740        MOVE 1 TO W-FLAG-NO-QUAD.                                 00052740
052750     MOVE SPACE TO W-TIPO-CHIAMATA.                               00052750
052760*F MODIFICA 13/03/2006 - IC: AGGIUNTA TABELLA W-TAB-IC            00052760
052770     CALL 'BQVFB8' USING W-TIPO-CHIAMATA                          00052770
052780                           BQVFB21                                00052780
052790                           W-TAB-MEM-BQVFB21                      00052790
052800                           W-TAB-SALDI                            00052800
052810                           W-DIV                                  00052810
052820                           W-CTR-NO-BLOC                          00052820
052830                           W-CTR-BLOC                             00052830
052840                           W-ALTRI-PARAM                          00052840
052850                           W-TAB-AZIENDE                          00052850
052860                           W-FLAG-BANCA                           00052860
052870                           W-SALDO-AGEV                           00052870
052880*--- ANTICIPO                                                     00052880
052890                           W-VERS                                 00052890
052900                           W-DATA-ANTIC                           00052900
052910                           W-ANTIC-CALC                           00052910
052920                           W-TAB-IC                               00052920
052930                           W-ANTIC-I24-CALC.                      00052930
052940                                                                  00052940
052950 H1-090.                                                          00052950
052960*---                                                              00052960
052970*--- SI CONTROLLA LA PRESENZA IN TABELLA SALDI DI PROVINCE        00052970
052980*--- CON ACCREDITAMENTI PER LE QUALI NON C'E' STATO UN            00052980
052990*--- CONTROLLO TRAMITE RECORD 37. TALE CONTROLLO VIENE EF-        00052990
053000*--- FETTUATO SOLO PER IL PRIMO RECORD V38 DELLA BANCA/CONC.      00053000
053010*---                                                              00053010
053020     IF W-CTR-38   EQUAL 1                                        00053020
053030       PERFORM H2-010-CONTR-FISCO THRU H2-990-CONTR-FISCO-EX.     00053030
053040*--- SI MEMORIZZA L'ESITO IMPOSTATO PER SCRIVERLO AL CAMBIO DI    00053040
053050*--- PROVINCIA DOPO LE QUADRATURE                                 00053050
053060     ADD 1 TO W-IND.                                              00053060
053070     ADD 1 TO W-IND-MAX.                                          00053070
053080     MOVE BQVFB21 TO W-MEM-BQVFB21(W-IND).                        00053080
053090 H1-990-CONTR-38-EX.                                              00053090
053100     EXIT.                                                        00053100
053110                                                                  00053110
053120*---                                                              00053120
053130*--- PERFORM I1-010-CONTR-49 - CONTROLLI SUL RECORD 49            00053130
053140*---                                                              00053140
053150 I1-010-CONTR-49.                                                 00053150
053160     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00053160
053170     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00053170
053180     ADD 1 TO W-CTR-49.                                           00053180
053190     MOVE ZERO TO BQVFB21-ERR-RECORD-49.                          00053190
053200     MOVE 1 TO W-FLAG-NUOVA-DELEGA.                               00053200
053210*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00053210
053220*--- COMUNI TRA PIU' RECORD                                       00053220
053230     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00053230
053240                                                                  00053240
053250 I1-020.                                                          00053250
053260*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00053260
053270*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00053270
053280* INIZIO MODIFICA EURO                                            00053280
053290     IF (BQVFB11-49-DIV-OPER NOT = W-APPO-DIV-OPER AND            00053290
053300         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00053300
053310     OR BQVFB11-49-DIV-OPER = W-APPO-DIV-OPER                     00053310
053320        GO TO I1-060.                                             00053320
053330                                                                  00053330
053340 I1-030.                                                          00053340
053350*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE DIVISA                 00053350
053360**** IF BQVFB11-49-DIV-OPER NOT = W-APPO-DIV-OPER AND             00053360
053370******* W-APPO-ERR-DIV-OPER = ZERO                                00053370
053380******* GO TO I1-050.                                             00053380
053390****                                                              00053390
053400*I1-040.                                                          00053400
053410*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00053410
053420**** MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-49-ERR-DIV-OPER.         00053420
053430**** IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00053430
053440******* MOVE 'E' TO BQVFB21-49-ERR-DIV-OPER-A                     00053440
053450******* ADD 1 TO W-CTR-BLOC.                                      00053450
053460**** GO TO I1-080.                                                00053460
053470****                                                              00053470
053480*I1-050.                                                          00053480
053490*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00053490
053500* SI ACCETTANO V49 CON DIVISA DIVERSA DAL RECORD DI TESTA         00053500
053510* SOLO SE SI RIFERISCONO A DELEGHE IN LIRE                        00053510
053520* RISCOSSE NEL PERIODO DI VALIDITA'                               00053520
053530     IF NOT (BQVFB11-49-DIV-OPER = 'ITL' AND                      00053530
053540             BQVFB11-49-DATA-RISC < BQVFCO1-DATA-EUR) THEN        00053540
053550         MOVE 502 TO BQVFB21-49-ERR-DIV-OPER                      00053550
053560         MOVE 'E' TO BQVFB21-49-ERR-DIV-OPER-A                    00053560
053570         ADD 1 TO W-CTR-BLOC                                      00053570
053580     END-IF.                                                      00053580
053590     GO TO I1-080.                                                00053590
053600* FINE MODIFICA EURO                                              00053600
053610                                                                  00053610
053620 I1-060.                                                          00053620
053630*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00053630
053640* INIZIO MODIFICA EURO                                            00053640
053650     IF  BQVFB11-49-DIV-OPER     = W-APPO-DIV-OPER                00053650
053660     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00053660
053670         MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-49-ERR-DIV-OPER      00053670
053680         MOVE 'E' TO BQVFB21-49-ERR-DIV-OPER-A                    00053680
053690         ADD 1 TO W-CTR-BLOC                                      00053690
053700         GO TO I1-080                                             00053700
053710     END-IF.                                                      00053710
053720*                                                                 00053720
053730 I1-065.                                                          00053730
053740*                                                                 00053740
053750*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00053750
053760     IF BQVFB11-49-DIV-OPER = 'EUR'                               00053760
053770     OR (    BQVFB11-49-DIV-OPER  = 'ITL'                         00053770
053780         AND BQVFB11-49-DATA-RISC < BQVFCO1-DATA-EUR  )           00053780
053790* FINE MODIFICA EURO                                              00053790
053800        GO TO I1-080.                                             00053800
053810                                                                  00053810
053820 I1-070.                                                          00053820
053830*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00053830
053840     MOVE 55 TO BQVFB21-49-ERR-DIV-OPER.                          00053840
053850     MOVE 'E' TO BQVFB21-49-ERR-DIV-OPER-A.                       00053850
053860     ADD 1 TO W-CTR-BLOC.                                         00053860
053870                                                                  00053870
053880 I1-080.                                                          00053880
053890*                                                                 00053890
053900*** MODIFICA PER V36/V49 CONTESTUALI                              00053900
053910*                                                                 00053910
053920     IF BQVFB11-49-CAUS-ANNULA = '7' THEN                         00053920
053930        ADD 1 TO W-CONT-V49                                       00053930
053940     END-IF.                                                      00053940
053950*                                                                 00053950
053960*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00053960
053970*--- SUL RECORD 49                                                00053970
053980     CALL 'BQVFB9' USING   W-FLAG-BANCA                           00053980
053990                           BQVFB21                                00053990
054000                           W-CTR-NO-BLOC                          00054000
054010                           W-CTR-BLOC                             00054010
054020                           W-TAB-AZIENDE                          00054020
054030                           W-TAB-REGIONI                          00054030
054040                           W-TAB-PROV.                            00054040
054050                                                                  00054050
054060 I1-990-CONTR-49-EX.                                              00054060
054070     EXIT.                                                        00054070
054080                                                                  00054080
054090*---                                                              00054090
054100*--- PERFORM L1-010-CONTR-99 - CONTROLLI SUL RECORD 99            00054100
054110*---                                                              00054110
054120 L1-010-CONTR-99.                                                 00054120
054130     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00054130
054140     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00054140
054150     ADD 1 TO W-CTR-99.                                           00054150
054160     MOVE ZERO TO BQVFB21-ERR-RECORD-99.                          00054160
054170     MOVE 1 TO W-FLAG-NUOVA-DELEGA.                               00054170
054180*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00054180
054190*--- COMUNI TRA PIU' RECORD                                       00054190
054200     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00054200
054210                                                                  00054210
054220 L1-020.                                                          00054220
054230*--- SI CONTROLLA IL PROGRESSIVO TRASMISSIONE CON IL RECORD DI TES00054230
054240     IF BQVFB11-99-PROG-TRASMA = W-APPO-PROG-TRASM                00054240
054250        GO TO L1-040.                                             00054250
054260                                                                  00054260
054270 L1-030.                                                          00054270
054280*--- ERRORE DI OMOGENEITA' DEL PROGRESSIVO TRASMISSIONE           00054280
054290     MOVE 502 TO BQVFB21-99-ERR-PROG-TRASM.                       00054290
054300     MOVE 'E' TO BQVFB21-99-ERR-PROG-TRASM-A.                     00054300
054310     ADD 1 TO W-CTR-BLOC.                                         00054310
054320                                                                  00054320
054330 L1-040.                                                          00054330
054340*--- SI CONTROLLA IL TIPO INVIO CON IL RECORD DI TESTA            00054340
054350     IF BQVFB11-99-TIPO-INVIO = W-APPO-TIPO-INVIO                 00054350
054360        GO TO L1-060.                                             00054360
054370                                                                  00054370
054380 L1-050.                                                          00054380
054390*--- ERRORE DI OMOGENEITA' DEL TIPO INVIO                         00054390
054400     MOVE 502 TO BQVFB21-99-ERR-TIPO-INVIO.                       00054400
054410     MOVE 'E' TO BQVFB21-99-ERR-TIPO-INVIO-A.                     00054410
054420     ADD 1 TO W-CTR-BLOC.                                         00054420
054430                                                                  00054430
054440 L1-060.                                                          00054440
054450*--- SI CONTROLLA IL PROGRESSIVO INVIO CON IL RECORD DI TESTA     00054450
054460     IF BQVFB11-99-PROG-INVIOA = W-APPO-PROG-INVIO                00054460
054470        GO TO L1-072.                                             00054470
054480                                                                  00054480
054490 L1-070.                                                          00054490
054500*--- ERRORE DI OMOGENEITA' DEL PROGRESSIVO INVIO                  00054500
054510     MOVE 502 TO BQVFB21-99-ERR-PROG-INVIO.                       00054510
054520     MOVE 'E' TO BQVFB21-99-ERR-PROG-INVIO-A.                     00054520
054530     ADD 1 TO W-CTR-BLOC.                                         00054530
054540     GO TO L1-080.                                                00054540
054550                                                                  00054550
054560 L1-072.                                                          00054560
054570     MOVE W-APPO-ERR-PROG-INVIO TO BQVFB21-99-ERR-PROG-INVIO.     00054570
054580     IF W-APPO-ERR-PROG-INVIO NOT = ZERO                          00054580
054590        MOVE 'W' TO BQVFB21-99-ERR-PROG-INVIO-A                   00054590
054600        ADD 1 TO W-CTR-NO-BLOC.                                   00054600
054610                                                                  00054610
054620 L1-080.                                                          00054620
054630*--- SI CONTROLLA L'IDENTIFICATIVO DEL FILE CON IL RECORD DI TESTA00054630
054640     IF BQVFB11-99-IDENT-FILE = W-APPO-IDENT-FILE                 00054640
054650        GO TO L1-092.                                             00054650
054660                                                                  00054660
054670 L1-090.                                                          00054670
054680*--- ERRORE DI OMOGENEITA' DELL'IDENTIFICATIVO DEL FILE           00054680
054690     MOVE 502 TO BQVFB21-99-ERR-IDENT-FILE.                       00054690
054700     MOVE 'E' TO BQVFB21-99-ERR-IDENT-FILE-A.                     00054700
054710     ADD 1 TO W-CTR-BLOC.                                         00054710
054720     GO TO L1-100.                                                00054720
054730                                                                  00054730
054740 L1-092.                                                          00054740
054750     MOVE W-APPO-ERR-IDENT-FILE TO BQVFB21-99-ERR-IDENT-FILE.     00054750
054760     IF W-APPO-ERR-IDENT-FILE NOT = ZERO                          00054760
054770        MOVE 'E' TO BQVFB21-99-ERR-IDENT-FILE-A                   00054770
054780        ADD 1 TO W-CTR-BLOC.                                      00054780
054790                                                                  00054790
054800 L1-100.                                                          00054800
054810*--- SI CONTROLLA L'IDENTIFICATIVO DEL FILE DA CORREGGERE         00054810
054820*--- CON IL RECORD DI TESTA                                       00054820
054830     IF BQVFB11-99-IDENT-FILE-CORR = W-APPO-IDENT-FILE-CORR       00054830
054840        GO TO L1-112.                                             00054840
054850                                                                  00054850
054860 L1-110.                                                          00054860
054870*--- ERRORE DI OMOGENEITA' DELL'IDENTIFICATIVO DEL FILE DA CORREGG00054870
054880     MOVE 502 TO BQVFB21-99-ERR-IDENT-FILE-CORR.                  00054880
054890     MOVE 'E' TO BQVFB21-99-ERR-IDENT-FILE-C-A.                   00054890
054900     ADD 1 TO W-CTR-BLOC.                                         00054900
054910     GO TO L1-120.                                                00054910
054920                                                                  00054920
054930 L1-112.                                                          00054930
054940     MOVE W-APPO-ERR-IDENT-FILE-CORR TO                           00054940
054950                                 BQVFB21-99-ERR-IDENT-FILE-CORR.  00054950
054960     IF W-APPO-ERR-IDENT-FILE-CORR NOT = ZERO                     00054960
054970        MOVE 'E' TO BQVFB21-99-ERR-IDENT-FILE-C-A                 00054970
054980        ADD 1 TO W-CTR-BLOC.                                      00054980
054990                                                                  00054990
055000 L1-120.                                                          00055000
055010*--- SI CONTROLLA LA DATA DI CREAZIONE DEL FILE CON IL RECORD DI T00055010
055020     IF BQVFB11-99-DATA-CR-FILE = W-APPO-DATA-CR-FILE             00055020
055030        GO TO L1-132.                                             00055030
055040                                                                  00055040
055050 L1-130.                                                          00055050
055060*--- ERRORE DI OMOGENEITA' DELLA DATA DI CREAZIONE DEL FILE       00055060
055070     MOVE 502 TO BQVFB21-99-ERR-DATA-CR-FILE.                     00055070
055080     MOVE 'E' TO BQVFB21-99-ERR-DATA-CR-FILE-A.                   00055080
055090     ADD 1 TO W-CTR-BLOC.                                         00055090
055100     GO TO L1-140.                                                00055100
055110                                                                  00055110
055120 L1-132.                                                          00055120
055130     MOVE W-APPO-ERR-DATA-CR-FILE TO BQVFB21-99-ERR-DATA-CR-FILE. 00055130
055140     IF W-APPO-ERR-DATA-CR-FILE NOT = ZERO                        00055140
055150        MOVE 'W' TO BQVFB21-99-ERR-DATA-CR-FILE-A                 00055150
055160        ADD 1 TO W-CTR-NO-BLOC.                                   00055160
055170                                                                  00055170
055180 L1-140.                                                          00055180
055190*--- SI CONTROLLA LA DATA DI INVIO DEL FILE CON IL RECORD DI TESTA00055190
055200     IF BQVFB11-99-DATA-INVIO-FILE = W-APPO-DATA-INVIO-FILE       00055200
055210        GO TO L1-152.                                             00055210
055220                                                                  00055220
055230 L1-150.                                                          00055230
055240*--- ERRORE DI OMOGENEITA' DELLA DATA DI INVIO DEL FILE           00055240
055250     MOVE 502 TO BQVFB21-99-ERR-DATA-INVIO-FILE.                  00055250
055260     MOVE 'E' TO BQVFB21-99-ERR-DATA-INV-FILE-A.                  00055260
055270     ADD 1 TO W-CTR-BLOC.                                         00055270
055280     GO TO L1-160.                                                00055280
055290                                                                  00055290
055300 L1-152.                                                          00055300
055310     MOVE W-APPO-ERR-DATA-INVIO-FILE TO                           00055310
055320                                BQVFB21-99-ERR-DATA-INVIO-FILE.   00055320
055330     MOVE W-APPO-FLAG-ERR-DATA-INV-F TO                           00055330
055340                                BQVFB21-99-ERR-DATA-INV-FILE-A.   00055340
055350     IF W-APPO-FLAG-ERR-DATA-INV-F = 'W'                          00055350
055360        ADD 1 TO W-CTR-NO-BLOC.                                   00055360
055370     IF W-APPO-FLAG-ERR-DATA-INV-F = 'E'                          00055370
055380        ADD 1 TO W-CTR-BLOC.                                      00055380
055390                                                                  00055390
055400 L1-160.                                                          00055400
055410*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA OPERAZIONE     00055410
055420*--- CON IL RECORD DI TESTA                                       00055420
055430     IF BQVFB11-99-DIV-OPER = W-APPO-DIV-OPER                     00055430
055440        GO TO L1-172.                                             00055440
055450                                                                  00055450
055460 L1-170.                                                          00055460
055470*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00055470
055480     MOVE 502 TO BQVFB21-99-ERR-DIV-OPER.                         00055480
055490     MOVE 'E' TO BQVFB21-99-ERR-DIV-OPER-A.                       00055490
055500     ADD 1 TO W-CTR-BLOC.                                         00055500
055510     GO TO L1-180.                                                00055510
055520                                                                  00055520
055530 L1-172.                                                          00055530
055540     MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-99-ERR-DIV-OPER.         00055540
055550     IF W-APPO-ERR-DIV-OPER NOT = ZERO                            00055550
055560        MOVE 'E' TO BQVFB21-99-ERR-DIV-OPER-A                     00055560
055570        ADD 1 TO W-CTR-BLOC.                                      00055570
055580                                                                  00055580
055590 L1-180.                                                          00055590
055600*--- SI CONTROLLA IL CODICE ABI MITTENTE CON IL RECORD DI TESTA   00055600
055610     IF BQVFB11-99-ABI-MITT = W-APPO-ABI-MITT                     00055610
055620        GO TO L1-192.                                             00055620
055630                                                                  00055630
055640 L1-190.                                                          00055640
055650*--- ERRORE DI OMOGENEITA' DEL CODICE ABI MITTENTE                00055650
055660     MOVE 502 TO BQVFB21-99-ERR-ABI-MITT.                         00055660
055670     MOVE 'E' TO BQVFB21-99-ERR-ABI-MITT-A.                       00055670
055680     ADD 1 TO W-CTR-BLOC.                                         00055680
055690     GO TO L1-200.                                                00055690
055700                                                                  00055700
055710 L1-192.                                                          00055710
055720     MOVE W-APPO-ERR-ABI-MITT TO BQVFB21-99-ERR-ABI-MITT.         00055720
055730     IF W-APPO-ERR-ABI-MITT NOT = ZERO                            00055730
055740        MOVE 'W' TO BQVFB21-99-ERR-ABI-MITT-A                     00055740
055750        ADD 1 TO W-CTR-NO-BLOC.                                   00055750
055760                                                                  00055760
055770 L1-200.                                                          00055770
055780*--- SI CONTROLLA IL CODICE ABI RICEVENTE CON IL RECORD DI TESTA  00055780
055790     IF BQVFB11-99-ABI-RICE = W-APPO-ABI-RICE                     00055790
055800        GO TO L1-212.                                             00055800
055810                                                                  00055810
055820 L1-210.                                                          00055820
055830*--- ERRORE DI OMOGENEITA' DEL CODICE ABI RICEVENTE               00055830
055840     MOVE 502 TO BQVFB21-99-ERR-ABI-RICE.                         00055840
055850     MOVE 'E' TO BQVFB21-99-ERR-ABI-RICE-A.                       00055850
055860     ADD 1 TO W-CTR-BLOC.                                         00055860
055870     GO TO L1-220.                                                00055870
055880                                                                  00055880
055890 L1-212.                                                          00055890
055900     MOVE W-APPO-ERR-ABI-RICE TO BQVFB21-99-ERR-ABI-RICE.         00055900
055910     IF W-APPO-ERR-ABI-RICE NOT = ZERO                            00055910
055920        MOVE 'W' TO BQVFB21-99-ERR-ABI-RICE-A                     00055920
055930        ADD 1 TO W-CTR-NO-BLOC.                                   00055930
055940                                                                  00055940
055950 L1-220.                                                          00055950
055960*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 01     00055960
055970     IF BQVFB11-99-NUMREC-V01A NUMERIC                            00055970
055980        GO TO L1-240.                                             00055980
055990                                                                  00055990
056000 L1-230.                                                          00056000
056010*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 01           00056010
056020     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V01.                        00056020
056030     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V01-A.                     00056030
056040     ADD 1 TO W-CTR-BLOC.                                         00056040
056050     GO TO L1-250.                                                00056050
056060                                                                  00056060
056070 L1-240.                                                          00056070
056080*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 01      00056080
056090*--- CON QUELLO CALCOLATO                                         00056090
056100     IF BQVFB11-99-NUMREC-V01 NOT = W-CTR-01                      00056100
056110        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V01                     00056110
056120        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V01-A                   00056120
056130        ADD 1 TO W-CTR-BLOC.                                      00056130
056140                                                                  00056140
056150 L1-250.                                                          00056150
056160*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 02     00056160
056170     IF BQVFB11-99-NUMREC-V02A NUMERIC                            00056170
056180        GO TO L1-270.                                             00056180
056190                                                                  00056190
056200 L1-260.                                                          00056200
056210*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 02           00056210
056220     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V02.                        00056220
056230     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V02-A.                     00056230
056240     ADD 1 TO W-CTR-BLOC.                                         00056240
056250     GO TO L1-280.                                                00056250
056260                                                                  00056260
056270 L1-270.                                                          00056270
056280*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 02      00056280
056290*--- CON QUELLO CALCOLATO                                         00056290
056300     IF BQVFB11-99-NUMREC-V02 NOT = W-CTR-02                      00056300
056310        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V02                     00056310
056320        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V02-A                   00056320
056330        ADD 1 TO W-CTR-BLOC.                                      00056330
056340                                                                  00056340
056350 L1-280.                                                          00056350
056360*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 03     00056360
056370     IF BQVFB11-99-NUMREC-V03A NUMERIC                            00056370
056380        GO TO L1-300.                                             00056380
056390                                                                  00056390
056400 L1-290.                                                          00056400
056410*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 03           00056410
056420     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V03.                        00056420
056430     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V03-A.                     00056430
056440     ADD 1 TO W-CTR-BLOC.                                         00056440
056450     GO TO L1-310.                                                00056450
056460                                                                  00056460
056470 L1-300.                                                          00056470
056480*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 03      00056480
056490*--- CON QUELLO CALCOLATO                                         00056490
056500     IF BQVFB11-99-NUMREC-V03 NOT = W-CTR-03                      00056500
056510        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V03                     00056510
056520        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V03-A                   00056520
056530        ADD 1 TO W-CTR-BLOC.                                      00056530
056540                                                                  00056540
056550 L1-310.                                                          00056550
056560*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 04     00056560
056570     IF BQVFB11-99-NUMREC-V04A NUMERIC                            00056570
056580        GO TO L1-312.                                             00056580
056590                                                                  00056590
056600 L1-311.                                                          00056600
056610*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 04           00056610
056620     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V04.                        00056620
056630     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V04-A.                     00056630
056640     ADD 1 TO W-CTR-BLOC.                                         00056640
056650     GO TO L1-313.                                                00056650
056660                                                                  00056660
056670 L1-312.                                                          00056670
056680*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 04      00056680
056690*--- CON QUELLO CALCOLATO                                         00056690
056700*F   IF BQVFB11-99-NUMREC-V04 NOT = W-CTR-04                      00056700
056710*F      MOVE 503 TO BQVFB21-99-ERR-NUMREC-V04                     00056710
056720*F      MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V04-A                   00056720
056730*F      ADD 1 TO W-CTR-BLOC.                                      00056730
056740                                                                  00056740
056750 L1-313.                                                          00056750
056760*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 05     00056760
056770     IF BQVFB11-99-NUMREC-V05A NUMERIC                            00056770
056780        GO TO L1-315.                                             00056780
056790                                                                  00056790
056800 L1-314.                                                          00056800
056810*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 05           00056810
056820     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V05.                        00056820
056830     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V05-A.                     00056830
056840     ADD 1 TO W-CTR-BLOC.                                         00056840
056850     GO TO L1-316.                                                00056850
056860                                                                  00056860
056870 L1-315.                                                          00056870
056880*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 05      00056880
056890*--- CON QUELLO CALCOLATO                                         00056890
056900     IF BQVFB11-99-NUMREC-V05 NOT = W-CTR-05                      00056900
056910        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V05                     00056910
056920        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V05-A                   00056920
056930        ADD 1 TO W-CTR-BLOC.                                      00056930
056940                                                                  00056940
056950 L1-316.                                                          00056950
056960*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 06     00056960
056970     IF BQVFB11-99-NUMREC-V06A NUMERIC                            00056970
056980        GO TO L1-318.                                             00056980
056990                                                                  00056990
057000 L1-317.                                                          00057000
057010*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 06           00057010
057020     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V06.                        00057020
057030     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V06-A.                     00057030
057040     ADD 1 TO W-CTR-BLOC.                                         00057040
057050     GO TO L1-319.                                                00057050
057060                                                                  00057060
057070 L1-318.                                                          00057070
057080*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 06      00057080
057090*--- CON QUELLO CALCOLATO                                         00057090
057100     IF BQVFB11-99-NUMREC-V06 NOT = W-CTR-06                      00057100
057110        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V06                     00057110
057120        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V06-A                   00057120
057130        ADD 1 TO W-CTR-BLOC.                                      00057130
057140                                                                  00057140
057150 L1-319.                                                          00057150
057160*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 07     00057160
057170     IF BQVFB11-99-NUMREC-V07A NUMERIC                            00057170
057180        GO TO L1-326.                                             00057180
057190                                                                  00057190
057200 L1-324.                                                          00057200
057210*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 07           00057210
057220     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V07.                        00057220
057230     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V07-A.                     00057230
057240     ADD 1 TO W-CTR-BLOC.                                         00057240
057250     GO TO L1-327.                                                00057250
057260                                                                  00057260
057270 L1-326.                                                          00057270
057280*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 07      00057280
057290*--- CON QUELLO CALCOLATO                                         00057290
057300     IF BQVFB11-99-NUMREC-V07 NOT = W-CTR-07                      00057300
057310        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V07                     00057310
057320        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V07-A                   00057320
057330        ADD 1 TO W-CTR-BLOC.                                      00057330
057340                                                                  00057340
057350 L1-327.                                                          00057350
057360                                                                  00057360
057370     IF W-VERS LESS 'R06'                                         00057370
057380        PERFORM L2-319 THRU L2-990-CONTR-99-EX                    00057380
057390        GO TO L1-490.                                             00057390
057400                                                                  00057400
057410 L1-327-R06.                                                      00057410
057420*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 12     00057420
057430     IF BQVFB11-99-NUMREC-V12A NUMERIC                            00057430
057440        GO TO L1-327-2.                                           00057440
057450                                                                  00057450
057460 L1-327-1.                                                        00057460
057470*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 12           00057470
057480     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V12.                        00057480
057490     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V12-A.                     00057490
057500     ADD 1 TO W-CTR-BLOC.                                         00057500
057510     GO TO L1-328.                                                00057510
057520                                                                  00057520
057530 L1-327-2.                                                        00057530
057540*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 12      00057540
057550*--- CON QUELLO CALCOLATO                                         00057550
057560     IF BQVFB11-99-NUMREC-V12 NOT = W-CTR-12                      00057560
057570        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V12                     00057570
057580        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V12-A                   00057580
057590        ADD 1 TO W-CTR-BLOC.                                      00057590
057600 L1-328.                                                          00057600
057610*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 14     00057610
057620     IF BQVFB11-99-NUMREC-V14A NUMERIC                            00057620
057630        GO TO L1-330.                                             00057630
057640                                                                  00057640
057650 L1-329.                                                          00057650
057660*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 14           00057660
057670     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V14.                        00057670
057680     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V14-A.                     00057680
057690     ADD 1 TO W-CTR-BLOC.                                         00057690
057700     GO TO L1-340.                                                00057700
057710                                                                  00057710
057720 L1-330.                                                          00057720
057730*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 14      00057730
057740*--- CON QUELLO CALCOLATO                                         00057740
057750     IF BQVFB11-99-NUMREC-V14 NOT = W-CTR-14                      00057750
057760        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V14                     00057760
057770        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V14-A                   00057770
057780        ADD 1 TO W-CTR-BLOC.                                      00057780
057790                                                                  00057790
057800 L1-340.                                                          00057800
057810*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 15     00057810
057820     IF BQVFB11-99-NUMREC-V15A NUMERIC                            00057820
057830        GO TO L1-360.                                             00057830
057840                                                                  00057840
057850 L1-350.                                                          00057850
057860*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 15           00057860
057870     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V15.                        00057870
057880     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V15-A.                     00057880
057890     ADD 1 TO W-CTR-BLOC.                                         00057890
057900     GO TO L1-370.                                                00057900
057910                                                                  00057910
057920 L1-360.                                                          00057920
057930*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 15      00057930
057940*--- CON QUELLO CALCOLATO                                         00057940
057950     IF BQVFB11-99-NUMREC-V15 NOT = W-CTR-15                      00057950
057960        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V15                     00057960
057970        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V15-A                   00057970
057980        ADD 1 TO W-CTR-BLOC.                                      00057980
057990                                                                  00057990
058000 L1-370.                                                          00058000
058010*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 20     00058010
058020     IF BQVFB11-99-NUMREC-V20A NUMERIC                            00058020
058030        GO TO L1-374.                                             00058030
058040                                                                  00058040
058050 L1-372.                                                          00058050
058060*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 20           00058060
058070     MOVE 33  TO BQVFB21-99-ERR-NUMREC-V20.                       00058070
058080     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V20-A.                     00058080
058090     ADD 1 TO W-CTR-BLOC.                                         00058090
058100     GO TO L1-378.                                                00058100
058110                                                                  00058110
058120 L1-374.                                                          00058120
058130*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 20      00058130
058140*--- CON QUELLO CALCOLATO                                         00058140
058150     IF BQVFB11-99-NUMREC-V20 NOT = W-CTR-20                      00058150
058160        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V20                     00058160
058170        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V20-A                   00058170
058180        ADD 1 TO W-CTR-BLOC.                                      00058180
058190                                                                  00058190
058200 L1-378.                                                          00058200
058210*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 36     00058210
058220     IF BQVFB11-99-NUMREC-V36A NUMERIC                            00058220
058230        GO TO L1-390.                                             00058230
058240                                                                  00058240
058250 L1-380.                                                          00058250
058260*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 36           00058260
058270     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V36.                        00058270
058280     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V36-A.                     00058280
058290     ADD 1 TO W-CTR-BLOC.                                         00058290
058300     GO TO L1-400.                                                00058300
058310                                                                  00058310
058320 L1-390.                                                          00058320
058330*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 36      00058330
058340*--- CON QUELLO CALCOLATO                                         00058340
058350     IF BQVFB11-99-NUMREC-V36 NOT = W-CTR-36                      00058350
058360        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V36                     00058360
058370        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V36-A                   00058370
058380        ADD 1 TO W-CTR-BLOC.                                      00058380
058390                                                                  00058390
058400 L1-400.                                                          00058400
058410*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 37     00058410
058420     IF BQVFB11-99-NUMREC-V37A NUMERIC                            00058420
058430        GO TO L1-420.                                             00058430
058440                                                                  00058440
058450 L1-410.                                                          00058450
058460*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 37           00058460
058470     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V37.                        00058470
058480     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V37-A.                     00058480
058490     ADD 1 TO W-CTR-BLOC.                                         00058490
058500     GO TO L1-430.                                                00058500
058510                                                                  00058510
058520 L1-420.                                                          00058520
058530*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 37      00058530
058540*--- CON QUELLO CALCOLATO                                         00058540
058550     IF BQVFB11-99-NUMREC-V37 NOT = W-CTR-37                      00058550
058560        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V37                     00058560
058570        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V37-A                   00058570
058580        ADD 1 TO W-CTR-BLOC.                                      00058580
058590                                                                  00058590
058600 L1-430.                                                          00058600
058610*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 38     00058610
058620     IF BQVFB11-99-NUMREC-V38A NUMERIC                            00058620
058630        GO TO L1-450.                                             00058630
058640                                                                  00058640
058650 L1-440.                                                          00058650
058660*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 38           00058660
058670     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V38.                        00058670
058680     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V38-A.                     00058680
058690     ADD 1 TO W-CTR-BLOC.                                         00058690
058700     GO TO L1-460.                                                00058700
058710                                                                  00058710
058720 L1-450.                                                          00058720
058730*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 38      00058730
058740*--- CON QUELLO CALCOLATO                                         00058740
058750     IF BQVFB11-99-NUMREC-V38 NOT = W-CTR-38                      00058750
058760        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V38                     00058760
058770        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V38-A                   00058770
058780        ADD 1 TO W-CTR-BLOC.                                      00058780
058790                                                                  00058790
058800 L1-460.                                                          00058800
058810*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 49     00058810
058820     IF BQVFB11-99-NUMREC-V49A NUMERIC                            00058820
058830        GO TO L1-480.                                             00058830
058840                                                                  00058840
058850 L1-470.                                                          00058850
058860*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 49           00058860
058870     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V49.                        00058870
058880     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V49-A.                     00058880
058890     ADD 1 TO W-CTR-BLOC.                                         00058890
058900     GO TO L1-490.                                                00058900
058910                                                                  00058910
058920 L1-480.                                                          00058920
058930*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 49      00058930
058940*--- CON QUELLO CALCOLATO                                         00058940
058950     IF BQVFB11-99-NUMREC-V49 NOT = W-CTR-49                      00058950
058960        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V49                     00058960
058970        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V49-A                   00058970
058980        ADD 1 TO W-CTR-BLOC                                       00058980
058990        GO TO L1-490                                              00058990
059000     END-IF.                                                      00059000
059010                                                                  00059010
059020*                                                                 00059020
059030*--- MODIFICA PER V36/V49 CONTESTUALI                             00059030
059040*--- SI CONTROLLA LA CONGRUENZA DEI CONTATORI V36/V49             00059040
059050*                                                                 00059050
059060     IF W-CONT-V49 NOT = W-CONT-V36                               00059060
059070        MOVE 506 TO BQVFB21-99-ERR-NUMREC-V49                     00059070
059080        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V49-A                   00059080
059090        ADD 1 TO W-CTR-BLOC                                       00059090
059100     END-IF.                                                      00059100
059110 L1-490.                                                          00059110
059120*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD TOTALI         00059120
059130*** MODIFICA PER CALCOLO TOTALE RECORD                            00059130
059140**** IF BQVFB11-99-NUMREC-TOTA NUMERIC                            00059140
059150******* GO TO L1-510.                                             00059150
059160     IF BQVFB11-99-NUMREC-6-TOTA NUMERIC                          00059160
059170        GO TO L1-510.                                             00059170
059180                                                                  00059180
059190 L1-500.                                                          00059190
059200*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD TOTALI               00059200
059210     MOVE 33 TO BQVFB21-99-ERR-NUMREC-TOT.                        00059210
059220     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-TOT-A.                     00059220
059230     ADD 1 TO W-CTR-BLOC.                                         00059230
059240     GO TO L1-990-CONTR-99-EX.                                    00059240
059250                                                                  00059250
059260 L1-510.                                                          00059260
059270*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD TOTALI          00059270
059280*--- CON QUELLO CALCOLATO                                         00059280
059290     COMPUTE W-CTR-TOT = W-CTR-01 + W-CTR-02 + W-CTR-03 +         00059290
059300                         W-CTR-04 + W-CTR-05 + W-CTR-06 +         00059300
059310                         W-CTR-07 +                               00059310
059320                         W-CTR-12 +                               00059320
059330                         W-CTR-20 +                               00059330
059340                         W-CTR-14 + W-CTR-15 + W-CTR-36 +         00059340
059350                         W-CTR-37 + W-CTR-38 + W-CTR-49 +         00059350
059360                         W-CTR-00 + W-CTR-99.                     00059360
059370*** MODIFICA PER CALCOLO TOTALE RECORD                            00059370
059380**** IF BQVFB11-99-NUMREC-TOT NOT = W-CTR-TOT                     00059380
059390******* MOVE 503 TO BQVFB21-99-ERR-NUMREC-TOT                     00059390
059400******* MOVE 'E' TO BQVFB21-99-ERR-NUMREC-TOT-A                   00059400
059410******* ADD 1 TO W-CTR-BLOC.                                      00059410
059420     MOVE ZERO TO W-FLAG-NUMREC.                                  00059420
059430     IF BQVFB11-99-NUMREC-6-TOT NOT = W-CTR-TOT                   00059430
059440        MOVE 1    TO W-FLAG-NUMREC                                00059440
059450        PERFORM F3-010 THRU F3-EXIT                               00059450
059460     END-IF.                                                      00059460
059470     IF W-FLAG-NUMREC = 1 THEN                                    00059470
059480        MOVE 503 TO BQVFB21-99-ERR-NUMREC-TOT                     00059480
059490        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-TOT-A                   00059490
059500        ADD 1 TO W-CTR-BLOC                                       00059500
059510     END-IF.                                                      00059510
059520*                                                                 00059520
059530     IF W-FLAG-CONF-F24 = '1' AND                                 00059530
059540        W-FLAG-CONF-I24 = '1' AND                                 00059540
059550        BQVFB11-DATA-BONIF     LESS '20141103'                    00059550
059560           MOVE  96 TO BQVFB21-99-ERR-F24-I24                     00059560
059570           MOVE 'W' TO BQVFB21-99-ERR-F24-I24-A                   00059570
059580           ADD 1 TO W-CTR-NO-BLOC                                 00059580
059590     END-IF.                                                      00059590
059600*                                                                 00059600
059610     IF W-FLAG-CONF-F24 = '1' AND                                 00059610
059620        W-FLAG-CONF-I24 = '1' AND                                 00059620
059630        BQVFB11-DATA-BONIF NOT LESS '20141103'                    00059630
059640           MOVE  96 TO BQVFB21-99-ERR-F24-I24                     00059640
059650           MOVE 'E' TO BQVFB21-99-ERR-F24-I24-A                   00059650
059660           ADD 1 TO W-CTR-BLOC                                    00059660
059670     END-IF.                                                      00059670
059680*                                                                 00059680
059690                                                                  00059690
059700 L1-990-CONTR-99-EX.                                              00059700
059710     EXIT.                                                        00059710
059720                                                                  00059720
059730*---                                                              00059730
059740*--- PERFORM H2-010-CONTR-FISCO - CONTROLLI SUL RECORD 38         00059740
059750*--- DI PRESENZA IN TABELLA SALDI DI PROVINCE CON ACCREDITAMENTI  00059750
059760*--- PER LE QUALI NON C'E' STATO UN CONTROLLO TRAMITE RECORD 37   00059760
059770*---                                                              00059770
059780 H2-010-CONTR-FISCO.                                              00059780
059790*--- SI CERCA IN TABELLA UNA PROVINCIA IMPOSTATA CHE NON SIA      00059790
059800*--- STATA GIA' CONTROLLATA CON IMPORTI RELATIVI ALLA PARTE       00059800
059810*--- FISCO VALORIZZATI E CHE NON SIA STATA TRATTATA DA RECORD 37  00059810
059820     MOVE 0 TO W-FLAG-TROVATO.                                    00059820
059830     SET S TO 1.                                                  00059830
059840     SEARCH W-EL-SALDI                                            00059840
059850     WHEN W-PROV(S) NOT = SPACE      AND                          00059850
059860          W-FLAG-CONTR(S) = 0                                     00059860
059870          MOVE 1 TO W-FLAG-TROVATO.                               00059870
059880     IF W-FLAG-TROVATO = 0                                        00059880
059890        GO TO H2-990-CONTR-FISCO-EX.                              00059890
059900                                                                  00059900
059910 H2-030.                                                          00059910
059920*--- ERRORE PER PROVINCIA CON SALDO POSITIVO E ASSENZA DI         00059920
059930*--- RECORD 37 RELATIVO                                           00059930
059940*F   IF BQVFB21-ERR-TIPO-RECORD-A = 'W'                           00059940
059950*F      SUBTRACT  1 FROM W-CTR-NO-BLOC.                           00059950
059960*F   IF BQVFB21-ERR-TIPO-RECORD-A NOT = 'E'                       00059960
059970*F      MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00059970
059980*F      MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00059980
059990*F      ADD 1 TO W-CTR-BLOC.                                      00059990
060000                                                                  00060000
060010 H2-990-CONTR-FISCO-EX.                                           00060010
060020     EXIT.                                                        00060020
060030                                                                  00060030
060040*---                                                              00060040
060050*--- PERFORM RA-010-WRITE - SCRITTURA FILE ESITI                  00060050
060060*---                                                              00060060
060070 RA-010-WRITE.                                                    00060070
060080*--- PER RECORD PRECEDENTE V37 O V38 SI RICHIAMA LA               00060080
060090*--- PERFORM DELLE QUADRATURE CONTROLLANDO SE                     00060090
060100*--- IL RECORD APPENA LETTO E' V00 O E' FINE FILE                 00060100
060110     IF W-TIPO-REC-PREC = 'V37' OR                                00060110
060120        W-TIPO-REC-PREC = 'V38'                                   00060120
060130        GO TO RA-050.                                             00060130
060140                                                                  00060140
060150 RA-030.                                                          00060150
060160*--- PER REC PRECEDENTE V01, V02, V03, V04, V05, V06 O V07 RECORD 00060160
060170*--- LETTO > V15 E FLAG DI SEGNALAZIONE ERRORE SU CF ACCESO,      00060170
060180*--- S'IMPOSTA L'ERRORE BLOCCANTE SUL RECORD PRECEDENTE           00060180
060190     IF  W-FLAG-E            = 1     AND                          00060190
060200         BQVFB11-TIPO-RECORD     > 'V15' AND                      00060200
060210         BQVFB11-TIPO-RECORD NOT = 'V20' AND                      00060210
060220        (W-TIPO-REC-PREC     = 'V01' OR                           00060220
060230         W-TIPO-REC-PREC     = 'V02' OR                           00060230
060240         W-TIPO-REC-PREC     = 'V03' OR                           00060240
060250         W-TIPO-REC-PREC     = 'V04' OR                           00060250
060260         W-TIPO-REC-PREC     = 'V05' OR                           00060260
060270         W-TIPO-REC-PREC     = 'V06' OR                           00060270
060280         W-TIPO-REC-PREC     = 'V07' OR                           00060280
060290         W-TIPO-REC-PREC     = 'V12' OR                           00060290
060300         W-TIPO-REC-PREC     = 'V20') AND                         00060300
060310        BQVFB21-01-ERR-CODICE-FISC-A EQUAL ZERO                   00060310
060320        MOVE 96                    TO BQVFB21-01-ERR-CODICE-FISC  00060320
060330        MOVE 'E'                   TO BQVFB21-01-ERR-CODICE-FISC-A00060330
060340        ADD 1                      TO W-CTR-BLOC                  00060340
060350       GO TO RA-040.                                              00060350
060360                                                                  00060360
060370 RA-032.                                                          00060370
060380     IF  W-FLAG-E            = 1     AND                          00060380
060390         BQVFB11-TIPO-RECORD     > 'V15' AND                      00060390
060400         BQVFB11-TIPO-RECORD NOT = 'V20' AND                      00060400
060410        (W-TIPO-REC-PREC     = 'V01' OR                           00060410
060420         W-TIPO-REC-PREC     = 'V02' OR                           00060420
060430         W-TIPO-REC-PREC     = 'V03' OR                           00060430
060440         W-TIPO-REC-PREC     = 'V04' OR                           00060440
060450         W-TIPO-REC-PREC     = 'V05' OR                           00060450
060460         W-TIPO-REC-PREC     = 'V06' OR                           00060460
060470         W-TIPO-REC-PREC     = 'V07' OR                           00060470
060480         W-TIPO-REC-PREC     = 'V12' OR                           00060480
060490         W-TIPO-REC-PREC     = 'V20') AND                         00060490
060500        BQVFB21-01-ERR-CODICE-FISC-A EQUAL 'W'                    00060500
060510        MOVE 96                    TO BQVFB21-01-ERR-CODICE-FISC  00060510
060520        MOVE 'E'                   TO BQVFB21-01-ERR-CODICE-FISC-A00060520
060530        ADD 1                      TO W-CTR-BLOC                  00060530
060540        SUBTRACT 1                 FROM W-CTR-NO-BLOC             00060540
060550        GO TO RA-040.                                             00060550
060560                                                                  00060560
060570 RA-034.                                                          00060570
060580*--- PER REC PRECEDENTE V01, V02 V03, V04, V05 O V06, V07 RECORD  00060580
060590*--- LETTO V01, V02, V03, V04, V05, V06 O V07 E PROGRESSIVO DELEGA00060590
060600*--- DIVERSO S'IMPOSTA L'ERRORE BLOCCANTE SUL RECORD PRECEDENTE   00060600
060610     IF (BQVFB11-TIPO-RECORD = 'V01' OR                           00060610
060620         BQVFB11-TIPO-RECORD = 'V02' OR                           00060620
060630         BQVFB11-TIPO-RECORD = 'V03' OR                           00060630
060640         BQVFB11-TIPO-RECORD = 'V04' OR                           00060640
060650         BQVFB11-TIPO-RECORD = 'V05' OR                           00060650
060660         BQVFB11-TIPO-RECORD = 'V06' OR                           00060660
060670         BQVFB11-TIPO-RECORD = 'V07' OR                           00060670
060680         BQVFB11-TIPO-RECORD = 'V12'   ) AND                      00060680
060690        (W-TIPO-REC-PREC     = 'V01' OR                           00060690
060700         W-TIPO-REC-PREC     = 'V02' OR                           00060700
060710         W-TIPO-REC-PREC     = 'V03' OR                           00060710
060720         W-TIPO-REC-PREC     = 'V04' OR                           00060720
060730         W-TIPO-REC-PREC     = 'V05' OR                           00060730
060740         W-TIPO-REC-PREC     = 'V06' OR                           00060740
060750         W-TIPO-REC-PREC     = 'V07' OR                           00060750
060760         W-TIPO-REC-PREC     = 'V12' OR                           00060760
060770         W-TIPO-REC-PREC     = 'V14' OR                           00060770
060780         W-TIPO-REC-PREC     = 'V15'   ) AND                      00060780
060790         BQVFB11-01-PROG-DELEGAA NUMERIC AND                      00060790
060800         BQVFB11-01-PROG-DELEGA NOT = W-CTR-DELEGA                00060800
060810        MOVE 505 TO BQVFB21-01-ERR-REC-SUCC                       00060810
060820        MOVE 'E' TO BQVFB21-01-ERR-REC-SUCC-A                     00060820
060830        ADD 1    TO W-CTR-BLOC                                    00060830
060840        MOVE 1   TO W-FLAG-NUOVA-DELEGA                           00060840
060850        MOVE 1   TO W-FLAG-ERR-DELEGA                             00060850
060860        GO TO RA-040.                                             00060860
060870 RA-038.                                                          00060870
060880*--- SI CONTROLLA CHE PER FINE FILE O INIZIO NUOVO INVIO          00060880
060890*--- (RECORD DI TESTA V00) IL RECORD PRECEDENTEMENTE LETTO        00060890
060900*--- FOSSE UN RECORD DI CODA (V99)                                00060900
060910     IF (W-FINE-BQVFB1    = 1 OR                                  00060910
060920         BQVFB11-TIPO-RECORD = 'V00') AND                         00060920
060930        W-TIPO-REC-PREC NOT  = 'V99'                              00060930
060940        MOVE 505 TO BQVFB21-00-ERR-REC-SUCC                       00060940
060950        MOVE 'E' TO BQVFB21-00-ERR-REC-SUCC-A                     00060950
060960        ADD 1 TO W-CTR-BLOC                                       00060960
060970        GO TO RA-040.                                             00060970
060980                                                                  00060980
060990 RA-039.                                                          00060990
061000*--- SI CONTROLLA CHE PER RECORD PRECEDENTEMENTE LETTO V99,       00061000
061010*--- IL SUCCESSIVO SIA V00                                        00061010
061020     IF W-TIPO-REC-PREC         EQUAL 'V99'   AND                 00061020
061030        BQVFB11-TIPO-RECORD NOT EQUAL 'V00'   AND                 00061030
061040        W-FINE-BQVFB1           EQUAL  ZERO                       00061040
061050       MOVE 1   TO W-FLAG-KO.                                     00061050
061060                                                                  00061060
061070 RA-040.                                                          00061070
061080*--- SI SCRIVE IL FILE ESITI                                      00061080
061090     WRITE BQVFB22 FROM BQVFB21.                                  00061090
061100     ADD 1 TO W-CTR-SCRITTI.                                      00061100
061110     GO TO RA-060.                                                00061110
061120                                                                  00061120
061130 RA-050.                                                          00061130
061140     IF W-FINE-BQVFB1    = 1       OR                             00061140
061150        BQVFB11-TIPO-RECORD = 'V00'                               00061150
061160        MOVE 1 TO W-FLAG-ERR-SUCC.                                00061160
061170 RA-060.                                                          00061170
061180     IF W-FLAG-REC-ERR EQUAL ZERO                                 00061180
061190        GO TO RA-080.                                             00061190
061200 RA-070.                                                          00061200
061210*    SUL RECORD E' STATO RILEVATO UN ERRORE. SE TALE RECORD       00061210
061220*    E' IL PRIMO V37 O V38 DEL FILE LOGICO, IMPOSTO UN FLAG CHE IN00061220
061230*    CHE SU TALE RECORD E' GIA' STATA SEGNALATA LA PRESENZA DI    00061230
061240*    ERRORI. (IN CASO DI ERRORI DI QUADRATURA IL CONTATORE DEI    00061240
061250*    RECORD ERRATI NON VERRA' INCREMENTATO)                       00061250
061260     MOVE ZERO   TO  W-FLAG-REC-ERR.                              00061260
061270     IF W-CTR-37   EQUAL 1                                        00061270
061280        MOVE 1 TO W-FLG-ERR-BLOC-37.                              00061280
061290     IF W-CTR-38   EQUAL 1                                        00061290
061300        MOVE 1 TO W-FLG-ERR-BLOC-38.                              00061300
061310     GO TO RA-120.                                                00061310
061320 RA-080.                                                          00061320
061330     IF W-CTR-BLOC = W-APPO-CTR-BLOC AND                          00061330
061340        W-FLAG-ERR-SUCC EQUAL ZERO                                00061340
061350        GO TO RA-100.                                             00061350
061360 RA-090.                                                          00061360
061370*    SUL RECORD E' STATO RILEVATO UN ERRORE BLOCCANTE O UN ERRORE 00061370
061380*    DI SEQUENZA. QUINDI IMPOSTO IL CONTATORE DI RECORD ERRATI E  00061380
061390*    SEGNALO CON IL RELATIVO FLAG CHE TALE CONTATORE E' GIA' STATO00061390
061400*    VALORIZZATO                                                  00061400
061410*    (SE HO ELABORATO IL PRIMO V37 O V38 DELLA BANCA/CONC.)       00061410
061420     ADD 1 TO W-TOT-REC-ERR.                                      00061420
061430     ADD 1 TO W-TOT-REC-ERR-BLOC.                                 00061430
061440     IF W-CTR-37   EQUAL 1                                        00061440
061450        MOVE 1 TO W-FLG-ERR-BLOC-37.                              00061450
061460     IF W-CTR-38   EQUAL 1                                        00061460
061470        MOVE 1 TO W-FLG-ERR-BLOC-38.                              00061470
061480     GO TO RA-120.                                                00061480
061490                                                                  00061490
061500 RA-100.                                                          00061500
061510     IF W-CTR-NO-BLOC  = W-APPO-CTR-NO-BLOC                       00061510
061520        GO TO RA-120.                                             00061520
061530                                                                  00061530
061540 RA-110.                                                          00061540
061550*    SUL RECORD E' STATO RILEVATO UN ERRORE NON BLOCCANTE.        00061550
061560*    QUINDI IMPOSTO IL CONTATORE DI RECORD ERRATI E SEGNALO       00061560
061570*    CON IL RELATIVO FLAG CHE TALE CONTATORE E' GIA' STATO        00061570
061580*    VALORIZZATO                                                  00061580
061590*    (SE HO ELABORATO IL PRIMO V37 O V38 DELLA BANCA/CONC.)       00061590
061600     ADD 1 TO W-TOT-REC-ERR.                                      00061600
061610     IF W-CTR-37   EQUAL 1                                        00061610
061620        MOVE 1 TO W-FLG-ERR-NO-BLOC-37.                           00061620
061630     IF W-CTR-38   EQUAL 1                                        00061630
061640        MOVE 1 TO W-FLG-ERR-NO-BLOC-38.                           00061640
061650 RA-120.                                                          00061650
061660*    PER RECORD PRECEDENTE V37 O V38 E RECORD ATTUALE DIVERSO DAL 00061660
061670*    PRECEDENTE, SI RICHIAMA LA PERFORM DI QUADRATURA             00061670
061680     IF (W-TIPO-REC-PREC = 'V37' OR                               00061680
061690         W-TIPO-REC-PREC = 'V38') AND                             00061690
061700         BQVFB11-TIPO-RECORD NOT EQUAL W-TIPO-REC-PREC            00061700
061710         PERFORM RG-010-QUADR THRU RG-990-QUADR-EX.               00061710
061720*F   IF W-TIPO-REC-PREC = 'V37' AND                               00061720
061730*F      BQVFB11-TIPO-RECORD NOT EQUAL W-TIPO-REC-PREC             00061730
061740*F       PERFORM RY-010-SQUADR THRU RY-990-SQUADR-EX.             00061740
061750                                                                  00061750
061760 RA-990-WRITE-EX.                                                 00061760
061770     EXIT.                                                        00061770
061780                                                                  00061780
061790*---                                                              00061790
061800*--- PERFORM RB-010-KO - SCRITTURA FILE INVII PER ESITO KO        00061800
061810*---                                                              00061810
061820 RB-010-KO.                                                       00061820
061830*                                                                 00061830
061840*--- IMPOSTAZIONE CAMPI FILE INVII PER KO                         00061840
061850*                                                                 00061850
061860     MOVE ZERO TO W-CTR-REC-KO.                                   00061860
061870     MOVE BQVFB11-COD-ABIA       TO BQVFB31-COD-ABI.              00061870
061880     MOVE BQVFB11-DATA-BONIF     TO BQVFB31-DATA-BONIF.           00061880
061890     MOVE BQVFB11-00-PROG-TRASMA TO BQVFB31-PROG-TRASM.           00061890
061900     MOVE BQVFB11-00-TIPO-INVIO  TO BQVFB31-TIPO-INVIO.           00061900
061910     MOVE BQVFB11-00-PROG-INVIOA TO BQVFB31-PROG-INVIO.           00061910
061920     ADD 1                       TO W-CTR-FLUSSI.                 00061920
061930     MOVE W-CTR-FLUSSI           TO BQVFB31-PROG-FLUSSO-TRASM.    00061930
061940     MOVE W-APPO-DATA-SYS        TO BQVFB31-DATA-ESITO.           00061940
061950     MOVE '3'                    TO BQVFB31-ESITO.                00061950
061960                                                                  00061960
061970 RB-020.                                                          00061970
061980*--- SI SCRIVE SU ESITI IL RECORD KO E TUTTI QUELLI LETTI         00061980
061990*--- DI SEGUITO FINO ALL'INIZIO DI UN NUOVO INVIO (V00)           00061990
062000     WRITE BQVFB22 FROM BQVFB21.                                  00062000
062010     ADD 1 TO W-CTR-SCRITTI.                                      00062010
062020     ADD 1 TO W-CTR-REC-KO.                                       00062020
062030*                                                                 00062030
062040     MOVE W-TIPO-REC-PREC     TO W-REC-PREC-V20.                  00062040
062050     MOVE BQVFB11-TIPO-RECORD TO W-TIPO-REC-PREC.                 00062050
062060*                                                                 00062060
062070*--- SI LEGGE IL RECORD SUCCESSIVO                                00062070
062080*                                                                 00062080
062090     READ BQVFB1 INTO BQVFB11 AT END                              00062090
062100          INITIALIZE BQVFB11                                      00062100
062110          MOVE 1 TO W-FINE-BQVFB1.                                00062110
062120                                                                  00062120
062130 RB-030.                                                          00062130
062140*--- SI CICLA FINO A FINE FILE O A QUANDO SI TROVA                00062140
062150*--- UN RECORD DI TESTA                                           00062150
062160     IF W-FINE-BQVFB1 NOT = 1 AND                                 00062160
062170        BQVFB11-TIPO-RECORD NOT = 'V00'                           00062170
062180        ADD 1 TO W-CTR-LETTI                                      00062180
062190        MOVE BQVFB11 TO BQVFB21                                   00062190
062200        MOVE ZERO TO BQVFB21-ERR-DATI-COMUNI                      00062200
062210        MOVE ZERO         TO BQVFB21-ANNO-TRASM                   00062210
062220        MOVE ZERO         TO BQVFB21-PROT-TRASM                   00062220
062230        MOVE ZERO         TO BQVFB21-PROG-REC                     00062230
062240        MOVE ZERO TO BQVFB21-ERR-RECORD-49                        00062240
062250        GO TO RB-020.                                             00062250
062260                                                                  00062260
062270 RB-040.                                                          00062270
062280     MOVE W-CTR-REC-KO TO BQVFB31-NUM-REC-TOT.                    00062280
062290*--- SI SCRIVE SU INVII IL RIEPILOGO DEL FLUSSO LETTO             00062290
062300*--- RIPORTANTE TRA L'ALTRO L'ESITO DEI CONTROLLI                 00062300
062310     WRITE BQVFB32 FROM BQVFB31.                                  00062310
062320     ADD 1 TO W-CTR-SCR-INVII.                                    00062320
062330     INITIALIZE BQVFB31.                                          00062330
062340                                                                  00062340
062350 RB-990-KO-EX.                                                    00062350
062360     EXIT.                                                        00062360
062370                                                                  00062370
062380*---                                                              00062380
062390*--- PERFORM RD-010-CONTR-SEQ - CONTROLLO DI SEQUENZA SUI RECORD  00062390
062400*---                                                              00062400
062410 RD-010-CONTR-SEQ.                                                00062410
062420     IF W-TIPO-REC-PREC           = 'V00'         AND             00062420
062430        ((BQVFB11-TIPO-RECORD NOT = 'V00' AND                     00062430
062440          BQVFB11-TIPO-RECORD NOT = 'V01' AND                     00062440
062450          BQVFB11-TIPO-RECORD NOT = 'V02' AND                     00062450
062460          BQVFB11-TIPO-RECORD NOT = 'V03' AND                     00062460
062470          BQVFB11-TIPO-RECORD NOT = 'V04' AND                     00062470
062480          BQVFB11-TIPO-RECORD NOT = 'V05' AND                     00062480
062490          BQVFB11-TIPO-RECORD NOT = 'V06' AND                     00062490
062500          BQVFB11-TIPO-RECORD NOT = 'V07' AND                     00062500
062510          BQVFB11-TIPO-RECORD NOT = 'V12' AND                     00062510
062520          BQVFB11-TIPO-RECORD NOT = 'V20' AND                     00062520
062530          BQVFB11-TIPO-RECORD NOT = 'V99'    ) OR                 00062530
062540         (BQVFB11-TIPO-RECORD     = 'V99' AND                     00062540
062550          W-APPO-TIPO-INVIO   NOT = 'A'      ) OR                 00062550
062560         (BQVFB11-TIPO-RECORD NOT = 'V99' AND                     00062560
062570          W-APPO-TIPO-INVIO       = 'A'      )   )                00062570
062580        MOVE 1 TO W-FLAG-ERR-SEQ                                  00062580
062590        GO TO RD-990-CONTR-SEQ-EX.                                00062590
062600                                                                  00062600
062610 RD-020.                                                          00062610
062620     IF W-TIPO-REC-PREC         = 'V01' AND                       00062620
062630        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00062630
062640        BQVFB11-TIPO-RECORD NOT = 'V01' AND                       00062640
062650        BQVFB11-TIPO-RECORD NOT = 'V02' AND                       00062650
062660        BQVFB11-TIPO-RECORD NOT = 'V03' AND                       00062660
062670        BQVFB11-TIPO-RECORD NOT = 'V04' AND                       00062670
062680        BQVFB11-TIPO-RECORD NOT = 'V05' AND                       00062680
062690        BQVFB11-TIPO-RECORD NOT = 'V06' AND                       00062690
062700        BQVFB11-TIPO-RECORD NOT = 'V07' AND                       00062700
062710        BQVFB11-TIPO-RECORD NOT = 'V14' AND                       00062710
062720        BQVFB11-TIPO-RECORD NOT = 'V15' AND                       00062720
062730        BQVFB11-TIPO-RECORD NOT = 'V36'                           00062730
062740        MOVE 1 TO W-FLAG-ERR-SEQ                                  00062740
062750        GO TO RD-990-CONTR-SEQ-EX.                                00062750
062760                                                                  00062760
062770 RD-030.                                                          00062770
062780     IF W-TIPO-REC-PREC         = 'V02' AND                       00062780
062790        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00062790
062800        BQVFB11-TIPO-RECORD NOT = 'V02' AND                       00062800
062810        BQVFB11-TIPO-RECORD NOT = 'V03' AND                       00062810
062820        BQVFB11-TIPO-RECORD NOT = 'V04' AND                       00062820
062830        BQVFB11-TIPO-RECORD NOT = 'V05' AND                       00062830
062840        BQVFB11-TIPO-RECORD NOT = 'V06' AND                       00062840
062850        BQVFB11-TIPO-RECORD NOT = 'V07' AND                       00062850
062860        BQVFB11-TIPO-RECORD NOT = 'V14' AND                       00062860
062870        BQVFB11-TIPO-RECORD NOT = 'V15' AND                       00062870
062880        BQVFB11-TIPO-RECORD NOT = 'V36'                           00062880
062890        MOVE 1 TO W-FLAG-ERR-SEQ                                  00062890
062900        GO TO RD-990-CONTR-SEQ-EX.                                00062900
062910                                                                  00062910
062920 RD-040.                                                          00062920
062930     IF W-TIPO-REC-PREC         = 'V03' AND                       00062930
062940        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00062940
062950        BQVFB11-TIPO-RECORD NOT = 'V03' AND                       00062950
062960        BQVFB11-TIPO-RECORD NOT = 'V04' AND                       00062960
062970        BQVFB11-TIPO-RECORD NOT = 'V05' AND                       00062970
062980        BQVFB11-TIPO-RECORD NOT = 'V06' AND                       00062980
062990        BQVFB11-TIPO-RECORD NOT = 'V07' AND                       00062990
063000        BQVFB11-TIPO-RECORD NOT = 'V14' AND                       00063000
063010        BQVFB11-TIPO-RECORD NOT = 'V15' AND                       00063010
063020        BQVFB11-TIPO-RECORD NOT = 'V36'                           00063020
063030        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063030
063040        GO TO RD-990-CONTR-SEQ-EX.                                00063040
063050                                                                  00063050
063060 RD-042.                                                          00063060
063070     IF W-TIPO-REC-PREC         = 'V04' AND                       00063070
063080        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00063080
063090        BQVFB11-TIPO-RECORD NOT = 'V04' AND                       00063090
063100        BQVFB11-TIPO-RECORD NOT = 'V05' AND                       00063100
063110        BQVFB11-TIPO-RECORD NOT = 'V06' AND                       00063110
063120        BQVFB11-TIPO-RECORD NOT = 'V07' AND                       00063120
063130        BQVFB11-TIPO-RECORD NOT = 'V14' AND                       00063130
063140        BQVFB11-TIPO-RECORD NOT = 'V15' AND                       00063140
063150        BQVFB11-TIPO-RECORD NOT = 'V36'                           00063150
063160        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063160
063170        GO TO RD-990-CONTR-SEQ-EX.                                00063170
063180                                                                  00063180
063190 RD-044.                                                          00063190
063200     IF W-TIPO-REC-PREC         = 'V05' AND                       00063200
063210        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00063210
063220        BQVFB11-TIPO-RECORD NOT = 'V05' AND                       00063220
063230        BQVFB11-TIPO-RECORD NOT = 'V06' AND                       00063230
063240*       BQVFB11-TIPO-RECORD NOT = 'V07' AND                       00063240
063250        BQVFB11-TIPO-RECORD NOT = 'V14' AND                       00063250
063260        BQVFB11-TIPO-RECORD NOT = 'V15' AND                       00063260
063270        BQVFB11-TIPO-RECORD NOT = 'V36'                           00063270
063280        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063280
063290        GO TO RD-990-CONTR-SEQ-EX.                                00063290
063300                                                                  00063300
063310 RD-046.                                                          00063310
063320     IF W-TIPO-REC-PREC         = 'V06' AND                       00063320
063330        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00063330
063340        BQVFB11-TIPO-RECORD NOT = 'V06' AND                       00063340
063350*       BQVFB11-TIPO-RECORD NOT = 'V07' AND                       00063350
063360        BQVFB11-TIPO-RECORD NOT = 'V14' AND                       00063360
063370        BQVFB11-TIPO-RECORD NOT = 'V15' AND                       00063370
063380        BQVFB11-TIPO-RECORD NOT = 'V36'                           00063380
063390        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063390
063400        GO TO RD-990-CONTR-SEQ-EX.                                00063400
063410                                                                  00063410
063420 RD-048.                                                          00063420
063430     IF W-TIPO-REC-PREC         = 'V07' AND                       00063430
063440        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00063440
063450        BQVFB11-TIPO-RECORD NOT = 'V07' AND                       00063450
063460        BQVFB11-TIPO-RECORD NOT = 'V14' AND                       00063460
063470        BQVFB11-TIPO-RECORD NOT = 'V15' AND                       00063470
063480        BQVFB11-TIPO-RECORD NOT = 'V36'                           00063480
063490        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063490
063500        GO TO RD-990-CONTR-SEQ-EX.                                00063500
063510                                                                  00063510
063520 RD-049.                                                          00063520
063530     IF W-TIPO-REC-PREC         = 'V12' AND                       00063530
063540        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00063540
063550        BQVFB11-TIPO-RECORD NOT = 'V12' AND                       00063550
063560        BQVFB11-TIPO-RECORD NOT = 'V14' AND                       00063560
063570        BQVFB11-TIPO-RECORD NOT = 'V15' AND                       00063570
063580        BQVFB11-TIPO-RECORD NOT = 'V36'                           00063580
063590        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063590
063600        GO TO RD-990-CONTR-SEQ-EX.                                00063600
063610                                                                  00063610
063620 RD-050.                                                          00063620
063630     IF (W-TIPO-REC-PREC         = 'V14' OR                       00063630
063640         W-TIPO-REC-PREC         = 'V15'   ) AND                  00063640
063650        BQVFB11-TIPO-RECORD NOT = 'V00'      AND                  00063650
063660        BQVFB11-TIPO-RECORD NOT = 'V36'                           00063660
063670        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063670
063680        GO TO RD-990-CONTR-SEQ-EX.                                00063680
063690                                                                  00063690
063700 RD-055.                                                          00063700
063710     IF W-TIPO-REC-PREC         = 'V20' AND                       00063710
063720        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00063720
063730        BQVFB11-TIPO-RECORD NOT = 'V36'                           00063730
063740        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063740
063750        GO TO RD-990-CONTR-SEQ-EX.                                00063750
063760                                                                  00063760
063770 RD-060.                                                          00063770
063780     IF W-TIPO-REC-PREC         = 'V36' AND                       00063780
063790        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00063790
063800        BQVFB11-TIPO-RECORD NOT = 'V01' AND                       00063800
063810        BQVFB11-TIPO-RECORD NOT = 'V02' AND                       00063810
063820        BQVFB11-TIPO-RECORD NOT = 'V03' AND                       00063820
063830        BQVFB11-TIPO-RECORD NOT = 'V04' AND                       00063830
063840        BQVFB11-TIPO-RECORD NOT = 'V05' AND                       00063840
063850        BQVFB11-TIPO-RECORD NOT = 'V06' AND                       00063850
063860        BQVFB11-TIPO-RECORD NOT = 'V07' AND                       00063860
063870        BQVFB11-TIPO-RECORD NOT = 'V12' AND                       00063870
063880        BQVFB11-TIPO-RECORD NOT = 'V20' AND                       00063880
063890        BQVFB11-TIPO-RECORD NOT = 'V37' AND                       00063890
063900        BQVFB11-TIPO-RECORD NOT = 'V38'                           00063900
063910        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063910
063920        GO TO RD-990-CONTR-SEQ-EX.                                00063920
063930                                                                  00063930
063940 RD-070.                                                          00063940
063950     IF W-TIPO-REC-PREC         = 'V37' AND                       00063950
063960        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00063960
063970        BQVFB11-TIPO-RECORD NOT = 'V37' AND                       00063970
063980        BQVFB11-TIPO-RECORD NOT = 'V38'                           00063980
063990        MOVE 1 TO W-FLAG-ERR-SEQ                                  00063990
064000        GO TO RD-990-CONTR-SEQ-EX.                                00064000
064010                                                                  00064010
064020 RD-072.                                                          00064020
064030     IF W-TIPO-REC-PREC         = 'V37' AND                       00064030
064040        BQVFB11-TIPO-RECORD     = 'V38'                           00064040
064050        MOVE 0 TO W-PROG-ACCR-BON                                 00064050
064060        GO TO RD-990-CONTR-SEQ-EX.                                00064060
064070                                                                  00064070
064080 RD-080.                                                          00064080
064090     IF W-TIPO-REC-PREC         = 'V38' AND                       00064090
064100        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00064100
064110        BQVFB11-TIPO-RECORD NOT = 'V38' AND                       00064110
064120        BQVFB11-TIPO-RECORD NOT = 'V49' AND                       00064120
064130        BQVFB11-TIPO-RECORD NOT = 'V99'                           00064130
064140        MOVE 1 TO W-FLAG-ERR-SEQ                                  00064140
064150        GO TO RD-990-CONTR-SEQ-EX.                                00064150
064160                                                                  00064160
064170 RD-090.                                                          00064170
064180     IF W-TIPO-REC-PREC         = 'V49' AND                       00064180
064190        BQVFB11-TIPO-RECORD NOT = 'V00' AND                       00064190
064200        BQVFB11-TIPO-RECORD NOT = 'V49' AND                       00064200
064210        BQVFB11-TIPO-RECORD NOT = 'V99'                           00064210
064220        MOVE 1 TO W-FLAG-ERR-SEQ                                  00064220
064230        GO TO RD-990-CONTR-SEQ-EX.                                00064230
064240                                                                  00064240
064250 RD-100.                                                          00064250
064260     IF W-TIPO-REC-PREC         = 'V99' AND                       00064260
064270        BQVFB11-TIPO-RECORD NOT = 'V00'                           00064270
064280        MOVE 1 TO W-FLAG-ERR-SEQ                                  00064280
064290        MOVE 1 TO W-FLAG-KO                                       00064290
064300        GO TO RD-990-CONTR-SEQ-EX.                                00064300
064310                                                                  00064310
064320 RD-990-CONTR-SEQ-EX.                                             00064320
064330     EXIT.                                                        00064330
064340                                                                  00064340
064350*---                                                              00064350
064360*--- PERFORM RE-010-CONTR-COMUNI - CONTROLLI SUI CAMPI COMUNI     00064360
064370*--- A VARI TIPI RECORD                                           00064370
064380*---                                                              00064380
064390 RE-010-CONTR-COMUNI.                                             00064390
064400*--- SI CONTROLLA IL CODICE ABI                                   00064400
064410     IF BQVFB11-COD-ABIA IS NUMERIC AND                           00064410
064420        BQVFB11-COD-ABI = W-APPO-COD-ABI                          00064420
064430        GO TO RE-030.                                             00064430
064440                                                                  00064440
064450 RE-020.                                                          00064450
064460*--- ERRORE DI DISCORDANZA CON RECORD DI TESTA                    00064460
064470     MOVE 502 TO BQVFB21-ERR-COD-ABI.                             00064470
064480     MOVE 'E' TO BQVFB21-ERR-COD-ABI-A.                           00064480
064490     ADD 1    TO W-CTR-BLOC.                                      00064490
064500     MOVE 1   TO W-FLAG-ERR-SEQ.                                  00064500
064510     IF BQVFB21-ERR-TIPO-RECORD-A = 'W'                           00064510
064520        SUBTRACT  1 FROM W-CTR-NO-BLOC.                           00064520
064530     IF BQVFB21-ERR-TIPO-RECORD-A NOT = 'E'                       00064530
064540        MOVE 502 TO BQVFB21-ERR-TIPO-RECORD                       00064540
064550        ADD 1    TO W-CTR-BLOC                                    00064550
064560        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                    00064560
064570                                                                  00064570
064580 RE-030.                                                          00064580
064590*--- SI CONTROLLA LA DATA DI BONIFICO                             00064590
064600     IF BQVFB11-DATA-BONIF = W-APPO-DATA-BON                      00064600
064610        GO TO RE-050.                                             00064610
064620                                                                  00064620
064630 RE-040.                                                          00064630
064640*--- ERRORE DI DISCORDANZA CON RECORD DI TESTA                    00064640
064650     MOVE 502 TO BQVFB21-ERR-DATA-BONIF.                          00064650
064660     MOVE 'E' TO BQVFB21-ERR-DATA-BONIF-A.                        00064660
064670     ADD 1 TO W-CTR-BLOC.                                         00064670
064680     MOVE 1   TO W-FLAG-ERR-SEQ.                                  00064680
064690     IF BQVFB21-ERR-TIPO-RECORD-A = 'W'                           00064690
064700        SUBTRACT 1  FROM W-CTR-NO-BLOC.                           00064700
064710     IF BQVFB21-ERR-TIPO-RECORD-A NOT = 'E'                       00064710
064720        MOVE 502 TO BQVFB21-ERR-TIPO-RECORD                       00064720
064730        ADD 1    TO W-CTR-BLOC                                    00064730
064740        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                    00064740
064750                                                                  00064750
064760 RE-050.                                                          00064760
064770*--- SI CONTROLLA SE TIPO RECORD 37, 38, 49 E 99                  00064770
064780     IF BQVFB11-TIPO-RECORD > 'V36'                               00064780
064790        GO TO RE-120.                                             00064790
064800                                                                  00064800
064810 RE-052.                                                          00064810
064820*--- SI CONTROLLA IL PROGRESSIVO DELEGA PER I RECORD 01,...,36    00064820
064830     IF BQVFB11-01-PROG-DELEGAA NUMERIC                           00064830
064840        GO TO RE-060.                                             00064840
064850                                                                  00064850
064860 RE-054.                                                          00064860
064870*--- ERRORE DI NUMERICITA' DEL PROGRESSIVO DELEGA                 00064870
064880     MOVE 33 TO BQVFB21-01-ERR-PROG-DELEGA.                       00064880
064890     MOVE 'E' TO BQVFB21-01-ERR-PROG-DELEGA-A.                    00064890
064900     ADD 1 TO W-CTR-BLOC.                                         00064900
064910     GO TO RE-130.                                                00064910
064920                                                                  00064920
064930 RE-060.                                                          00064930
064940*--- SI CONTROLLA LA VALIDITA' DEL PROGRESSIVO DELEGA             00064940
064950     IF BQVFB11-01-PROG-DELEGA NOT = ZERO                         00064950
064960        GO TO RE-080.                                             00064960
064970                                                                  00064970
064980 RE-070.                                                          00064980
064990*--- ERRORE DI VALIDITA' DEL PROGRESSIVO DELEGA                   00064990
065000     MOVE 39 TO BQVFB21-01-ERR-PROG-DELEGA.                       00065000
065010     MOVE 'E' TO BQVFB21-01-ERR-PROG-DELEGA-A.                    00065010
065020     ADD 1 TO W-CTR-BLOC.                                         00065020
065030     GO TO RE-130.                                                00065030
065040                                                                  00065040
065050 RE-080.                                                          00065050
065060*--- SI CONTROLLA LA SEQUENZIALITA' DEL PROGRESSIVO DELEGA        00065060
065070     IF BQVFB11-01-PROG-DELEGA = W-CTR-DELEGA                     00065070
065080        GO TO RE-130.                                             00065080
065090                                                                  00065090
065100 RE-090.                                                          00065100
065110     IF W-FLAG-CAMBIO-DELEGA = 1                                  00065110
065120        GO TO RE-110.                                             00065120
065130                                                                  00065130
065140 RE-100.                                                          00065140
065150     IF W-ERR-DELEGA-PREC EQUAL 506                               00065150
065160        GO TO RE-130.                                             00065160
065170 RE-105.                                                          00065170
065180*--- ERRORE DI OMOGENEITA' DEL PROGRESSIVO DELEGA                 00065180
065190     MOVE 509 TO BQVFB21-01-ERR-PROG-DELEGA.                      00065190
065200     MOVE 'E' TO BQVFB21-01-ERR-PROG-DELEGA-A.                    00065200
065210     ADD 1 TO W-CTR-BLOC.                                         00065210
065220     MOVE BQVFB11-01-PROG-DELEGA TO W-CTR-DELEGA.                 00065220
065230     GO TO RE-130.                                                00065230
065240                                                                  00065240
065250 RE-110.                                                          00065250
065260*--- ERRORE DI SEQUENZIALITA' DEL PROGRESSIVO DELEGA              00065260
065270     MOVE 506 TO BQVFB21-01-ERR-PROG-DELEGA.                      00065270
065280     MOVE 506 TO W-ERR-DELEGA-PREC.                               00065280
065290     MOVE 'E' TO BQVFB21-01-ERR-PROG-DELEGA-A.                    00065290
065300     ADD 1 TO W-CTR-BLOC.                                         00065300
065310     MOVE BQVFB11-01-PROG-DELEGA TO W-CTR-DELEGA.                 00065310
065320     GO TO RE-130.                                                00065320
065330                                                                  00065330
065340 RE-120.                                                          00065340
065350*--- SI CONTROLLA IL PROGRESSIVO DELEGA PER I RECORD 37, 38, 49   00065350
065360*--- E 99                                                         00065360
065370     IF BQVFB11-01-PROG-DELEGAA NOT = '999999'                    00065370
065380        MOVE 55  TO BQVFB21-01-ERR-PROG-DELEGA                    00065380
065390        MOVE 'E' TO BQVFB21-01-ERR-PROG-DELEGA-A                  00065390
065400        ADD 1    TO W-CTR-BLOC.                                   00065400
065410                                                                  00065410
065420 RE-130.                                                          00065420
065430     IF BQVFB21-01-ERR-PROG-DELEGA NOT = ZERO AND                 00065430
065440        BQVFB21-ERR-TIPO-RECORD-A = 'W'                           00065440
065450        SUBTRACT 1  FROM W-CTR-NO-BLOC.                           00065450
065460     IF BQVFB21-01-ERR-PROG-DELEGA NOT = ZERO AND                 00065460
065470        BQVFB21-ERR-TIPO-RECORD-A NOT = 'E'                       00065470
065480        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00065480
065490        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00065490
065500        ADD   1  TO W-CTR-BLOC.                                   00065500
065510*--- PER RECORD DI TIPO 49 SI PASSA AL CONTROLLO DEL CF           00065510
065520     IF BQVFB11-TIPO-RECORD = 'V49'                               00065520
065530            PERFORM C9-010-CONTR-V49 THRU C9-990-EXIT             00065530
065540            GO TO RE-990-CONTR-COMUNI-EX.                         00065540
065550*--- PER RECORD DI TIPO 99 SI TERMINANO I CONTROLLI COMUNI        00065550
065560     IF BQVFB11-TIPO-RECORD = 'V99'                               00065560
065570        GO TO RE-990-CONTR-COMUNI-EX.                             00065570
065580                                                                  00065580
065590 RE-131.                                                          00065590
065600     IF W-FLAG-CAMBIO-DELEGA = 1                                  00065600
065610        MOVE ZERO TO W-FLAG-CAMBIO-DELEGA.                        00065610
065620     IF BQVFB11-TIPO-RECORD < 'V14' OR                            00065620
065630        BQVFB11-TIPO-RECORD = 'V20'                               00065630
065640        GO TO RE-134.                                             00065640
065650                                                                  00065650
065660 RE-132.                                                          00065660
065670*--- SI CONTROLLA IL PROGRESSIVO RIGA PER I RECORD > 6            00065670
065680     IF BQVFB11-01-PROG-RIGAA NOT NUMERIC OR                      00065680
065690        BQVFB11-01-PROG-RIGA  NOT = ZERO                          00065690
065700        MOVE 55 TO BQVFB21-01-ERR-PROG-RIGA                       00065700
065710        MOVE 'E' TO BQVFB21-01-ERR-PROG-RIGA-A                    00065710
065720        ADD 1 TO W-CTR-BLOC.                                      00065720
065730     GO TO RE-210.                                                00065730
065740                                                                  00065740
065750 RE-134.                                                          00065750
065760*--- SI CONTROLLA IL PROGRESSIVO RIGA PER I RECORD 1, 2, 3, 4, 5 E00065760
065770     IF BQVFB11-01-PROG-RIGAA NUMERIC                             00065770
065780        GO TO RE-150.                                             00065780
065790                                                                  00065790
065800 RE-140.                                                          00065800
065810*--- ERRORE DI NUMERICITA' DEL PROGRESSIVO RIGA                   00065810
065820     MOVE 33 TO BQVFB21-01-ERR-PROG-RIGA.                         00065820
065830     MOVE 'E' TO BQVFB21-01-ERR-PROG-RIGA-A.                      00065830
065840     ADD 1 TO W-CTR-BLOC.                                         00065840
065850     GO TO RE-210.                                                00065850
065860                                                                  00065860
065870 RE-150.                                                          00065870
065880*--- SI CONTROLLA LA VALIDITA' DEL PROGRESSIVO RIGA               00065880
065890     IF BQVFB11-01-PROG-RIGA NOT = ZERO                           00065890
065900        GO TO RE-170.                                             00065900
065910                                                                  00065910
065920 RE-160.                                                          00065920
065930*--- ERRORE DI VALIDITA' DEL PROGRESSIVO RIGA                     00065930
065940     MOVE 39 TO BQVFB21-01-ERR-PROG-RIGA.                         00065940
065950     MOVE 'E' TO BQVFB21-01-ERR-PROG-RIGA-A.                      00065950
065960     ADD 1 TO W-CTR-BLOC.                                         00065960
065970     GO TO RE-210.                                                00065970
065980                                                                  00065980
065990 RE-170.                                                          00065990
066000*--- SI CONTROLLA L'AMMISSIBILITA' DEL PROGRESSIVO RIGA           00066000
066010*    IF W-APPO-CTR NOT > W-PROG-RIGA                              00066010
066020*       GO TO RE-190.                                             00066020
066030*                                                                 00066030
066040*RE-180.                                                          00066040
066050*--- ERRORE DI AMMISSIBILITA' DEL PROGRESSIVO RIGA                00066050
066060*    MOVE 96 TO BQVFB21-01-ERR-PROG-RIGA.                         00066060
066070*    MOVE 'E' TO BQVFB21-01-ERR-PROG-RIGA-A.                      00066070
066080*    ADD 1 TO W-CTR-BLOC.                                         00066080
066090*    IF BQVFB21-ERR-TIPO-RECORD-A EQUAL 'W'                       00066090
066100*      SUBTRACT 1  FROM W-CTR-NO-BLOC.                            00066100
066110*    IF BQVFB21-ERR-TIPO-RECORD-A NOT EQUAL 'E'                   00066110
066120*      MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                        00066120
066130*      MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                      00066130
066140*      ADD 1 TO W-CTR-BLOC.                                       00066140
066150*    GO TO RE-210.                                                00066150
066160*                                                                 00066160
066170*RE-190.                                                          00066170
066180     IF BQVFB11-01-PROG-RIGA = W-CTR-RIGA                         00066180
066190        GO TO RE-210.                                             00066190
066200                                                                  00066200
066210 RE-200.                                                          00066210
066220*--- ERRORE DI SEQUENZIALITA' DEL PROGRESSIVO RIGA                00066220
066230     MOVE 508 TO BQVFB21-ERR-TIPO-RECORD.                         00066230
066240     MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                       00066240
066250     MOVE 1   TO W-FLAG-ERR-SEQ.                                  00066250
066260     ADD 1 TO W-CTR-BLOC.                                         00066260
066270                                                                  00066270
066280 RE-210.                                                          00066280
066290*--- SI CONTROLLA SE TIPO RECORD 08                               00066290
066300     IF BQVFB11-TIPO-RECORD = 'V38'                               00066300
066310        GO TO RE-299.                                             00066310
066320                                                                  00066320
066330 RE-212.                                                          00066330
066340*--- SI CONTROLLA SE TIPO RECORD 07                               00066340
066350     IF BQVFB11-TIPO-RECORD = 'V37'                               00066350
066360        GO TO RE-291.                                             00066360
066370                                                                  00066370
066380 RE-214.                                                          00066380
066390*--- SI CONTROLLA L'OMOGENEITA' DELLA PROVINCIA                   00066390
066400     IF BQVFB11-01-SIGLA-PROV = W-APPO-SIGLA-PROV AND             00066400
066410        W-CTR-RIGA NOT = 1                                        00066410
066420        GO TO RE-290.                                             00066420
066430                                                                  00066430
066440 RE-220.                                                          00066440
066450     IF W-APPO-ERR-SIGLA-PROV = ZERO AND                          00066450
066460        W-CTR-RIGA NOT = 1                                        00066460
066470        GO TO RE-280.                                             00066470
066480                                                                  00066480
066490 RE-222.                                                          00066490
066500     IF W-CTR-RIGA = 1                                            00066500
066510        MOVE BQVFB11-01-SIGLA-PROV TO W-APPO-SIGLA-PROV.          00066510
066520                                                                  00066520
066530 RE-230.                                                          00066530
066540*--- SI CONTROLLA L'ESISTENZA DELLA PROVINCIA IN ARCHIVIO         00066540
066550     MOVE BQVFB11-01-SIGLA-PROV TO W-PROV-INP.                    00066550
066560     PERFORM RR-010-RIC-PROV   THRU RR-990-RIC-PROV-EX.           00066560
066570     IF W-FLAG-TROVATO = 1                                        00066570
066580        GO TO RE-300.                                             00066580
066590                                                                  00066590
066600 RE-240.                                                          00066600
066610*--- ERRORE DI ESISTENZA DELLA PROVINCIA                          00066610
066620     MOVE 119 TO BQVFB21-01-ERR-SIGLA-PROV.                       00066620
066630     MOVE 'E' TO BQVFB21-01-ERR-SIGLA-PROV-A.                     00066630
066640     ADD 1 TO W-CTR-BLOC.                                         00066640
066650     IF W-CTR-RIGA = 1                                            00066650
066660        MOVE 119 TO W-APPO-ERR-SIGLA-PROV.                        00066660
066670     GO TO RE-300.                                                00066670
066680                                                                  00066680
066690 RE-280.                                                          00066690
066700*--- ERRORE DI OMOGENEITA' DELLA PROVINCIA                        00066700
066710     MOVE 509 TO BQVFB21-01-ERR-SIGLA-PROV.                       00066710
066720     MOVE 'E' TO BQVFB21-01-ERR-SIGLA-PROV-A.                     00066720
066730     ADD 1 TO W-CTR-BLOC.                                         00066730
066740     GO TO RE-300.                                                00066740
066750                                                                  00066750
066760 RE-290.                                                          00066760
066770     MOVE W-APPO-ERR-SIGLA-PROV TO BQVFB21-01-ERR-SIGLA-PROV.     00066770
066780     IF W-APPO-ERR-SIGLA-PROV NOT = ZERO                          00066780
066790        MOVE 'E' TO BQVFB21-01-ERR-SIGLA-PROV-A                   00066790
066800        ADD 1 TO W-CTR-BLOC.                                      00066800
066810     GO TO RE-300.                                                00066810
066820                                                                  00066820
066830 RE-291.                                                          00066830
066840*--- SI CONTROLLA L'OMOGENEITA' DELLA PROVINCIA PER RECORD 37     00066840
066850     IF BQVFB11-01-SIGLA-PROV = W-MEM-SIGLA-PROV                  00066850
066860        GO TO RE-298.                                             00066860
066870                                                                  00066870
066880 RE-292.                                                          00066880
066890*--- AL CAMBIO DI PROVINCIA SI PASSA ALLA PERFORM PER IL          00066890
066900*--- TRATTAMENTO DELLE QUADRATURE E PER LA SCRITTURA SU           00066900
066910*--- ESITI DEI RECORD MEMORIZZATI                                 00066910
066920     IF W-MEM-SIGLA-PROV NOT = SPACE                              00066920
066930        PERFORM RG-010-QUADR THRU RG-990-QUADR-EX.                00066930
066940     MOVE 0 TO W-CTR-ACCR-BON.                                    00066940
066950     SET S TO 1.                                                  00066950
066960     SEARCH W-EL-SALDI                                            00066960
066970     WHEN W-PROV(S) = BQVFB11-01-SIGLA-PROV                       00066970
066980          MOVE 1 TO W-CTR-ACCR-BON.                               00066980
066990     IF W-CTR-ACCR-BON = 1                                        00066990
067000        GO TO RE-294.                                             00067000
067010                                                                  00067010
067020 RE-293.                                                          00067020
067030*--- ERRORE PER PROVINCIA NON TROVATA SULLA TABELLA DEI SALDI     00067030
067040*--- O PER PROVINCIA PRESENTE MA NON TRATTATA DA RECORD V01       00067040
067050     MOVE 1 TO W-PROG-ACCR-BON.                                   00067050
067060     MOVE 1 TO W-FLAG-NO-QUAD.                                    00067060
067070     MOVE 506 TO BQVFB21-01-ERR-SIGLA-PROV.                       00067070
067080     MOVE 'E' TO BQVFB21-01-ERR-SIGLA-PROV-A.                     00067080
067090     ADD 1 TO W-CTR-BLOC.                                         00067090
067100     GO TO RE-300.                                                00067100
067110                                                                  00067110
067120 RE-294.                                                          00067120
067130*--- SI CARICA LA TABELLE DI APPOGGIO DELLE PROVINCE TRATTATE     00067130
067140*--- E PER PROVINCIA GIA' TRATTATA SI IMPOSTA IL FLAG PER NON     00067140
067150*--- ESEGUIRE LE QUADRATURE                                       00067150
067160     SET P TO 1.                                                  00067160
067170     SEARCH W-EL-APPO-PROV                                        00067170
067180     AT END ADD 1 TO W-P                                          00067180
067190            MOVE BQVFB11-01-SIGLA-PROV TO W-APPO-PROV(W-P)        00067190
067200     WHEN W-APPO-PROV(P) = BQVFB11-01-SIGLA-PROV                  00067200
067210          MOVE 1 TO W-FLAG-NO-QUAD.                               00067210
067220     MOVE 1 TO W-PROG-ACCR-BON.                                   00067220
067230     IF BQVFB11-01-SIGLA-PROV < W-MEM-SIGLA-PROV                  00067230
067240*--- ERRORE PER PROVINCIA NON IN ORDINE CRESCENTE                 00067240
067250        GO TO RE-296.                                             00067250
067260                                                                  00067260
067270 RE-295.                                                          00067270
067280     MOVE BQVFB11-01-SIGLA-PROV TO W-MEM-SIGLA-PROV.              00067280
067290     GO TO RE-300.                                                00067290
067300                                                                  00067300
067310 RE-296.                                                          00067310
067320     ADD 1 TO W-CTR-BLOC.                                         00067320
067330     MOVE 1 TO W-FLAG-NO-QUAD.                                    00067330
067340     IF BQVFB21-ERR-TIPO-RECORD-A  = 'W'                          00067340
067350        SUBTRACT 1 FROM W-CTR-NO-BLOC.                            00067350
067360     IF BQVFB21-ERR-TIPO-RECORD-A NOT = 'E'                       00067360
067370*--- ERRORE PER PROVINCIA NON IN ORDINE CRESCENTE                 00067370
067380        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00067380
067390        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A.                    00067390
067400     GO TO RE-300.                                                00067400
067410                                                                  00067410
067420 RE-298.                                                          00067420
067430     ADD 1 TO W-PROG-ACCR-BON.                                    00067430
067440     GO TO RE-300.                                                00067440
067450                                                                  00067450
067460 RE-299.                                                          00067460
067470     IF BQVFB11-01-SIGLA-PROV NOT = SPACE                         00067470
067480*--- ERRORE PER PROVINCIA IMPOSTATA SU RECORD 38                  00067480
067490        MOVE 55 TO BQVFB21-01-ERR-SIGLA-PROV                      00067490
067500        MOVE 'E' TO BQVFB21-01-ERR-SIGLA-PROV-A                   00067500
067510        ADD 1 TO W-CTR-BLOC.                                      00067510
067520                                                                  00067520
067530 RE-300.                                                          00067530
067540*--- SI CONTROLLA IL TIPO RECORD                                  00067540
067550     IF BQVFB11-TIPO-RECORD < 'V37'                               00067550
067560        GO TO RE-309.                                             00067560
067570                                                                  00067570
067580 RE-301.                                                          00067580
067590*--- SI CONTROLLA LA NUMERICITA' DEL PROGRESSIVO                  00067590
067600*--- ACCREDITAMENTO/BONIFICO PER RECORD 37 E 38                   00067600
067610     IF BQVFB11-01-PROG-ACCR-BONA NUMERIC                         00067610
067620        GO TO RE-303.                                             00067620
067630                                                                  00067630
067640 RE-302.                                                          00067640
067650*--- ERRORE DI NUMERICITA' DEL PROGRESSIVO                        00067650
067660*--- ACCREDITAMENTO/BONIFICO                                      00067660
067670     MOVE 33 TO BQVFB21-01-ERR-PROG-ACCR-BON.                     00067670
067680     MOVE 'E' TO BQVFB21-01-ERR-PROG-ACCR-BON-A.                  00067680
067690     ADD 1 TO W-CTR-BLOC.                                         00067690
067700     MOVE 1 TO W-FLAG-NO-QUAD.                                    00067700
067710     GO TO RE-308.                                                00067710
067720                                                                  00067720
067730 RE-303.                                                          00067730
067740*--- SI CONTROLLA LA CORRETTEZZA DEL PROGRESSIVO                  00067740
067750*--- ACCREDITAMENTO/BONIFICO                                      00067750
067760     IF (BQVFB11-01-PROG-ACCR-BON = 1    AND                      00067760
067770         BQVFB11-TIPO-RECORD      = 'V37'   ) OR                  00067770
067780        (BQVFB11-01-PROG-ACCR-BON > ZERO AND                      00067780
067790         BQVFB11-TIPO-RECORD      = 'V38'   )                     00067790
067800        GO TO RE-305.                                             00067800
067810                                                                  00067810
067820 RE-304.                                                          00067820
067830*--- ERRORE DI CORRETTEZZA DEL PROGRESSIVO                        00067830
067840*--- ACCREDITAMENTO/BONIFICO                                      00067840
067850     MOVE 39 TO BQVFB21-01-ERR-PROG-ACCR-BON.                     00067850
067860     MOVE 'E' TO BQVFB21-01-ERR-PROG-ACCR-BON-A.                  00067860
067870     ADD 1 TO W-CTR-BLOC.                                         00067870
067880     MOVE 1 TO W-FLAG-NO-QUAD.                                    00067880
067890     GO TO RE-308.                                                00067890
067900                                                                  00067900
067910 RE-305.                                                          00067910
067920*--- SI CONTROLLA LA SEQUENZIALITA' DEL PROGRESSIVO               00067920
067930*--- ACCREDITAMENTO/BONIFICO                                      00067930
067940     IF BQVFB11-01-PROG-ACCR-BON = W-PROG-ACCR-BON                00067940
067950        GO TO RE-308.                                             00067950
067960                                                                  00067960
067970 RE-306.                                                          00067970
067980*--- ERRORE DI SEQUENZIALITA' DEL PROGRESSIVO                     00067980
067990*--- ACCREDITAMENTO/BONIFICO                                      00067990
068000     IF BQVFB21-ERR-TIPO-RECORD-A     EQUAL 'W'                   00068000
068010        SUBTRACT  1  FROM W-CTR-NO-BLOC.                          00068010
068020     IF BQVFB21-ERR-TIPO-RECORD-A NOT EQUAL 'E'                   00068020
068030        MOVE 508 TO BQVFB21-ERR-TIPO-RECORD                       00068030
068040        MOVE 'E' TO BQVFB21-ERR-TIPO-RECORD-A                     00068040
068050        ADD 1  TO W-CTR-BLOC.                                     00068050
068060     MOVE 1 TO W-FLAG-ERR-SEQ.                                    00068060
068070     MOVE 1 TO W-FLAG-NO-QUAD.                                    00068070
068080                                                                  00068080
068090 RE-308.                                                          00068090
068100*--- PER RECORD DI TIPO 37 E 38 SI TERMINANO I CONTROLLI COMUNI   00068100
068110     GO TO RE-990-CONTR-COMUNI-EX.                                00068110
068120                                                                  00068120
068130 RE-309.                                                          00068130
068140*--- SI CONTROLLA LA CORRETTEZZA DEL PROGRESSIVO                  00068140
068150*--- ACCREDITAMENTO/BONIFICO PER RECORD 01, 02, 03, 04, 05, 06    00068150
068160*--- 14, 15 E 36                                                  00068160
068170     IF BQVFB11-01-PROG-ACCR-BONA NOT = '00'                      00068170
068180        MOVE 55 TO BQVFB21-01-ERR-PROG-ACCR-BON                   00068180
068190        MOVE 'W' TO BQVFB21-01-ERR-PROG-ACCR-BON-A                00068190
068200        ADD 1 TO W-CTR-NO-BLOC.                                   00068200
068210                                                                  00068210
068220 RE-310.                                                          00068220
068230     MOVE 0 TO W-FLAG-ERR1.                                       00068230
068240     MOVE 0 TO W-FLAG-OK2.                                        00068240
068250*--- SI CONTROLLA IL PRIMO CODICE FISCALE                         00068250
068260*--- DELLA DELEGA                                                 00068260
068270     IF W-CTR-RIGA = 1                                            00068270
068280        MOVE 0 TO W-APPO-FLAG-OK2                                 00068280
068290        MOVE BQVFB11-01-CODICE-FISC TO W-APPO-COD-FISC            00068290
068300        GO TO RE-460.                                             00068300
068310                                                                  00068310
068320 RE-420.                                                          00068320
068330*--- SI CONTROLLA IL CODICE FISCALE DIVERSO                       00068330
068340*--- DA QUELLO TROVATO SULLA PRIMA RIGA DELLA DELEGA              00068340
068350     IF BQVFB11-TIPO-RECORD = 'V20'                               00068350
068360        MOVE ZERO TO W-APPO-ERR-CF.                               00068360
068370     IF BQVFB11-01-CODICE-FISC NOT = W-APPO-COD-FISC AND          00068370
068380        W-APPO-ERR-CF NOT = ZERO                                  00068380
068390        GO TO RE-460.                                             00068390
068400                                                                  00068400
068410 RE-430.                                                          00068410
068420     MOVE 1 TO W-FLAG-ERR1.                                       00068420
068430*--- SI CONTROLLA L'OMOGENEITA' DEL CODICE FISCALE                00068430
068440     IF BQVFB11-01-CODICE-FISC NOT = W-APPO-COD-FISC AND          00068440
068450        W-APPO-ERR-CF = ZERO                                      00068450
068460        GO TO RE-450.                                             00068460
068470                                                                  00068470
068480 RE-440.                                                          00068480
068490*--- CODICE FISCALE UGUALE A QUELLO PRECEDENTE                    00068490
068500     MOVE W-APPO-ERR-CF TO BQVFB21-01-ERR-CODICE-FISC.            00068500
068510     MOVE W-APPO-FLAG-OK2 TO W-FLAG-OK2.                          00068510
068520     IF W-APPO-ERR-CF NOT = ZERO                                  00068520
068530        MOVE 'W' TO BQVFB21-01-ERR-CODICE-FISC-A                  00068530
068540        ADD 1 TO W-CTR-NO-BLOC.                                   00068540
068550     GO TO RE-460.                                                00068550
068560                                                                  00068560
068570 RE-450.                                                          00068570
068580*--- ERRORE DI OMOGENEITA' DEL CODICE FISCALE                     00068580
068590     MOVE 509 TO BQVFB21-01-ERR-CODICE-FISC.                      00068590
068600     MOVE 'E' TO BQVFB21-01-ERR-CODICE-FISC-A.                    00068600
068610     ADD 1 TO W-CTR-BLOC.                                         00068610
068620     MOVE SPACE TO W-PF-PNF.                                      00068620
068630     MOVE '2'   TO W-COD-FISC-KO.                                 00068630
068640     MOVE '2'   TO W-COD-FISC-KO-M.                               00068640
068650                                                                  00068650
068660 RE-460.                                                          00068660
068665*$-- INIZIO MODIFICA 13/12/2023 (CTRL CF P.F. SE MAIUSC/MINUSC.)  00068665
068666     IF (BQVFB11-01-FLAG-ERR-CF NOT = '1'                         00068666
068667      OR BQVFB11-01-FLAG-ERR-CF NOT =  1)                         00068667
068668     AND BQVFB11-TIPO-RECORD    NOT = 'V14'                       00068668
068669        IF  BQVFB11-01-CODICE-FISC(12:5) NOT = SPACES             00068669
068670        AND BQVFB11-01-CODICE-FISC(12:5) NOT = LOW-VALUE          00068670
068671            PERFORM S1-010-CTRL-CF THRU S1-990-EX                 00068671
068672        END-IF                                                    00068672
068673     END-IF.                                                      00068673
068675*                                                                 00068675
068678*$-- FINE MODIFICA                                                00068678
068679*--- SE IL RECORD V20 NON HA COD.FISC. OPPURE                     00068679
068680*--- ELABORO IL RECORD V36 RELATIVO AL V20                        00068680
068690*--- SALTO IL CONTROLLO                                           00068690
068700*--- INTERNET                                                     00068700
068710     IF   BQVFB11-TIPO-RECORD = 'V20'                             00068710
068720          MOVE BQVFB11-20-NUM-RIFERA TO W-APPO-NUM-RIF.           00068720
068730*                                                                 00068730
068740*** MODIFICA CONTRIBUTO UNIFICATO                                 00068740
068750     IF ( BQVFB11-TIPO-RECORD = 'V20' AND                         00068750
068760*F - INIZIO MODIFICA 13/08/2004 - INPDAP                          00068760
068770*F        (( W-APPO-SETTORE  NOT = '3'   AND                      00068770
068780*F           W-APPO-SETTORE  NOT = '5'   AND                      00068780
068790*F           W-APPO-SETTORE  NOT = '6')  AND                      00068790
068800        (((W-APPO-SETTORE  NOT = '3' OR                           00068800
068810          (W-APPO-SETTORE = '3' AND W-APPO-PRIMA-CIFRA GREATER 7))00068810
068820           AND W-APPO-SETTORE NOT = '5' AND NOT = '6') AND        00068820
068830*F - FINE MODIFICA 13/08/2004 - INPDAP                            00068830
068840*F MODIFICA 31/01/2005 - BOLLO AUTO                               00068840
068850                 (W-APPO-SETTORE NOT = '4' OR                     00068850
068860*F                W-APPO-PRIMA-CIFRA NOT = 8) )                   00068860
068870                  W-APPO-PRIMA-CIFRA LESS  8) )                   00068870
068880          AND                                                     00068880
068890        ( BQVFB11-01-CODICE-FISC = SPACES OR ZERO ) )             00068890
068900     OR                                                           00068900
068910*F - INIZIO MODIFICA 24/01/2005 - CODICE A BARRE                  00068910
068920        ( BQVFB11-TIPO-RECORD = 'V20' AND                         00068920
068930        ( BQVFB11-01-CODICE-FISC = SPACES OR ZERO ) AND           00068930
068940          BQVFB11-20-IDENT-PAGAM > 0) OR                          00068940
068950        ( BQVFB11-TIPO-RECORD = 'V36' AND                         00068950
068960          BQVFB11-36-MOD-CONFER = '4' AND                         00068960
068970          W-REC-PREC-V20     = 'V20'     ) OR                     00068970
068980*F - FINE MODIFICA 24/01/2005 - CODICE A BARRE                    00068980
068990        ( BQVFB11-TIPO-RECORD = 'V36' AND                         00068990
069000          BQVFB11-36-MOD-CONFER = '2' AND                         00069000
069010          W-REC-PREC-V20     = 'V20'     )                        00069010
069020          GO TO RE-710.                                           00069020
069030*** FINE MODIFICA CONTRIBUTO UNIFICATO                            00069030
069040 RE-461.                                                          00069040
069050     IF W-FLAG-ERR1 = 1                                           00069050
069060        GO TO RE-530.                                             00069060
069070                                                                  00069070
069080 RE-462.                                                          00069080
069090*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE FISCALE               00069090
069100     MOVE ZERO TO W-APPO-CF-11.                                   00069100
069110     MOVE ZERO TO W-FLAG-NO-BQVFB3.                               00069110
069120     MOVE 0 TO W-BQVFB3-COD-RIT.                                  00069120
069130     MOVE BQVFB11-01-CODICE-FISC TO W-APPO-CF.                    00069130
069140     IF W-APPO-CF-DX NOT = SPACE     AND                          00069140
069150        W-APPO-CF-DX NOT = LOW-VALUE AND                          00069150
069160        W-APPO-CF-DX NOT = HIGH-VALUE                             00069160
069170        GO TO RE-497.                                             00069170
069180                                                                  00069180
069190 RE-470.                                                          00069190
069200*--- CF DI 11 CARATTERI ALLINEATI A SINISTRA                      00069200
069210     MOVE 'PNF' TO W-PF-PNF.                                      00069210
069220     IF W-APPO-CF-SX NUMERIC         AND                          00069220
069230        W-APPO-CF-DX NOT = LOW-VALUE AND                          00069230
069240        W-APPO-CF-DX NOT = HIGH-VALUE                             00069240
069250        MOVE W-APPO-CF TO W-BQVFB3-COD-FISC                       00069250
069260        GO TO RE-482.                                             00069260
069270                                                                  00069270
069280 RE-480.                                                          00069280
069290*--- CF DI 11 CARATTERI ERRATO                                    00069290
069300     MOVE 1 TO W-BQVFB3-COD-RIT.                                  00069300
069310     GO TO RE-499.                                                00069310
069320                                                                  00069320
069330 RE-482.                                                          00069330
069340*F   MODIFICA DEL 19/09/2005: AGGIUNTO RANGE 900 - 950 (INCLUSI)  00069340
069350     MOVE W-BQVFB3-COD-FISC TO W-APPO-CF-11.                      00069350
069360     IF (W-APPO-CF-11-COD-UFF > 150 AND                           00069360
069370         W-APPO-CF-11-COD-UFF < 246    ) OR                       00069370
069380        (W-APPO-CF-11-COD-UFF > 300 AND                           00069380
069390         W-APPO-CF-11-COD-UFF < 767    ) OR                       00069390
069400        (W-APPO-CF-11-COD-UFF > 899 AND                           00069400
069410         W-APPO-CF-11-COD-UFF < 951    ) OR                       00069410
069420        W-APPO-CF-11-COD-UFF  = ZERO                              00069420
069430        MOVE 'PF '     TO W-PF-PNF.                               00069430
069440                                                                  00069440
069450 RE-490.                                                          00069450
069460*--- SE IL CODICE FISCALE NON E' ASSEGNATO NON ATTIVO LA ROUTINE  00069460
069470*--- E LO CONSIDERO VALIDO                                        00069470
069480     IF W-APPO-CF-11-COD-UFF  = ZERO AND                          00069480
069490        W-APPO-CF-11-PROG     > ZERO AND                          00069490
069500        W-APPO-CF-11-PROG     < 273961                            00069500
069510        MOVE 1 TO W-FLAG-NO-BQVFB3                                00069510
069520        GO TO RE-499.                                             00069520
069530                                                                  00069530
069540 RE-492.                                                          00069540
069550*--- SE IL CODICE UFFICIO O IL PROGRESSIVO NON SONO               00069550
069560*--- VALIDI NON ATTIVO LA ROUTINE E IMPOSTO L'ERRORE              00069560
069570     IF W-APPO-CF-11-COD-UFF = ZERO AND                           00069570
069580        ((W-APPO-CF-11-PROG > 0273960 AND                         00069580
069590          W-APPO-CF-11-PROG < 0400001   ) OR                      00069590
069600         (W-APPO-CF-11-PROG > 1072480 AND                         00069600
069610          W-APPO-CF-11-PROG < 1500001   ) OR                      00069610
069620         (W-APPO-CF-11-PROG > 1828636 AND                         00069620
069630          W-APPO-CF-11-PROG < 2000001   ) OR                      00069630
069640          W-APPO-CF-11-PROG > 2054095       )                     00069640
069650        MOVE 1    TO  W-BQVFB3-COD-RIT                            00069650
069660        GO TO RE-499.                                             00069660
069670                                                                  00069670
069680 RE-494.                                                          00069680
069690*--- SE IL CODICE UFFICIO NON E' VALIDO NON ATTIVO LA ROUTINE     00069690
069700*--- E IMPOSTO L'ERRORE                                           00069700
069710*F   MODIFICA DEL 19/09/2005: AGGIUNTO RANGE 900 - 950 (INCLUSI)  00069710
069720     IF ((W-APPO-CF-11-COD-UFF  > 100 AND                         00069720
069730          W-APPO-CF-11-COD-UFF  < 120    ) OR                     00069730
069740         (W-APPO-CF-11-COD-UFF  > 121 AND                         00069740
069750          W-APPO-CF-11-COD-UFF  < 151    ) OR                     00069750
069760         (W-APPO-CF-11-COD-UFF  > 245 AND                         00069760
069770          W-APPO-CF-11-COD-UFF  < 301    ) OR                     00069770
069780         (W-APPO-CF-11-COD-UFF  > 766 AND                         00069780
069790          W-APPO-CF-11-COD-UFF  NOT EQUAL 888 AND                 00069790
069800          W-APPO-CF-11-COD-UFF  < 900    ) OR                     00069800
069810         (W-APPO-CF-11-COD-UFF  > 950 AND                         00069810
069820          W-APPO-CF-11-COD-UFF  NOT EQUAL 999)                    00069820
069830          AND W-APPO-CF-11-PROG   < 8000000)                      00069830
069840     OR                                                           00069840
069850        W-APPO-CF-11-PROG      = ZERO                             00069850
069860        MOVE 1 TO W-BQVFB3-COD-RIT                                00069860
069870        GO TO RE-499.                                             00069870
069880                                                                  00069880
069890 RE-496.                                                          00069890
069900*--- SE IL CF E' P. IVA E IL PROGRESSIVO NON E' VALIDO NON        00069900
069910*--- ATTIVO LA ROUTINE E IMPOSTO L'ERRORE                         00069910
069920     IF W-APPO-CF-11-COD-UFF >  95 AND                            00069920
069930        W-APPO-CF-11-PROG  NOT < 8000000                          00069930
069940        MOVE 1 TO W-BQVFB3-COD-RIT.                               00069940
069950     GO TO RE-499.                                                00069950
069960                                                                  00069960
069970 RE-497.                                                          00069970
069980*---                                                              00069980
069990*--- CODICE FISCALE DI 16 CARATTERI                               00069990
070000*--- MODIFICATO PERCHE' CONTROLLI ANCHE LA CONGRUENZA FRA         00070000
070010*--- MESE E GIORNO                                                00070010
070020*---                                                              00070020
070030     MOVE W-APPO-CF TO W-CF.                                      00070030
070040     MOVE W-APPO-CF TO W-ANNO.                                    00070040
070050     MOVE W-APPO-CF TO W-GIORNO.                                  00070050
070060     IF W-COD-FISC-CATAST-OK        AND                           00070060
070070        W-APPO-CF-DENOM ALPHABETIC  AND                           00070070
070080                W-APPO-CF-DENOM-L1  NOT EQUAL SPACE AND           00070080
070090                W-APPO-CF-DENOM-L2  NOT EQUAL SPACE AND           00070090
070100                W-APPO-CF-DENOM-L3  NOT EQUAL SPACE AND           00070100
070110                W-APPO-CF-DENOM-L4  NOT EQUAL SPACE AND           00070110
070120                W-APPO-CF-DENOM-L5  NOT EQUAL SPACE AND           00070120
070130                W-APPO-CF-DENOM-L6  NOT EQUAL SPACE AND           00070130
070140        (W-CF-ANNO1     NUMERIC   OR                              00070140
070150         W-CF-ANNO1-OK)              AND                          00070150
070160        (W-CF-ANNO2     NUMERIC   OR                              00070160
070170         W-CF-ANNO2-OK)              AND                          00070170
070180        W-APPO-CF-MESE-OK           AND                           00070180
070190        ((((W-APPO-CF-GIORNO   > ZERO AND                         00070190
070200            W-APPO-CF-GIORNO   < 32      ) OR                     00070200
070210           (W-APPO-CF-GIORNO   > 40   AND                         00070210
070220            W-APPO-CF-GIORNO   < 72      )) AND                   00070220
070230            W-CF-MESE-31-OK)                      OR              00070230
070240         (((W-APPO-CF-GIORNO   > ZERO AND                         00070240
070250            W-APPO-CF-GIORNO   < 31      ) OR                     00070250
070260           (W-APPO-CF-GIORNO   > 40   AND                         00070260
070270            W-APPO-CF-GIORNO   < 71      )) AND                   00070270
070280            W-CF-MESE-30-OK)                      OR              00070280
070290         (((W-APPO-CF-GIORNO   > ZERO AND                         00070290
070300            W-APPO-CF-GIORNO   < 30      ) OR                     00070300
070310           (W-APPO-CF-GIORNO   > 40   AND                         00070310
070320            W-APPO-CF-GIORNO   < 70      )) AND                   00070320
070330            W-CF-MESE-28-OK)               OR                     00070330
070340           ((W-CF-GIORNO1    NUMERIC   OR                         00070340
070350             W-CF-GIORNO1-OK)               AND                   00070350
070360            (W-CF-GIORNO2    NUMERIC   OR                         00070360
070370             W-CF-GIORNO2-OK)))                                   00070370
070380        MOVE W-APPO-CF TO W-BQVFB3-COD-FISC                       00070380
070390        MOVE 'PF '     TO W-PF-PNF                                00070390
070400        PERFORM R1-010-CATAST THRU R1-010-CATAST-EX               00070400
070410        GO TO RE-499.                                             00070410
070420                                                                  00070420
070430 RE-498.                                                          00070430
070440*--- ERRORE DI CORRETTEZZA DEL CODICE FISCALE PER:                00070440
070450*--- BYTE DA 1 A 6 NON TUTTI ALFABETICI O                         00070450
070460*--- BYTE 7 E 8 NON NUMERICI O                                    00070460
070470*--- BYTE 9 NON COMPRESO TRA I VALORI A,B,C,D,E,H,L,M,P,R,S,T O   00070470
070480*--- BYTE 10 E 11 NON NUMERICI O NON COMPRESI TRA I VALORI AMMESSI00070480
070490*--- BYTE 12, CORRISPONDENTE AL CODICE CATASTALE, FUORI SEQUENZA  00070490
070500     MOVE 1 TO W-BQVFB3-COD-RIT.                                  00070500
070510 RE-499.                                                          00070510
070520*---                                                              00070520
070530     IF W-BQVFB3-COD-RIT NOT = ZERO OR                            00070530
070540        W-FLAG-NO-BQVFB3 NOT = ZERO                               00070540
070550        GO TO RE-502.                                             00070550
070560                                                                  00070560
070570 RE-500.                                                          00070570
070580     CALL 'BQVFB3' USING W-PARAM-BQVFB3.                          00070580
070590                                                                  00070590
070600 RE-502.                                                          00070600
070610     IF W-BQVFB3-COD-RIT = ZERO                                   00070610
070620        GO TO RE-520.                                             00070620
070630                                                                  00070630
070640 RE-510.                                                          00070640
070650*--- ERRORE DI CORRETTEZZA DEL CODICE FISCALE                     00070650
070660     MOVE '1'   TO W-COD-FISC-KO.                                 00070660
070670     MOVE '1'   TO W-COD-FISC-KO-M.                               00070670
070680     MOVE SPACE TO W-PF-PNF.                                      00070680
070690     IF BQVFB11-01-FLAG-ERR-CF = 1                                00070690
070700        AND BQVFB11-TIPO-RECORD NOT = 'V20'                       00070700
070710        MOVE 1 TO W-FLAG-OK2                                      00070710
070720        GO TO RE-514.                                             00070720
070730                                                                  00070730
070740 RE-512.                                                          00070740
070750*--- ERRORE DI CORRETTEZZA DEL CODICE FISCALE                     00070750
070760     MOVE 96 TO BQVFB21-01-ERR-CODICE-FISC.                       00070760
070770     MOVE 'W' TO BQVFB21-01-ERR-CODICE-FISC-A.                    00070770
070780     MOVE 1   TO W-FLAG-E.                                        00070780
070790     ADD 1 TO W-CTR-NO-BLOC.                                      00070790
070800     IF W-CTR-RIGA = 1                                            00070800
070810       MOVE W-PF-PNF        TO W-APPO-PF-PNF.                     00070810
070820*       MOVE 96   TO W-APPO-ERR-CF.                               00070820
070830     GO TO RE-530.                                                00070830
070840                                                                  00070840
070850 RE-514.                                                          00070850
070860     MOVE 1 TO W-FLAG-OK2.                                        00070860
070870     IF W-CTR-RIGA = 1                                            00070870
070880       MOVE W-PF-PNF        TO W-APPO-PF-PNF                      00070880
070890        MOVE 1              TO W-APPO-FLAG-OK2.                   00070890
070900     GO TO RE-530.                                                00070900
070910                                                                  00070910
070920 RE-520.                                                          00070920
070930     IF W-CTR-RIGA = 1                                            00070930
070940        MOVE W-PF-PNF TO W-APPO-PF-PNF.                           00070940
070950                                                                  00070950
070960 RE-530.                                                          00070960
070970*--- PER RECORD DI TIPO 20 CONTINUO CON                           00070970
070980*--- IL CONTROLLO DELLA DATA RISCOSSIONE                          00070980
070990*--- INTERNET                                                     00070990
071000     IF BQVFB11-TIPO-RECORD = 'V20'                               00071000
071010        MOVE ZERO TO W-APPO-FLAG-ERR-CF                           00071010
071020        GO TO RE-710.                                             00071020
071030 RE-540.                                                          00071030
071040*--- PER RECORD DI TIPO 14 E 15 SI TERMINANO I CONTROLLI COMUNI   00071040
071050     IF BQVFB11-TIPO-RECORD = 'V14' OR                            00071050
071060        BQVFB11-TIPO-RECORD = 'V15'                               00071060
071070        GO TO RE-710.                                             00071070
071080                                                                  00071080
071090 RE-622.                                                          00071090
071100*--- SI CONTROLLA IL PRIMO FLAG ERRORE CODICE FISCALE             00071100
071110*--- DELLA DELEGA                                                 00071110
071120     IF W-CTR-RIGA = 1                                            00071120
071130        MOVE BQVFB11-01-FLAG-ERR-CF TO W-APPO-FLAG-ERR-CF         00071130
071140        GO TO RE-670.                                             00071140
071150                                                                  00071150
071160 RE-630.                                                          00071160
071170*--- SI CONTROLLA IL FLAG ERRORE CODICE FISCALE DIVERSO           00071170
071180*--- DA QUELLO TROVATO SULLA PRIMA RIGA DELLA DELEGA              00071180
071190     IF BQVFB11-01-FLAG-ERR-CF NOT = W-APPO-FLAG-ERR-CF AND       00071190
071200        W-APPO-ERR-FLAG-ERR-CF NOT = ZERO                         00071200
071210        GO TO RE-670.                                             00071210
071220                                                                  00071220
071230 RE-640.                                                          00071230
071240*--- SI CONTROLLA L'OMOGENEITA' DEL FLAG ERRORE CODICE FISCALE    00071240
071250     IF BQVFB11-01-FLAG-ERR-CF NOT = W-APPO-FLAG-ERR-CF AND       00071250
071260        W-APPO-ERR-FLAG-ERR-CF = ZERO                             00071260
071270        GO TO RE-660.                                             00071270
071280                                                                  00071280
071290 RE-650.                                                          00071290
071300*--- FLAG ERRORE CODICE FISCALE UGUALE A QUELLO PRECEDENTE        00071300
071310     IF W-APPO-ERR-FLAG-ERR-CF NOT = 24                           00071310
071320        MOVE W-APPO-ERR-FLAG-ERR-CF TO BQVFB21-01-ERR-FLAG-ERR-CF.00071320
071330     IF W-APPO-ERR-FLAG-ERR-CF  NOT = ZERO AND                    00071330
071340        W-APPO-ERR-FLAG-ERR-CF  NOT = 24                          00071340
071350        MOVE 'E' TO BQVFB21-01-ERR-FLAG-ERR-CF-A                  00071350
071360        ADD 1 TO W-CTR-BLOC.                                      00071360
071370     GO TO RE-670.                                                00071370
071380                                                                  00071380
071390 RE-660.                                                          00071390
071400*--- ERRORE DI OMOGENEITA' DEL FLAG ERRORE CODICE FISCALE         00071400
071410     MOVE 509 TO BQVFB21-01-ERR-FLAG-ERR-CF.                      00071410
071420     MOVE 'E' TO BQVFB21-01-ERR-FLAG-ERR-CF-A.                    00071420
071430     ADD 1 TO W-CTR-BLOC.                                         00071430
071440                                                                  00071440
071450 RE-670.                                                          00071450
071460*--- SI CONTROLLA LA CORRETTEZZA DEL FLAG                         00071460
071470     IF BQVFB11-01-FLAG-ERR-CF = '0' OR                           00071470
071480        BQVFB11-01-FLAG-ERR-CF = '1' OR                           00071480
071490        BQVFB21-01-ERR-FLAG-ERR-CF = 55                           00071490
071500        GO TO RE-690.                                             00071500
071510                                                                  00071510
071520 RE-680.                                                          00071520
071530*--- ERRORE DI CORRETTEZZA DEL FLAG                               00071530
071540     IF BQVFB21-01-ERR-FLAG-ERR-CF = ZERO                         00071540
071550        MOVE 55 TO BQVFB21-01-ERR-FLAG-ERR-CF                     00071550
071560        MOVE 'E' TO BQVFB21-01-ERR-FLAG-ERR-CF-A                  00071560
071570        ADD 1 TO W-CTR-BLOC.                                      00071570
071580     IF W-CTR-RIGA = 1                                            00071580
071590        MOVE 55 TO W-APPO-ERR-FLAG-ERR-CF.                        00071590
071600     GO TO RE-710.                                                00071600
071610                                                                  00071610
071620 RE-690.                                                          00071620
071630     IF BQVFB21-01-ERR-CODICE-FISC = 509                          00071630
071640        GO TO RE-710.                                             00071640
071650                                                                  00071650
071660 RE-692.                                                          00071660
071670*--- SI CONTROLLA LA CONGRUENZA DEL FLAG                          00071670
071680     IF (BQVFB21-01-ERR-CODICE-FISC = ZERO AND                    00071680
071690         BQVFB11-01-FLAG-ERR-CF   = '0'       )         OR        00071690
071700        ((BQVFB21-01-ERR-CODICE-FISC NOT = ZERO OR                00071700
071710          W-FLAG-OK2                     = 1      ) AND           00071710
071720         BQVFB11-01-FLAG-ERR-CF   = '1'                )          00071720
071730        GO TO RE-710.                                             00071730
071740                                                                  00071740
071750 RE-700.                                                          00071750
071760*--- ERRORE DI CONGRUENZA DEL FLAG                                00071760
071770     IF BQVFB21-01-ERR-FLAG-ERR-CF = ZERO                         00071770
071780        MOVE 24  TO BQVFB21-01-ERR-FLAG-ERR-CF                    00071780
071790        MOVE 'W' TO BQVFB21-01-ERR-FLAG-ERR-CF-A                  00071790
071800        ADD 1 TO W-CTR-NO-BLOC.                                   00071800
071810     IF W-CTR-RIGA = 1                                            00071810
071820        MOVE 24  TO W-APPO-ERR-FLAG-ERR-CF.                       00071820
071830                                                                  00071830
071840 RE-710.                                                          00071840
071850*--- PER RECORD DI TIPO 14 E 15 SI TERMINANO I CONTROLLI COMUNI   00071850
071860     IF BQVFB11-TIPO-RECORD = 'V14' OR                            00071860
071870        BQVFB11-TIPO-RECORD = 'V15'                               00071870
071880        GO TO RE-990-CONTR-COMUNI-EX.                             00071880
071890                                                                  00071890
071900 RE-715.                                                          00071900
071910*--- SI CONTROLLA LA PRIMA DATA DI RISCOSSIONE                    00071910
071920*--- DELLA DELEGA                                                 00071920
071930     MOVE 0 TO W-FLAG-ERR1.                                       00071930
071940     IF W-CTR-RIGA = 1                                            00071940
071950        MOVE BQVFB11-01-DATA-RISC TO W-APPO-DATA-RISC             00071950
071960        GO TO RE-760.                                             00071960
071970                                                                  00071970
071980 RE-720.                                                          00071980
071990*--- SI CONTROLLA LA DATA DI RISCOSSIONE DIVERSA                  00071990
072000*--- DA QUELLA TROVATA SULLA PRIMA RIGA DELLA DELEGA              00072000
072010     IF BQVFB11-01-DATA-RISC NOT = W-APPO-DATA-RISC AND           00072010
072020        W-APPO-ERR-DATA-RISC NOT = ZERO                           00072020
072030        GO TO RE-760.                                             00072030
072040                                                                  00072040
072050 RE-730.                                                          00072050
072060*--- SI CONTROLLA L'OMOGENEITA' DELLA DATA DI RISCOSSIONE         00072060
072070     IF BQVFB11-01-DATA-RISC NOT = W-APPO-DATA-RISC AND           00072070
072080        W-APPO-ERR-DATA-RISC = ZERO                               00072080
072090        GO TO RE-750.                                             00072090
072100                                                                  00072100
072110 RE-740.                                                          00072110
072120*--- DATA DI RISCOSSIONE UGUALE A QUELLA PRECEDENTE               00072120
072130     MOVE 1 TO W-FLAG-ERR1.                                       00072130
072140     MOVE W-APPO-ERR-DATA-RISC TO BQVFB21-01-ERR-DATA-RISC.       00072140
072150     IF W-APPO-ERR-DATA-RISC NOT = ZERO                           00072150
072160        MOVE 'E' TO BQVFB21-01-ERR-DATA-RISC-A                    00072160
072170        ADD 1 TO W-CTR-BLOC.                                      00072170
072180     GO TO RE-760.                                                00072180
072190                                                                  00072190
072200 RE-750.                                                          00072200
072210*--- ERRORE DI OMOGENEITA' DELLA DATA DI RISCOSSIONE              00072210
072220     MOVE 1 TO W-FLAG-ERR1.                                       00072220
072230     MOVE 509 TO BQVFB21-01-ERR-DATA-RISC.                        00072230
072240     MOVE 'E' TO BQVFB21-01-ERR-DATA-RISC-A.                      00072240
072250     ADD 1 TO W-CTR-BLOC.                                         00072250
072260                                                                  00072260
072270 RE-760.                                                          00072270
072280     IF W-FLAG-ERR1 = 1                                           00072280
072290        GO TO RE-990-CONTR-COMUNI-EX.                             00072290
072300                                                                  00072300
072310 RE-762.                                                          00072310
072320*--- SI CONTROLLA LA CORRETTEZZA DELLA DATA DI RISCOSSIONE        00072320
072330     MOVE BQVFB11-01-DATA-RISC TO BQVFDA1-DAT1.                   00072330
072340     MOVE SPACE                TO BQVFDA1-DAT2.                   00072340
072350     CALL 'BQVFDA' USING BQVFDA1.                                 00072350
072360     IF BQVFDA1-OK = ZERO                                         00072360
072370        GO TO RE-780.                                             00072370
072380                                                                  00072380
072390 RE-770.                                                          00072390
072400*--- ERRORE DI AMMISSIBILITA' DELLA DATA DI RISCOSSIONE           00072400
072410     MOVE 96 TO BQVFB21-01-ERR-DATA-RISC.                         00072410
072420     MOVE 'E' TO BQVFB21-01-ERR-DATA-RISC-A.                      00072420
072430     ADD 1 TO W-CTR-BLOC.                                         00072430
072440     IF W-CTR-RIGA = 1                                            00072440
072450        MOVE 96 TO W-APPO-ERR-DATA-RISC.                          00072450
072460     GO TO RE-990-CONTR-COMUNI-EX.                                00072460
072470                                                                  00072470
072480 RE-780.                                                          00072480
072490*--- SI CONTROLLA LA CORRETTEZZA DELLA DATA DI RISCOSSIONE;       00072490
072500*--- PER MODALITA' CONFERIMENTO = '2' (ATM) O = '3' (INTERNET)    00072500
072510*--- PUO' ESSERE ANCHE UN SABATO O UNA DOMENICA O UNA FESTIVITA'  00072510
072520*    IF ( BQVFB11-TIPO-RECORD           = 'V36'             AND   00072520
072530*         BQVFB11-36-MOD-CONFER     NOT = '2'               AND   00072530
072540*--- INTERNET                                                     00072540
072550*         BQVFB11-36-MOD-CONFER     NOT = '3'               AND   00072550
072560*         BQVFDA1-FESTIVO               = '0'               AND   00072560
072570********* BQVFDA1-SETTIMANA             < 7                 AND   00072570
072580*         BQVFB11-01-DATA-RISC      NOT > W-APPO-DATA-BON       ) 00072580
072590*       OR                                                        00072590
072600*       ( BQVFB11-TIPO-RECORD           = 'V36'             AND   00072600
072610*--- INTERNET                                                     00072610
072620*        (BQVFB11-36-MOD-CONFER         = '2' OR '3')       AND   00072620
072630*         BQVFB11-01-DATA-RISC      NOT > W-APPO-DATA-BON       ) 00072630
072640*       OR                                                        00072640
072650*        ( BQVFB11-TIPO-RECORD           = 'V20'             AND  00072650
072660*          BQVFB11-01-DATA-RISC      NOT > W-APPO-DATA-BON       )00072660
072670*       OR                                                        00072670
072680*        ( BQVFB11-TIPO-RECORD       NOT = 'V36'             AND  00072680
072690*          BQVFB11-TIPO-RECORD       NOT = 'V20'             AND  00072690
072700*          BQVFDA1-FESTIVO               = '0'               AND  00072700
072710*          BQVFB11-01-DATA-RISC      NOT > W-APPO-DATA-BON       )00072710
072720*       GO TO RE-800.                                             00072720
072730*F INIZIO MODIFICA 13/04/2004 - MONOPOLI                          00072730
072740*F   IF    BQVFB11-01-DATA-RISC      NOT > W-APPO-DATA-BON        00072740
072750*F      GO TO RE-800.                                             00072750
072760     IF    BQVFB11-01-DATA-RISC      NOT > W-APPO-DATA-BON AND    00072760
072770           (W-VERS                       > 'R04' OR               00072770
072780           (W-VERS                   NOT > 'R04' AND              00072780
072790            BQVFB11-01-DATA-RISC         < W-DATA-R05     ))      00072790
072800        GO TO RE-800.                                             00072800
072810*F FINE MODIFICA 13/04/2004 - MONOPOLI                            00072810
072820                                                                  00072820
072830 RE-790.                                                          00072830
072840*--- ERRORE DI CORRETTEZZA DELLA DATA DI RISCOSSIONE              00072840
072850     MOVE 45 TO BQVFB21-01-ERR-DATA-RISC.                         00072850
072860     MOVE 'E' TO BQVFB21-01-ERR-DATA-RISC-A.                      00072860
072870     ADD 1 TO W-CTR-BLOC.                                         00072870
072880     IF W-CTR-RIGA = 1                                            00072880
072890        MOVE 45 TO W-APPO-ERR-DATA-RISC.                          00072890
072900     GO TO RE-990-CONTR-COMUNI-EX.                                00072900
072910                                                                  00072910
072920 RE-800.                                                          00072920
072930*--- SI CONTROLLA LA CORRETTEZZA DELLA DATA DI RISCOSSIONE        00072930
072940     IF BQVFB11-01-DATA-RISC NOT < W-APPO-DATA-AVVIO              00072940
072950        GO TO RE-990-CONTR-COMUNI-EX.                             00072950
072960                                                                  00072960
072970 RE-810.                                                          00072970
072980*--- ERRORE DI CORRETTEZZA DELLA DATA DI RISCOSSIONE              00072980
072990     MOVE 45 TO BQVFB21-01-ERR-DATA-RISC.                         00072990
073000     MOVE 'W' TO BQVFB21-01-ERR-DATA-RISC-A.                      00073000
073010     ADD 1 TO W-CTR-NO-BLOC.                                      00073010
073020                                                                  00073020
073030 RE-990-CONTR-COMUNI-EX.                                          00073030
073040     EXIT.                                                        00073040
073050                                                                  00073050
073060*---                                                              00073060
073070*--- PERFORM RF-010-SCR-INVII                                     00073070
073080*---             SCRITTURA SUL FILE INVII BANCHE/CONCESSIONARI    00073080
073090*---                                                              00073090
073100 RF-010-SCR-INVII.                                                00073100
073110*--- SI SCRIVE IL FILE INVII BANCHE / CONCESSIONARI               00073110
073120     MOVE W-APPO-COD-ABI    TO BQVFB31-COD-ABI.                   00073120
073130     MOVE W-APPO-DATA-BON   TO BQVFB31-DATA-BONIF.                00073130
073140     MOVE W-APPO-PROG-TRASM TO BQVFB31-PROG-TRASM.                00073140
073150     MOVE W-APPO-TIPO-INVIO TO BQVFB31-TIPO-INVIO.                00073150
073160     MOVE W-APPO-PROG-INVIO TO BQVFB31-PROG-INVIO.                00073160
073170     ADD 1                  TO W-CTR-FLUSSI.                      00073170
073180     MOVE W-CTR-FLUSSI      TO BQVFB31-PROG-FLUSSO-TRASM.         00073180
073190     MOVE W-APPO-DATA-SYS   TO BQVFB31-DATA-ESITO.                00073190
073200     IF W-CTR-BLOC NOT = 0 AND                                    00073200
073210        W-FLAG-SQUADR  = 0                                        00073210
073220        MOVE '2' TO BQVFB31-ESITO                                 00073220
073230        GO TO RF-040.                                             00073230
073240                                                                  00073240
073250 RF-012.                                                          00073250
073260     IF W-CTR-BLOC NOT = 0 AND                                    00073260
073270        W-FLAG-SQUADR  = 1                                        00073270
073280        MOVE '4' TO BQVFB31-ESITO                                 00073280
073290        GO TO RF-040.                                             00073290
073300                                                                  00073300
073310 RF-020.                                                          00073310
073320     IF W-CTR-NO-BLOC NOT = 0                                     00073320
073330        MOVE '1' TO BQVFB31-ESITO                                 00073330
073340        GO TO RF-040.                                             00073340
073350                                                                  00073350
073360 RF-030.                                                          00073360
073370     MOVE '0' TO BQVFB31-ESITO.                                   00073370
073380                                                                  00073380
073390 RF-040.                                                          00073390
073400     MOVE ZERO                TO BQVFB31-FLAG-TIPO-ERR.           00073400
073410     MOVE W-TOT-REC-ERR       TO BQVFB31-TOT-REC-ERRATI.          00073410
073420     MOVE W-TOT-REC-ERR-BLOC  TO BQVFB31-TOT-REC-ERR-BLOC.        00073420
073430     COMPUTE W-TOT-ERR = W-CTR-BLOC + W-CTR-NO-BLOC.              00073430
073440     MOVE W-TOT-ERR           TO BQVFB31-NUM-ERR-TOT.             00073440
073450     MOVE W-CTR-BLOC          TO BQVFB31-NUM-ERR-BLOC.            00073450
073460     MOVE W-CTR-01            TO BQVFB31-REC-FISCO.               00073460
073470     MOVE W-CTR-02            TO BQVFB31-REC-INPS.                00073470
073480     MOVE W-CTR-03            TO BQVFB31-REC-REG.                 00073480
073490     MOVE W-CTR-04            TO BQVFB31-REC-ENTI.                00073490
073500     MOVE W-CTR-05            TO BQVFB31-REC-INAIL.               00073500
073510     MOVE W-CTR-06            TO BQVFB31-REC-ALTRI.               00073510
073520     MOVE W-CTR-07            TO BQVFB31-REC-ACCISE.              00073520
073530     MOVE W-CTR-12            TO BQVFB31-REC-IVA-AUTO.            00073530
073540     MOVE W-CTR-20            TO BQVFB31-REC-ATM.                 00073540
073550     MOVE W-CTR-14            TO BQVFB31-REC-ANAG-PF.             00073550
073560     MOVE W-CTR-15            TO BQVFB31-REC-ANAG-PNF.            00073560
073570     MOVE W-CTR-36            TO BQVFB31-REC-RIEPIL.              00073570
073580     MOVE W-CTR-37            TO BQVFB31-REC-ACCRED.              00073580
073590     MOVE W-CTR-38            TO BQVFB31-REC-BONIF.               00073590
073600     MOVE W-CTR-49            TO BQVFB31-REC-ASS.                 00073600
073610     COMPUTE W-TOT-REC = W-CTR-01 + W-CTR-02 + W-CTR-03 +         00073610
073620                         W-CTR-04 + W-CTR-05 + W-CTR-06 +         00073620
073630                         W-CTR-07 +                               00073630
073640                         W-CTR-12 +                               00073640
073650                         W-CTR-20 +                               00073650
073660                         W-CTR-14 + W-CTR-15 + W-CTR-36 +         00073660
073670                         W-CTR-37 + W-CTR-38 + W-CTR-49 +         00073670
073680                         W-CTR-00 + W-CTR-99 +                    00073680
073690                         W-CTR-REC-ERR.                           00073690
073700     MOVE W-TOT-REC           TO BQVFB31-NUM-REC-TOT.             00073700
073710*--- SI SCRIVE SU INVII IL RIEPILOGO DEL FLUSSO LETTO             00073710
073720*--- RIPORTANTE TRA L'ALTRO L'ESITO DEI CONTROLLI                 00073720
073730     WRITE BQVFB32 FROM BQVFB31.                                  00073730
073740     ADD 1 TO W-CTR-SCR-INVII.                                    00073740
073750     INITIALIZE BQVFB31.                                          00073750
073760                                                                  00073760
073770 RF-990-SCR-INVII-EX.                                             00073770
073780     EXIT.                                                        00073780
073790                                                                  00073790
073800*---                                                              00073800
073810*--- PERFORM RG-010-QUADR - EVENTUALE QUADRATURA DEGLI            00073810
073820*---                        ACCREDITAMENTI E SCRITTURA SU ESITI   00073820
073830*---                                                              00073830
073840 RG-010-QUADR.                                                    00073840
073850     IF W-FLAG-NO-QUAD = 1                                        00073850
073860        GO TO RG-030.                                             00073860
073870                                                                  00073870
073880 RG-020.                                                          00073880
073890     MOVE W-CTR-BLOC    TO W-APPO-CTR-BLOC.                       00073890
073900     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00073900
073910     IF W-TIPO-REC-PREC = 'V38'                                   00073910
073920        GO TO RG-024.                                             00073920
073930                                                                  00073930
073940 RG-021.                                                          00073940
073950     MOVE 'Q' TO W-TIPO-CHIAMATA.                                 00073950
073960*F   MOVE ZERO TO W-NUM-SQUADR.                                   00073960
073970*F   MOVE ZERO TO W-DATI-SQUADR.                                  00073970
073980*F   ADD  1    TO W-CTR-PROV-DIST.                                00073980
073990*F   CALL 'BQVFB7' USING                                          00073990
074000*F                         W-FLAG-BANCA                           00074000
074010*F                         W-TIPO-CHIAMATA                        00074010
074020*F                         W-MEM-BQVFB21(1)                       00074020
074030*F                         W-TAB-SALDI                            00074030
074040*F                         W-DIV                                  00074040
074050*F                         W-CTR-NO-BLOC                          00074050
074060*F                         W-CTR-BLOC                             00074060
074070*F                         W-FLAG-NO-QUAD                         00074070
074080*F                         W-NUM-SQUADR                           00074080
074090*F                         W-DATI-SQUADR.                         00074090
074100     IF W-NUM-SQUADR NOT = ZERO                                   00074100
074110        MOVE 1             TO W-FLAG-SQUADR                       00074110
074120        ADD  1             TO W-IND-S                             00074120
074130        ADD  W-NUM-SQUADR  TO BQVFBS1-NUM-SQUADR                  00074130
074140        MOVE W-DATI-SQUADR TO BQVFBS1-TAB(W-IND-S).               00074140
074150     IF W-CTR-BLOC NOT EQUAL W-APPO-CTR-BLOC AND                  00074150
074160        W-FLG-ERR-BLOC-37    NOT EQUAL 1    AND                   00074160
074170        W-FLG-ERR-NO-BLOC-37 NOT EQUAL 1                          00074170
074180        ADD 1 TO W-TOT-REC-ERR                                    00074180
074190        ADD 1 TO W-TOT-REC-ERR-BLOC                               00074190
074200        GO TO RG-030.                                             00074200
074210                                                                  00074210
074220 RG-022.                                                          00074220
074230     IF W-CTR-BLOC NOT EQUAL W-APPO-CTR-BLOC AND                  00074230
074240        W-FLG-ERR-BLOC-37    NOT EQUAL 1    AND                   00074240
074250        W-FLG-ERR-NO-BLOC-37     EQUAL 1                          00074250
074260        ADD 1 TO W-TOT-REC-ERR-BLOC                               00074260
074270        GO TO RG-030.                                             00074270
074280                                                                  00074280
074290 RG-023.                                                          00074290
074300     IF W-CTR-NO-BLOC NOT EQUAL W-APPO-CTR-NO-BLOC AND            00074300
074310        W-FLG-ERR-BLOC-37    NOT EQUAL 1    AND                   00074310
074320        W-FLG-ERR-NO-BLOC-37 NOT EQUAL 1                          00074320
074330        ADD 1 TO W-TOT-REC-ERR.                                   00074330
074340     GO TO RG-030.                                                00074340
074350                                                                  00074350
074360 RG-024.                                                          00074360
074370     MOVE 'Q' TO W-TIPO-CHIAMATA.                                 00074370
074380*---                                                              00074380
074390*--- MODIFICHE MAGGIO 2001                                        00074390
074400*---                                                              00074400
074410     MOVE W-COMM-CALC-NEW  TO W-COMM-CALC.                        00074410
074420     MOVE ZERO             TO W-COMM-CALC-NEW.                    00074420
074430*F MODIFICA 13/03/2006 - IC: AGGIUNTA TABELLA W-TAB-IC            00074430
074440     CALL 'BQVFB8' USING   W-TIPO-CHIAMATA                        00074440
074450                           W-MEM-BQVFB21(1)                       00074450
074460                           W-TAB-MEM-BQVFB21                      00074460
074470                           W-TAB-SALDI                            00074470
074480                           W-DIV                                  00074480
074490                           W-CTR-NO-BLOC                          00074490
074500                           W-CTR-BLOC                             00074500
074510                           W-ALTRI-PARAM                          00074510
074520                           W-TAB-AZIENDE                          00074520
074530                           W-FLAG-BANCA                           00074530
074540                           W-SALDO-AGEV                           00074540
074550*--- ANTICIPO                                                     00074550
074560                           W-VERS                                 00074560
074570                           W-DATA-ANTIC                           00074570
074580                           W-ANTIC-CALC                           00074580
074590                           W-TAB-IC                               00074590
074600                           W-ANTIC-I24-CALC.                      00074600
074610     IF W-CTR-BLOC NOT EQUAL W-APPO-CTR-BLOC AND                  00074610
074620        W-FLG-ERR-BLOC-38    NOT EQUAL 1    AND                   00074620
074630        W-FLG-ERR-NO-BLOC-38 NOT EQUAL 1                          00074630
074640        ADD 1 TO W-TOT-REC-ERR                                    00074640
074650        ADD 1 TO W-TOT-REC-ERR-BLOC                               00074650
074660        GO TO RG-030.                                             00074660
074670                                                                  00074670
074680 RG-025.                                                          00074680
074690     IF W-CTR-BLOC NOT EQUAL W-APPO-CTR-BLOC AND                  00074690
074700        W-FLG-ERR-BLOC-38    NOT EQUAL 1    AND                   00074700
074710        W-FLG-ERR-NO-BLOC-38     EQUAL 1                          00074710
074720        ADD 1 TO W-TOT-REC-ERR-BLOC                               00074720
074730        GO TO RG-030.                                             00074730
074740                                                                  00074740
074750 RG-026.                                                          00074750
074760     IF W-CTR-NO-BLOC NOT EQUAL W-APPO-CTR-NO-BLOC AND            00074760
074770        W-FLG-ERR-BLOC-38    NOT EQUAL 1    AND                   00074770
074780        W-FLG-ERR-NO-BLOC-38 NOT EQUAL 1                          00074780
074790        ADD 1 TO W-TOT-REC-ERR.                                   00074790
074800                                                                  00074800
074810 RG-030.                                                          00074810
074820     MOVE ZERO TO W-IND.                                          00074820
074830                                                                  00074830
074840 RG-040.                                                          00074840
074850     ADD 1 TO W-IND.                                              00074850
074860     IF W-IND = W-IND-MAX AND                                     00074860
074870        W-FLAG-ERR-SUCC = 1                                       00074870
074880        MOVE 505 TO W-MEM-BQVFB21-ERR-REC-SUCC(W-IND)             00074880
074890        MOVE 'E' TO W-MEM-BQVFB21-ERR-REC-SUCC-A(W-IND)           00074890
074900        ADD 1 TO W-CTR-BLOC.                                      00074900
074910     WRITE BQVFB22 FROM W-MEM-BQVFB21(W-IND).                     00074910
074920     ADD 1 TO W-CTR-SCRITTI.                                      00074920
074930     IF W-IND < W-IND-MAX                                         00074930
074940        GO TO RG-040.                                             00074940
074950                                                                  00074950
074960 RG-050.                                                          00074960
074970     MOVE ZERO TO W-IND.                                          00074970
074980     MOVE ZERO TO W-IND-MAX.                                      00074980
074990     MOVE ZERO TO W-FLAG-ERR-SUCC.                                00074990
075000     MOVE ZERO TO W-FLAG-NO-QUAD.                                 00075000
075010     MOVE SPACE  TO W-TAB-MEM-BQVFB21.                            00075010
075020                                                                  00075020
075030 RG-060.                                                          00075030
075040     ADD 1 TO W-IND.                                              00075040
075050     MOVE ZERO TO W-MEM-BQVFB21-ERR-REC-SUCC(W-IND).              00075050
075060     IF W-IND < 99                                                00075060
075070        GO TO RG-060.                                             00075070
075080                                                                  00075080
075090 RG-070.                                                          00075090
075100     MOVE ZERO TO W-IND.                                          00075100
075110                                                                  00075110
075120 RG-990-QUADR-EX.                                                 00075120
075130     EXIT.                                                        00075130
075140                                                                  00075140
075150*---                                                              00075150
075160*--- PERFORM RY-010-SQUADR - SCRITTURA SUL FILE BQVFBS            00075160
075170*---                                                              00075170
075180*RY-010-SQUADR.                                                   00075180
075190*--- SI SCRIVE IL FILE SQUADRATURE                                00075190
075200*    IF W-FLAG-SQUADR NOT = 1                                     00075200
075210*       GO TO RY-990-SQUADR-EX.                                   00075210
075220*RY-020.                                                          00075220
075230*    MOVE W-APPO-COD-ABI    TO BQVFBS1-COD-ABI.                   00075230
075240*    MOVE W-APPO-DATA-BON   TO BQVFBS1-DATA-BONIF.                00075240
075250*    MOVE W-APPO-PROG-TRASM TO BQVFBS1-PROG-TRASM.                00075250
075260*    MOVE W-APPO-TIPO-INVIO TO BQVFBS1-TIPO-INVIO.                00075260
075270*    MOVE W-APPO-PROG-INVIO TO BQVFBS1-PROG-INVIO.                00075270
075280*    MOVE W-CTR-PROV-DIST   TO BQVFBS1-NUM-PROV.                  00075280
075290*    MOVE W-IND-S           TO BQVFBS1-NUM-PROV-SQUADR.           00075290
075300*--- SI SCRIVE SU INVII IL RIEPILOGO DEL FLUSSO LETTO             00075300
075310*--- RIPORTANTE TRA L'ALTRO L'ESITO DEI CONTROLLI                 00075310
075320*    WRITE BQVFBS2 FROM BQVFBS1.                                  00075320
075330*    ADD 1 TO W-CTR-SCR-SQUADR.                                   00075330
075340*    INITIALIZE BQVFBS1.                                          00075340
075350*                                                                 00075350
075360*RY-990-SQUADR-EX.                                                00075360
075370*    EXIT.                                                        00075370
075380*                                                                 00075380
075390*---                                                              00075390
075400*--- PERFORM RH-010-NUOVA DELEGA - IMPOSTAZIONE E INIZIALIZZAZIONE00075400
075410*---                               CAMPI PER CAMBIO DELEGA        00075410
075420*---                                                              00075420
075430 RH-010-NUOVA-DELEGA.                                             00075430
075440     MOVE ZERO TO W-FLAG-E.                                       00075440
075450     MOVE ZERO TO W-FLAG-NUOVA-DELEGA.                            00075450
075460     MOVE 1 TO W-FLAG-CAMBIO-DELEGA.                              00075460
075470     MOVE ZERO TO W-ERR-DELEGA-PREC.                              00075470
075480     ADD 1 TO W-CTR-DELEGA.                                       00075480
075490     INITIALIZE W-CAMPI-DELEGA.                                   00075490
075500     MOVE ZERO     TO W-COD-FISC-KO.                              00075500
075510     MOVE ZERO     TO W-UFF-RIF-M.                                00075510
075520     MOVE ZERO     TO W-NUM-RIF-M.                                00075520
075530     MOVE ZERO     TO W-COD-FISC-KO-M.                            00075530
075540     MOVE ZERO     TO W-UFF-RIF-ERARIO.                           00075540
075550     MOVE ZERO     TO W-NUM-RIF-ERARIO.                           00075550
075560     MOVE '9'      TO W-FLAG-AGEV.                                00075560
075570     MOVE ZERO     TO W-COD-NUM-RIF.                              00075570
075580     MOVE ZERO     TO W-NUM-RIF                                   00075580
075590     MOVE ZERO     TO W-NUM-RIF-04.                               00075590
075600     MOVE ZERO     TO W-UFF-RIF.                                  00075600
075610     MOVE ZERO     TO W-COD-ENTE.                                 00075610
075620     MOVE 1 TO W-CTR-RIGA.                                        00075620
075630     INITIALIZE W-TAB-TOT.                                        00075630
075640*--- ICI                                                          00075640
075650     INITIALIZE W-TAB-COMUNI.                                     00075650
075660     MOVE ZERO TO W-IND-ICI.                                      00075660
075670     MOVE ZERO TO W-TOT-RIMB-TRIB.                                00075670
075680     MOVE ZERO TO W-TIPO-TRIB-NO-IMU.                             00075680
075690     MOVE ZERO TO W-TIPO-TRIB-NO-TARES.                           00075690
075700     MOVE ZERO TO W-TIPO-TRIB-NO-TASI.                            00075700
075710     MOVE ZERO TO W-FLAG-TRIB-CONC.                               00075710
075720     MOVE ZERO TO W-FLAG-CRED.                                    00075720
075730     MOVE ZERO TO W-FLAG-COMP-IVA.                                00075730
075740     MOVE ZERO TO W-FLAG-COMP-IRS.                                00075740
075750     MOVE ZERO TO W-FLAG-COMP-IRP.                                00075750
075760     MOVE ZERO TO W-FLAG-COMP-IRM.                                00075760
075770     MOVE ZERO TO W-FLAG-COMP-ELO.                                00075770
075780     MOVE ZERO TO W-FLAG-COMP-IRF.                                00075780
075790     MOVE ZERO TO W-FLAG-COMP-ADX.                                00075790
075800     MOVE ZERO TO W-FLAG-COMP-IIE.                                00075800
075810     MOVE ZERO TO W-FLAG-COMP-IFE.                                00075810
075820     MOVE ZERO TO W-FLAG-COMP-FF1.                                00075820
075830     MOVE ZERO TO W-FLAG-COMP-FF2.                                00075830
075840     MOVE ZERO TO W-FLAG-COMP-FF3.                                00075840
075850     MOVE ZERO TO W-FLAG-COMP-ORO.                                00075850
075860     MOVE ZERO TO W-FLAG-COMP-SEC.                                00075860
075870     MOVE ZERO TO W-FLAG-COMP-IEC.                                00075870
075880     MOVE ZERO TO W-FLAG-COMP-LEZ.                                00075880
075890     MOVE ZERO TO W-FLAG-COMP-QR1.                                00075890
075891     MOVE ZERO TO W-FLAG-COMP-BTC.                                00075891
075900*---                                                              00075900
075910     MOVE ZERO TO W-COMP-FISCO.                                   00075910
075920     MOVE ZERO TO W-COMP-REG.                                     00075920
075930     MOVE ZERO TO W-COMP-EL.                                      00075930
075940     MOVE W-CTR-01 TO W-MEM-CTR-01.                               00075940
075950     MOVE W-CTR-02 TO W-MEM-CTR-02.                               00075950
075960     MOVE W-CTR-03 TO W-MEM-CTR-03.                               00075960
075970     MOVE W-CTR-04 TO W-MEM-CTR-04.                               00075970
075980     MOVE W-CTR-05 TO W-MEM-CTR-05.                               00075980
075990     MOVE W-CTR-06 TO W-MEM-CTR-06.                               00075990
076000     MOVE W-CTR-07 TO W-MEM-CTR-07.                               00076000
076010     MOVE W-CTR-12 TO W-MEM-CTR-12.                               00076010
076020     MOVE W-CTR-20 TO W-MEM-CTR-20.                               00076020
076030     MOVE ZERO TO W-COD-ENTE.                                     00076030
076040     MOVE ZERO TO W-COD-ALTRO.                                    00076040
076050                                                                  00076050
076060 RH-990-NUOVA-DELEGA-EX.                                          00076060
076070     EXIT.                                                        00076070
076080                                                                  00076080
076090 Z1-010-CAR-TAB.                                                  00076090
076100*    CARICAMENTO TABELLA CODICI AMBITO                            00076100
076110     PERFORM RI-010-CAR-AMBITI THRU RI-990-CAR-AMBITI-EX.         00076110
076120*    CARICAMENTO TABELLA CODICIA ABI                              00076120
076130     PERFORM RL-010-CAR-AZIENDE THRU RL-990-CAR-AZIENDE-EX.       00076130
076140*    CARICAMENTO TABELLA CODICI REGIONE                           00076140
076150     PERFORM RM-010-CAR-REGIONI THRU RM-990-CAR-REGIONI-EX.       00076150
076160*    CARICAMENTO TABELLA CODICI PROVINCIA                         00076160
076170     PERFORM RN-010-CAR-PROV   THRU RN-990-CAR-PROV-EX.           00076170
076180*    CARICAMENTO TABELLA CODICI TRIBUTI                           00076180
076190     PERFORM RS-010-CAR-TRIB   THRU RS-990-CAR-TRIB-EX.           00076190
076200*    CARICAMENTO TABELLA TRIBUTI - ENTI (ACCISE-MONOPOLI)         00076200
076210     PERFORM SR-010-CAR-ENTI-TRIB THRU SR-990-CAR-ENTI-TRIB-EX.   00076210
076220*    CARICAMENTO TABELLA MATRICOLE INPS                           00076220
076230     PERFORM RT-010-CAR-MATR   THRU RT-990-CAR-MATR-EX.           00076230
076240*    CARICAMENTO TABELLA SEDI INPS                                00076240
076250     PERFORM RU-010-CAR-SEDE   THRU RU-990-CAR-SEDE-EX.           00076250
076260*    CARICAMENTO TABELLA ENTI LOCALI                              00076260
076270     PERFORM RV-010-CAR-ENTE   THRU RV-990-CAR-ENTE-EX.           00076270
076280*    CARICAMENTO TABELLA INAIL                                    00076280
076290     PERFORM RZ-010-CAR-INAIL  THRU RZ-990-CAR-INAIL-EX.          00076290
076300*    CARICAMENTO TABELLA ALTRI ENTI                               00076300
076310     PERFORM RX-010-CAR-ALTRO  THRU RX-990-CAR-ALTRO-EX.          00076310
076320*    CARICAMENTO TABELLA CAUSALI ALTRI ENTI                       00076320
076330     PERFORM RW-010-CAR-CAUS   THRU RW-990-CAR-CAUS-EX.           00076330
076340*    CARICAMENTO TABELLA UFFICI                                   00076340
076350     PERFORM R3-010-CAR-UFF    THRU R3-990-CAR-UFF-EX.            00076350
076360*** SOSTITUITA DA TABELLA LINK COMUNI-TRIBUTI                     00076360
076370*    CARICAMENTO TABELLA CODICI CATASTALI                         00076370
076380***  PERFORM R5-010-CAR-CAT    THRU R5-990-CAR-CAT-EX.            00076380
076390*    CARICAMENTO TABELLA LINK CODICI CATASTALI - TRIBUTI          00076390
076400     PERFORM R6-010-CAR-CAT-TRIB THRU R6-990-CAR-CAT-TRIB-EX.     00076400
076410*    CARICAMENTO TABELLA CODICI AMMESSI FORMALISMO TR             00076410
076420     PERFORM R7-010-CAR-COD-T3   THRU R7-990-CAR-COD-T3-EX.       00076420
076430*    CARICAMENTO TABELLA INTERESSI - COMMISSIONI IC               00076430
076440     PERFORM R8-010-CAR-IC   THRU R8-990-CAR-IC-EX.               00076440
076450*    CARICAMENTO TABELLA CODICE IDENTIFICATIVO CI                 00076450
076460     PERFORM SA-010-CAR-CI   THRU SA-990-CAR-CI-EX.               00076460
076470*    CARICAMENTO TABELLA TIPO VEICOLO CV                          00076470
076480     PERFORM SB-010-CAR-CV   THRU SB-990-CAR-CV-EX.               00076480
076490*    CARICAMENTO TABELLA CODICI PROVINCIA DIRITTI CAMERALI        00076490
076500     PERFORM SC-010-CAR-PRPC   THRU SC-990-CAR-PRPC-EX.           00076500
076510*    CARICAMENTO TABELLA LIMITI DI COMPENSABILIT - TRIBUTI       00076510
076520     PERFORM SE-010-CAR-COMP   THRU SE-990-CAR-COMP-EX.           00076520
076530*    CARICAMENTO TABELLA LIMITI DI COMPENSABILIT - TIPOLOGIE     00076530
076540     PERFORM SF-010-CAR-COMP   THRU SF-990-CAR-COMP-EX.           00076540
076550                                                                  00076550
076560 Z1-990-CAR-TAB-EX.                                               00076560
076570     EXIT.                                                        00076570
076580                                                                  00076580
076590***************************************************************** 00076590
076600*    CARICAMENTO IN MEMORIA DEI CODICI AMBITI                   * 00076600
076610***************************************************************** 00076610
076620 RI-010-CAR-AMBITI.                                               00076620
076630*    INIZIALIZZO LA TABELLA DI WORKING                            00076630
076640     SET W-PUNT-AMBITI TO 1.                                      00076640
076650     MOVE HIGH-VALUE   TO W-TAB-AMBITI-OCC.                       00076650
076660     MOVE LOW-VALUE    TO W-FF.                                   00076660
076670*    APERTURA ARCHIVIO AMBITI                                     00076670
076680     OPEN INPUT  BQVFAM.                                          00076680
076690*                                                                 00076690
076700 RI-020.                                                          00076700
076710     READ BQVFAM INTO BQVFAM1   AT END                            00076710
076720               MOVE HIGH-VALUE TO W-FF.                           00076720
076730     IF W-FF EQUAL LOW-VALUE                                      00076730
076740        GO TO RI-040.                                             00076740
076750 RI-030.                                                          00076750
076760     GO TO RI-050.                                                00076760
076770 RI-040.                                                          00076770
076780*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00076780
076790     MOVE BQVFAM1-COD   TO W-TAB-AMBITI-COD-NUM(W-PUNT-AMBITI).   00076790
076800     MOVE BQVFAM1-INIZ-VAL TO W-TAB-AMBITI-INI-VAL(W-PUNT-AMBITI).00076800
076810     MOVE BQVFAM1-FINE-VAL TO W-TAB-AMBITI-FIN-VAL(W-PUNT-AMBITI).00076810
076820     MOVE BQVFAM1-PRV   TO W-TAB-AMBITI-COD-PROV(W-PUNT-AMBITI).  00076820
076830 RI-050.                                                          00076830
076840*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00076840
076850     IF W-FF          = LOW-VALUE        AND                      00076850
076860        W-PUNT-AMBITI < W-TAB-AMBITI-NUM-MAX                      00076860
076870        SET W-PUNT-AMBITI UP BY 1                                 00076870
076880        GO TO  RI-020.                                            00076880
076890 RI-060.                                                          00076890
076900*    VERIFICA SFONDAMENTO TABELLA                                 00076900
076910     IF W-PUNT-AMBITI = W-TAB-AMBITI-NUM-MAX AND                  00076910
076920        W-FF          = LOW-VALUE                                 00076920
076930*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00076930
076940*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00076940
076950*       DELLA TABELLA DI WORKING.                                 00076950
076960        MOVE '0002'      TO ABEND-CODE                            00076960
076970        DISPLAY 'BQVFB0-RI-060-01: SUPERATO IL NUMERO MASSIMO  '  00076970
076980        DISPLAY 'BQVFB0-RI-060-01: DI ELEMENTI PER LA TABELLA  '  00076980
076990        DISPLAY 'BQVFB0-RI-060-01: DI WORKING "W-TAB-AMBITI".'    00076990
077000        CALL 'BQVFSR' USING ABEND-CODE.                           00077000
077010*                                                                 00077010
077020*    CHIUSURA ARCHIVIO AMBITI                                     00077020
077030     CLOSE   BQVFAM.                                              00077030
077040*                                                                 00077040
077050 RI-990-CAR-AMBITI-EX.                                            00077050
077060     EXIT.                                                        00077060
077070***************************************************************** 00077070
077080*    CARICAMENTO IN MEMORIA DEI CODICI AZIENDA                  * 00077080
077090***************************************************************** 00077090
077100 RL-010-CAR-AZIENDE.                                              00077100
077110*    INIZIALIZZO LA TABELLA DI WORKING                            00077110
077120     SET  W-PUNT-AZIENDE    TO 1.                                 00077120
077130     MOVE HIGH-VALUE        TO W-TAB-AZIENDE-OCC.                 00077130
077140     MOVE LOW-VALUE         TO W-FF.                              00077140
077150*    APERTURA ARCHIVIO AZIENDE                                    00077150
077160     OPEN INPUT  BQVFAZ.                                          00077160
077170*                                                                 00077170
077180 RL-020.                                                          00077180
077190     READ BQVFAZ INTO BQVFAZ1  AT END                             00077190
077200               MOVE HIGH-VALUE TO W-FF.                           00077200
077210     IF W-FF EQUAL LOW-VALUE                                      00077210
077220        GO TO RL-040.                                             00077220
077230 RL-030.                                                          00077230
077240*    ARCHIVIO TERMINATO, VERIFICO LA PRESENZA DI AZIENDE          00077240
077250     GO TO RL-050.                                                00077250
077260 RL-040.                                                          00077260
077270*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00077270
077280     MOVE BQVFAZ1-COD       TO W-TAB-AZ-COD-NUM(W-PUNT-AZIENDE).  00077280
077290 RL-050.                                                          00077290
077300*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00077300
077310     IF W-FF           = LOW-VALUE         AND                    00077310
077320        W-PUNT-AZIENDE < W-TAB-AZIENDE-NUM-MAX                    00077320
077330        SET  W-PUNT-AZIENDE UP BY 1                               00077330
077340        GO TO  RL-020.                                            00077340
077350 RL-060.                                                          00077350
077360*    VERIFICA SFONDAMENTO TABELLA                                 00077360
077370     IF W-PUNT-AZIENDE = W-TAB-AZIENDE-NUM-MAX AND                00077370
077380        W-FF           = LOW-VALUE                                00077380
077390*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00077390
077400*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00077400
077410*       DELLA TABELLA DI WORKING.                                 00077410
077420        MOVE '0003'      TO ABEND-CODE                            00077420
077430        DISPLAY 'BQVFB0-RL-060-01: SUPERATO IL NUMERO MASSIMO  '  00077430
077440        DISPLAY 'BQVFB0-RL-060-01: DI ELEMENTI PER LA TABELLA  '  00077440
077450        DISPLAY 'BQVFB0-RL-060-01: DI WORKING "W-TAB-AZIENDE".'   00077450
077460        CALL 'BQVFSR' USING ABEND-CODE.                           00077460
077470*    CHIUSURA ARCHIVIO                                            00077470
077480     CLOSE BQVFAZ.                                                00077480
077490 RL-990-CAR-AZIENDE-EX.                                           00077490
077500     EXIT.                                                        00077500
077510***************************************************************** 00077510
077520*    CARICAMENTO IN MEMORIA DEI CODICI REGIONE                  * 00077520
077530***************************************************************** 00077530
077540 RM-010-CAR-REGIONI.                                              00077540
077550*    INIZIALIZZO LA TABELLA DI WORKING                            00077550
077560     SET W-PUNT-REGIONI TO 1.                                     00077560
077570     MOVE HIGH-VALUE   TO W-TAB-REGIONI-OCC.                      00077570
077580     MOVE LOW-VALUE    TO W-FF.                                   00077580
077590*    APERTURA ARCHIVIO REGIONI                                    00077590
077600     OPEN INPUT  BQVFRE.                                          00077600
077610*                                                                 00077610
077620 RM-020.                                                          00077620
077630     READ BQVFRE INTO BQVFRE1   AT END                            00077630
077640               MOVE HIGH-VALUE TO W-FF.                           00077640
077650     IF W-FF EQUAL LOW-VALUE                                      00077650
077660        GO TO RM-040.                                             00077660
077670 RM-030.                                                          00077670
077680     GO TO RM-050.                                                00077680
077690 RM-040.                                                          00077690
077700*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00077700
077710     MOVE BQVFRE1-COD   TO W-TAB-REGIONI-COD(W-PUNT-REGIONI).     00077710
077720 RM-050.                                                          00077720
077730*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00077730
077740     IF W-FF          = LOW-VALUE        AND                      00077740
077750        W-PUNT-REGIONI < W-TAB-REGIONI-NUM-MAX                    00077750
077760        SET W-PUNT-REGIONI UP BY 1                                00077760
077770        GO TO  RM-020.                                            00077770
077780 RM-060.                                                          00077780
077790*    VERIFICA SFONDAMENTO TABELLA                                 00077790
077800     IF W-PUNT-REGIONI = W-TAB-REGIONI-NUM-MAX AND                00077800
077810        W-FF          = LOW-VALUE                                 00077810
077820*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00077820
077830*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00077830
077840*       DELLA TABELLA DI WORKING.                                 00077840
077850        MOVE '0004'      TO ABEND-CODE                            00077850
077860        DISPLAY 'BQVFB0-RM-060-01: SUPERATO IL NUMERO MASSIMO  '  00077860
077870        DISPLAY 'BQVFB0-RM-060-01: DI ELEMENTI PER LA TABELLA  '  00077870
077880        DISPLAY 'BQVFB0-RM-060-01: DI WORKING "W-TAB-REGIONI".'   00077880
077890        CALL 'BQVFSR' USING ABEND-CODE.                           00077890
077900*                                                                 00077900
077910*    CHIUSURA ARCHIVIO REGIONI                                    00077910
077920     CLOSE   BQVFRE.                                              00077920
077930*                                                                 00077930
077940 RM-990-CAR-REGIONI-EX.                                           00077940
077950     EXIT.                                                        00077950
077960***************************************************************** 00077960
077970*    CARICAMENTO IN MEMORIA DEI CODICI PROVINCIA                * 00077970
077980***************************************************************** 00077980
077990 RN-010-CAR-PROV.                                                 00077990
078000*    INIZIALIZZO LA TABELLA DI WORKING                            00078000
078010     SET W-PUNT-PROV TO 1.                                        00078010
078020     MOVE HIGH-VALUE   TO W-TAB-PROV-OCC.                         00078020
078030     MOVE LOW-VALUE    TO W-FF.                                   00078030
078040*    APERTURA ARCHIVIO PROVINCE                                   00078040
078050     OPEN INPUT  BQVFPR.                                          00078050
078060*                                                                 00078060
078070 RN-020.                                                          00078070
078080     READ BQVFPR INTO BQVFPR1   AT END                            00078080
078090               MOVE HIGH-VALUE TO W-FF.                           00078090
078100     IF W-FF EQUAL LOW-VALUE                                      00078100
078110        GO TO RN-040.                                             00078110
078120 RN-030.                                                          00078120
078130     GO TO RN-050.                                                00078130
078140 RN-040.                                                          00078140
078150*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00078150
078160     MOVE BQVFPR1-COD   TO W-TAB-PROV-COD(W-PUNT-PROV).           00078160
078170 RN-050.                                                          00078170
078180*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00078180
078190     IF W-FF          = LOW-VALUE        AND                      00078190
078200        W-PUNT-PROV < W-TAB-PROV-NUM-MAX                          00078200
078210        SET W-PUNT-PROV UP BY 1                                   00078210
078220        GO TO  RN-020.                                            00078220
078230 RN-060.                                                          00078230
078240*    VERIFICA SFONDAMENTO TABELLA                                 00078240
078250     IF W-PUNT-PROV = W-TAB-PROV-NUM-MAX AND                      00078250
078260        W-FF          = LOW-VALUE                                 00078260
078270*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00078270
078280*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00078280
078290*       DELLA TABELLA DI WORKING.                                 00078290
078300        MOVE '0005'      TO ABEND-CODE                            00078300
078310        DISPLAY 'BQVFB0-RN-060-01: SUPERATO IL NUMERO MASSIMO  '  00078310
078320        DISPLAY 'BQVFB0-RN-060-01: DI ELEMENTI PER LA TABELLA  '  00078320
078330        DISPLAY 'BQVFB0-RN-060-01: DI WORKING "W-TAB-PROV".'      00078330
078340        CALL 'BQVFSR' USING ABEND-CODE.                           00078340
078350*                                                                 00078350
078360*    CHIUSURA ARCHIVIO PROVINCE                                   00078360
078370     CLOSE   BQVFPR.                                              00078370
078380*                                                                 00078380
078390 RN-990-CAR-PROV-EX.                                              00078390
078400     EXIT.                                                        00078400
078410***************************************************************** 00078410
078420*    CARICAMENTO IN MEMORIA DEI CODICI PROVINCIA PER DIR. CAM.  * 00078420
078430***************************************************************** 00078430
078440 SC-010-CAR-PRPC.                                                 00078440
078450*    INIZIALIZZO LA TABELLA DI WORKING                            00078450
078460     SET W-PUNT-PRPC TO 1.                                        00078460
078470     MOVE HIGH-VALUE   TO W-TAB-PRPC-OCC.                         00078470
078480     MOVE LOW-VALUE    TO W-FF.                                   00078480
078490*    APERTURA ARCHIVIO PROVINCE DIRITTI CAMERALI                  00078490
078500     OPEN INPUT  BQVFPC.                                          00078500
078510*                                                                 00078510
078520 SC-020.                                                          00078520
078530     READ BQVFPC INTO BQVFPC1   AT END                            00078530
078540               MOVE HIGH-VALUE TO W-FF.                           00078540
078550     IF W-FF EQUAL LOW-VALUE                                      00078550
078560        GO TO SC-040.                                             00078560
078570 SC-030.                                                          00078570
078580     GO TO SC-050.                                                00078580
078590 SC-040.                                                          00078590
078600*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00078600
078610     MOVE BQVFPC1-COD   TO W-TAB-PRPC-COD(W-PUNT-PRPC).           00078610
078620 SC-050.                                                          00078620
078630*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00078630
078640     IF W-FF          = LOW-VALUE        AND                      00078640
078650        W-PUNT-PRPC < W-TAB-PRPC-NUM-MAX                          00078650
078660        SET W-PUNT-PRPC UP BY 1                                   00078660
078670        GO TO  SC-020.                                            00078670
078680 SC-060.                                                          00078680
078690*    VERIFICA SFONDAMENTO TABELLA                                 00078690
078700     IF W-PUNT-PRPC = W-TAB-PRPC-NUM-MAX AND                      00078700
078710        W-FF          = LOW-VALUE                                 00078710
078720*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00078720
078730*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00078730
078740*       DELLA TABELLA DI WORKING.                                 00078740
078750        MOVE '0005'      TO ABEND-CODE                            00078750
078760        DISPLAY 'BQVFB0-SC-060-01: SUPERATO IL NUMERO MASSIMO  '  00078760
078770        DISPLAY 'BQVFB0-SC-060-01: DI ELEMENTI PER LA TABELLA  '  00078770
078780        DISPLAY 'BQVFB0-SC-060-01: DI WORKING "W-TAB-PRPC".'      00078780
078790        CALL 'BQVFSR' USING ABEND-CODE.                           00078790
078800*                                                                 00078800
078810*    CHIUSURA ARCHIVIO PROVINCE DIRITTI CAMERALI                  00078810
078820     CLOSE   BQVFPC.                                              00078820
078830*                                                                 00078830
078840 SC-990-CAR-PRPC-EX.                                              00078840
078850     EXIT.                                                        00078850
078860***************************************************************** 00078860
078870*CARICAMENTO IN MEMORIA DEI LIMITI DI COMPENSABILITA' TRIBUTI   * 00078870
078880***************************************************************** 00078880
078890 SE-010-CAR-COMP.                                                 00078890
078900*                                                                 00078900
078910     SET W-PUNT-COTR TO 1.                                        00078910
078920     MOVE HIGH-VALUE   TO W-TAB-COMP-TRIB-OCC.                    00078920
078930     MOVE LOW-VALUE    TO W-FF.                                   00078930
078940*                                                                 00078940
078950     OPEN INPUT  BQVFCB.                                          00078950
078960*                                                                 00078960
078970 SE-020.                                                          00078970
078980     READ BQVFCB INTO BQVFCB1   AT END                            00078980
078990               MOVE HIGH-VALUE TO W-FF.                           00078990
079000     IF W-FF EQUAL LOW-VALUE                                      00079000
079010        GO TO SE-040.                                             00079010
079020 SE-030.                                                          00079020
079030     GO TO SE-050.                                                00079030
079040 SE-040.                                                          00079040
079050*                                                                 00079050
079060     MOVE BQVFCB1-COD-COMP    TO                                  00079060
079070                 W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR).           00079070
079080     MOVE BQVFCB1-COD-TRIB    TO                                  00079080
079090                 W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR).           00079090
079100     MOVE BQVFCB1-ESP-TRIB    TO                                  00079100
079110                 W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR).           00079110
079120     MOVE BQVFCB1-INIZIO-VAL  TO                                  00079120
079130                 W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR).         00079130
079140     MOVE BQVFCB1-FINE-VAL    TO                                  00079140
079150                 W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR).           00079150
079160     MOVE BQVFCB1-ANNO-RIF    TO                                  00079160
079170                 W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR).           00079170
079180     MOVE BQVFCB1-INIZ-INTER  TO                                  00079180
079190                 W-TAB-COMP-TRIB-INIZ-INTERV(W-PUNT-COTR).        00079190
079200     MOVE BQVFCB1-FINE-INTER  TO                                  00079200
079210                 W-TAB-COMP-TRIB-FINE-INTERV(W-PUNT-COTR).        00079210
079220 SE-050.                                                          00079220
079230*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00079230
079240     IF W-FF          = LOW-VALUE        AND                      00079240
079250        W-PUNT-COTR < W-TAB-COMP-TRIB-NUM-MAX                     00079250
079260        SET W-PUNT-COTR UP BY 1                                   00079260
079270        GO TO  SE-020.                                            00079270
079280 SE-060.                                                          00079280
079290*    VERIFICA SFONDAMENTO TABELLA                                 00079290
079300     IF W-PUNT-COTR = W-TAB-COMP-TRIB-NUM-MAX AND                 00079300
079310        W-FF          = LOW-VALUE                                 00079310
079320*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00079320
079330*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00079330
079340*       DELLA TABELLA DI WORKING.                                 00079340
079350        MOVE '0006'      TO ABEND-CODE                            00079350
079360        DISPLAY 'BQVFB0-SE-060-01: SUPERATO IL NUMERO MASSIMO  '  00079360
079370        DISPLAY 'BQVFB0-SE-060-01: DI ELEMENTI PER LA TABELLA  '  00079370
079380        DISPLAY 'BQVFB0-SE-060-01: DI WORKING "W-TAB-COMP-TRIB".' 00079380
079390        CALL 'BQVFSR' USING ABEND-CODE.                           00079390
079400*                                                                 00079400
079410     CLOSE   BQVFCB.                                              00079410
079420*                                                                 00079420
079430 SE-990-CAR-COMP-EX.                                              00079430
079440     EXIT.                                                        00079440
079450***************************************************************** 00079450
079460*CARICAMENTO IN MEMORIA DEI LIMITI DI COMPENSABILITA' TIPOLOGIE * 00079460
079470***************************************************************** 00079470
079480 SF-010-CAR-COMP.                                                 00079480
079490*                                                                 00079490
079500     SET W-PUNT-COTI TO 1.                                        00079500
079510     MOVE HIGH-VALUE   TO W-TAB-COMP-TIPO-OCC.                    00079510
079520     MOVE LOW-VALUE    TO W-FF.                                   00079520
079530*                                                                 00079530
079540     OPEN INPUT  BQVFCC.                                          00079540
079550*                                                                 00079550
079560 SF-020.                                                          00079560
079570     READ BQVFCC INTO BQVFCC1   AT END                            00079570
079580               MOVE HIGH-VALUE TO W-FF.                           00079580
079590     IF W-FF EQUAL LOW-VALUE                                      00079590
079600        GO TO SF-040.                                             00079600
079610 SF-030.                                                          00079610
079620     GO TO SF-050.                                                00079620
079630 SF-040.                                                          00079630
079640*                                                                 00079640
079650     MOVE BQVFCC1-COD-COMP    TO                                  00079650
079660                 W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI).           00079660
079670     MOVE BQVFCC1-INIZIO-VAL  TO                                  00079670
079680                 W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI).         00079680
079690     MOVE BQVFCC1-FINE-VAL    TO                                  00079690
079700                 W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI).           00079700
079710     MOVE BQVFCC1-SEZIONE     TO                                  00079710
079720                 W-TAB-COMP-TIPO-SEZIONE(W-PUNT-COTI).            00079720
079730     MOVE BQVFCC1-IMPORTO-1   TO                                  00079730
079740                 W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI).          00079740
079750     MOVE BQVFCC1-IMPORTO-2   TO                                  00079750
079760                 W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI).          00079760
079770 SF-050.                                                          00079770
079780*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00079780
079790     IF W-FF          = LOW-VALUE        AND                      00079790
079800        W-PUNT-COTI < W-TAB-COMP-TIPO-NUM-MAX                     00079800
079810        SET W-PUNT-COTI UP BY 1                                   00079810
079820        GO TO  SF-020.                                            00079820
079830 SF-060.                                                          00079830
079840*    VERIFICA SFONDAMENTO TABELLA                                 00079840
079850     IF W-PUNT-COTI = W-TAB-COMP-TIPO-NUM-MAX AND                 00079850
079860        W-FF          = LOW-VALUE                                 00079860
079870*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00079870
079880*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00079880
079890*       DELLA TABELLA DI WORKING.                                 00079890
079900        MOVE '0007'      TO ABEND-CODE                            00079900
079910        DISPLAY 'BQVFB0-SF-060-01: SUPERATO IL NUMERO MASSIMO  '  00079910
079920        DISPLAY 'BQVFB0-SF-060-01: DI ELEMENTI PER LA TABELLA  '  00079920
079930        DISPLAY 'BQVFB0-SF-060-01: DI WORKING "W-TAB-COMP-TIPO".' 00079930
079940        CALL 'BQVFSR' USING ABEND-CODE.                           00079940
079950*                                                                 00079950
079960     CLOSE   BQVFCC.                                              00079960
079970*                                                                 00079970
079980 SF-990-CAR-COMP-EX.                                              00079980
079990     EXIT.                                                        00079990
080000***************************************************************** 00080000
080010*    CARICAMENTO IN MEMORIA DEI CODICI TRIBUTO                  * 00080010
080020***************************************************************** 00080020
080030 RS-010-CAR-TRIB.                                                 00080030
080040*    INIZIALIZZO LA TABELLA DI WORKING                            00080040
080050     SET W-PUNT-TRIB TO 1.                                        00080050
080060     MOVE HIGH-VALUE   TO W-TAB-TRIB-OCC.                         00080060
080070     MOVE LOW-VALUE    TO W-FF.                                   00080070
080080*    APERTURA ARCHIVIO TRIBUTI                                    00080080
080090     OPEN INPUT  BQVFTR.                                          00080090
080100*                                                                 00080100
080110 RS-020.                                                          00080110
080120     READ BQVFTR INTO BQVFTR1   AT END                            00080120
080130               MOVE HIGH-VALUE TO W-FF.                           00080130
080140     IF W-FF EQUAL LOW-VALUE                                      00080140
080150        GO TO RS-040.                                             00080150
080160 RS-030.                                                          00080160
080170     GO TO RS-050.                                                00080170
080180 RS-040.                                                          00080180
080190*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00080190
080200     MOVE BQVFTR1-COD      TO W-TAB-TRIB-COD(W-PUNT-TRIB).        00080200
080210     MOVE BQVFTR1-INIZ-VAL TO                                     00080210
080220                           W-TAB-TRIB-INI-VAL(W-PUNT-TRIB).       00080220
080230     MOVE BQVFTR1-FINE-VAL TO                                     00080230
080240                           W-TAB-TRIB-FIN-VAL(W-PUNT-TRIB).       00080240
080250     MOVE BQVFTR1-TIPO-TRIB TO                                    00080250
080260                           W-TAB-TRIB-TIPO-TR(W-PUNT-TRIB).       00080260
080270     MOVE BQVFTR1-TIPO-PERIODO TO                                 00080270
080280                           W-TAB-TRIB-TIPO-PE(W-PUNT-TRIB).       00080280
080290     MOVE BQVFTR1-FLAG-COMPENS TO                                 00080290
080300                           W-TAB-TRIB-FLAG-COMPEN(W-PUNT-TRIB).   00080300
080310     MOVE BQVFTR1-FLAG-AGEV    TO                                 00080310
080320                           W-TAB-TRIB-FLAG-AGEV(W-PUNT-TRIB).     00080320
080330     MOVE BQVFTR1-FLAG-CONC    TO                                 00080330
080340                           W-TAB-TRIB-FLAG-CONC(W-PUNT-TRIB).     00080340
080350     MOVE BQVFTR1-ELEM-IDENT   TO                                 00080350
080360                           W-TAB-TRIB-ELEM-IDENT(W-PUNT-TRIB).    00080360
080370     MOVE BQVFTR1-COD-ATTO     TO                                 00080370
080380                           W-TAB-TRIB-COD-ATTO(W-PUNT-TRIB).      00080380
080390     MOVE BQVFTR1-COD-UFF      TO                                 00080390
080400                           W-TAB-TRIB-COD-UFF(W-PUNT-TRIB).       00080400
080410     MOVE BQVFTR1-ANNO-RIF     TO                                 00080410
080420                           W-TAB-TRIB-ANNO-RIF(W-PUNT-TRIB).      00080420
080430     MOVE BQVFTR1-IDENT-OPER   TO                                 00080430
080440                           W-TAB-TRIB-IDENT-OPER(W-PUNT-TRIB).    00080440
080450     MOVE BQVFTR1-TAB-ENTE-COMUNE-1   TO                          00080450
080460                  W-TAB-TRIB-TAB-ENTE-COMUNE-1(W-PUNT-TRIB).      00080460
080470     MOVE BQVFTR1-TAB-ENTE-COMUNE-2   TO                          00080470
080480                  W-TAB-TRIB-TAB-ENTE-COMUNE-2(W-PUNT-TRIB).      00080480
080490     MOVE BQVFTR1-TAB-ENTE-COMUNE-3   TO                          00080490
080500                  W-TAB-TRIB-TAB-ENTE-COMUNE-3(W-PUNT-TRIB).      00080500
080510 RS-050.                                                          00080510
080520*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00080520
080530     IF W-FF        = LOW-VALUE        AND                        00080530
080540        W-PUNT-TRIB < W-TAB-TRIB-NUM-MAX                          00080540
080550        SET W-PUNT-TRIB UP BY 1                                   00080550
080560        GO TO  RS-020.                                            00080560
080570 RS-060.                                                          00080570
080580*    VERIFICA SFONDAMENTO TABELLA                                 00080580
080590     IF W-PUNT-TRIB = W-TAB-TRIB-NUM-MAX AND                      00080590
080600        W-FF          = LOW-VALUE                                 00080600
080610*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00080610
080620*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00080620
080630*       DELLA TABELLA DI WORKING.                                 00080630
080640        MOVE '0006'      TO ABEND-CODE                            00080640
080650        DISPLAY 'BQVFB0-RS-060-01: SUPERATO IL NUMERO MASSIMO  '  00080650
080660        DISPLAY 'BQVFB0-RS-060-01: DI ELEMENTI PER LA TABELLA  '  00080660
080670        DISPLAY 'BQVFB0-RS-060-01: DI WORKING "W-TAB-TRIBUTI".'   00080670
080680        CALL 'BQVFSR' USING ABEND-CODE.                           00080680
080690*                                                                 00080690
080700*    CHIUSURA ARCHIVIO TRIBUTI                                    00080700
080710     CLOSE   BQVFTR.                                              00080710
080720*                                                                 00080720
080730 RS-990-CAR-TRIB-EX.                                              00080730
080740     EXIT.                                                        00080740
080750***************************************************************** 00080750
080760*AN  INIZIO MODIFICA 30 APRILE 2004 - MONOPOLI                  * 00080760
080770*    CARICAMENTO IN MEMORIA DEI CODICI TRIBUTO                  * 00080770
080780***************************************************************** 00080780
080790 SR-010-CAR-ENTI-TRIB.                                            00080790
080800*    INIZIALIZZO LA TABELLA DI WORKING                            00080800
080810     SET W-PUNT-ENTI-TRIB TO 1.                                   00080810
080820     MOVE HIGH-VALUE   TO W-TAB-ENTI-TRIB-OCC.                    00080820
080830     MOVE LOW-VALUE    TO W-FF.                                   00080830
080840*    APERTURA ARCHIVIO ENTI-TRIBUTI                               00080840
080850     OPEN INPUT  BQVFTE.                                          00080850
080860*                                                                 00080860
080870 SR-020.                                                          00080870
080880     READ BQVFTE INTO BQVFTE1   AT END                            00080880
080890               MOVE HIGH-VALUE TO W-FF.                           00080890
080900     IF W-FF EQUAL LOW-VALUE                                      00080900
080910        GO TO SR-040.                                             00080910
080920 SR-030.                                                          00080920
080930     GO TO SR-050.                                                00080930
080940 SR-040.                                                          00080940
080950*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00080950
080960     MOVE BQVFTE1-KEY-COD-ENTE TO                                 00080960
080970                    W-TAB-ENTI-TRIB-COD-ENTE(W-PUNT-ENTI-TRIB).   00080970
080980     MOVE BQVFTE1-KEY-COD-TRIB TO                                 00080980
080990                    W-TAB-ENTI-TRIB-COD-TRIB(W-PUNT-ENTI-TRIB).   00080990
081000     MOVE BQVFTE1-KEY-INIZIO-VAL TO                               00081000
081010                    W-TAB-ENTI-TRIB-INIZIO-VAL(W-PUNT-ENTI-TRIB). 00081010
081020     MOVE BQVFTE1-FINE-VAL TO                                     00081020
081030                    W-TAB-ENTI-TRIB-FINE-VAL(W-PUNT-ENTI-TRIB).   00081030
081040     MOVE BQVFTE1-DESCR    TO                                     00081040
081050                    W-TAB-ENTI-TRIB-DESCR(W-PUNT-ENTI-TRIB).      00081050
081060     MOVE BQVFTE1-PROV     TO                                     00081060
081070                    W-TAB-ENTI-TRIB-PR(W-PUNT-ENTI-TRIB).         00081070
081080     MOVE BQVFTE1-COD-IDENT TO                                    00081080
081090                    W-TAB-ENTI-TRIB-COD-IDENT(W-PUNT-ENTI-TRIB).  00081090
081100     MOVE BQVFTE1-RIFER-TRIB   TO                                 00081100
081110                    W-TAB-ENTI-TRIB-RIFER-TRIB(W-PUNT-ENTI-TRIB). 00081110
081120     MOVE BQVFTE1-COD-UFF      TO                                 00081120
081130                    W-TAB-ENTI-TRIB-COD-UFF(W-PUNT-ENTI-TRIB).    00081130
081140     MOVE BQVFTE1-COD-ATTO     TO                                 00081140
081150                    W-TAB-ENTI-TRIB-COD-ATTO(W-PUNT-ENTI-TRIB).   00081150
081160     MOVE BQVFTE1-RATEAZIONE   TO                                 00081160
081170                    W-TAB-ENTI-TRIB-RATEAZIONE(W-PUNT-ENTI-TRIB). 00081170
081180*                                                                 00081180
081190 SR-050.                                                          00081190
081200*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00081200
081210     IF W-FF        = LOW-VALUE        AND                        00081210
081220        W-PUNT-ENTI-TRIB < W-TAB-ENTI-TRIB-NUM-MAX                00081220
081230        SET W-PUNT-ENTI-TRIB UP BY 1                              00081230
081240        GO TO  SR-020.                                            00081240
081250*                                                                 00081250
081260 SR-060.                                                          00081260
081270*    VERIFICA SFONDAMENTO TABELLA                                 00081270
081280     IF W-PUNT-ENTI-TRIB = W-TAB-ENTI-TRIB-NUM-MAX AND            00081280
081290        W-FF          = LOW-VALUE                                 00081290
081300*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00081300
081310*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00081310
081320*       DELLA TABELLA DI WORKING.                                 00081320
081330        MOVE '0099'      TO ABEND-CODE                            00081330
081340        DISPLAY 'BQVFB0-SR-060-01: SUPERATO IL NUMERO MASSIMO  '  00081340
081350        DISPLAY 'BQVFB0-SR-060-01: DI ELEMENTI PER LA TABELLA  '  00081350
081360        DISPLAY 'BQVFB0-SR-060-01: DI WORKING "W-TAB-ENTI-TRIB".' 00081360
081370        CALL 'BQVFSR' USING ABEND-CODE.                           00081370
081380*                                                                 00081380
081390*    CHIUSURA ARCHIVIO TRIBUTI                                    00081390
081400     CLOSE   BQVFTE.                                              00081400
081410*                                                                 00081410
081420 SR-990-CAR-ENTI-TRIB-EX.                                         00081420
081430     EXIT.                                                        00081430
081440*AN  FINE MODIFICA 30 APRILE 2004 - MONOPOLI                    * 00081440
081450***************************************************************** 00081450
081460*    CARICAMENTO IN MEMORIA DEI CODICI MATR.INPS                * 00081460
081470***************************************************************** 00081470
081480 RT-010-CAR-MATR.                                                 00081480
081490*    INIZIALIZZO LA TABELLA DI WORKING                            00081490
081500     SET W-PUNT-MATR   TO 1.                                      00081500
081510     MOVE HIGH-VALUE   TO W-TAB-MATR-OCC.                         00081510
081520     MOVE LOW-VALUE    TO W-FF.                                   00081520
081530*    APERTURA ARCHIVIO MATRICOLE INPS                             00081530
081540     OPEN INPUT  BQVFMA.                                          00081540
081550*                                                                 00081550
081560 RT-020.                                                          00081560
081570     READ BQVFMA INTO BQVFMA1   AT END                            00081570
081580               MOVE HIGH-VALUE TO W-FF.                           00081580
081590     IF W-FF EQUAL LOW-VALUE                                      00081590
081600        GO TO RT-040.                                             00081600
081610 RT-030.                                                          00081610
081620     GO TO RT-050.                                                00081620
081630 RT-040.                                                          00081630
081640**MODIFICA 13/03/2006                                             00081640
081650**AGGIUNTO FLAG-COMPEN                                            00081650
081660*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00081660
081670     MOVE BQVFMA1-COD   TO W-TAB-MATR-COD(W-PUNT-MATR).           00081670
081680     MOVE BQVFMA1-INIZ-VAL TO                                     00081680
081690                           W-TAB-MATR-INI-VAL(W-PUNT-MATR).       00081690
081700     MOVE BQVFMA1-FINE-VAL TO                                     00081700
081710                           W-TAB-MATR-FIN-VAL(W-PUNT-MATR).       00081710
081720     MOVE BQVFMA1-FORM     TO W-TAB-MATR-FORM(W-PUNT-MATR).       00081720
081730     MOVE BQVFMA1-TIPO-INI  TO W-TAB-MATR-TIPO-INI(W-PUNT-MATR).  00081730
081740     MOVE BQVFMA1-TIPO-FINE TO W-TAB-MATR-TIPO-FIN(W-PUNT-MATR).  00081740
081750     MOVE BQVFMA1-DESCR     TO W-TAB-MATR-DESR(W-PUNT-MATR).      00081750
081760     MOVE BQVFMA1-FLAG-COMPEN TO                                  00081760
081770                     W-TAB-MATR-FL-COMP(W-PUNT-MATR).             00081770
081780 RT-050.                                                          00081780
081790*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00081790
081800     IF W-FF          = LOW-VALUE        AND                      00081800
081810        W-PUNT-MATR < W-TAB-MATR-NUM-MAX                          00081810
081820        SET W-PUNT-MATR UP BY 1                                   00081820
081830        GO TO  RT-020.                                            00081830
081840 RT-060.                                                          00081840
081850*    VERIFICA SFONDAMENTO TABELLA                                 00081850
081860     IF W-PUNT-MATR = W-TAB-MATR-NUM-MAX AND                      00081860
081870        W-FF          = LOW-VALUE                                 00081870
081880*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00081880
081890*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00081890
081900*       DELLA TABELLA DI WORKING.                                 00081900
081910        MOVE '0000'      TO ABEND-CODE                            00081910
081920        DISPLAY 'BQVFB0-RT-060-01: SUPERATO IL NUMERO MASSIMO  '  00081920
081930        DISPLAY 'BQVFB0-RT-060-01: DI ELEMENTI PER LA TABELLA  '  00081930
081940        DISPLAY 'BQVFB0-RT-060-01: DI WORKING "W-TAB-MATR".'      00081940
081950        CALL 'BQVFSR' USING ABEND-CODE.                           00081950
081960*                                                                 00081960
081970*    CHIUSURA ARCHIVIO MATRICOLE INPS                             00081970
081980     CLOSE   BQVFMA.                                              00081980
081990*                                                                 00081990
082000 RT-990-CAR-MATR-EX.                                              00082000
082010     EXIT.                                                        00082010
082020***************************************************************** 00082020
082030*    CARICAMENTO IN MEMORIA DEI CODICI SEDE INPS                * 00082030
082040***************************************************************** 00082040
082050 RU-010-CAR-SEDE.                                                 00082050
082060*    INIZIALIZZO LA TABELLA DI WORKING                            00082060
082070     SET W-PUNT-SEDE   TO 1.                                      00082070
082080     MOVE HIGH-VALUE   TO W-TAB-SEDE-OCC.                         00082080
082090     MOVE LOW-VALUE    TO W-FF.                                   00082090
082100*    APERTURA ARCHIVIO SEDI INPS                                  00082100
082110     OPEN INPUT  BQVFSE.                                          00082110
082120*                                                                 00082120
082130 RU-020.                                                          00082130
082140     READ BQVFSE INTO BQVFSE1   AT END                            00082140
082150               MOVE HIGH-VALUE TO W-FF.                           00082150
082160     IF W-FF EQUAL LOW-VALUE                                      00082160
082170        GO TO RU-040.                                             00082170
082180 RU-030.                                                          00082180
082190     GO TO RU-050.                                                00082190
082200 RU-040.                                                          00082200
082210*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00082210
082220     MOVE BQVFSE1-COD   TO W-TAB-SEDE-COD(W-PUNT-SEDE).           00082220
082230 RU-050.                                                          00082230
082240*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00082240
082250     IF W-FF          = LOW-VALUE        AND                      00082250
082260        W-PUNT-SEDE < W-TAB-SEDE-NUM-MAX                          00082260
082270        SET W-PUNT-SEDE UP BY 1                                   00082270
082280        GO TO  RU-020.                                            00082280
082290 RU-060.                                                          00082290
082300*    VERIFICA SFONDAMENTO TABELLA                                 00082300
082310     IF W-PUNT-SEDE = W-TAB-SEDE-NUM-MAX AND                      00082310
082320        W-FF          = LOW-VALUE                                 00082320
082330*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00082330
082340*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00082340
082350*       DELLA TABELLA DI WORKING.                                 00082350
082360        MOVE '0000'      TO ABEND-CODE                            00082360
082370        DISPLAY 'BQVFB0-RU-060-01: SUPERATO IL NUMERO MASSIMO  '  00082370
082380        DISPLAY 'BQVFB0-RU-060-01: DI ELEMENTI PER LA TABELLA  '  00082380
082390        DISPLAY 'BQVFB0-RU-060-01: DI WORKING "W-TAB-SEDE".'      00082390
082400        CALL 'BQVFSR' USING ABEND-CODE.                           00082400
082410*                                                                 00082410
082420*    CHIUSURA ARCHIVIO SEDI INPS                                  00082420
082430     CLOSE   BQVFSE.                                              00082430
082440*                                                                 00082440
082450 RU-990-CAR-SEDE-EX.                                              00082450
082460     EXIT.                                                        00082460
082470***************************************************************** 00082470
082480*    CARICAMENTO IN MEMORIA DEI CODICI ENTI LOCALI              * 00082480
082490***************************************************************** 00082490
082500 RV-010-CAR-ENTE.                                                 00082500
082510*    INIZIALIZZO LA TABELLA DI WORKING                            00082510
082520     SET W-PUNT-ENTE   TO 1.                                      00082520
082530     MOVE HIGH-VALUE   TO W-TAB-ENTE-OCC.                         00082530
082540     MOVE LOW-VALUE    TO W-FF.                                   00082540
082550*    APERTURA ARCHIVIO ENTI LOCALI                                00082550
082560     OPEN INPUT  BQVFEL.                                          00082560
082570*                                                                 00082570
082580 RV-020.                                                          00082580
082590     READ BQVFEL INTO BQVFEL1   AT END                            00082590
082600               MOVE HIGH-VALUE TO W-FF.                           00082600
082610     IF W-FF EQUAL LOW-VALUE                                      00082610
082620        GO TO RV-040.                                             00082620
082630 RV-030.                                                          00082630
082640     GO TO RV-050.                                                00082640
082650 RV-040.                                                          00082650
082660*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00082660
082670     MOVE BQVFEL1-COD      TO W-TAB-ENTE-COD(W-PUNT-ENTE).        00082670
082680     MOVE BQVFEL1-INIZ-VAL TO W-TAB-ENTE-INIZ(W-PUNT-ENTE).       00082680
082690     MOVE BQVFEL1-FINE-VAL TO W-TAB-ENTE-FINE(W-PUNT-ENTE).       00082690
082700 RV-050.                                                          00082700
082710*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00082710
082720     IF W-FF          = LOW-VALUE        AND                      00082720
082730        W-PUNT-ENTE < W-TAB-ENTE-NUM-MAX                          00082730
082740        SET W-PUNT-ENTE UP BY 1                                   00082740
082750        GO TO  RV-020.                                            00082750
082760 RV-060.                                                          00082760
082770*    VERIFICA SFONDAMENTO TABELLA                                 00082770
082780     IF W-PUNT-ENTE = W-TAB-ENTE-NUM-MAX AND                      00082780
082790        W-FF          = LOW-VALUE                                 00082790
082800*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00082800
082810*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00082810
082820*       DELLA TABELLA DI WORKING.                                 00082820
082830        MOVE '0000'      TO ABEND-CODE                            00082830
082840        DISPLAY 'BQVFB0-RV-060-01: SUPERATO IL NUMERO MASSIMO  '  00082840
082850        DISPLAY 'BQVFB0-RV-060-01: DI ELEMENTI PER LA TABELLA  '  00082850
082860        DISPLAY 'BQVFB0-RV-060-01: DI WORKING "W-TAB-ENTE".'      00082860
082870        CALL 'BQVFSR' USING ABEND-CODE.                           00082870
082880*                                                                 00082880
082890*    CHIUSURA ARCHIVIO ENTI LOCALI                                00082890
082900     CLOSE   BQVFEL.                                              00082900
082910*                                                                 00082910
082920 RV-990-CAR-ENTE-EX.                                              00082920
082930     EXIT.                                                        00082930
082940***************************************************************** 00082940
082950*    CARICAMENTO IN MEMORIA DEI LINK CODICI CATASTALI - TRIBUTO   00082950
082960***************************************************************** 00082960
082970 R6-010-CAR-CAT-TRIB.                                             00082970
082980**** INIZIALIZZO LA TABELLA DI WORKING                            00082980
082990     SET W-PUNT-CAT-TRIB   TO 1.                                  00082990
083000     MOVE HIGH-VALUE   TO W-TAB-CAT-TRIB-OCC.                     00083000
083010     MOVE LOW-VALUE    TO W-FF.                                   00083010
083020**** APERTURA ARCHIVIO CODICI CATASTALI                           00083020
083030     OPEN INPUT  BQVFTC.                                          00083030
083040*                                                                 00083040
083050 R6-020.                                                          00083050
083060     READ BQVFTC INTO BQVFTC1   AT END                            00083060
083070               MOVE HIGH-VALUE TO W-FF.                           00083070
083080     IF W-FF EQUAL LOW-VALUE                                      00083080
083090        GO TO R6-040.                                             00083090
083100 R6-030.                                                          00083100
083110     GO TO R6-050.                                                00083110
083120 R6-040.                                                          00083120
083130***  ESTRATTA UNA COPPIA CODICE COMUNE - TRIBUTO:                 00083130
083140***  LA IMPOSTO IN TABELLA                                        00083140
083150     MOVE BQVFTC1-COD-ENTE                                        00083150
083160           TO W-TAB-CAT-TRIB-ENTE(W-PUNT-CAT-TRIB).               00083160
083170     MOVE BQVFTC1-COD-TRIB                                        00083170
083180           TO W-TAB-CAT-TRIB-TRIBUTO(W-PUNT-CAT-TRIB).            00083180
083190     MOVE BQVFTC1-INIZIO-VAL                                      00083190
083200           TO W-TAB-CAT-TRIB-INIZ(W-PUNT-CAT-TRIB).               00083200
083210     MOVE BQVFTC1-FINE-VAL                                        00083210
083220           TO W-TAB-CAT-TRIB-FINE(W-PUNT-CAT-TRIB).               00083220
083230     MOVE BQVFTC1-TIPO-IMP                                        00083230
083240           TO W-TAB-CAT-TRIB-TIPO-IMP(W-PUNT-CAT-TRIB).           00083240
083250 R6-050.                                                          00083250
083260**** VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00083260
083270     IF W-FF          = LOW-VALUE        AND                      00083270
083280        W-PUNT-CAT-TRIB < W-TAB-CAT-TRIB-NUM-MAX                  00083280
083290        SET W-PUNT-CAT-TRIB UP BY 1                               00083290
083300        GO TO  R6-020.                                            00083300
083310 R6-060.                                                          00083310
083320***  VERIFICA SFONDAMENTO TABELLA                                 00083320
083330     IF W-PUNT-CAT-TRIB = W-TAB-CAT-TRIB-NUM-MAX AND              00083330
083340        W-FF          = LOW-VALUE                                 00083340
083350***     SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00083350
083360***     IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00083360
083370***     DELLA TABELLA DI WORKING.                                 00083370
083380        MOVE '0000'      TO ABEND-CODE                            00083380
083390        DISPLAY 'BQVFB0-R6-060-01: SUPERATO IL NUMERO MASSIMO  '  00083390
083400        DISPLAY 'BQVFB0-R6-060-01: DI ELEMENTI PER LA TABELLA  '  00083400
083410        DISPLAY 'BQVFB0-R6-060-01: DI WORKING "W-TAB-CAT-TRIB".'  00083410
083420        CALL 'BQVFSR' USING ABEND-CODE.                           00083420
083430***                                                               00083430
083440***  CHIUSURA ARCHIVIO ENTI LOCALI                                00083440
083450     CLOSE   BQVFTC.                                              00083450
083460***                                                               00083460
083470 R6-990-CAR-CAT-TRIB-EX.                                          00083470
083480     EXIT.                                                        00083480
083490***************************************************************** 00083490
083500*    CARICAMENTO IN MEMORIA DELLA TABELLA CODICI AMMESSI TR       00083500
083510***************************************************************** 00083510
083520 R7-010-CAR-COD-T3.                                               00083520
083530**** INIZIALIZZO LA TABELLA DI WORKING                            00083530
083540     SET W-PUNT-T3         TO 1.                                  00083540
083550     MOVE HIGH-VALUE   TO W-TAB-COD-T3-OCC.                       00083550
083560     MOVE LOW-VALUE    TO W-FF.                                   00083560
083570**** APERTURA ARCHIVIO CODICI T3                                  00083570
083580     OPEN INPUT  BQVFT3.                                          00083580
083590*                                                                 00083590
083600 R7-020.                                                          00083600
083610     READ BQVFT3 INTO BQVFT31   AT END                            00083610
083620               MOVE HIGH-VALUE TO W-FF.                           00083620
083630     IF W-FF EQUAL LOW-VALUE                                      00083630
083640        GO TO R7-040.                                             00083640
083650 R7-030.                                                          00083650
083660     GO TO R7-050.                                                00083660
083670 R7-040.                                                          00083670
083680***  ESTRATTA UNA RIGA                                            00083680
083690***  LA IMPOSTO IN TABELLA                                        00083690
083700     MOVE BQVFT31-COD-FORMAL                                      00083700
083710           TO W-TAB-T3-COD-FORMAL(W-PUNT-T3).                     00083710
083720     MOVE BQVFT31-CODICE                                          00083720
083730           TO W-TAB-T3-CODICE(W-PUNT-T3).                         00083730
083740     MOVE BQVFT31-INIZIO-VAL                                      00083740
083750           TO W-TAB-T3-INIZIO-VAL(W-PUNT-T3).                     00083750
083760     MOVE BQVFT31-FINE-VAL                                        00083760
083770           TO W-TAB-T3-FINE-VAL(W-PUNT-T3).                       00083770
083780 R7-050.                                                          00083780
083790**** VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00083790
083800     IF W-FF          = LOW-VALUE        AND                      00083800
083810        W-PUNT-T3 < W-TAB-COD-T3-NUM-MAX                          00083810
083820        SET W-PUNT-T3 UP BY 1                                     00083820
083830        GO TO  R7-020.                                            00083830
083840 R7-060.                                                          00083840
083850***  VERIFICA SFONDAMENTO TABELLA                                 00083850
083860     IF W-PUNT-T3     = W-TAB-COD-T3-NUM-MAX AND                  00083860
083870        W-FF          = LOW-VALUE                                 00083870
083880***     SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00083880
083890***     IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00083890
083900***     DELLA TABELLA DI WORKING.                                 00083900
083910        MOVE '0000'      TO ABEND-CODE                            00083910
083920        DISPLAY 'BQVFB0-R7-060-01: SUPERATO IL NUMERO MASSIMO  '  00083920
083930        DISPLAY 'BQVFB0-R7-060-01: DI ELEMENTI PER LA TABELLA  '  00083930
083940        DISPLAY 'BQVFB0-R7-060-01: DI WORKING "W-TAB-COD-T3".  '  00083940
083950        CALL 'BQVFSR' USING ABEND-CODE.                           00083950
083960***                                                               00083960
083970***  CHIUSURA ARCHIVIO ENTI LOCALI                                00083970
083980     CLOSE   BQVFT3.                                              00083980
083990***                                                               00083990
084000 R7-990-CAR-COD-T3-EX.                                            00084000
084010     EXIT.                                                        00084010
084020***************************************************************** 00084020
084030*    CARICAMENTO IN MEMORIA DELLA TABELLA INTERESSI - COMMISSIONI 00084030
084040***************************************************************** 00084040
084050 R8-010-CAR-IC.                                                   00084050
084060**** INIZIALIZZO LA TABELLA DI WORKING                            00084060
084070     SET W-PUNT-IC         TO 1.                                  00084070
084080     MOVE HIGH-VALUE   TO W-TAB-IC-OCC.                           00084080
084090     MOVE LOW-VALUE    TO W-FF.                                   00084090
084100**** APERTURA ARCHIVIO IC                                         00084100
084110     OPEN INPUT  BQVFIC.                                          00084110
084120*                                                                 00084120
084130 R8-020.                                                          00084130
084140     READ BQVFIC INTO BQVFIC1   AT END                            00084140
084150               MOVE HIGH-VALUE TO W-FF.                           00084150
084160     IF W-FF EQUAL LOW-VALUE                                      00084160
084170        GO TO R8-040.                                             00084170
084180 R8-030.                                                          00084180
084190     GO TO R8-050.                                                00084190
084200 R8-040.                                                          00084200
084210***  ESTRATTA UNA RIGA                                            00084210
084220***  LA IMPOSTO IN TABELLA                                        00084220
084230     MOVE BQVFIC1-TIPO                                            00084230
084240           TO W-TAB-IC-TIPO(W-PUNT-IC).                           00084240
084250     MOVE BQVFIC1-ENTE                                            00084250
084260           TO W-TAB-IC-ENTE(W-PUNT-IC).                           00084260
084270     MOVE BQVFIC1-MOD-CONF                                        00084270
084280           TO W-TAB-IC-MOD-CONF(W-PUNT-IC).                       00084280
084290     MOVE BQVFIC1-INIZIO-VAL                                      00084290
084300           TO W-TAB-IC-INIZIO-VAL(W-PUNT-IC).                     00084300
084310     MOVE BQVFIC1-FINE-VAL                                        00084310
084320           TO W-TAB-IC-FINE-VAL(W-PUNT-IC).                       00084320
084330     MOVE BQVFIC1-COMM                                            00084330
084340           TO W-TAB-IC-COMM(W-PUNT-IC).                           00084340
084350     MOVE BQVFIC1-INTER                                           00084350
084360           TO W-TAB-IC-INTER(W-PUNT-IC).                          00084360
084370 R8-050.                                                          00084370
084380**** VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00084380
084390     IF W-FF          = LOW-VALUE        AND                      00084390
084400        W-PUNT-IC < W-TAB-IC-NUM-MAX                              00084400
084410        SET W-PUNT-IC UP BY 1                                     00084410
084420        GO TO  R8-020.                                            00084420
084430 R8-060.                                                          00084430
084440***  VERIFICA SFONDAMENTO TABELLA                                 00084440
084450     IF W-PUNT-IC     = W-TAB-IC-NUM-MAX AND                      00084450
084460        W-FF          = LOW-VALUE                                 00084460
084470***     SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00084470
084480***     IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00084480
084490***     DELLA TABELLA DI WORKING.                                 00084490
084500        MOVE '0000'      TO ABEND-CODE                            00084500
084510        DISPLAY 'BQVFB0-R8-060-01: SUPERATO IL NUMERO MASSIMO  '  00084510
084520        DISPLAY 'BQVFB0-R8-060-01: DI ELEMENTI PER LA TABELLA  '  00084520
084530        DISPLAY 'BQVFB0-R8-060-01: DI WORKING "W-TAB-IC".  '      00084530
084540        CALL 'BQVFSR' USING ABEND-CODE.                           00084540
084550***                                                               00084550
084560***  CHIUSURA ARCHIVIO ENTI LOCALI                                00084560
084570     CLOSE   BQVFIC.                                              00084570
084580***                                                               00084580
084590 R8-990-CAR-IC-EX.                                                00084590
084600     EXIT.                                                        00084600
084610***************************************************************** 00084610
084620*    CARICAMENTO IN MEMORIA DEI CODICI INAIL                    * 00084620
084630***************************************************************** 00084630
084640 RZ-010-CAR-INAIL.                                                00084640
084650                                                                  00084650
084660*    INIZIALIZZO LA TABELLA DI WORKING                            00084660
084670     SET W-PUNT-INAIL  TO 1.                                      00084670
084680     MOVE HIGH-VALUE   TO W-TAB-INAIL-OCC.                        00084680
084690     MOVE LOW-VALUE    TO W-FF.                                   00084690
084700*    APERTURA ARCHIVIO INAIL                                      00084700
084710     OPEN INPUT  BQVFIN.                                          00084710
084720*                                                                 00084720
084730 RZ-020.                                                          00084730
084740     READ BQVFIN INTO BQVFIN1   AT END                            00084740
084750               MOVE HIGH-VALUE TO W-FF.                           00084750
084760     IF W-FF EQUAL LOW-VALUE                                      00084760
084770        GO TO RZ-040.                                             00084770
084780 RZ-030.                                                          00084780
084790     GO TO RZ-050.                                                00084790
084800 RZ-040.                                                          00084800
084810*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00084810
084820     MOVE BQVFIN1-COD      TO W-TAB-INAIL-COD(W-PUNT-INAIL).      00084820
084830     MOVE BQVFIN1-INIZ-VAL TO W-TAB-INAIL-INIZ(W-PUNT-INAIL).     00084830
084840     MOVE BQVFIN1-FINE-VAL TO W-TAB-INAIL-FINE(W-PUNT-INAIL).     00084840
084850 RZ-050.                                                          00084850
084860*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00084860
084870     IF W-FF         = LOW-VALUE         AND                      00084870
084880        W-PUNT-INAIL < W-TAB-INAIL-NUM-MAX                        00084880
084890        SET W-PUNT-INAIL UP BY 1                                  00084890
084900        GO TO  RZ-020.                                            00084900
084910 RZ-060.                                                          00084910
084920*    VERIFICA SFONDAMENTO TABELLA                                 00084920
084930     IF W-PUNT-INAIL = W-TAB-INAIL-NUM-MAX AND                    00084930
084940        W-FF         = LOW-VALUE                                  00084940
084950*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00084950
084960*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00084960
084970*       DELLA TABELLA DI WORKING.                                 00084970
084980        MOVE '0000'      TO ABEND-CODE                            00084980
084990        DISPLAY 'BQVFB0-RZ-060-01: SUPERATO IL NUMERO MASSIMO  '  00084990
085000        DISPLAY 'BQVFB0-RZ-060-01: DI ELEMENTI PER LA TABELLA  '  00085000
085010        DISPLAY 'BQVFB0-RZ-060-01: DI WORKING "W-TAB-INAIL".'     00085010
085020        CALL 'BQVFSR' USING ABEND-CODE.                           00085020
085030*                                                                 00085030
085040*    CHIUSURA ARCHIVIO INAIL                                      00085040
085050     CLOSE   BQVFIN.                                              00085050
085060*                                                                 00085060
085070 RZ-990-CAR-INAIL-EX.                                             00085070
085080     EXIT.                                                        00085080
085090***************************************************************** 00085090
085100*    CARICAMENTO IN MEMORIA DEI CODICI ALTRI ENTI               * 00085100
085110***************************************************************** 00085110
085120 RX-010-CAR-ALTRO.                                                00085120
085130*    INIZIALIZZO LA TABELLA DI WORKING                            00085130
085140     SET W-PUNT-ALTRO  TO 1.                                      00085140
085150     MOVE HIGH-VALUE   TO W-TAB-ALTRO-OCC.                        00085150
085160     MOVE LOW-VALUE    TO W-FF.                                   00085160
085170*    APERTURA ARCHIVIO ALTRI ENTI                                 00085170
085180     OPEN INPUT  BQVFAE.                                          00085180
085190*                                                                 00085190
085200 RX-020.                                                          00085200
085210     READ BQVFAE INTO BQVFAE1   AT END                            00085210
085220               MOVE HIGH-VALUE TO W-FF.                           00085220
085230     IF W-FF EQUAL LOW-VALUE                                      00085230
085240        GO TO RX-040.                                             00085240
085250 RX-030.                                                          00085250
085260     GO TO RX-050.                                                00085260
085270 RX-040.                                                          00085270
085280*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00085280
085290     MOVE BQVFAE1-COD      TO W-TAB-ALTRO-COD(W-PUNT-ALTRO).      00085290
085300     MOVE BQVFAE1-SEDE     TO W-TAB-ALTRO-SEDE(W-PUNT-ALTRO).     00085300
085310     MOVE BQVFAE1-INIZ-VAL TO W-TAB-ALTRO-INIZ(W-PUNT-ALTRO).     00085310
085320     MOVE BQVFAE1-FINE-VAL TO W-TAB-ALTRO-FINE(W-PUNT-ALTRO).     00085320
085330 RX-050.                                                          00085330
085340*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00085340
085350     IF W-FF         = LOW-VALUE         AND                      00085350
085360        W-PUNT-ALTRO < W-TAB-ALTRO-NUM-MAX                        00085360
085370        SET W-PUNT-ALTRO UP BY 1                                  00085370
085380        GO TO  RX-020.                                            00085380
085390 RX-060.                                                          00085390
085400*    VERIFICA SFONDAMENTO TABELLA                                 00085400
085410     IF W-PUNT-ALTRO = W-TAB-ALTRO-NUM-MAX AND                    00085410
085420        W-FF         = LOW-VALUE                                  00085420
085430*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00085430
085440*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00085440
085450*       DELLA TABELLA DI WORKING.                                 00085450
085460        MOVE '0000'      TO ABEND-CODE                            00085460
085470        DISPLAY 'BQVFB0-RX-060-01: SUPERATO IL NUMERO MASSIMO  '  00085470
085480        DISPLAY 'BQVFB0-RX-060-01: DI ELEMENTI PER LA TABELLA  '  00085480
085490        DISPLAY 'BQVFB0-RX-060-01: DI WORKING "W-TAB-ALTRO".'     00085490
085500        CALL 'BQVFSR' USING ABEND-CODE.                           00085500
085510*                                                                 00085510
085520*    CHIUSURA ARCHIVIO ALTRI ENTI                                 00085520
085530     CLOSE   BQVFAE.                                              00085530
085540*                                                                 00085540
085550 RX-990-CAR-ALTRO-EX.                                             00085550
085560     EXIT.                                                        00085560
085570***************************************************************** 00085570
085580*    CARICAMENTO IN MEMORIA DELLE CAUSALI ALTRI ENTI            * 00085580
085590***************************************************************** 00085590
085600 RW-010-CAR-CAUS.                                                 00085600
085610*    INIZIALIZZO LA TABELLA DI WORKING                            00085610
085620     SET W-PUNT-CAUS   TO 1.                                      00085620
085630     MOVE HIGH-VALUE   TO W-TAB-CAUS-OCC.                         00085630
085640     MOVE LOW-VALUE    TO W-FF.                                   00085640
085650*    APERTURA ARCHIVIO CAUSALI ALTRI ENTI                         00085650
085660     OPEN INPUT  BQVFCA.                                          00085660
085670*                                                                 00085670
085680 RW-020.                                                          00085680
085690     READ BQVFCA INTO BQVFCA1   AT END                            00085690
085700               MOVE HIGH-VALUE TO W-FF.                           00085700
085710     IF W-FF EQUAL LOW-VALUE                                      00085710
085720        GO TO RW-040.                                             00085720
085730 RW-030.                                                          00085730
085740     GO TO RW-050.                                                00085740
085750 RW-040.                                                          00085750
085760*    ESTRATTO UN CODICE: LO IMPOSTO IN TABELLA                    00085760
085770     MOVE BQVFCA1-COD         TO W-TAB-CAUS-COD(W-PUNT-CAUS).     00085770
085780     MOVE BQVFCA1-CAU         TO W-TAB-CAUS-CAU(W-PUNT-CAUS).     00085780
085790     MOVE BQVFCA1-INIZ-VAL    TO W-TAB-CAUS-INIZ(W-PUNT-CAUS).    00085790
085800     MOVE BQVFCA1-FINE-VAL    TO W-TAB-CAUS-FINE(W-PUNT-CAUS).    00085800
085810     MOVE BQVFCA1-TIPO-INIZIO TO                                  00085810
085820                              W-TAB-CAUS-TIPO-INIZ(W-PUNT-CAUS).  00085820
085830     MOVE BQVFCA1-TIPO-FINE   TO                                  00085830
085840                              W-TAB-CAUS-TIPO-FINE(W-PUNT-CAUS).  00085840
085850 RW-050.                                                          00085850
085860*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00085860
085870     IF W-FF          = LOW-VALUE        AND                      00085870
085880        W-PUNT-CAUS < W-TAB-CAUS-NUM-MAX                          00085880
085890        SET W-PUNT-CAUS UP BY 1                                   00085890
085900        GO TO  RW-020.                                            00085900
085910 RW-060.                                                          00085910
085920*    VERIFICA SFONDAMENTO TABELLA                                 00085920
085930     IF W-PUNT-CAUS = W-TAB-CAUS-NUM-MAX AND                      00085930
085940        W-FF          = LOW-VALUE                                 00085940
085950*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00085950
085960*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00085960
085970*       DELLA TABELLA DI WORKING.                                 00085970
085980        MOVE '0000'      TO ABEND-CODE                            00085980
085990        DISPLAY 'BQVFB0-RW-060-01: SUPERATO IL NUMERO MASSIMO  '  00085990
086000        DISPLAY 'BQVFB0-RW-060-01: DI ELEMENTI PER LA TABELLA  '  00086000
086010        DISPLAY 'BQVFB0-RW-060-01: DI WORKING "W-TAB-CAUS".'      00086010
086020        CALL 'BQVFSR' USING ABEND-CODE.                           00086020
086030*                                                                 00086030
086040*    CHIUSURA ARCHIVIO ENTI LOCALI                                00086040
086050     CLOSE   BQVFCA.                                              00086050
086060*                                                                 00086060
086070 RW-990-CAR-CAUS-EX.                                              00086070
086080     EXIT.                                                        00086080
086090***************************************************************** 00086090
086100*    CARICAMENTO IN MEMORIA DEGLI UFFICI                        * 00086100
086110***************************************************************** 00086110
086120 R3-010-CAR-UFF.                                                  00086120
086130*    INIZIALIZZO LA TABELLA DI WORKING                            00086130
086140     SET W-PUNT-UFF    TO 1.                                      00086140
086150     MOVE HIGH-VALUE   TO W-TAB-UFF-OCC.                          00086150
086160     MOVE LOW-VALUE    TO W-FF.                                   00086160
086170*    APERTURA ARCHIVIO UFFICI                                     00086170
086180     OPEN INPUT  BQVFUF.                                          00086180
086190*                                                                 00086190
086200 R3-020.                                                          00086200
086210     READ BQVFUF INTO BQVFUF1   AT END                            00086210
086220               MOVE HIGH-VALUE TO W-FF.                           00086220
086230     IF W-FF EQUAL LOW-VALUE                                      00086230
086240        GO TO R3-040.                                             00086240
086250 R3-030.                                                          00086250
086260     GO TO R3-050.                                                00086260
086270 R3-040.                                                          00086270
086280*    ESTRATTO UN UFF: LO IMPOSTO IN TABELLA                       00086280
086290     MOVE BQVFUF1-KEY-UFFICIO TO W-TAB-UFF-COD(W-PUNT-UFF).       00086290
086300     MOVE BQVFUF1-INIZIO-VAL  TO W-TAB-UFF-INIZIO-VAL(W-PUNT-UFF).00086300
086310     MOVE BQVFUF1-SETTORE     TO W-TAB-UFF-SETTORE(W-PUNT-UFF).   00086310
086320     MOVE BQVFUF1-DENOM       TO W-TAB-UFF-DENOM(W-PUNT-UFF).     00086320
086330     MOVE BQVFUF1-FINE-VAL    TO W-TAB-UFF-FINE-VAL(W-PUNT-UFF).  00086330
086340 R3-050.                                                          00086340
086350*    VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00086350
086360     IF W-FF          = LOW-VALUE        AND                      00086360
086370        W-PUNT-UFF < W-TAB-UFF-NUM-MAX                            00086370
086380        SET W-PUNT-UFF UP BY 1                                    00086380
086390        GO TO  R3-020.                                            00086390
086400 R3-060.                                                          00086400
086410*    VERIFICA SFONDAMENTO TABELLA                                 00086410
086420     IF W-PUNT-UFF = W-TAB-UFF-NUM-MAX AND                        00086420
086430        W-FF          = LOW-VALUE                                 00086430
086440*       SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00086440
086450*       IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00086450
086460*       DELLA TABELLA DI WORKING.                                 00086460
086470        MOVE '0000'      TO ABEND-CODE                            00086470
086480        DISPLAY 'BQVFB0-R3-060-01: SUPERATO IL NUMERO MASSIMO  '  00086480
086490        DISPLAY 'BQVFB0-R3-060-01: DI ELEMENTI PER LA TABELLA  '  00086490
086500        DISPLAY 'BQVFB0-R3-060-01: DI WORKING "W-TAB-UFF".'       00086500
086510        CALL 'BQVFSR' USING ABEND-CODE.                           00086510
086520*                                                                 00086520
086530*    CHIUSURA ARCHIVIO ENTI LOCALI                                00086530
086540     CLOSE   BQVFUF.                                              00086540
086550*                                                                 00086550
086560 R3-990-CAR-UFF-EX.                                               00086560
086570     EXIT.                                                        00086570
086580***************************************************************** 00086580
086590*    RICERCA DEL CODICE AMBITO                                  * 00086590
086600***************************************************************** 00086600
086610 RO-010-RIC-AMBITI.                                               00086610
086620     SEARCH  ALL W-TAB-AMBITI-EL                                  00086620
086630        AT END MOVE ZERO TO W-FLAG-TROVATO                        00086630
086640     WHEN W-TAB-AMBITI-COD-ALF(W-PUNT-AMBITI) EQUAL W-AMBITO-INP  00086640
086650        MOVE 1           TO W-FLAG-TROVATO.                       00086650
086660 RO-990-RIC-AMBITI-EX.                                            00086660
086670     EXIT.                                                        00086670
086680***************************************************************** 00086680
086690*    RICERCA DEL CODICE AZIENDA                                 * 00086690
086700***************************************************************** 00086700
086710 RP-010-RIC-AZIENDE.                                              00086710
086720     SEARCH  ALL W-TAB-AZIENDE-EL                                 00086720
086730        AT END MOVE ZERO TO W-FLAG-TROVATO                        00086730
086740     WHEN W-TAB-AZ-COD-NUM(W-PUNT-AZIENDE)                        00086740
086750                                     EQUAL W-AZIENDA-INP          00086750
086760        MOVE 1           TO W-FLAG-TROVATO.                       00086760
086770 RP-990-RIC-AZIENDE-EX.                                           00086770
086780     EXIT.                                                        00086780
086790***************************************************************** 00086790
086800*    RICERCA DEL CODICE REGIONE                                 * 00086800
086810***************************************************************** 00086810
086820 RQ-010-RIC-REGIONI.                                              00086820
086830     SEARCH  ALL W-TAB-REGIONI-EL                                 00086830
086840        AT END MOVE ZERO TO W-FLAG-TROVATO                        00086840
086850     WHEN W-TAB-REGIONI-COD(W-PUNT-REGIONI) EQUAL W-REGIONE-INP   00086850
086860        MOVE 1           TO W-FLAG-TROVATO.                       00086860
086870 RQ-990-RIC-REGIONI-EX.                                           00086870
086880     EXIT.                                                        00086880
086890***************************************************************** 00086890
086900*    RICERCA DEL CODICE PROVINCIA                               * 00086900
086910***************************************************************** 00086910
086920 RR-010-RIC-PROV.                                                 00086920
086930     SEARCH  ALL W-TAB-PROV-EL                                    00086930
086940        AT END MOVE ZERO TO W-FLAG-TROVATO                        00086940
086950     WHEN W-TAB-PROV-COD(W-PUNT-PROV) EQUAL W-PROV-INP            00086950
086960        MOVE 1           TO W-FLAG-TROVATO.                       00086960
086970 RR-990-RIC-PROV-EX.                                              00086970
086980     EXIT.                                                        00086980
086990***************************************************************** 00086990
087000*    RICERCA DEL CODICE ENTE LOCALE                             * 00087000
087010***************************************************************** 00087010
087020*RK-010-RIC-ENTE.                                                 00087020
087030*    SET W-PUNT-ENTE   TO 1.                                      00087030
087040*    SEARCH W-TAB-ENTE-EL                                         00087040
087050*       AT END MOVE ZERO TO W-FLAG-TROVATO                        00087050
087060*    WHEN W-TAB-ENTE-COD(W-PUNT-ENTE)  EQUAL W-ENTE-INP           00087060
087070*     AND W-TAB-ENTE-INIZ(W-PUNT-ENTE) NOT > BQVFB11-04-DATA-RISC 00087070
087080*     AND W-TAB-ENTE-FINE(W-PUNT-ENTE) NOT < BQVFB11-04-DATA-RISC 00087080
087090*     MOVE 1 TO W-FLAG-TROVATO.                                   00087090
087100*RK-990-RIC-ENTE-EX.                                              00087100
087110*    EXIT.                                                        00087110
087120***************************************************************** 00087120
087130*    RICERCA DEL CODICE CATASTALE                               * 00087130
087140***************************************************************** 00087140
087150*R9-010-RIC-CAT.                                                  00087150
087160*    SET W-PUNT-CAT   TO 1.                                       00087160
087170*    SEARCH W-TAB-CAT-EL                                          00087170
087180*       AT END MOVE ZERO TO W-FLAG-TROVATO                        00087180
087190*    WHEN W-TAB-CAT-COD(W-PUNT-CAT)  EQUAL W-ENTE-INP             00087190
087200*     AND W-TAB-CAT-INIZ(W-PUNT-CAT) NOT > BQVFB11-04-DATA-RISC   00087200
087210*     AND W-TAB-CAT-FINE(W-PUNT-CAT) NOT < BQVFB11-04-DATA-RISC   00087210
087220*     MOVE 1 TO W-FLAG-TROVATO.                                   00087220
087230*R9-990-RIC-CAT-EX.                                               00087230
087240*    EXIT.                                                        00087240
087250***************************************************************** 00087250
087260*    RICERCA DEL CODICE ALTRO ENTE                              * 00087260
087270***************************************************************** 00087270
087280 RJ-010-RIC-ALTRO.                                                00087280
087290     SET W-PUNT-ALTRO  TO 1.                                      00087290
087300     SEARCH W-TAB-ALTRO-EL                                        00087300
087310        AT END MOVE ZERO TO W-FLAG-TROVATO                        00087310
087320     WHEN W-TAB-ALTRO-COD-ALF(W-PUNT-ALTRO) EQUAL W-ALTRO-INP     00087320
087330      MOVE 1 TO W-FLAG-TROVATO.                                   00087330
087340 RJ-990-RIC-ALTRO-EX.                                             00087340
087350     EXIT.                                                        00087350
087360                                                                  00087360
087370***************************************************************** 00087370
087380 FX-010-TARD.                                                     00087380
087390     IF BQVFB11-36-DATA-RISC < W-APPO-DATA-AVVIO                  00087390
087400        MOVE 45  TO BQVFB21-36-ERR-DATA-RISC                      00087400
087410        MOVE 'E' TO BQVFB21-36-ERR-DATA-RISC-A                    00087410
087420        ADD 1 TO W-CTR-BLOC.                                      00087420
087430 FX-010-TARD-EX.                                                  00087430
087440     EXIT.                                                        00087440
087450                                                                  00087450
087460*                                                                 00087460
087470* IL PRIMO CARATTERE DEL CODICE CATASTALE DEVE ESSERE ALFABETICO E00087470
087480* DEVE ASSUMERE UNO DEI SEGUENTI VALORI: 'Z' O DA 'A' AD 'M' AD   00087480
087490* ESCLUSIONE DI 'J' 'K'; LE TRE CIFRE SUCCESSIVE POSSONO ESSERE   00087490
087500* NUMERICHE (DA 000 A 999), OPPURE E' UNA STRINGA ALFANUMERICA    00087500
087510* CONTENENTE SOLO I CARATTERI L, M, N, P, Q, R, S, T, U, V;       00087510
087520* SE IL PRIMO BYTE E' M, QUELLO SUCCESSIVO PUO' ESSERE O UN       00087520
087530* NUMERO < 4, OPPURE PUO' VALERE SOLO L, M, N, P.                 00087530
087540*                                                                 00087540
087550 R1-010-CATAST.                                                   00087550
087560     MOVE BQVFB11-01-CODICE-FISC TO W-CF-CATAST.                  00087560
087570     IF W-CATAST-SOTTO2 NUMERIC AND                               00087570
087580        W-CATAST-SOTTO2 > '000' AND                               00087580
087590        W-CATAST-SOTTO2 NOT > '999'                               00087590
087600        GO TO R1-010-CATAST-EX.                                   00087600
087610 R1-020.                                                          00087610
087620     IF (W-CATAST-SOTTO21 NUMERIC OR                              00087620
087630         W-CATAST-SOTTO21-OK)        AND                          00087630
087640        (W-CATAST-SOTTO22 NUMERIC OR                              00087640
087650         W-CATAST-SOTTO22-OK)        AND                          00087650
087660        (W-CATAST-SOTTO23 NUMERIC OR                              00087660
087670         W-CATAST-SOTTO23-OK)                                     00087670
087680        GO TO R1-010-CATAST-EX.                                   00087680
087690 R1-030.                                                          00087690
087700     MOVE 1 TO W-BQVFB3-COD-RIT.                                  00087700
087710 R1-010-CATAST-EX.                                                00087710
087720     EXIT.                                                        00087720
087730                                                                  00087730
087740***************************************************************   00087740
087750***** ROUTINE DI CONTROLLO CF UTILIZZATA PER V49 (METCOB) *****   00087750
087760***************************************************************   00087760
087770 C9-010-CONTR-V49.                                                00087770
087780****                                                              00087780
087790*--- COPIA DA RE-462 A RE-502 CON AGGIUNTA IMPOSTAZIONE CODICI ERR00087790
087800****                                                              00087800
087810*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE FISCALE               00087810
087820     MOVE ZERO TO W-APPO-CF-11.                                   00087820
087830     MOVE ZERO TO W-FLAG-NO-BQVFB3.                               00087830
087840     MOVE 0 TO W-BQVFB3-COD-RIT.                                  00087840
087850     MOVE BQVFB11-01-CODICE-FISC TO W-APPO-CF.                    00087850
087860     IF W-APPO-CF-DX NOT = SPACE     AND                          00087860
087870        W-APPO-CF-DX NOT = LOW-VALUE AND                          00087870
087880        W-APPO-CF-DX NOT = HIGH-VALUE                             00087880
087890        GO TO C9-497.                                             00087890
087900                                                                  00087900
087910 C9-470.                                                          00087910
087920*--- CF DI 11 CARATTERI ALLINEATI A SINISTRA                      00087920
087930     MOVE 'PNF' TO W-PF-PNF.                                      00087930
087940     IF W-APPO-CF-SX NUMERIC         AND                          00087940
087950        W-APPO-CF-DX NOT = LOW-VALUE AND                          00087950
087960        W-APPO-CF-DX NOT = HIGH-VALUE                             00087960
087970        MOVE W-APPO-CF TO W-BQVFB3-COD-FISC                       00087970
087980        GO TO C9-482.                                             00087980
087990                                                                  00087990
088000 C9-480.                                                          00088000
088010*--- CF DI 11 CARATTERI ERRATO                                    00088010
088020     MOVE 1 TO W-BQVFB3-COD-RIT.                                  00088020
088030     GO TO C9-499.                                                00088030
088040                                                                  00088040
088050 C9-482.                                                          00088050
088060     MOVE W-BQVFB3-COD-FISC TO W-APPO-CF-11.                      00088060
088070     IF (W-APPO-CF-11-COD-UFF > 150 AND                           00088070
088080         W-APPO-CF-11-COD-UFF < 246    ) OR                       00088080
088090        (W-APPO-CF-11-COD-UFF > 300 AND                           00088090
088100         W-APPO-CF-11-COD-UFF < 767    ) OR                       00088100
088110        W-APPO-CF-11-COD-UFF  = ZERO                              00088110
088120        MOVE 'PF '     TO W-PF-PNF.                               00088120
088130                                                                  00088130
088140 C9-490.                                                          00088140
088150*--- SE IL CODICE FISCALE NON E' ASSEGNATO NON ATTIVO LA ROUTINE  00088150
088160*--- E LO CONSIDERO VALIDO                                        00088160
088170     IF W-APPO-CF-11-COD-UFF  = ZERO AND                          00088170
088180        W-APPO-CF-11-PROG     > ZERO AND                          00088180
088190        W-APPO-CF-11-PROG     < 273961                            00088190
088200        MOVE 1 TO W-FLAG-NO-BQVFB3                                00088200
088210        GO TO C9-499.                                             00088210
088220                                                                  00088220
088230 C9-492.                                                          00088230
088240*--- SE IL CODICE UFFICIO O IL PROGRESSIVO NON SONO               00088240
088250*--- VALIDI NON ATTIVO LA ROUTINE E IMPOSTO L'ERRORE              00088250
088260     IF W-APPO-CF-11-COD-UFF = ZERO AND                           00088260
088270        ((W-APPO-CF-11-PROG > 0273960 AND                         00088270
088280          W-APPO-CF-11-PROG < 0400001   ) OR                      00088280
088290         (W-APPO-CF-11-PROG > 1072480 AND                         00088290
088300          W-APPO-CF-11-PROG < 1500001   ) OR                      00088300
088310         (W-APPO-CF-11-PROG > 1828636 AND                         00088310
088320          W-APPO-CF-11-PROG < 2000001   ) OR                      00088320
088330          W-APPO-CF-11-PROG > 2054095       )                     00088330
088340        MOVE 1    TO  W-BQVFB3-COD-RIT                            00088340
088350        GO TO C9-499.                                             00088350
088360                                                                  00088360
088370 C9-494.                                                          00088370
088380*--- SE IL CODICE UFFICIO NON E' VALIDO NON ATTIVO LA ROUTINE     00088380
088390*--- E IMPOSTO L'ERRORE                                           00088390
088400*F   MODIFICA DEL 19/09/2005: AGGIUNTO RANGE 900 - 950 (INCLUSI)  00088400
088410     IF (W-APPO-CF-11-COD-UFF  > 100 AND                          00088410
088420         W-APPO-CF-11-COD-UFF  < 120    ) OR                      00088420
088430        (W-APPO-CF-11-COD-UFF  > 121 AND                          00088430
088440         W-APPO-CF-11-COD-UFF  < 151    ) OR                      00088440
088450        (W-APPO-CF-11-COD-UFF  > 245 AND                          00088450
088460         W-APPO-CF-11-COD-UFF  < 301    ) OR                      00088460
088470        (W-APPO-CF-11-COD-UFF  > 766 AND                          00088470
088480         W-APPO-CF-11-COD-UFF  NOT EQUAL 888 AND                  00088480
088490         W-APPO-CF-11-COD-UFF  < 900    ) OR                      00088490
088500        (W-APPO-CF-11-COD-UFF  > 950 AND                          00088500
088510         W-APPO-CF-11-COD-UFF  NOT EQUAL 999)                     00088510
088520     OR                                                           00088520
088530        W-APPO-CF-11-PROG      = ZERO                             00088530
088540        MOVE 1 TO W-BQVFB3-COD-RIT                                00088540
088550        GO TO C9-499.                                             00088550
088560                                                                  00088560
088570 C9-496.                                                          00088570
088580*--- SE IL CF E' P. IVA E IL PROGRESSIVO NON E' VALIDO NON        00088580
088590*--- ATTIVO LA ROUTINE E IMPOSTO L'ERRORE                         00088590
088600     IF ((W-APPO-CF-11-COD-UFF >  95 AND                          00088600
088610          W-APPO-CF-11-COD-UFF < 101    ) OR                      00088610
088620         (W-APPO-CF-11-COD-UFF > 119 AND                          00088620
088630          W-APPO-CF-11-COD-UFF < 122    )   ) AND                 00088630
088640        W-APPO-CF-11-PROG  NOT < 8000000                          00088640
088650        MOVE 1 TO W-BQVFB3-COD-RIT.                               00088650
088660     GO TO C9-499.                                                00088660
088670                                                                  00088670
088680 C9-497.                                                          00088680
088690*---                                                              00088690
088700*--- CODICE FISCALE DI 16 CARATTERI                               00088700
088710*--- MODIFICATO PERCHE' CONTROLLI ANCHE LA CONGRUENZA FRA         00088710
088720*--- MESE E GIORNO                                                00088720
088730*---                                                              00088730
088740     MOVE W-APPO-CF TO W-CF.                                      00088740
088750     IF W-COD-FISC-CATAST-OK        AND                           00088750
088760        W-APPO-CF-DENOM ALPHABETIC  AND                           00088760
088770                W-APPO-CF-DENOM-L1  NOT EQUAL SPACE AND           00088770
088780                W-APPO-CF-DENOM-L2  NOT EQUAL SPACE AND           00088780
088790                W-APPO-CF-DENOM-L3  NOT EQUAL SPACE AND           00088790
088800                W-APPO-CF-DENOM-L4  NOT EQUAL SPACE AND           00088800
088810                W-APPO-CF-DENOM-L5  NOT EQUAL SPACE AND           00088810
088820                W-APPO-CF-DENOM-L6  NOT EQUAL SPACE AND           00088820
088830        W-APPO-CF-ANNO      NUMERIC AND                           00088830
088840        W-APPO-CF-MESE-OK           AND                           00088840
088850        W-APPO-CF-GIORNO    NUMERIC AND                           00088850
088860        ((((W-APPO-CF-GIORNO   > ZERO AND                         00088860
088870            W-APPO-CF-GIORNO   < 32      ) OR                     00088870
088880           (W-APPO-CF-GIORNO   > 40   AND                         00088880
088890            W-APPO-CF-GIORNO   < 72      )) AND                   00088890
088900            W-CF-MESE-31-OK)                      OR              00088900
088910         (((W-APPO-CF-GIORNO   > ZERO AND                         00088910
088920            W-APPO-CF-GIORNO   < 31      ) OR                     00088920
088930           (W-APPO-CF-GIORNO   > 40   AND                         00088930
088940            W-APPO-CF-GIORNO   < 71      )) AND                   00088940
088950            W-CF-MESE-30-OK)                      OR              00088950
088960         (((W-APPO-CF-GIORNO   > ZERO AND                         00088960
088970            W-APPO-CF-GIORNO   < 30      ) OR                     00088970
088980           (W-APPO-CF-GIORNO   > 40   AND                         00088980
088990            W-APPO-CF-GIORNO   < 70      )) AND                   00088990
089000            W-CF-MESE-28-OK))                                     00089000
089010        MOVE W-APPO-CF TO W-BQVFB3-COD-FISC                       00089010
089020        MOVE 'PF '     TO W-PF-PNF                                00089020
089030        PERFORM R1-010-CATAST THRU R1-010-CATAST-EX               00089030
089040        GO TO C9-499.                                             00089040
089050                                                                  00089050
089060 C9-498.                                                          00089060
089070*--- ERRORE DI CORRETTEZZA DEL CODICE FISCALE PER:                00089070
089080*--- BYTE DA 1 A 6 NON TUTTI ALFABETICI O                         00089080
089090*--- BYTE 7 E 8 NON NUMERICI O                                    00089090
089100*--- BYTE 9 NON COMPRESO TRA I VALORI A,B,C,D,E,H,L,M,P,R,S,T O   00089100
089110*--- BYTE 10 E 11 NON NUMERICI O NON COMPRESI TRA I VALORI AMMESSI00089110
089120*--- BYTE 12, CORRISPONDENTE AL CODICE CATASTALE, FUORI SEQUENZA  00089120
089130     MOVE 1 TO W-BQVFB3-COD-RIT.                                  00089130
089140 C9-499.                                                          00089140
089150*---                                                              00089150
089160     IF W-BQVFB3-COD-RIT NOT = ZERO OR                            00089160
089170        W-FLAG-NO-BQVFB3 NOT = ZERO                               00089170
089180        GO TO C9-502.                                             00089180
089190                                                                  00089190
089200 C9-500.                                                          00089200
089210     CALL 'BQVFB3' USING W-PARAM-BQVFB3.                          00089210
089220                                                                  00089220
089230 C9-502.                                                          00089230
089240*                                                                 00089240
089250*---   NON SI IMPOSTA ERRORE SE DELEGA VIRTUALE                   00089250
089260*                                                                 00089260
089270     IF BQVFB11-49-CAUS-ANNUL = 4 OR                              00089270
089280        BQVFB11-49-CAUS-ANNUL = 5 OR                              00089280
089290        BQVFB11-49-CAUS-ANNUL = 6 OR                              00089290
089300        ((BQVFB11-49-CAUS-ANNUL = 7 OR                            00089300
089310          BQVFB11-49-CAUS-ANNUL = 8 OR                            00089310
089320          BQVFB11-49-CAUS-ANNUL = 9) AND                          00089320
089330         BQVFB11-49-IDENT-PAGAM  > 0)                             00089330
089340             MOVE ZERO TO W-BQVFB3-COD-RIT.                       00089340
089350*---                                                              00089350
089360*--- INIZIO TRATTAMENTO RECORD V49                                00089360
089370*---                                                              00089370
089380*--- VALORE ERRATO PER IL FLAG DI ERRORE CF                       00089380
089390*---                                                              00089390
089400       IF ( BQVFB11-01-FLAG-ERR-CF NOT = '0'  ) AND               00089400
089410          ( BQVFB11-01-FLAG-ERR-CF NOT = '1'  ) AND               00089410
089420          ( BQVFB21-01-ERR-FLAG-ERR-CF = ZERO ) THEN              00089420
089430              MOVE 55 TO BQVFB21-01-ERR-FLAG-ERR-CF               00089430
089440              MOVE 'E' TO BQVFB21-01-ERR-FLAG-ERR-CF-A            00089440
089450              ADD 1 TO W-CTR-BLOC                                 00089450
089460       END-IF.                                                    00089460
089470*---                                                              00089470
089480*--- SI CONTROLLA LA CONGRUENZA DEL FLAG DI ERRORE                00089480
089490*---                                                              00089490
089500       IF W-BQVFB3-COD-RIT = ZERO  AND                            00089500
089510             BQVFB11-01-FLAG-ERR-CF  = '1' THEN                   00089510
089520           IF BQVFB21-01-ERR-FLAG-ERR-CF = ZERO                   00089520
089530                MOVE 24  TO BQVFB21-01-ERR-FLAG-ERR-CF            00089530
089540                MOVE 'W' TO BQVFB21-01-ERR-FLAG-ERR-CF-A          00089540
089550                ADD 1 TO W-CTR-NO-BLOC                            00089550
089560           END-IF                                                 00089560
089570       END-IF.                                                    00089570
089580*---                                                              00089580
089590*--- CODICE FISCALE ERRATO E FLAG NON IMPOSTATO A 1               00089590
089600*---                                                              00089600
089610       IF W-BQVFB3-COD-RIT NOT = ZERO  AND                        00089610
089620             BQVFB11-01-FLAG-ERR-CF  NOT = '1' THEN               00089620
089630          MOVE   96               TO BQVFB21-01-ERR-CODICE-FISC   00089630
089640          MOVE 'E'                TO BQVFB21-01-ERR-CODICE-FISC-A 00089640
089650          ADD  1                  TO W-CTR-BLOC                   00089650
089660          IF BQVFB21-01-ERR-FLAG-ERR-CF EQUAL ZERO THEN           00089660
089670            MOVE  24              TO BQVFB21-01-ERR-FLAG-ERR-CF   00089670
089680            MOVE 'E'              TO BQVFB21-01-ERR-FLAG-ERR-CF-A 00089680
089690            ADD  1                TO W-CTR-BLOC                   00089690
089700          END-IF                                                  00089700
089710       END-IF.                                                    00089710
089720*---                                                              00089720
089730*---                                                              00089730
089740*--- FINE TRATTAMENTO RECORD V49                                  00089740
089750*---                                                              00089750
089760 C9-990-EXIT.                                                     00089760
089770     EXIT.                                                        00089770
089780                                                                  00089780
089790*---                                                              00089790
089800*--- MODIFICHE MAGGIO 2001                                        00089800
089810*---                                                              00089810
089820*---                                                              00089820
089830*--- SI CALCOLA LA COMMISSIONE PER DELEGA                         00089830
089840*---                                                              00089840
089850 F2-010-CALC-COMM.                                                00089850
089860*---                                                              00089860
089870*--- SE IL FLUSSO PROVIENE DA BANCHE LA COMMISSIONE SI CALCOLA    00089870
089880*--- CON L'IMPORTO FISSO DI 6750 LIRE O 349 EURO                  00089880
089890*--- SE IL FLUSSO PROVIENE DAI CONCESSIONARI LA COMMISSIONE       00089890
089900*--- SI CALCOLA IN PERCENTUALE                                    00089900
089910     IF W-FLAG-BANCA = 'B'                                        00089910
089920     OR (W-FLAG-BANCA = 'C' AND BQVFB11-36-DATA-RISC > '20000901')00089920
089930        GO TO F2-200.                                             00089930
089940*---                                                              00089940
089950*--- SI IMPOSTANO I CAMPI DI APPOGGIO PER LA COMMISSIONE MINIMA   00089950
089960*--- E MASSIMA A SECONDA DELLA VALUTA                             00089960
089970     MOVE BQVFCO1-COM-DIS-LIRE-MIN TO W-COMM-MIN.                 00089970
089980     MOVE BQVFCO1-COM-DIS-LIRE-MAX TO W-COMM-MAX.                 00089980
089990     IF W-DIV = 'EUR'                                             00089990
090000        MOVE BQVFCO1-COM-DIS-EUR-MIN TO W-COMM-MIN                00090000
090010        MOVE BQVFCO1-COM-DIS-EUR-MAX TO W-COMM-MAX.               00090010
090020*--- SE IL SALDO FISCO PER LA DELEGA RISULTA NEGATIVO             00090020
090030*--- SI FORZA UGUALE A ZERO                                       00090030
090040     IF W-APPO-SALDO-FISCO-COMM < ZERO                            00090040
090050        MOVE ZERO TO W-APPO-SALDO-FISCO-COMM.                     00090050
090060*--- SI CALCOLA LA COMMISSIONE PER DELEGA IN PERCENTUALE          00090060
090070*--- SUL SALDO FISCO                                              00090070
090080     COMPUTE W-COMMISS-ARROT = W-APPO-SALDO-FISCO-COMM *          00090080
090090                               BQVFCO1-COM-DIS-PERC.              00090090
090100     COMPUTE W-COMMISSIONI   = W-COMMISS-ARROT + 0,5.             00090100
090110*--- SI TESTA LA COMMISSIONE CALCOLATA RISPETTO AL MINIMO         00090110
090120*--- ED AL MASSIMO CONSENTITO                                     00090120
090130     IF W-COMMISSIONI < W-COMM-MIN                                00090130
090140        GO TO F2-050.                                             00090140
090150                                                                  00090150
090160 F2-020.                                                          00090160
090170     IF W-COMMISSIONI > W-COMM-MAX                                00090170
090180        GO TO F2-040.                                             00090180
090190                                                                  00090190
090200 F2-030.                                                          00090200
090210*--- SE LA COMMISSIONE CALCOLATA RISULTA COMPRESA FRA IL          00090210
090220*--- MINIMO ED IL MASSIMO CONSENTITO, SI ADDIZIONA AL             00090220
090230*--- TOTALE COMMISSIONE CALCOLATA PER FLUSSO                      00090230
090240     ADD W-COMMISSIONI TO W-COMM-CALC-NEW.                        00090240
090250     GO TO F2-010-CALC-COMM-EX.                                   00090250
090260                                                                  00090260
090270 F2-040.                                                          00090270
090280*--- SE LA COMMISSIONE CALCOLATA RISULTA MAGGIORE DEL             00090280
090290*--- MASSIMO CONSENTITO, SI ADDIZIONA QUEST'ULTIMO                00090290
090300*--- AL TOTALE COMMISSIONE CALCOLATA PER FLUSSO                   00090300
090310     ADD W-COMM-MAX    TO W-COMM-CALC-NEW.                        00090310
090320     GO TO F2-010-CALC-COMM-EX.                                   00090320
090330                                                                  00090330
090340 F2-050.                                                          00090340
090350*--- SE LA COMMISSIONE CALCOLATA RISULTA MINORE DEL               00090350
090360*--- MINIMO CONSENTITO, SI ADDIZIONA QUEST'ULTIMO                 00090360
090370*--- AL TOTALE COMMISSIONE CALCOLATA PER FLUSSO                   00090370
090380     ADD W-COMM-MIN    TO W-COMM-CALC-NEW.                        00090380
090390     GO TO F2-010-CALC-COMM-EX.                                   00090390
090400                                                                  00090400
090410 F2-200.                                                          00090410
090420*---                                                              00090420
090430*---   IMPOSTAZIONE IMPORTO COMMISSIONI PER DELEGA                00090430
090440*---                                                              00090440
090450*F INIZIO MODIFICA 04/02/2003  - CONDONO (CONFER.RISERVATO)       00090450
090460*                                                                 00090460
090470**A**MODIFICA PRONTA PER DELEGHE RISERVATE CONDONO                00090470
090480**A**IF W-FLAG-BANCA               = 'B'        AND               00090480
090490**A**   BQVFB11-36-MOD-CONFER      = '8'                          00090490
090500**A**     MOVE BQVFCO1-COM-DEL-COND1  TO W-COMMISSIONI            00090500
090510**A**     GO TO F2-250.                                           00090510
090520*                                                                 00090520
090530*F FINE MODIFICA 04/02/2003                                       00090530
090540*                                                                 00090540
090550*---   MODIFICA DEL 02/05/2001: SOLO PER LE BANCHE E SOLO PER     00090550
090560*---   DELEGHE NON INTERNET SI DIFFERENZIA IL CALCOLO NEL SEGUENTE00090560
090570*---   MODO:                                                      00090570
090580*---                                                              00090580
090590*---   PER DATA RISCOSSIONE < 20010514:   6750 LIRE O 3,49 EURO   00090590
090600*---                                                              00090600
090610*---   PER DATA RISCOSSIONE COMPRESA FRA 20000514 E 20001231:     00090610
090620*---                                      5050 LIRE O 2,61 EURO   00090620
090630*---   PER DATA RISCOSSIONE > 20011231 E <= 20031231              00090630
090640*---                                      5400 LIRE O 2,79 EURO   00090640
090650*---   PER DATA RISCOSSIONE > 20031231:                           00090650
090660*---                                      2,55 EURO               00090660
090670*---                                                              00090670
090680*F INIZIO MODIFICA 13/03/2006                                     00090680
090690     IF BQVFB11-36-DATA-RISC   NOT < '20060101'                   00090690
090700        PERFORM F4-010 THRU F4-EXIT                               00090700
090710          GO TO F2-250.                                           00090710
090720*---                                                              00090720
090730*A INIZIO MODIFICA 03/01/2006                                     00090730
090740*F   IF (BQVFB11-36-MOD-CONFER  = '1' OR '2')    AND              00090740
090750*F      BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-CONF12-PT       00090750
090760*F      AND BQVFB11-COD-ABI   = 7601                              00090760
090770*F        MOVE BQVFCO1-COM-CONF12-PT TO W-COMMISSIONI             00090770
090780*F        GO TO F2-250.                                           00090780
090790*---                                                              00090790
090800*F   IF BQVFB11-36-MOD-CONFER  = '4'            AND               00090800
090810*F      BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-CONF4-PT        00090810
090820*F      AND BQVFB11-COD-ABI   = 7601                              00090820
090830*F        MOVE BQVFCO1-COM-CONF4-PT  TO W-COMMISSIONI             00090830
090840*F        GO TO F2-250.                                           00090840
090850*A FINE MODIFICA 03/01/2006                                       00090850
090860*F FINE MODIFICA 13/03/2006                                       00090860
090870*                                                                 00090870
090880*F INIZIO MODIFICA 28/01/2004                                     00090880
090890     IF (BQVFB11-36-MOD-CONFER  = '1' OR '2')    AND              00090890
090900        BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-CONF12          00090900
090910        AND BQVFB11-COD-ABI  NOT = 7601                           00090910
090920        AND BQVFB11-COD-ABI  NOT = 36081                          00090920
090930          MOVE BQVFCO1-COM-CONF12    TO W-COMMISSIONI             00090930
090940          GO TO F2-250.                                           00090940
090950*---                                                              00090950
090960     IF BQVFB11-36-MOD-CONFER  = '4'            AND               00090960
090970        BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-CONF4           00090970
090980        AND BQVFB11-COD-ABI  NOT = 7601                           00090980
090990        AND BQVFB11-COD-ABI  NOT = 36081                          00090990
091000          MOVE BQVFCO1-COM-CONF4     TO W-COMMISSIONI             00091000
091010          GO TO F2-250.                                           00091010
091020*F FINE MODIFICA 28/01/2004                                       00091020
091030*---                                                              00091030
091040*F INIZIO MODIFICA 22/12/2003                                     00091040
091050     IF BQVFB11-36-MOD-CONFER  NOT = '3'        AND               00091050
091060        BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-NEW-ALL01       00091060
091070*A 07/01/2004 - INIZIO                                            00091070
091080********AND W-FLAG-BANCA = 'B'                                    00091080
091090        AND BQVFB11-COD-ABI  NOT = 7601                           00091090
091100        AND BQVFB11-COD-ABI  NOT = 36081                          00091100
091110*A 07/01/2004 - FINE                                              00091110
091120          MOVE BQVFCO1-COM-NEW-ALL01  TO W-COMMISSIONI            00091120
091130          GO TO F2-250.                                           00091130
091140*F FINE MODIFICA 22/12/2003                                       00091140
091150*---                                                              00091150
091160     IF (BQVFB11-COD-ABI            = 7601       OR               00091160
091170         BQVFB11-COD-ABI            = 36081)     AND              00091170
091180        BQVFB11-36-MOD-CONFER  NOT = '3'        AND               00091180
091190        BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-INIZIO-T1 AND   00091190
091200        BQVFB11-36-DATA-RISC   NOT > BQVFCO1-DATA-FINE-T1         00091200
091210          MOVE BQVFCO1-COM-DEL-EUR-PT1  TO W-COMMISSIONI          00091210
091220          GO TO F2-250.                                           00091220
091230* INIZIO MODIFICA APRILE 2004                                     00091230
091240 F2-202.                                                          00091240
091250**** IF BQVFB11-COD-ABI            = 7601       AND               00091250
091260******* BQVFB11-36-MOD-CONFER  NOT = '3'        AND               00091260
091270******* BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-INIZIO-T2       00091270
091280********* MOVE BQVFCO1-COM-DEL-EUR-PT2  TO W-COMMISSIONI          00091280
091290********* GO TO F2-250.                                           00091290
091300     IF (BQVFB11-COD-ABI            = 7601       OR               00091300
091310         BQVFB11-COD-ABI            = 36081)     AND              00091310
091320        BQVFB11-36-MOD-CONFER  NOT = '3'        AND               00091320
091330        BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-INIZIO-T2 AND   00091330
091340        BQVFB11-36-DATA-RISC       < BQVFCO1-DATA-POSTE1          00091340
091350          MOVE BQVFCO1-COM-DEL-EUR-PT2  TO W-COMMISSIONI          00091350
091360          GO TO F2-250.                                           00091360
091370 F2-203.                                                          00091370
091380     IF (BQVFB11-COD-ABI            = 7601       OR               00091380
091390         BQVFB11-COD-ABI            = 36081)     AND              00091390
091400        BQVFB11-36-MOD-CONFER  NOT = '3'        AND               00091400
091410        BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-POSTE1          00091410
091420          MOVE BQVFCO1-COM-POSTE1  TO W-COMMISSIONI               00091420
091430          GO TO F2-250.                                           00091430
091440* FINE MODIFICA APRILE 2004                                       00091440
091450 F2-205.                                                          00091450
091460     IF W-FLAG-BANCA               = 'B'        AND               00091460
091470        BQVFB11-36-MOD-CONFER  NOT = '3'        AND               00091470
091480        BQVFB11-COD-ABI        NOT = 7601       AND               00091480
091490        BQVFB11-COD-ABI        NOT = 36081      AND               00091490
091500        BQVFB11-36-DATA-RISC   NOT < BQVFCO1-DATA-INIZIO-T        00091500
091510        GO TO F2-220.                                             00091510
091520* INIZIO MODIFICA 29/10/2002                                      00091520
091530*F2-208-INTERNET-OLD.                                             00091530
091540 F2-208-INTERNET-NEW.                                             00091540
091550     IF W-FLAG-BANCA               = 'B'        AND               00091550
091560        BQVFB11-36-MOD-CONFER      = '3'        AND               00091560
091570        BQVFB11-DATA-BONIF      > BQVFCO1-DATA-FINE-T3I   AND     00091570
091580        BQVFB11-DATA-BONIF      < BQVFCO1-DATA-INIZIO-T4I         00091580
091590        MOVE BQVFCO1-COM-DEL-T3I TO W-COMMISSIONI                 00091590
091600        GO TO F2-250.                                             00091600
091610 F2-208-INTERNET-NEW-REGIME.                                      00091610
091620     IF W-FLAG-BANCA               = 'B'        AND               00091620
091630        BQVFB11-36-MOD-CONFER      = '3'        AND               00091630
091640        BQVFB11-DATA-BONIF  NOT < BQVFCO1-DATA-INIZIO-T4I         00091640
091650        MOVE BQVFCO1-COM-DEL-T4I TO W-COMMISSIONI                 00091650
091660        GO TO F2-250.                                             00091660
091670* CONC-NEW E CONC-NEW-REGIME AL MOMENTO NON ATTIVATE              00091670
091680* DATE IMPOSTATE A 99999999 SU FBQVFCO1                           00091680
091690 F2-208-CONC-NEW.                                                 00091690
091700     IF W-FLAG-BANCA               = 'C'        AND               00091700
091710        BQVFB11-36-DATA-RISC       > BQVFCO1-DATA-FINE-T3C   AND  00091710
091720******* BQVFB11-36-DATA-RISC       < BQVFCO1-DATA-INIZIO-T4C AND  00091720
091730        BQVFB11-DATA-BONIF      < BQVFCO1-DATA-INIZIO-T4C         00091730
091740        MOVE BQVFCO1-COM-DEL-T3C TO W-COMMISSIONI                 00091740
091750        GO TO F2-250.                                             00091750
091760 F2-208-CONC-NEW-REGIME.                                          00091760
091770     IF W-FLAG-BANCA               = 'C'        AND               00091770
091780        BQVFB11-36-DATA-RISC       > BQVFCO1-DATA-FINE-T3C AND    00091780
091790        BQVFB11-DATA-BONIF  NOT < BQVFCO1-DATA-INIZIO-T4C         00091790
091800        MOVE BQVFCO1-COM-DEL-T4C TO W-COMMISSIONI                 00091800
091810        GO TO F2-250.                                             00091810
091820* FINE MODIFICA 29/10/2002                                        00091820
091830*  INIZIO MODIFICA 27/03/2003  - CONCESSIONARI                    00091830
091840*                                                                 00091840
091850     IF W-FLAG-BANCA            = 'C'        AND                  00091850
091860        BQVFB11-36-DATA-RISC NOT < BQVFCO1-DATA-NEW-CONC1 AND     00091860
091870        BQVFB11-36-DATA-RISC     < BQVFCO1-DATA-NEW-CONC2         00091870
091880        MOVE BQVFCO1-COM-NEW-CONC1 TO W-COMMISSIONI               00091880
091890        GO TO F2-250.                                             00091890
091900*                                                                 00091900
091910     IF W-FLAG-BANCA            = 'C'        AND                  00091910
091920        BQVFB11-36-DATA-RISC NOT < BQVFCO1-DATA-NEW-CONC2         00091920
091930        MOVE BQVFCO1-COM-NEW-CONC2 TO W-COMMISSIONI               00091930
091940        GO TO F2-250.                                             00091940
091950*                                                                 00091950
091960*F FINE MODIFICA 27/03/2003                                       00091960
091970*                                                                 00091970
091980*F INIZIO MODIFICA 21/05/2003  - NUOVE COMMISSIONI INTERNET       00091980
091990*                                                                 00091990
092000     IF BQVFB11-36-MOD-CONFER   = '3'        AND                  00092000
092010        W-FLAG-BANCA            = 'B'        AND                  00092010
092020        BQVFB11-36-DATA-RISC NOT < BQVFCO1-DATA-NEW-INTER1 AND    00092020
092030        BQVFB11-36-DATA-RISC    < BQVFCO1-DATA-NEW-INTER2         00092030
092040        MOVE BQVFCO1-COM-NEW-INTER1 TO W-COMMISSIONI              00092040
092050        GO TO F2-250.                                             00092050
092060*                                                                 00092060
092070     IF BQVFB11-36-MOD-CONFER   = '3'        AND                  00092070
092080        W-FLAG-BANCA            = 'B'        AND                  00092080
092090        BQVFB11-36-DATA-RISC NOT < BQVFCO1-DATA-NEW-INTER2 AND    00092090
092100        BQVFB11-36-DATA-RISC    < BQVFCO1-DATA-NEW-INTER3         00092100
092110        MOVE BQVFCO1-COM-NEW-INTER2 TO W-COMMISSIONI              00092110
092120        GO TO F2-250.                                             00092120
092130*                                                                 00092130
092140     IF BQVFB11-36-MOD-CONFER   = '3'        AND                  00092140
092150        W-FLAG-BANCA            = 'B'        AND                  00092150
092160        BQVFB11-36-DATA-RISC NOT < BQVFCO1-DATA-NEW-INTER3 AND    00092160
092170        BQVFB11-36-DATA-RISC    < BQVFCO1-DATA-NEW-INTER4         00092170
092180        MOVE BQVFCO1-COM-NEW-INTER3 TO W-COMMISSIONI              00092180
092190        GO TO F2-250.                                             00092190
092200*                                                                 00092200
092210     IF BQVFB11-36-MOD-CONFER   = '3'        AND                  00092210
092220        W-FLAG-BANCA            = 'B'        AND                  00092220
092230        BQVFB11-36-DATA-RISC NOT < BQVFCO1-DATA-NEW-INTER4        00092230
092240        MOVE BQVFCO1-COM-NEW-INTER4 TO W-COMMISSIONI              00092240
092250        GO TO F2-250.                                             00092250
092260*                                                                 00092260
092270*F FINE MODIFICA 21/05/2003                                       00092270
092280*                                                                 00092280
092290 F2-210.                                                          00092290
092300     MOVE BQVFCO1-COM-DEL-LIRE   TO W-COMMISSIONI.                00092300
092310     IF W-DIV EQUAL 'EUR'                                         00092310
092320       MOVE BQVFCO1-COM-DEL-EUR  TO W-COMMISSIONI.                00092320
092330     IF BQVFB21-COD-ABI = 7601 OR                                 00092330
092340        BQVFB21-COD-ABI = 36081                                   00092340
092350       MOVE BQVFCO1-COM-DEL-LIRE-PT  TO W-COMMISSIONI.            00092350
092360     IF (BQVFB21-COD-ABI = 7601 OR                                00092360
092370         BQVFB21-COD-ABI = 36081) AND                             00092370
092380        W-DIV EQUAL 'EUR'                                         00092380
092390       MOVE BQVFCO1-COM-DEL-EUR-PT   TO W-COMMISSIONI.            00092390
092400     GO TO F2-250.                                                00092400
092410 F2-220.                                                          00092410
092420     IF BQVFB11-36-DATA-RISC > BQVFCO1-DATA-FINE-T                00092420
092430        GO TO F2-240.                                             00092430
092440 F2-230.                                                          00092440
092450     MOVE BQVFCO1-COM-DEL-LIRE-T   TO W-COMMISSIONI.              00092450
092460     IF W-DIV EQUAL 'EUR'                                         00092460
092470       MOVE BQVFCO1-COM-DEL-EUR-T  TO W-COMMISSIONI.              00092470
092480     GO TO F2-250.                                                00092480
092490 F2-240.                                                          00092490
092500     MOVE BQVFCO1-COM-DEL-LIRE-N   TO W-COMMISSIONI.              00092500
092510     IF W-DIV EQUAL 'EUR'                                         00092510
092520       MOVE BQVFCO1-COM-DEL-EUR-N  TO W-COMMISSIONI.              00092520
092530 F2-250.                                                          00092530
092540     ADD W-COMMISSIONI             TO W-COMM-CALC-NEW.            00092540
092550 F2-010-CALC-COMM-EX.                                             00092550
092560     EXIT.                                                        00092560
092570                                                                  00092570
092580*                                                                 00092580
092590***************************************************************   00092590
092600* CALCOLO TOTALE RECORD (CAMPO DA 8 BYTES)                    *   00092600
092610***************************************************************   00092610
092620*                                                                 00092620
092630 F3-010.                                                          00092630
092640*                                                                 00092640
092650     IF BQVFB11-99-NUMREC-2-TOTA NOT NUMERIC                      00092650
092660        GO TO F3-EXIT.                                            00092660
092670*                                                                 00092670
092680 F3-020.                                                          00092680
092690*                                                                 00092690
092700     IF BQVFB11-99-NUMREC-TOT  NOT = W-CTR-TOT                    00092700
092710        GO TO F3-EXIT.                                            00092710
092720*                                                                 00092720
092730 F3-030.                                                          00092730
092740*                                                                 00092740
092750     MOVE ZERO TO W-FLAG-NUMREC.                                  00092750
092760*                                                                 00092760
092770 F3-EXIT.                                                         00092770
092780     EXIT.                                                        00092780
092790                                                                  00092790
092800*--                                                               00092800
092810*---   A PARTIRE DAL 01/01/2006 (DATA RISCOSSIONE) LE             00092810
092820*---   COMMISSIONI VENGONO PRESE DAL FILE BQVFIC                  00092820
092830*---                                                              00092830
092840 F4-010.                                                          00092840
092850*---                                                              00092850
092860     MOVE 'COM'                      TO W-IC-TIPO.                00092860
092870     MOVE 'B'                        TO W-IC-ENTE.                00092870
092880     IF   BQVFB11-COD-ABI < 1000                                  00092880
092890         MOVE 'C'                    TO W-IC-ENTE.                00092890
092900     IF   BQVFB11-COD-ABI = 7601  OR                              00092900
092910          BQVFB11-COD-ABI = 36081                                 00092910
092920         MOVE 'P'                    TO W-IC-ENTE.                00092920
092930     IF   BQVFB11-COD-ABI = 36042                                 00092930
092940         MOVE 'F'                    TO W-IC-ENTE.                00092940
092950     IF ((BQVFB11-36-MOD-CONFER = '0' OR '1' OR '2' OR '3' OR '4')00092950
092960                            OR                                    00092960
092970         (BQVFB11-36-MOD-CONFER = '5' AND                         00092970
092980          (BQVFB11-COD-ABI = 7601   OR                            00092980
092990           BQVFB11-COD-ABI = 36081))                              00092990
093000                            OR                                    00093000
093010         (BQVFB11-36-MOD-CONFER = '6' AND                         00093010
093020          (BQVFB11-COD-ABI = 7601   OR                            00093020
093030           BQVFB11-COD-ABI = 36081))                              00093030
093040                            OR                                    00093040
093050         (BQVFB11-36-MOD-CONFER = '7' AND                         00093050
093060          (BQVFB11-COD-ABI = 7601   OR                            00093060
093070           BQVFB11-COD-ABI = 36081)))                             00093070
093080         MOVE BQVFB11-36-MOD-CONFER  TO W-IC-MOD-CONF             00093080
093090            ELSE                                                  00093090
093100         MOVE '0'                    TO W-IC-MOD-CONF.            00093100
093110*                                                                 00093110
093120     SET W-PUNT-IC TO 1.                                          00093120
093130     SEARCH W-TAB-IC-EL                                           00093130
093140        AT END MOVE ZERO TO W-FLAG-TROVATO                        00093140
093150     WHEN W-TAB-IC-TIPO(W-PUNT-IC)                                00093150
093160                       EQUAL W-IC-TIPO AND                        00093160
093170          W-TAB-IC-ENTE(W-PUNT-IC)                                00093170
093180                       EQUAL W-IC-ENTE AND                        00093180
093190          W-TAB-IC-MOD-CONF(W-PUNT-IC)                            00093190
093200                       EQUAL W-IC-MOD-CONF AND                    00093200
093210          W-TAB-IC-INIZIO-VAL(W-PUNT-IC)                          00093210
093220                       NOT GREATER BQVFB11-36-DATA-RISC AND       00093220
093230          W-TAB-IC-FINE-VAL(W-PUNT-IC)                            00093230
093240                       NOT LESS    BQVFB11-36-DATA-RISC           00093240
093250        MOVE 1           TO W-FLAG-TROVATO.                       00093250
093260     IF W-FLAG-TROVATO = 1                                        00093260
093270        GO TO F4-050.                                             00093270
093280 F4-030.                                                          00093280
093290      DISPLAY 'F4-030-BQVFB0-045: RECORD NON TROVATO SU BQVFIC'.  00093290
093300      DISPLAY '                   TIPO               = '          00093300
093310                                      W-IC-TIPO.                  00093310
093320      DISPLAY '                   ENTE               = '          00093320
093330                                      W-IC-ENTE.                  00093330
093340      DISPLAY '                   CONFERIMENTO       = '          00093340
093350                                      W-IC-MOD-CONF.              00093350
093360      DISPLAY '                   DATA RISCOSSIONE   = '          00093360
093370                                      BQVFB11-36-DATA-RISC.       00093370
093380      MOVE 0001                TO ABEND-CODE.                     00093380
093390      CALL 'BQVFSR' USING ABEND-CODE.                             00093390
093400      GO TO F4-EXIT.                                              00093400
093410*                                                                 00093410
093420*                                                                 00093420
093430 F4-050.                                                          00093430
093440*                                                                 00093440
093450     MOVE W-TAB-IC-COMM(W-PUNT-IC) TO  W-COMMISSIONI.             00093450
093460*                                                                 00093460
093470 F4-EXIT.                                                         00093470
093480     EXIT.                                                        00093480
093490*---                                                              00093490
093500*---                                                              00093500
093510 F5-010.                                                          00093510
093520*---                                                              00093520
093530     MOVE 0 TO W-FLAG-TROVATO.                                    00093530
093540     SET W-PUNT-COTI TO 1.                                        00093540
093550     SEARCH W-TAB-COMP-TIPO-EL                                    00093550
093560     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'IVA'   AND     00093560
093570          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00093570
093580                   BQVFB21-36-DATA-RISC                   AND     00093580
093590          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00093590
093600                   BQVFB21-36-DATA-RISC                           00093600
093610     MOVE 1                               TO W-FLAG-TROVATO.      00093610
093620*                                                                 00093620
093630 F5-020.                                                          00093630
093640*                                                                 00093640
093650     IF W-FLAG-TROVATO = 0                                        00093650
093660      DISPLAY 'F5-020-BQVFB0    : RECORD NON TROVATO SU BQVFCC'   00093660
093670      DISPLAY '                 CODICE COMPENSAZIONE = IVA'       00093670
093680      DISPLAY '                   DATA RISCOSSIONE   = '          00093680
093690                                      BQVFB11-36-DATA-RISC        00093690
093700      MOVE 0001                TO ABEND-CODE                      00093700
093710      CALL 'BQVFSR' USING ABEND-CODE                              00093710
093720      GO TO F5-EXIT.                                              00093720
093730*                                                                 00093730
093740 F5-030.                                                          00093740
093750*                                                                 00093750
093760*                                                                 00093760
093770 F5-040.                                                          00093770
093780*                                                                 00093780
093790     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00093790
093800                              TO  W-IMP-CRED-MAX1.                00093800
093810     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00093810
093820                              TO  W-IMP-CRED-MAX2.                00093820
093830*                                                                 00093830
093840 F5-EXIT.                                                         00093840
093850     EXIT.                                                        00093850
093860*---                                                              00093860
093870                                                                  00093870
093880*---                                                              00093880
093890 F6-010.                                                          00093890
093900*---                                                              00093900
093910     MOVE 0 TO W-FLAG-TROVATO.                                    00093910
093920     SET W-PUNT-COTI TO 1.                                        00093920
093930     SEARCH W-TAB-COMP-TIPO-EL                                    00093930
093940     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'IRS'   AND     00093940
093950          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00093950
093960                   BQVFB21-36-DATA-RISC                   AND     00093960
093970          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00093970
093980                   BQVFB21-36-DATA-RISC                           00093980
093990     MOVE 1                               TO W-FLAG-TROVATO.      00093990
094000*                                                                 00094000
094010 F6-020.                                                          00094010
094020*                                                                 00094020
094030     IF W-FLAG-TROVATO = 0                                        00094030
094040      DISPLAY 'F6-020-BQVFB0    : RECORD NON TROVATO SU BQVFCC'   00094040
094050      DISPLAY '                 CODICE COMPENSAZIONE = IRS'       00094050
094060      DISPLAY '                   DATA RISCOSSIONE   = '          00094060
094070                                      BQVFB11-36-DATA-RISC        00094070
094080      MOVE 0001                TO ABEND-CODE                      00094080
094090      CALL 'BQVFSR' USING ABEND-CODE                              00094090
094100      GO TO F6-EXIT.                                              00094100
094110*                                                                 00094110
094120 F6-030.                                                          00094120
094130*                                                                 00094130
094140*                                                                 00094140
094150 F6-040.                                                          00094150
094160*                                                                 00094160
094170     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00094170
094180                              TO  W-IMP-CRED-MAX1.                00094180
094190     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00094190
094200                              TO  W-IMP-CRED-MAX2.                00094200
094210*                                                                 00094210
094220 F6-EXIT.                                                         00094220
094230     EXIT.                                                        00094230
094240*---                                                              00094240
094250                                                                  00094250
094260*---                                                              00094260
094270 F7-010.                                                          00094270
094280*---                                                              00094280
094290     MOVE 0 TO W-FLAG-TROVATO.                                    00094290
094300     SET W-PUNT-COTI TO 1.                                        00094300
094310     SEARCH W-TAB-COMP-TIPO-EL                                    00094310
094320     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'IRP'   AND     00094320
094330          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00094330
094340                   BQVFB21-36-DATA-RISC                   AND     00094340
094350          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00094350
094360                   BQVFB21-36-DATA-RISC                           00094360
094370     MOVE 1                               TO W-FLAG-TROVATO.      00094370
094380*                                                                 00094380
094390 F7-020.                                                          00094390
094400*                                                                 00094400
094410     IF W-FLAG-TROVATO = 0                                        00094410
094420      DISPLAY 'F7-020-BQVFB0    : RECORD NON TROVATO SU BQVFCC'   00094420
094430      DISPLAY '                 CODICE COMPENSAZIONE = IRP'       00094430
094440      DISPLAY '                   DATA RISCOSSIONE   = '          00094440
094450                                      BQVFB11-36-DATA-RISC        00094450
094460      MOVE 0001                TO ABEND-CODE                      00094460
094470      CALL 'BQVFSR' USING ABEND-CODE                              00094470
094480      GO TO F7-EXIT.                                              00094480
094490*                                                                 00094490
094500 F7-030.                                                          00094500
094510*                                                                 00094510
094520*                                                                 00094520
094530 F7-040.                                                          00094530
094540*                                                                 00094540
094550     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00094550
094560                              TO  W-IMP-CRED-MAX1.                00094560
094570     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00094570
094580                              TO  W-IMP-CRED-MAX2.                00094580
094590*                                                                 00094590
094600 F7-EXIT.                                                         00094600
094610     EXIT.                                                        00094610
094620*---                                                              00094620
094630                                                                  00094630
094640*---                                                              00094640
094650 F8-010.                                                          00094650
094660*---                                                              00094660
094670     MOVE 0 TO W-FLAG-TROVATO.                                    00094670
094680     SET W-PUNT-COTI TO 1.                                        00094680
094690     SEARCH W-TAB-COMP-TIPO-EL                                    00094690
094700     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'IRM'   AND     00094700
094710          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00094710
094720                   BQVFB21-36-DATA-RISC                   AND     00094720
094730          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00094730
094740                   BQVFB21-36-DATA-RISC                           00094740
094750     MOVE 1                               TO W-FLAG-TROVATO.      00094750
094760*                                                                 00094760
094770 F8-020.                                                          00094770
094780*                                                                 00094780
094790     IF W-FLAG-TROVATO = 0                                        00094790
094800      DISPLAY 'F8-020-BQVFB0    : RECORD NON TROVATO SU BQVFCC'   00094800
094810      DISPLAY '                 CODICE COMPENSAZIONE = IRM'       00094810
094820      DISPLAY '                   DATA RISCOSSIONE   = '          00094820
094830                                      BQVFB11-36-DATA-RISC        00094830
094840      MOVE 0001                TO ABEND-CODE                      00094840
094850      CALL 'BQVFSR' USING ABEND-CODE                              00094850
094860      GO TO F8-EXIT.                                              00094860
094870*                                                                 00094870
094880 F8-030.                                                          00094880
094890*                                                                 00094890
094900*                                                                 00094900
094910 F8-040.                                                          00094910
094920*                                                                 00094920
094930     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00094930
094940                              TO  W-IMP-CRED-MAX1.                00094940
094950     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00094950
094960                              TO  W-IMP-CRED-MAX2.                00094960
094970*                                                                 00094970
094980 F8-EXIT.                                                         00094980
094990     EXIT.                                                        00094990
095000*---                                                              00095000
095010                                                                  00095010
095020*---                                                              00095020
095030 F9-010.                                                          00095030
095040*---                                                              00095040
095050     MOVE 0 TO W-FLAG-TROVATO.                                    00095050
095060     SET W-PUNT-COTI TO 1.                                        00095060
095070     SEARCH W-TAB-COMP-TIPO-EL                                    00095070
095080     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'ELO'   AND     00095080
095090          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00095090
095100                   BQVFB21-36-DATA-RISC                   AND     00095100
095110          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00095110
095120                   BQVFB21-36-DATA-RISC                           00095120
095130     MOVE 1                               TO W-FLAG-TROVATO.      00095130
095140*                                                                 00095140
095150 F9-020.                                                          00095150
095160*                                                                 00095160
095170     IF W-FLAG-TROVATO = 0                                        00095170
095180      DISPLAY 'F9-020-BQVFB0    : RECORD NON TROVATO SU BQVFCC'   00095180
095190      DISPLAY '                 CODICE COMPENSAZIONE = ELO'       00095190
095200      DISPLAY '                   DATA RISCOSSIONE   = '          00095200
095210                                      BQVFB11-36-DATA-RISC        00095210
095220      MOVE 0001                TO ABEND-CODE                      00095220
095230      CALL 'BQVFSR' USING ABEND-CODE                              00095230
095240      GO TO F9-EXIT.                                              00095240
095250*                                                                 00095250
095260 F9-030.                                                          00095260
095270*                                                                 00095270
095280*                                                                 00095280
095290 F9-040.                                                          00095290
095300*                                                                 00095300
095310     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00095310
095320                              TO  W-IMP-CRED-MAX1.                00095320
095330     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00095330
095340                              TO  W-IMP-CRED-MAX2.                00095340
095350*                                                                 00095350
095360 F9-EXIT.                                                         00095360
095370     EXIT.                                                        00095370
095380*---                                                              00095380
095390                                                                  00095390
095400*---                                                              00095400
095410 F10-010.                                                         00095410
095420*---                                                              00095420
095430     MOVE 0 TO W-FLAG-TROVATO.                                    00095430
095440     SET W-PUNT-COTI TO 1.                                        00095440
095450     SEARCH W-TAB-COMP-TIPO-EL                                    00095450
095460     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'IRF'   AND     00095460
095470          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00095470
095480                   BQVFB21-36-DATA-RISC                   AND     00095480
095490          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00095490
095500                   BQVFB21-36-DATA-RISC                           00095500
095510     MOVE 1                               TO W-FLAG-TROVATO.      00095510
095520*                                                                 00095520
095530 F10-020.                                                         00095530
095540*                                                                 00095540
095550     IF W-FLAG-TROVATO = 0                                        00095550
095560      DISPLAY 'F10-020-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00095560
095570      DISPLAY '                 CODICE COMPENSAZIONE = IRF'       00095570
095580      DISPLAY '                   DATA RISCOSSIONE   = '          00095580
095590                                      BQVFB11-36-DATA-RISC        00095590
095600      MOVE 0001                TO ABEND-CODE                      00095600
095610      CALL 'BQVFSR' USING ABEND-CODE                              00095610
095620      GO TO F10-EXIT.                                             00095620
095630*                                                                 00095630
095640 F10-030.                                                         00095640
095650*                                                                 00095650
095660*                                                                 00095660
095670 F10-040.                                                         00095670
095680*                                                                 00095680
095690     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00095690
095700                              TO  W-IMP-CRED-MAX1.                00095700
095710     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00095710
095720                              TO  W-IMP-CRED-MAX2.                00095720
095730*                                                                 00095730
095740 F10-EXIT.                                                        00095740
095750     EXIT.                                                        00095750
095760*---                                                              00095760
095770                                                                  00095770
095780*---                                                              00095780
095790 F11-010.                                                         00095790
095800*---                                                              00095800
095810     MOVE 0 TO W-FLAG-TROVATO.                                    00095810
095820     SET W-PUNT-COTI TO 1.                                        00095820
095830     SEARCH W-TAB-COMP-TIPO-EL                                    00095830
095840     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'ADX'   AND     00095840
095850          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00095850
095860                   BQVFB21-36-DATA-RISC                   AND     00095860
095870          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00095870
095880                   BQVFB21-36-DATA-RISC                           00095880
095890     MOVE 1                               TO W-FLAG-TROVATO.      00095890
095900*                                                                 00095900
095910 F11-020.                                                         00095910
095920*                                                                 00095920
095930     IF W-FLAG-TROVATO = 0                                        00095930
095940      DISPLAY 'F11-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00095940
095950      DISPLAY '                 CODICE COMPENSAZIONE = ADX'       00095950
095960      DISPLAY '                   DATA RISCOSSIONE   = '          00095960
095970                                      BQVFB11-36-DATA-RISC        00095970
095980      MOVE 0001                TO ABEND-CODE                      00095980
095990      CALL 'BQVFSR' USING ABEND-CODE                              00095990
096000      GO TO F11-EXIT.                                             00096000
096010*                                                                 00096010
096020 F11-030.                                                         00096020
096030*                                                                 00096030
096040*                                                                 00096040
096050 F11-040.                                                         00096050
096060*                                                                 00096060
096070     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00096070
096080                              TO  W-IMP-CRED-MAX1.                00096080
096090     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00096090
096100                              TO  W-IMP-CRED-MAX2.                00096100
096110*                                                                 00096110
096120 F11-EXIT.                                                        00096120
096130     EXIT.                                                        00096130
096140*---                                                              00096140
096150                                                                  00096150
096160*---                                                              00096160
096170 F12-010.                                                         00096170
096180*---                                                              00096180
096190     MOVE 0 TO W-FLAG-TROVATO.                                    00096190
096200     SET W-PUNT-COTI TO 1.                                        00096200
096210     SEARCH W-TAB-COMP-TIPO-EL                                    00096210
096220     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'IIE'   AND     00096220
096230          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00096230
096240                   BQVFB21-36-DATA-RISC                   AND     00096240
096250          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00096250
096260                   BQVFB21-36-DATA-RISC                           00096260
096270     MOVE 1                               TO W-FLAG-TROVATO.      00096270
096280*                                                                 00096280
096290 F12-020.                                                         00096290
096300*                                                                 00096300
096310     IF W-FLAG-TROVATO = 0                                        00096310
096320      DISPLAY 'F12-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00096320
096330      DISPLAY '                 CODICE COMPENSAZIONE = IIE'       00096330
096340      DISPLAY '                   DATA RISCOSSIONE   = '          00096340
096350                                      BQVFB11-36-DATA-RISC        00096350
096360      MOVE 0001                TO ABEND-CODE                      00096360
096370      CALL 'BQVFSR' USING ABEND-CODE                              00096370
096380      GO TO F12-EXIT.                                             00096380
096390*                                                                 00096390
096400 F12-030.                                                         00096400
096410*                                                                 00096410
096420*                                                                 00096420
096430 F12-040.                                                         00096430
096440*                                                                 00096440
096450     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00096450
096460                              TO  W-IMP-CRED-MAX1.                00096460
096470     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00096470
096480                              TO  W-IMP-CRED-MAX2.                00096480
096490*                                                                 00096490
096500 F12-EXIT.                                                        00096500
096510     EXIT.                                                        00096510
096520*---                                                              00096520
096530                                                                  00096530
096540*---                                                              00096540
096550 F13-010.                                                         00096550
096560*---                                                              00096560
096570     MOVE 0 TO W-FLAG-TROVATO.                                    00096570
096580     SET W-PUNT-COTI TO 1.                                        00096580
096590     SEARCH W-TAB-COMP-TIPO-EL                                    00096590
096600     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'IFE'   AND     00096600
096610          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00096610
096620                   BQVFB21-36-DATA-RISC                   AND     00096620
096630          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00096630
096640                   BQVFB21-36-DATA-RISC                           00096640
096650     MOVE 1                               TO W-FLAG-TROVATO.      00096650
096660*                                                                 00096660
096670 F13-020.                                                         00096670
096680*                                                                 00096680
096690     IF W-FLAG-TROVATO = 0                                        00096690
096700      DISPLAY 'F13-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00096700
096710      DISPLAY '                 CODICE COMPENSAZIONE = IFE'       00096710
096720      DISPLAY '                   DATA RISCOSSIONE   = '          00096720
096730                                      BQVFB11-36-DATA-RISC        00096730
096740      MOVE 0001                TO ABEND-CODE                      00096740
096750      CALL 'BQVFSR' USING ABEND-CODE                              00096750
096760      GO TO F13-EXIT.                                             00096760
096770*                                                                 00096770
096780 F13-030.                                                         00096780
096790*                                                                 00096790
096800*                                                                 00096800
096810 F13-040.                                                         00096810
096820*                                                                 00096820
096830     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00096830
096840                              TO  W-IMP-CRED-MAX1.                00096840
096850     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00096850
096860                              TO  W-IMP-CRED-MAX2.                00096860
096870*                                                                 00096870
096880 F13-EXIT.                                                        00096880
096890     EXIT.                                                        00096890
096900*---                                                              00096900
096910                                                                  00096910
096920*---                                                              00096920
096930 F14-010.                                                         00096930
096940*---                                                              00096940
096950     MOVE 0 TO W-FLAG-TROVATO.                                    00096950
096960     SET W-PUNT-COTI TO 1.                                        00096960
096970     SEARCH W-TAB-COMP-TIPO-EL                                    00096970
096980     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'FF1'   AND     00096980
096990          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00096990
097000                   BQVFB21-36-DATA-RISC                   AND     00097000
097010          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00097010
097020                   BQVFB21-36-DATA-RISC                           00097020
097030     MOVE 1                               TO W-FLAG-TROVATO.      00097030
097040*                                                                 00097040
097050 F14-020.                                                         00097050
097060*                                                                 00097060
097070     IF W-FLAG-TROVATO = 0                                        00097070
097080      DISPLAY 'F14-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00097080
097090      DISPLAY '                 CODICE COMPENSAZIONE = FF1'       00097090
097100      DISPLAY '                   DATA RISCOSSIONE   = '          00097100
097110                                      BQVFB11-36-DATA-RISC        00097110
097120      MOVE 0001                TO ABEND-CODE                      00097120
097130      CALL 'BQVFSR' USING ABEND-CODE                              00097130
097140      GO TO F14-EXIT.                                             00097140
097150*                                                                 00097150
097160 F14-030.                                                         00097160
097170*                                                                 00097170
097180*                                                                 00097180
097190 F14-040.                                                         00097190
097200*                                                                 00097200
097210     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00097210
097220                              TO  W-IMP-CRED-MAX1.                00097220
097230     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00097230
097240                              TO  W-IMP-CRED-MAX2.                00097240
097250*                                                                 00097250
097260 F14-EXIT.                                                        00097260
097270     EXIT.                                                        00097270
097280*---                                                              00097280
097290                                                                  00097290
097300*---                                                              00097300
097310 F15-010.                                                         00097310
097320*---                                                              00097320
097330     MOVE 0 TO W-FLAG-TROVATO.                                    00097330
097340     SET W-PUNT-COTI TO 1.                                        00097340
097350     SEARCH W-TAB-COMP-TIPO-EL                                    00097350
097360     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'FF2'   AND     00097360
097370          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00097370
097380                   BQVFB21-36-DATA-RISC                   AND     00097380
097390          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00097390
097400                   BQVFB21-36-DATA-RISC                           00097400
097410     MOVE 1                               TO W-FLAG-TROVATO.      00097410
097420*                                                                 00097420
097430 F15-020.                                                         00097430
097440*                                                                 00097440
097450     IF W-FLAG-TROVATO = 0                                        00097450
097460      DISPLAY 'F15-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00097460
097470      DISPLAY '                 CODICE COMPENSAZIONE = FF2'       00097470
097480      DISPLAY '                   DATA RISCOSSIONE   = '          00097480
097490                                      BQVFB11-36-DATA-RISC        00097490
097500      MOVE 0001                TO ABEND-CODE                      00097500
097510      CALL 'BQVFSR' USING ABEND-CODE                              00097510
097520      GO TO F15-EXIT.                                             00097520
097530*                                                                 00097530
097540 F15-030.                                                         00097540
097550*                                                                 00097550
097560*                                                                 00097560
097570 F15-040.                                                         00097570
097580*                                                                 00097580
097590     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00097590
097600                              TO  W-IMP-CRED-MAX1.                00097600
097610     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00097610
097620                              TO  W-IMP-CRED-MAX2.                00097620
097630*                                                                 00097630
097640 F15-EXIT.                                                        00097640
097650     EXIT.                                                        00097650
097660*---                                                              00097660
097670                                                                  00097670
097680*---                                                              00097680
097690 F16-010.                                                         00097690
097700*---                                                              00097700
097710     MOVE 0 TO W-FLAG-TROVATO.                                    00097710
097720     SET W-PUNT-COTI TO 1.                                        00097720
097730     SEARCH W-TAB-COMP-TIPO-EL                                    00097730
097740     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'FF3'   AND     00097740
097750          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00097750
097760                   BQVFB21-36-DATA-RISC                   AND     00097760
097770          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00097770
097780                   BQVFB21-36-DATA-RISC                           00097780
097790     MOVE 1                               TO W-FLAG-TROVATO.      00097790
097800*                                                                 00097800
097810 F16-020.                                                         00097810
097820*                                                                 00097820
097830     IF W-FLAG-TROVATO = 0                                        00097830
097840      DISPLAY 'F16-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00097840
097850      DISPLAY '                 CODICE COMPENSAZIONE = FF3'       00097850
097860      DISPLAY '                   DATA RISCOSSIONE   = '          00097860
097870                                      BQVFB11-36-DATA-RISC        00097870
097880      MOVE 0001                TO ABEND-CODE                      00097880
097890      CALL 'BQVFSR' USING ABEND-CODE                              00097890
097900      GO TO F16-EXIT.                                             00097900
097910*                                                                 00097910
097920 F16-030.                                                         00097920
097930*                                                                 00097930
097940*                                                                 00097940
097950 F16-040.                                                         00097950
097960*                                                                 00097960
097970     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00097970
097980                              TO  W-IMP-CRED-MAX1.                00097980
097990     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00097990
098000                              TO  W-IMP-CRED-MAX2.                00098000
098010*                                                                 00098010
098020 F16-EXIT.                                                        00098020
098030     EXIT.                                                        00098030
098040*---                                                              00098040
098050                                                                  00098050
098060*---                                                              00098060
098070 F17-010.                                                         00098070
098080*---                                                              00098080
098090     MOVE 0 TO W-FLAG-TROVATO.                                    00098090
098100     SET W-PUNT-COTI TO 1.                                        00098100
098110     SEARCH W-TAB-COMP-TIPO-EL                                    00098110
098120     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'ORO'   AND     00098120
098130          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00098130
098140                   BQVFB21-36-DATA-RISC                   AND     00098140
098150          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00098150
098160                   BQVFB21-36-DATA-RISC                           00098160
098170     MOVE 1                               TO W-FLAG-TROVATO.      00098170
098180*                                                                 00098180
098190 F17-020.                                                         00098190
098200*                                                                 00098200
098210     IF W-FLAG-TROVATO = 0                                        00098210
098220      DISPLAY 'F17-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00098220
098230      DISPLAY '                 CODICE COMPENSAZIONE = ORO'       00098230
098240      DISPLAY '                   DATA RISCOSSIONE   = '          00098240
098250                                      BQVFB11-36-DATA-RISC        00098250
098260      MOVE 0001                TO ABEND-CODE                      00098260
098270      CALL 'BQVFSR' USING ABEND-CODE                              00098270
098280      GO TO F17-EXIT.                                             00098280
098290*                                                                 00098290
098300 F17-030.                                                         00098300
098310*                                                                 00098310
098320*                                                                 00098320
098330 F17-040.                                                         00098330
098340*                                                                 00098340
098350     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00098350
098360                              TO  W-IMP-CRED-MAX1.                00098360
098370     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00098370
098380                              TO  W-IMP-CRED-MAX2.                00098380
098390*                                                                 00098390
098400 F17-EXIT.                                                        00098400
098410     EXIT.                                                        00098410
098420*---                                                              00098420
098430                                                                  00098430
098440*---                                                              00098440
098450 F18-010.                                                         00098450
098460*---                                                              00098460
098470     MOVE 0 TO W-FLAG-TROVATO.                                    00098470
098480     SET W-PUNT-COTI TO 1.                                        00098480
098490     SEARCH W-TAB-COMP-TIPO-EL                                    00098490
098500     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'SEC'   AND     00098500
098510          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00098510
098520                   BQVFB21-36-DATA-RISC                   AND     00098520
098530          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00098530
098540                   BQVFB21-36-DATA-RISC                           00098540
098550     MOVE 1                               TO W-FLAG-TROVATO.      00098550
098560*                                                                 00098560
098570 F18-020.                                                         00098570
098580*                                                                 00098580
098590     IF W-FLAG-TROVATO = 0                                        00098590
098600      DISPLAY 'F18-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00098600
098610      DISPLAY '                 CODICE COMPENSAZIONE = SEC'       00098610
098620      DISPLAY '                   DATA RISCOSSIONE   = '          00098620
098630                                      BQVFB11-36-DATA-RISC        00098630
098640      MOVE 0001                TO ABEND-CODE                      00098640
098650      CALL 'BQVFSR' USING ABEND-CODE                              00098650
098660      GO TO F18-EXIT.                                             00098660
098670*                                                                 00098670
098680 F18-030.                                                         00098680
098690*                                                                 00098690
098700*                                                                 00098700
098710 F18-040.                                                         00098710
098720*                                                                 00098720
098730     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00098730
098740                              TO  W-IMP-CRED-MAX1.                00098740
098750     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00098750
098760                              TO  W-IMP-CRED-MAX2.                00098760
098770*                                                                 00098770
098780 F18-EXIT.                                                        00098780
098790     EXIT.                                                        00098790
098800*---                                                              00098800
098810                                                                  00098810
098820*---                                                              00098820
098830 F19-010.                                                         00098830
098840*---                                                              00098840
098850     MOVE 0 TO W-FLAG-TROVATO.                                    00098850
098860     SET W-PUNT-COTI TO 1.                                        00098860
098870     SEARCH W-TAB-COMP-TIPO-EL                                    00098870
098880     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'IEC'   AND     00098880
098890          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00098890
098900                   BQVFB21-36-DATA-RISC                   AND     00098900
098910          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00098910
098920                   BQVFB21-36-DATA-RISC                           00098920
098930     MOVE 1                               TO W-FLAG-TROVATO.      00098930
098940*                                                                 00098940
098950 F19-020.                                                         00098950
098960*                                                                 00098960
098970     IF W-FLAG-TROVATO = 0                                        00098970
098980      DISPLAY 'F19-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00098980
098990      DISPLAY '                 CODICE COMPENSAZIONE = IEC'       00098990
099000      DISPLAY '                   DATA RISCOSSIONE   = '          00099000
099010                                      BQVFB11-36-DATA-RISC        00099010
099020      MOVE 0001                TO ABEND-CODE                      00099020
099030      CALL 'BQVFSR' USING ABEND-CODE                              00099030
099040      GO TO F19-EXIT.                                             00099040
099050*                                                                 00099050
099060 F19-030.                                                         00099060
099070*                                                                 00099070
099080*                                                                 00099080
099090 F19-040.                                                         00099090
099100*                                                                 00099100
099110     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00099110
099120                              TO  W-IMP-CRED-MAX1.                00099120
099130     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00099130
099140                              TO  W-IMP-CRED-MAX2.                00099140
099150*                                                                 00099150
099160 F19-EXIT.                                                        00099160
099170     EXIT.                                                        00099170
099180*---                                                              00099180
099190                                                                  00099190
099200*---                                                              00099200
099210 F20-010.                                                         00099210
099220*---                                                              00099220
099230     MOVE 0 TO W-FLAG-TROVATO.                                    00099230
099240     SET W-PUNT-COTI TO 1.                                        00099240
099250     SEARCH W-TAB-COMP-TIPO-EL                                    00099250
099260     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'LEZ'   AND     00099260
099270          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00099270
099280                   BQVFB21-36-DATA-RISC                   AND     00099280
099290          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00099290
099300                   BQVFB21-36-DATA-RISC                           00099300
099310     MOVE 1                               TO W-FLAG-TROVATO.      00099310
099320*                                                                 00099320
099330 F20-020.                                                         00099330
099340*                                                                 00099340
099350     IF W-FLAG-TROVATO = 0                                        00099350
099360      DISPLAY 'F20-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00099360
099370      DISPLAY '                 CODICE COMPENSAZIONE = LEZ'       00099370
099380      DISPLAY '                   DATA RISCOSSIONE   = '          00099380
099390                                      BQVFB11-36-DATA-RISC        00099390
099400      MOVE 0001                TO ABEND-CODE                      00099400
099410      CALL 'BQVFSR' USING ABEND-CODE                              00099410
099420      GO TO F20-EXIT.                                             00099420
099430*                                                                 00099430
099440 F20-030.                                                         00099440
099450*                                                                 00099450
099460*                                                                 00099460
099470 F20-040.                                                         00099470
099480*                                                                 00099480
099490     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00099490
099500                              TO  W-IMP-CRED-MAX1.                00099500
099510     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00099510
099520                              TO  W-IMP-CRED-MAX2.                00099520
099530*                                                                 00099530
099540 F20-EXIT.                                                        00099540
099550     EXIT.                                                        00099550
099560*---                                                              00099560
099570                                                                  00099570
099580*---                                                              00099580
099590 F21-010.                                                         00099590
099600*---                                                              00099600
099610     MOVE 0 TO W-FLAG-TROVATO.                                    00099610
099620     SET W-PUNT-COTI TO 1.                                        00099620
099630     SEARCH W-TAB-COMP-TIPO-EL                                    00099630
099640     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'QR1'   AND     00099640
099650          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00099650
099660                   BQVFB21-36-DATA-RISC                   AND     00099660
099670          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00099670
099680                   BQVFB21-36-DATA-RISC                           00099680
099690     MOVE 1                               TO W-FLAG-TROVATO.      00099690
099700*                                                                 00099700
099710 F21-020.                                                         00099710
099720*                                                                 00099720
099730     IF W-FLAG-TROVATO = 0                                        00099730
099740      DISPLAY 'F21-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00099740
099750      DISPLAY '                 CODICE COMPENSAZIONE = QR1'       00099750
099760      DISPLAY '                   DATA RISCOSSIONE   = '          00099760
099770                                      BQVFB11-36-DATA-RISC        00099770
099780      MOVE 0001                TO ABEND-CODE                      00099780
099790      CALL 'BQVFSR' USING ABEND-CODE                              00099790
099800      GO TO F21-EXIT.                                             00099800
099810*                                                                 00099810
099820 F21-030.                                                         00099820
099830*                                                                 00099830
099840*                                                                 00099840
099850 F21-040.                                                         00099850
099860*                                                                 00099860
099870     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00099870
099880                              TO  W-IMP-CRED-MAX1.                00099880
099890     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00099890
099900                              TO  W-IMP-CRED-MAX2.                00099900
099910*                                                                 00099910
099920 F21-EXIT.                                                        00099920
099930     EXIT.                                                        00099930
099940*---                                                              00099940
099942 F22-010.                                                         00099942
099943*---                                                              00099943
099944     MOVE 0 TO W-FLAG-TROVATO.                                    00099944
099945     SET W-PUNT-COTI TO 1.                                        00099945
099946     SEARCH W-TAB-COMP-TIPO-EL                                    00099946
099947     WHEN W-TAB-COMP-TIPO-COD-COMP(W-PUNT-COTI) = 'BTC'   AND     00099947
099948          W-TAB-COMP-TIPO-INIZIO-VAL(W-PUNT-COTI)       NOT >     00099948
099949                   BQVFB21-36-DATA-RISC                   AND     00099949
099950          W-TAB-COMP-TIPO-FINE-VAL(W-PUNT-COTI)         NOT <     00099950
099951                   BQVFB21-36-DATA-RISC                           00099951
099952     MOVE 1                               TO W-FLAG-TROVATO.      00099952
099953*                                                                 00099953
099954 F22-020.                                                         00099954
099955*                                                                 00099955
099958     IF W-FLAG-TROVATO = 0                                        00099958
099959      DISPLAY 'F21-010-BQVFB0    : RECORD NON TROVATO SU BQVFCC'  00099959
099960      DISPLAY '                 CODICE COMPENSAZIONE = BTC'       00099960
099961      DISPLAY '                   DATA RISCOSSIONE   = '          00099961
099962                                      BQVFB11-36-DATA-RISC        00099962
099963      MOVE 0001                TO ABEND-CODE                      00099963
099964      CALL 'BQVFSR' USING ABEND-CODE                              00099964
099965      GO TO F22-EXIT.                                             00099965
099966*                                                                 00099966
099967 F22-030.                                                         00099967
099968*                                                                 00099968
099969*                                                                 00099969
099970 F22-040.                                                         00099970
099971*                                                                 00099971
099972     MOVE W-TAB-COMP-TIPO-IMPORTO-1(W-PUNT-COTI)                  00099972
099973                              TO  W-IMP-CRED-MAX1.                00099973
099974     MOVE W-TAB-COMP-TIPO-IMPORTO-2(W-PUNT-COTI)                  00099974
099975                              TO  W-IMP-CRED-MAX2.                00099975
099976*                                                                 00099976
100005 F22-EXIT.                                                        00100005
100006     EXIT.                                                        00100006
100007*---                                                              00100007
100008                                                                  00100008
100009*---                                                              00100009
100010*--- PERFORM Q1-010-CONTR-12 - CONTROLLI SUL RECORD 12            00100010
100011*---                                                              00100011
100012 Q1-010-CONTR-12.                                                 00100012
100013     MOVE ZERO TO BQVFB21-ERR-RECORD-12.                          00100013
100014     MOVE W-CTR-BLOC TO W-APPO-CTR-BLOC.                          00100014
100020     MOVE W-CTR-NO-BLOC TO W-APPO-CTR-NO-BLOC.                    00100020
100030*---                                                              00100030
100040     IF W-FLAG-NUOVA-DELEGA = 1                                   00100040
100050        PERFORM RH-010-NUOVA-DELEGA THRU RH-990-NUOVA-DELEGA-EX.  00100050
100060     ADD 1 TO W-CTR-12.                                           00100060
100070*--- SI RICHIAMA LA PERFORM DEI CONTROLLI PER I CAMPI             00100070
100080*--- COMUNI TRA PIU' RECORD                                       00100080
100090     COMPUTE W-APPO-CTR = W-CTR-12 - W-MEM-CTR-12.                00100090
100100     PERFORM RE-010-CONTR-COMUNI THRU RE-990-CONTR-COMUNI-EX.     00100100
100110                                                                  00100110
100120 Q1-020.                                                          00100120
100130* INIZIO MODIFICA EURO                                            00100130
100140*--- SI CONTROLLA IL CODICE DIVISA OPERAZIONE DIVERSO             00100140
100150*--- DA QUELLO TROVATO SUL RECORD DI TESTA                        00100150
100160* SI ESEGUE LO STESSO CONTROLLO ANCHE PER DIVISE UGUALI           00100160
100170     IF (BQVFB11-12-DIVISA-OPER NOT = W-APPO-DIV-OPER AND         00100170
100180         W-APPO-ERR-DIV-OPER NOT = ZERO)                          00100180
100190     OR BQVFB11-12-DIVISA-OPER = W-APPO-DIV-OPER                  00100190
100200        GO TO Q1-060.                                             00100200
100210                                                                  00100210
100220 Q1-030.                                                          00100220
100230*--- ERRORE DI OMOGENEITA' DEL CODICE DIVISA                      00100230
100240     MOVE 502 TO BQVFB21-12-ERR-DIV-OPER.                         00100240
100250     MOVE 'E' TO BQVFB21-12-ERR-DIV-OPER-A.                       00100250
100260     ADD 1 TO W-CTR-BLOC.                                         00100260
100270     GO TO Q1-080.                                                00100270
100280                                                                  00100280
100290 Q1-060.                                                          00100290
100300*--- CODICE DIVISA UGUALE A QUELLO DEL RECORD DI TESTA            00100300
100310*--- E CODICE DIVISA DEL RECORD DI TESTA ERRATO                   00100310
100320     IF  BQVFB11-12-DIVISA-OPER = W-APPO-DIV-OPER                 00100320
100330     AND W-APPO-ERR-DIV-OPER NOT = ZERO                           00100330
100340        MOVE W-APPO-ERR-DIV-OPER TO BQVFB21-12-ERR-DIV-OPER       00100340
100350        MOVE 'E' TO BQVFB21-12-ERR-DIV-OPER-A                     00100350
100360        ADD 1 TO W-CTR-BLOC                                       00100360
100370        GO TO Q1-080                                              00100370
100380     END-IF.                                                      00100380
100390*                                                                 00100390
100400 Q1-065.                                                          00100400
100410*--- SI CONTROLLA LA CORRETTEZZA DEL CODICE DIVISA                00100410
100420     IF BQVFB11-12-DIVISA-OPER = 'EUR'                            00100420
100430     OR (    BQVFB11-12-DIVISA-OPER = 'ITL'                       00100430
100440         AND BQVFB11-12-DATA-RISC < BQVFCO1-DATA-EUR )            00100440
100450        GO TO Q1-080.                                             00100450
100460                                                                  00100460
100470 Q1-070.                                                          00100470
100480*--- ERRORE DI CORRETTEZZA DEL CODICE DIVISA                      00100480
100490     MOVE 55 TO BQVFB21-12-ERR-DIV-OPER.                          00100490
100500     MOVE 'E' TO BQVFB21-12-ERR-DIV-OPER-A.                       00100500
100510     ADD 1 TO W-CTR-BLOC.                                         00100510
100520                                                                  00100520
100530 Q1-080.                                                          00100530
100540*--- SI RICHIAMA LA ROUTINE PER GLI ULTERIORI CONTROLLI           00100540
100550*--- SUL RECORD 12                                                00100550
100560     MOVE SPACE TO W-DIV.                                         00100560
100570     IF W-APPO-ERR-DIV-OPER = ZERO                                00100570
100580        MOVE W-APPO-DIV-OPER TO W-DIV.                            00100580
100590     CALL 'BQVFE9' USING   W-FLAG-BANCA                           00100590
100600                           BQVFB21                                00100600
100610                           W-TAB-TOT                              00100610
100620                           W-DIV                                  00100620
100630                           W-CTR-NO-BLOC                          00100630
100640                           W-CTR-BLOC                             00100640
100650                           W-TAB-TRIBUTI                          00100650
100660                           W-TAB-VEIC                             00100660
100670                           W-TAB-UFFICIO                          00100670
100680                           W-UFF-RIF                              00100680
100690                           W-NUM-RIF                              00100690
100700                           W-COD-FISC-KO                          00100700
100710                           W-TAB-CAT-TRIB.                        00100710
100720     IF BQVFB21-12-ERR-NUM-RIFER = 888 AND                        00100720
100730        BQVFB21-12-ERR-CODICE-FISC-A = 'W'                        00100730
100740        SUBTRACT 1       FROM W-CTR-NO-BLOC                       00100740
100750        ADD      1         TO W-CTR-BLOC.                         00100750
100760     IF BQVFB21-12-ERR-NUM-RIFER = 888 AND                        00100760
100770        BQVFB21-12-ERR-CODICE-FISC-A = '0'                        00100770
100780        ADD      1         TO W-CTR-BLOC.                         00100780
100790     IF BQVFB21-12-ERR-NUM-RIFER = 888                            00100790
100800        MOVE 55            TO BQVFB21-12-ERR-NUM-RIFER            00100800
100810        MOVE 55            TO BQVFB21-12-ERR-CODICE-FISC          00100810
100820        MOVE 'E'           TO BQVFB21-12-ERR-CODICE-FISC-A.       00100820
100830                                                                  00100830
100840 Q1-990-CONTR-12-EX.                                              00100840
100850     EXIT.                                                        00100850
100860                                                                  00100860
100870***************************************************************** 00100870
100880*    CARICAMENTO IN MEMORIA DELLA TABELLA CODICE IDENTIFICATIVO   00100880
100890***************************************************************** 00100890
100900 SA-010-CAR-CI.                                                   00100900
100910**** INIZIALIZZO LA TABELLA DI WORKING                            00100910
100920     SET W-PUNT-IDENT      TO 1.                                  00100920
100930     MOVE HIGH-VALUE   TO W-TAB-IDENT-OCC.                        00100930
100940     MOVE LOW-VALUE    TO W-FF.                                   00100940
100950**** APERTURA ARCHIVIO CI                                         00100950
100960     OPEN INPUT  BQVFCI.                                          00100960
100970*                                                                 00100970
100980 SA-020.                                                          00100980
100990     READ BQVFCI INTO BQVFCI1   AT END                            00100990
101000               MOVE HIGH-VALUE TO W-FF.                           00101000
101010     IF W-FF EQUAL LOW-VALUE                                      00101010
101020        GO TO SA-040.                                             00101020
101030 SA-030.                                                          00101030
101040     GO TO SA-050.                                                00101040
101050 SA-040.                                                          00101050
101060***  ESTRATTA UNA RIGA                                            00101060
101070***  LA IMPOSTO IN TABELLA                                        00101070
101080     MOVE BQVFCI1-COD-IDENT                                       00101080
101090           TO W-TAB-IDENT-COD(W-PUNT-IDENT).                      00101090
101100     MOVE BQVFCI1-INIZIO-VAL                                      00101100
101110           TO W-TAB-IDENT-INIZIO-VAL(W-PUNT-IDENT).               00101110
101120     MOVE BQVFCI1-FINE-VAL                                        00101120
101130           TO W-TAB-IDENT-FINE-VAL(W-PUNT-IDENT).                 00101130
101140 SA-050.                                                          00101140
101150**** VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00101150
101160     IF W-FF          = LOW-VALUE        AND                      00101160
101170        W-PUNT-IDENT < W-TAB-IDENT-NUM-MAX                        00101170
101180        SET W-PUNT-IDENT UP BY 1                                  00101180
101190        GO TO  SA-020.                                            00101190
101200 SA-060.                                                          00101200
101210***  VERIFICA SFONDAMENTO TABELLA                                 00101210
101220     IF W-PUNT-IDENT  = W-TAB-IDENT-NUM-MAX AND                   00101220
101230        W-FF          = LOW-VALUE                                 00101230
101240***     SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00101240
101250***     IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00101250
101260***     DELLA TABELLA DI WORKING.                                 00101260
101270        MOVE '0000'      TO ABEND-CODE                            00101270
101280        DISPLAY 'BQVFB0-SA-060-01: SUPERATO IL NUMERO MASSIMO  '  00101280
101290        DISPLAY 'BQVFB0-SA-060-01: DI ELEMENTI PER LA TABELLA  '  00101290
101300        DISPLAY 'BQVFB0-SA-060-01: DI WORKING "W-TAB-IDENT".  '   00101300
101310        CALL 'BQVFSR' USING ABEND-CODE.                           00101310
101320***                                                               00101320
101330***  CHIUSURA ARCHIVIO CODICE IDENTIFICATIVO                      00101330
101340     CLOSE   BQVFCI.                                              00101340
101350***                                                               00101350
101360 SA-990-CAR-CI-EX.                                                00101360
101370     EXIT.                                                        00101370
101380***************************************************************** 00101380
101390*    CARICAMENTO IN MEMORIA DELLA TABELLA TIPO VEICIOLO           00101390
101400***************************************************************** 00101400
101410 SB-010-CAR-CV.                                                   00101410
101420**** INIZIALIZZO LA TABELLA DI WORKING                            00101420
101430     SET W-PUNT-VEIC       TO 1.                                  00101430
101440     MOVE HIGH-VALUE   TO W-TAB-VEIC-OCC.                         00101440
101450     MOVE LOW-VALUE    TO W-FF.                                   00101450
101460**** APERTURA ARCHIVIO CV                                         00101460
101470     OPEN INPUT  BQVFCV.                                          00101470
101480*                                                                 00101480
101490 SB-020.                                                          00101490
101500     READ BQVFCV INTO BQVFCV1   AT END                            00101500
101510               MOVE HIGH-VALUE TO W-FF.                           00101510
101520     IF W-FF EQUAL LOW-VALUE                                      00101520
101530        GO TO SB-040.                                             00101530
101540 SB-030.                                                          00101540
101550     GO TO SB-050.                                                00101550
101560 SB-040.                                                          00101560
101570***  ESTRATTA UNA RIGA                                            00101570
101580***  LA IMPOSTO IN TABELLA                                        00101580
101590     MOVE BQVFCV1-TIPO-VEIC                                       00101590
101600           TO W-TAB-VEIC-TIPO(W-PUNT-VEIC).                       00101600
101610     MOVE BQVFCV1-INIZIO-VAL                                      00101610
101620           TO W-TAB-VEIC-INIZIO-VAL(W-PUNT-VEIC).                 00101620
101630     MOVE BQVFCV1-FINE-VAL                                        00101630
101640           TO W-TAB-VEIC-FINE-VAL(W-PUNT-VEIC).                   00101640
101650 SB-050.                                                          00101650
101660**** VERIFICO SE CONTINUARE AD ESTRARRE LE OCCORRENZE             00101660
101670     IF W-FF          = LOW-VALUE        AND                      00101670
101680        W-PUNT-VEIC < W-TAB-VEIC-NUM-MAX                          00101680
101690        SET W-PUNT-VEIC UP BY 1                                   00101690
101700        GO TO  SB-020.                                            00101700
101710 SB-060.                                                          00101710
101720***  VERIFICA SFONDAMENTO TABELLA                                 00101720
101730     IF W-PUNT-VEIC   = W-TAB-VEIC-NUM-MAX AND                    00101730
101740        W-FF          = LOW-VALUE                                 00101740
101750***     SE IL PUNTATORE PUNTA AL MASSIMO ELEMENTO E               00101750
101760***     IL FILE DI INPUT NON E' FINITO SI SEGNALA LO SFONDAMENTO  00101760
101770***     DELLA TABELLA DI WORKING.                                 00101770
101780        MOVE '0000'      TO ABEND-CODE                            00101780
101790        DISPLAY 'BQVFB0-SB-060-01: SUPERATO IL NUMERO MASSIMO  '  00101790
101800        DISPLAY 'BQVFB0-SB-060-01: DI ELEMENTI PER LA TABELLA  '  00101800
101810        DISPLAY 'BQVFB0-SB-060-01: DI WORKING "W-TAB-VEIC".  '    00101810
101820        CALL 'BQVFSR' USING ABEND-CODE.                           00101820
101830***                                                               00101830
101840***  CHIUSURA ARCHIVIO TIPO VEICOLO                               00101840
101850     CLOSE   BQVFCV.                                              00101850
101860***                                                               00101860
101870 SB-990-CAR-CV-EX.                                                00101870
101880     EXIT.                                                        00101880
101890*                                                                 00101890
101900 L2-319.                                                          00101900
101910*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 14     00101910
101920     IF BQVFB11-99-NUMREC-V12A NUMERIC                            00101920
101930        GO TO L2-319-2.                                           00101930
101940                                                                  00101940
101950 L2-319-1.                                                        00101950
101960*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 14           00101960
101970     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V12.                        00101970
101980     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V12-A.                     00101980
101990     ADD 1 TO W-CTR-BLOC.                                         00101990
102000     GO TO L2-320.                                                00102000
102010                                                                  00102010
102020 L2-319-2.                                                        00102020
102030*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 14      00102030
102040*--- CON QUELLO CALCOLATO                                         00102040
102050     IF BQVFB11-99-NUMREC-V12 NOT = W-CTR-14                      00102050
102060        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V12                     00102060
102070        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V12-A                   00102070
102080        ADD 1 TO W-CTR-BLOC.                                      00102080
102090*                                                                 00102090
102100                                                                  00102100
102110 L2-320.                                                          00102110
102120*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 15     00102120
102130     IF BQVFB11-99-NUMREC-V14A NUMERIC                            00102130
102140        GO TO L2-330.                                             00102140
102150                                                                  00102150
102160 L2-325.                                                          00102160
102170*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 15           00102170
102180     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V14.                        00102180
102190     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V14-A.                     00102190
102200     ADD 1 TO W-CTR-BLOC.                                         00102200
102210     GO TO L2-340.                                                00102210
102220                                                                  00102220
102230 L2-330.                                                          00102230
102240*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 15      00102240
102250*--- CON QUELLO CALCOLATO                                         00102250
102260     IF BQVFB11-99-NUMREC-V14 NOT = W-CTR-15                      00102260
102270        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V14                     00102270
102280        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V14-A                   00102280
102290        ADD 1 TO W-CTR-BLOC.                                      00102290
102300                                                                  00102300
102310 L2-340.                                                          00102310
102320*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 20     00102320
102330     IF BQVFB11-99-NUMREC-V15A NUMERIC                            00102330
102340        GO TO L2-360.                                             00102340
102350                                                                  00102350
102360 L2-350.                                                          00102360
102370*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 20           00102370
102380     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V15.                        00102380
102390     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V15-A.                     00102390
102400     ADD 1 TO W-CTR-BLOC.                                         00102400
102410     GO TO L2-370.                                                00102410
102420                                                                  00102420
102430 L2-360.                                                          00102430
102440*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 20      00102440
102450*--- CON QUELLO CALCOLATO                                         00102450
102460     IF BQVFB11-99-NUMREC-V15 NOT = W-CTR-20                      00102460
102470        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V15                     00102470
102480        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V15-A                   00102480
102490        ADD 1 TO W-CTR-BLOC.                                      00102490
102500                                                                  00102500
102510 L2-370.                                                          00102510
102520*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 36     00102520
102530     IF BQVFB11-99-NUMREC-V20A NUMERIC                            00102530
102540        GO TO L2-374.                                             00102540
102550                                                                  00102550
102560 L2-372.                                                          00102560
102570*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 36           00102570
102580     MOVE 33  TO BQVFB21-99-ERR-NUMREC-V20.                       00102580
102590     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V20-A.                     00102590
102600     ADD 1 TO W-CTR-BLOC.                                         00102600
102610     GO TO L2-378.                                                00102610
102620                                                                  00102620
102630 L2-374.                                                          00102630
102640*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 36      00102640
102650*--- CON QUELLO CALCOLATO                                         00102650
102660     IF BQVFB11-99-NUMREC-V20 NOT = W-CTR-36                      00102660
102670        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V20                     00102670
102680        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V20-A                   00102680
102690        ADD 1 TO W-CTR-BLOC.                                      00102690
102700                                                                  00102700
102710 L2-378.                                                          00102710
102720*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 37     00102720
102730     IF BQVFB11-99-NUMREC-V36A NUMERIC                            00102730
102740        GO TO L2-390.                                             00102740
102750                                                                  00102750
102760 L2-380.                                                          00102760
102770*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 37           00102770
102780     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V36.                        00102780
102790     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V36-A.                     00102790
102800     ADD 1 TO W-CTR-BLOC.                                         00102800
102810     GO TO L2-400.                                                00102810
102820                                                                  00102820
102830 L2-390.                                                          00102830
102840*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 37      00102840
102850*--- CON QUELLO CALCOLATO                                         00102850
102860     IF BQVFB11-99-NUMREC-V36 NOT = W-CTR-37                      00102860
102870        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V36                     00102870
102880        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V36-A                   00102880
102890        ADD 1 TO W-CTR-BLOC.                                      00102890
102900                                                                  00102900
102910 L2-400.                                                          00102910
102920*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 38     00102920
102930     IF BQVFB11-99-NUMREC-V37A NUMERIC                            00102930
102940        GO TO L2-420.                                             00102940
102950                                                                  00102950
102960 L2-410.                                                          00102960
102970*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 38           00102970
102980     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V37.                        00102980
102990     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V37-A.                     00102990
103000     ADD 1 TO W-CTR-BLOC.                                         00103000
103010     GO TO L2-430.                                                00103010
103020                                                                  00103020
103030 L2-420.                                                          00103030
103040*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 38      00103040
103050*--- CON QUELLO CALCOLATO                                         00103050
103060     IF BQVFB11-99-NUMREC-V37 NOT = W-CTR-38                      00103060
103070        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V37                     00103070
103080        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V37-A                   00103080
103090        ADD 1 TO W-CTR-BLOC.                                      00103090
103100                                                                  00103100
103110 L2-430.                                                          00103110
103120*--- SI CONTROLLA LA NUMERICITA' DEL NUMERO RECORD DI TIPO 49     00103120
103130     IF BQVFB11-99-NUMREC-V38A NUMERIC                            00103130
103140        GO TO L2-450.                                             00103140
103150                                                                  00103150
103160 L2-440.                                                          00103160
103170*--- ERRORE DI NUMERICITA' DEL NUMERO RECORD DI TIPO 49           00103170
103180     MOVE 33 TO BQVFB21-99-ERR-NUMREC-V38.                        00103180
103190     MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V38-A.                     00103190
103200     ADD 1 TO W-CTR-BLOC.                                         00103200
103210     GO TO L2-460.                                                00103210
103220                                                                  00103220
103230 L2-450.                                                          00103230
103240*--- SI CONTROLLA LA CONGRUENZA DEL NUMERO RECORD DI TIPO 49      00103240
103250*--- CON QUELLO CALCOLATO                                         00103250
103260     IF BQVFB11-99-NUMREC-V38 NOT = W-CTR-49                      00103260
103270        MOVE 503 TO BQVFB21-99-ERR-NUMREC-V38                     00103270
103280        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V38-A                   00103280
103290        ADD 1 TO W-CTR-BLOC.                                      00103290
103300                                                                  00103300
103310 L2-460.                                                          00103310
103320*--- SI CONTROLLA LA CONGRUENZA DEI CONTATORI V36/V49             00103320
103330*                                                                 00103330
103340     IF W-CONT-V49 NOT = W-CONT-V36                               00103340
103350        MOVE 506 TO BQVFB21-99-ERR-NUMREC-V49                     00103350
103360        MOVE 'E' TO BQVFB21-99-ERR-NUMREC-V49-A                   00103360
103370        ADD 1 TO W-CTR-BLOC                                       00103370
103380     END-IF.                                                      00103380
103390                                                                  00103390
103400 L2-990-CONTR-99-EX.                                              00103400
103410     EXIT.                                                        00103410
103420                                                                  00103420
103430*                                                                 00103430
103440*////////////////////////////////////////////////////////////////*00103440
103450*///                                                          ///*00103450
103460*///  CONTROLLIAMO SE UN CF PRESENTA CARATTERI MAIUSCOLI      ///*00103460
103470*///  OPPURE MINUSCOLI, E NEL SECONDO CASO, VIENE SEGNALATO   ///*00103470
103480*///  COME ERRORE, OVVIAMENTE NON BLOCCANTE.                  ///*00103480
103490*///                                                          ///*00103490
105100*////////////////////////////////////////////////////////////////*00105100
105200 S1-010-CTRL-CF.                                                  00105200
105300*                                                                 00105300
105600     MOVE BQVFB11-01-CODICE-FISC  TO W-COD-FISC.                  00105600
105700*                                                                 00105700
105800     PERFORM VARYING W-I FROM 1 BY 1                              00105800
105900       UNTIL W-I > 16  OR  W-CTR-BLOC = '1'                       00105900
106000        MOVE    SPACES         TO W-BYTE                          00106000
106100        MOVE W-COD-FISC(W-I:1) TO W-BYTE                          00106100
106200        EVALUATE W-BYTE                                           00106200
106300* --- CARATTERE NUMERICO ( CONTROLLO OK )                         00106300
106400           WHEN '0'                                               00106400
106500           WHEN '1'                                               00106500
106600           WHEN '2'                                               00106600
106700           WHEN '3'                                               00106700
106800           WHEN '4'                                               00106800
106900           WHEN '5'                                               00106900
107000           WHEN '6'                                               00107000
107100           WHEN '7'                                               00107100
107200           WHEN '8'                                               00107200
107300           WHEN '9'                                               00107300
107400* --- CARATTERE ALFABETICO MAIUSCOLO ( CONTROLLO OK )             00107400
107500           WHEN 'A'                                               00107500
107600           WHEN 'B'                                               00107600
107700           WHEN 'C'                                               00107700
107800           WHEN 'D'                                               00107800
107900           WHEN 'E'                                               00107900
108000           WHEN 'F'                                               00108000
108100           WHEN 'G'                                               00108100
108200           WHEN 'H'                                               00108200
108300           WHEN 'I'                                               00108300
108400           WHEN 'J'                                               00108400
108500           WHEN 'K'                                               00108500
108600           WHEN 'L'                                               00108600
108700           WHEN 'M'                                               00108700
108800           WHEN 'N'                                               00108800
108900           WHEN 'O'                                               00108900
109000           WHEN 'P'                                               00109000
109100           WHEN 'Q'                                               00109100
109200           WHEN 'R'                                               00109200
109300           WHEN 'S'                                               00109300
109400           WHEN 'T'                                               00109400
109500           WHEN 'U'                                               00109500
109600           WHEN 'V'                                               00109600
109700           WHEN 'W'                                               00109700
109800           WHEN 'X'                                               00109800
109900           WHEN 'Y'                                               00109900
110000           WHEN 'Z'                                               00110000
110100              CONTINUE                                            00110100
110200           WHEN OTHER                                             00110200
110500* --- CARATTERE NON AMMESSO ( CONTROLLO KO )                      00110500
110600              MOVE 096   TO BQVFB21-01-ERR-CODICE-FISC            00110600
110700              MOVE 'E'   TO BQVFB21-01-ERR-CODICE-FISC-A          00110700
110800              ADD   1    TO W-CTR-BLOC                            00110800
110900              MOVE SPACE TO W-PF-PNF                              00110900
111000              MOVE '2'   TO W-COD-FISC-KO                         00111000
111100              MOVE '2'   TO W-COD-FISC-KO-M                       00111100
111200        END-EVALUATE                                              00111200
111300     END-PERFORM.                                                 00111300
111400*                                                                 00111400
111500 S1-990-EX.                                                       00111500
111600     EXIT.                                                        00111600
111700                                                                  00111700
