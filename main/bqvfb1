000100 IDENTIFICATION DIVISION.                                         00000100
000200 PROGRAM-ID.     BQVFB1.                                          00000200
000300 AUTHOR. BQH10.                                                   00000300
000400 DATE-WRITTEN.  29/04/2004.                                       00000400
000500*************************************************************     00000500
000600*$1 TITOLO - CONTROLLO TIPO RECORD 01/03                          00000600
000700*************************************************************     00000700
000800*$1 FUNZIONI SVOLTE E LOGICA DI ELABORAZIONE                      00000800
000900*   IL COMPONENTE RICEVE IN INPUT I DATI RELATIVI AI RECORD       00000900
001000*   DI TIPO 01/03 (TRAMITE MODULO DI COLLOQUIO FBQVFB21) E        00001000
001100*   SVOLGE DEI CONTROLLI FORMALI; IN CASO DI INCORRETTEZZE        00001100
001200*   PROVVEDE AD IMPOSTARE (NELLO STESSO MODULO) DEI               00001200
001300*   CODICI DI ERRORE ED INCREMENTA DEI CONTATORI RELATIVI         00001300
001400*   AL TIPO DI ERRORE(BLOCCANTE/NON BLOCCANTE)                    00001400
001500*                                                                 00001500
001600* 2. ARCHIVI GESTITI                                              00001600
001700*      NESSUNO                                                    00001700
001800*                                                                 00001800
001900* 3. SUBROUTINES RICHIAMATE                                       00001900
002000*      NOME       DESCRIZIONE                                     00002000
002100*    BQVFDA    ROUTINE CALCOLO DATE                               00002100
002200*                                                                 00002200
002300 ENVIRONMENT DIVISION.                                            00002300
002400 CONFIGURATION SECTION.                                           00002400
002500 SPECIAL-NAMES.                                                   00002500
002600     DECIMAL-POINT IS COMMA.                                      00002600
002700 INPUT-OUTPUT SECTION.                                            00002700
002800 FILE-CONTROL.                                                    00002800
002900 DATA DIVISION.                                                   00002900
003000 FILE SECTION.                                                    00003000
003100***************  WORKING STORAGE SECTION  **********************  00003100
003200 WORKING-STORAGE SECTION.                                         00003200
003300 77  W-S                            PIC X(8) VALUE 'BQVFB1WS'.    00003300
003400*---   FLAG PER INDICARE SE IL TRIBUTO ESISTE                     00003400
003500*---                                                              00003500
003600 77  W-TROVATO                      PIC X(002).                   00003600
003700*---   FLAG PER INDICARE SE IL RIMBORSO PUO' ESSERE CHIESTO       00003700
003800*---   DAL DICHIARANTE                                            00003800
003900 77  W-INDICA                       PIC X(002).                   00003900
004000*** MODIFICA GIUGNO 2003: NUOVO FLAG COMPENSABILITA'              00004000
004100 77  FLAG-COMPEN                    PIC X.                        00004100
004200*** MODIFICA GENNAIO 2004: FLAG TRIBUTO AGEVOLATO E SOLO CONC.    00004200
004300 77  FLAG-TRIB-AGEV                 PIC X.                        00004300
004400 77  FLAG-TRIB-CONC                 PIC X.                        00004400
004500 77  COD-ATTO                       PIC X(002).                   00004500
004600 77  ANNO-RIF                       PIC 9(002).                   00004600
004700*---                                                              00004700
004800*---   TRIBUTI VALIDI SOLO PER I CONCESSIONARI                    00004800
004900*---                                                              00004900
005000 01  W-TRIBUTI-AGEV                 PIC X(004).                   00005000
005100 01  W-TRIB-6603                    PIC X(004) VALUE '6603'.      00005100
005200 01  W-TRIB-6706                    PIC X(004) VALUE '6706'.      00005200
005300 01  W-TRIB-6707                    PIC X(004) VALUE '6707'.      00005300
005400 01  W-TRIB-3888                    PIC X(004) VALUE '3888'.      00005400
005500 01  W-TRIB-3889                    PIC X(004) VALUE '3889'.      00005500
005600 01  W-TRIB-3890                    PIC X(004) VALUE '3890'.      00005600
005700 01  W-KO-AGEV                      PIC X(001).                   00005700
005800*                                                                 00005800
005900*** INIZIO MODIFICA TRIBUTI AGEVOLATI - GENNAIO 2004              00005900
006000*---                                                              00006000
006100*--- TRIBUTI PER I QUALI NON VALE LA COMPENSAZIONE MASSIMA        00006100
006200*--- DI CINQUECENTO MILIONI                                       00006200
006300*01  W-TRIB-AGEV-V01                PIC X(004).                   00006300
006400*    88  W-TRIB-AGEV-V01-OK         VALUE '1250'                  00006400
006500*                                         '6601'                  00006500
006600*                                         '6602'                  00006600
006700*                                         '6603'                  00006700
006800*                                         '6604'                  00006800
006900*                                         '6605'                  00006900
007000*                                         '6606'                  00007000
007100*                                         '6700'                  00007100
007200*                                         '6701'                  00007200
007300*                                         '6702'                  00007300
007400*                                         '6703'                  00007400
007500*                                         '6705'                  00007500
007600*                                         '6706'                  00007600
007700*                                         '6707'                  00007700
007800*                                         '6708'                  00007800
007900*                                         '6709'                  00007900
008000*                                         '6710'                  00008000
008100*                                         '6711'                  00008100
008200*                                         '6712'                  00008200
008300*                                         '6713'                  00008300
008400*                                         '6714'                  00008400
008500*                                         '6715'                  00008500
008600*                                         '6716'                  00008600
008700*                                         '6717'                  00008700
008800*                                         '6718'                  00008800
008900*                                         '6719'                  00008900
009000*                                         '6730'                  00009000
009100*                                         '6731'                  00009100
009200*                                         '6732'                  00009200
009300*                                         '6733'                  00009300
009400*                                         '6734'                  00009400
009500*                                         '6735'                  00009500
009600*                                         '6736'                  00009600
009700*                                         '6737'                  00009700
009800*                                         '6738'                  00009800
009900*                                         '6740'                  00009900
010000*                                         '6741'                  00010000
010100*                                         '6742'                  00010100
010200*                                         '6743'                  00010200
010300*                                         '6744'                  00010300
010400*                                         '6745'                  00010400
010500*                                         '6746'                  00010500
010600*                                         '6751'                  00010600
010700*                                         '6752'                  00010700
010800*                                         '6753'                  00010800
010900*                                         '6754'                  00010900
011000*                                         '6755'                  00011000
011100*                                         '6756'                  00011100
011200*                                         '6757'                  00011200
011300*                                         '6758'.                 00011300
011400*---                                                              00011400
011500*01  W-TRIB-AGEV-V03                PIC X(004).                   00011500
011600*    88  W-TRIB-AGEV-V03-OK         VALUE '3887'                  00011600
011700*                                         '3888'                  00011700
011800*                                         '3889'                  00011800
011900*                                         '3890'.                 00011900
012000*** FINE MODIFICA TRIBUTI AGEVOLATI - GENNAIO 2004                00012000
012100*---                                                              00012100
012200*---   FLAG PER INDICARE CHE IL CAMPO E' STATO TROVATO            00012200
012300 77  W-FLAG-TROVATO                 PIC 9(001).                   00012300
012400*---   CAMPI GESTITI DALLA SEARCH:                                00012400
012500*---   TIPO TRIBUTO E TIPO PERIODO                                00012500
012600 77  W-TIPO-TRI-INP                 PIC X(001).                   00012600
012700 77  W-TIPO-TRIB-MIN                PIC X(001).                   00012700
012800 77  W-TIPO-TRIB-MAX                PIC X(001).                   00012800
012900 77  W-TIPO-TRIB-OUT                PIC X(001).                   00012900
013000*---                                                              00013000
013100 77  W-UFF-KO                       PIC X(002).                   00013100
013200 77  W-NUM-KO                       PIC X(002).                   00013200
013300*---                                                              00013300
013400 77  W-TIPO-PER-OUT                 PIC X(008).                   00013400
013500*---   CAMPI GESTITI DALLA SEARCH:                                00013500
013600*---   CODICE TRIBUTO, COD. PROV.REG.                             00013600
013700 77  W-COD-TRIB-OUT                 PIC X(004).                   00013700
013800 77  W-COD-PROV-REG-INP             PIC X(002).                   00013800
013900 77  W-COD-PROV-REG-OUT             PIC X(002).                   00013900
014000*---   CAMPO DI OUTPUT DELLA SEARCH:                              00014000
014100*---   TIPO UFFICIO                                               00014100
014200 77  W-KEY-UFF-OUT                  PIC X(011).                   00014200
014300*---   CODICI TRIBUTO PER PERSONA FISICA                          00014300
014400*---                                                              00014400
014500*---                                                              00014500
014600 01  W-TIPO-RECORD                  PIC X(003).                   00014600
014700*---   CAMPI PER DATA RISCOSSIONE                                 00014700
014800*---                                                              00014800
014900 01  W-DATA-RISC                    PIC X(008).                   00014900
015000 01  W-DATA-RISC1 REDEFINES W-DATA-RISC.                          00015000
015100     03  W-DATA-RISC-AA             PIC 9(004).                   00015100
015200     03  W-DATA-RISC-MM             PIC 9(002).                   00015200
015300     03  W-DATA-RISC-GG             PIC 9(002).                   00015300
015400 01  W-DATA-RISC2 REDEFINES W-DATA-RISC.                          00015400
015500     03  W-DATA-RIS2-AA             PIC 9(004).                   00015500
015600     03  W-DATA-RIS2-MM             PIC 9(002).                   00015600
015700     03  W-DATA-RIS2-GG             PIC 9(002).                   00015700
015800*---                                                              00015800
015900 01  W-DATA-GMA.                                                  00015900
016000     03  W-DATA-GMA-G               PIC 9(002).                   00016000
016100     03  W-DATA-GMA-M               PIC 9(002).                   00016100
016200     03  W-DATA-GMA-A               PIC 9(004).                   00016200
016300*---                                                              00016300
016400 01  W-DATA-AMG.                                                  00016400
016500     03  W-DATA-AMG-A               PIC 9(004).                   00016500
016600     03  W-DATA-AMG-M               PIC 9(002).                   00016600
016700     03  W-DATA-AMG-G               PIC 9(002).                   00016700
016800*---                                                              00016800
016900*---   CAMPI APPOGGIO PER CAMPI DEL FILE ESITO                    00016900
017000*---                                                              00017000
017100 01  W-COD-TRIB                     PIC X(004).                   00017100
017200 01  W-FLAG-TRIB                    PIC X(001).                   00017200
017300 01  W-PERIODO-RIF                  PIC X(008).                   00017300
017400 01  W-ESER-A-CAV                   PIC X(002).                   00017400
017500 01  W-IRAP-APPO-ANNO.                                            00017500
017600     03  W-IRAP-ANNO-I              PIC 9(002).                   00017600
017700     03  W-IRAP-ANNO-II             PIC 9(002).                   00017700
017800 01  W-PER-IRAP.                                                  00017800
017900     03  W-PER-IRAP-00              PIC 9(002).                   00017900
018000     03  W-PER-IRAP-NN              PIC 9(002).                   00018000
018100     03  W-PER-IRAP-AAAA.                                         00018100
018200         05  W-PER-IRAP-AA1         PIC 9(002).                   00018200
018300         05  W-PER-IRAP-AA2         PIC 9(002).                   00018300
018400 01  W-PERIODO-OK                   PIC X(002).                   00018400
018500 01  W-FLAG-PER                     PIC X(001).                   00018500
018600 01  W-IMP-PAGAM                    PIC 9(015).                   00018600
018700 01  W-IMP-PAGAM1 REDEFINES W-IMP-PAGAM.                          00018700
018800     03  W-IMP-PAGAM1-12            PIC X(012).                   00018800
018900     03  W-IMP-PAGAM1-03            PIC X(003).                   00018900
019000 01  W-IMP-PAGAM2 REDEFINES W-IMP-PAGAM.                          00019000
019100     03  W-IMP-PAGAM1-13            PIC X(013).                   00019100
019200     03  W-IMP-PAGAM1-02            PIC X(002).                   00019200
019300 01  W-IMP-RIMB                     PIC 9(015).                   00019300
019400 01  W-IMP-RIMB1 REDEFINES W-IMP-RIMB.                            00019400
019500     03  W-IMP-RIMB1-12             PIC X(012).                   00019500
019600     03  W-IMP-RIMB1-03             PIC X(003).                   00019600
019700 01  W-IMP-RIMB2 REDEFINES W-IMP-RIMB.                            00019700
019800     03  W-IMP-RIMB1-13             PIC X(013).                   00019800
019900     03  W-IMP-RIMB1-02             PIC X(002).                   00019900
020000*---                                                              00020000
020100*----------------------------------------------                   00020100
020200 01  W-UFFICIO-RIF                  PIC X(003).                   00020200
020300 01  W-NUMERO-RIF                   PIC X(011).                   00020300
020400 01  W-FLAG-ERR-UFFICIO             PIC X(001).                   00020400
020500 01  W-FLAG-ERR-NUMERO              PIC X(001).                   00020500
020600*----------------------------------------------                   00020600
020700*---   CAMPI APPOGGIO PER ERRORI DEL FILE ESITO                   00020700
020800*---                                                              00020800
020900 01  W-ERR.                                                       00020900
021000     03  W-ERR-COD-TRIB                 PIC 9(003).               00021000
021100     03  W-ERR-FLAG-TRIB                PIC 9(003).               00021100
021200     03  W-ERR-PERIODO                  PIC 9(003).               00021200
021300     03  W-ERR-FLAG-PER                 PIC 9(003).               00021300
021400     03  W-ERR-PAGAM                    PIC 9(003).               00021400
021500     03  W-ERR-RIMB                     PIC 9(003).               00021500
021600     03  W-ERR-UFFICIO-RIF              PIC 9(003).               00021600
021700     03  W-ERR-FLAG-ERR-UFFICIO         PIC 9(003).               00021700
021800     03  W-ERR-NUMERO-RIF               PIC 9(003).               00021800
021900     03  W-ERR-FLAG-ERR-NUMERO          PIC 9(003).               00021900
022000*---   CAMPI APPOGGIO PER SEGNALARE SE L'ERRORE E'                00022000
022100*---   BLOCCANTE O MENO:                                          00022100
022200*---   ...   IMPOSTATO A "E" NEL PRIMO CASO                       00022200
022300*---   ...   IMPOSTATO A "W" NEL SECONDO                          00022300
022400*---                                                              00022400
022500 01  W-SEGNAL.                                                    00022500
022600     03  W-SEGNAL-COD-TRIB              PIC X(001).               00022600
022700     03  W-SEGNAL-FLAG-TRIB             PIC X(001).               00022700
022800     03  W-SEGNAL-PERIODO               PIC X(001).               00022800
022900     03  W-SEGNAL-FLAG-PER              PIC X(001).               00022900
023000     03  W-SEGNAL-PAGAM                 PIC X(001).               00023000
023100     03  W-SEGNAL-RIMB                  PIC X(001).               00023100
023200     03  W-SEGNAL-UFF-RIF               PIC X(001).               00023200
023300     03  W-SEGNAL-NUM-RIF               PIC X(001).               00023300
023400     03  W-SEGNAL-FLAG-ERR-UFF          PIC X(001).               00023400
023500     03  W-SEGNAL-FLAG-ERR-NUM          PIC X(001).               00023500
023600*---                                                              00023600
023700*A MODIFICA 3/02/2006 - FORMALISMO T3                             00023700
023800*---                                                              00023800
023900*---    APPOGGIO PER CODICE PERIODO RIFERIMENTO  ---              00023900
024000*---                                                              00024000
024100 01  W-APPO-FORMAL.                                               00024100
024200     03  W-APPO-FORMAL-00              PIC X(2).                  00024200
024300     03  W-APPO-FORMAL-TR.                                        00024300
024400         05  W-APPO-FORMAL-T           PIC X.                     00024400
024500         05  W-APPO-FORMAL-R           PIC 9.                     00024500
024600     03  W-APPO-FORMAL-ANNO            PIC X(4).                  00024600
024700*---                                                              00024700
024800*---------     APPOGGIO PER INPUT PERIODO RIFERIMENTO ---         00024800
024900*---                                                              00024900
025000 01  W-APPO-PER-RIF.                                              00025000
025100     03  W-APPO-PER-RIF-XXXX.                                     00025100
025200         05  W-APPO-PER-RIF-RA              PIC XX.               00025200
025300         05  W-APPO-PER-RIF-NU              PIC XX.               00025300
025400     03  W-APPO-PER-RIF-ANNO.                                     00025400
025500         05  W-APPO-PER-RIF-SS          PIC XX.                   00025500
025600         05  W-APPO-PER-RIF-AA          PIC XX.                   00025600
025700*---                                                              00025700
025800*---------     APPOGGIO PER DATA SISTEMA              ---         00025800
025900*---                                                              00025900
026000 01  W-DATA-SYS.                                                  00026000
026100     05  W-DATA-SYS-AA                  PIC 99.                   00026100
026200     05  W-DATA-SYS-MM                  PIC 99.                   00026200
026300     05  W-DATA-SYS-GG                  PIC 99.                   00026300
026400*---                                                              00026400
026500 01  W-ANNO-APPO-R.                                               00026500
026600     05  W-ANNO-APPO-R-SS               PIC 99 VALUE 20.          00026600
026700     05  W-ANNO-APPO-R-AA               PIC 99.                   00026700
026800 01  W-ANNO-APPO   REDEFINES                                      00026800
026900                       W-ANNO-APPO-R    PIC 9(04).                00026900
027000*---                                                              00027000
027100*---------     APPOGGIO PER DATA       -------------              00027100
027200*---                                                              00027200
027300 01  W-ANNO-DIFF                       PIC S9(004).               00027300
027400 01  W-ANNO.                                                      00027400
027500     03  W-ANNO1                       PIC 9(004).                00027500
027600     03  W-ANNO2                       PIC 9(004).                00027600
027700*01  W-ANNO-MILL.                                                 00027700
027800*    03  W-ANNO-MILL1                  PIC 9(001).                00027800
027900*    03  W-ANNO-MILL7                  PIC 9(007).                00027900
028000 01  W-ANNO2-MILL.                                                00028000
028100     03  W-ANNO2-MILL1                 PIC 9(001).                00028100
028200     03  W-ANNO2-MILL3                 PIC 9(003).                00028200
028300*---                                                              00028300
028400 01  W-DATA-PASS                       PIC 9(6).                  00028400
028500*---                                                              00028500
028600 01  W-DATA-APPO .                                                00028600
028700     03  W-DATA-APP-GG                 PIC 99.                    00028700
028800     03  W-DATA-APP-MM                 PIC 99.                    00028800
028900     03  W-DATA-APP-ANNO.                                         00028900
029000         05  W-DATA-APP-SS             PIC 99.                    00029000
029100         05  W-DATA-APP-AA             PIC 99.                    00029100
029200     03  W-APP-ANNO REDEFINES W-DATA-APP-ANNO PIC 9(004).         00029200
029300*---                                                              00029300
029400 01  W-DATA-INPUT.                                                00029400
029500     03  W-DATA-INP-SS                 PIC 99.                    00029500
029600     03  W-DATA-INP.                                              00029600
029700         05  W-DATA-INP-AA             PIC 99.                    00029700
029800         05  W-DATA-INP-MM             PIC 99.                    00029800
029900         05  W-DATA-INP-GG             PIC 99.                    00029900
030000*---                                                              00030000
030100 01  W-DATA-OUTPUT.                                               00030100
030200     03  W-DATA-OUT-SS                 PIC 99.                    00030200
030300     03  W-DATA-OUT.                                              00030300
030400         05  W-DATA-OUT-AA             PIC 99.                    00030400
030500         05  W-DATA-OUT-MM             PIC 99.                    00030500
030600         05  W-DATA-OUT-GG             PIC 99.                    00030600
030700*                                                                 00030700
030800 01  W-DATA-RISC-AA-PIU1               PIC 9(004).                00030800
030900*                                                                 00030900
031000*---                                                              00031000
031100*----      CAMPI DI PASSAGGIO PER LA ROUTINE BQVFB3               00031100
031200 01  W-PARAM-BQVFB3.                                              00031200
031300     03  W-BQVFB3-COD-FISC             PIC X(16).                 00031300
031400     03  W-BQVFB3-COD-RIT              PIC X.                     00031400
031500*---                                                              00031500
031600*----      ROUTINE PER IL CALCOLO DATE                            00031600
031700*                                                                 00031700
031800     COPY 'FBQVFDA1'.                                             00031800
031900*---               TRACCIATO RECORD "ESITI" - BANCA               00031900
032000     COPY 'FBQVFB21'.                                             00032000
032100*---               TRACCIATO RECORD "ESITI" - CONCESSIONARIO      00032100
032200*    COPY 'FBQVFD21'.                                             00032200
032300*---        TABELLA PER TOTALIZZARE                               00032300
032400 01  W-TAB.                                                       00032400
032500     03  W-TAB-EL OCCURS 7.                                       00032500
032600         05  W-TAB-EL-PAG          PIC 9(015).                    00032600
032700         05  W-TAB-EL-RIM          PIC 9(015).                    00032700
032800*---                                                              00032800
032900*---   CAMPI DI APPOGGIO PER CAMPI OBBLIGATORI (G1-010)           00032900
033000*---                                                              00033000
033100 01  W-FLAG-OBBL-UFF               PIC X(001).                    00033100
033200 01  W-FLAG-OBBL-NUM               PIC X(001).                    00033200
033300*---                                                              00033300
033400 01  W-COD-NUM-RIF                 PIC X(001).                    00033400
033500*---                                                              00033500
033600 01  W-NUM-RIF-KO                  PIC X(01).                     00033600
033700*---                                                              00033700
033800 01  W-ANNO-RIF-1                  PIC 9(004).                    00033800
033900 01  W-ANNO-RIF-2                  PIC 9(004).                    00033900
034000*---                                                              00034000
034100 01  W-APPO-RIF-COMP.                                             00034100
034200     03  W-APPO-RIF-COMP-FILL          PIC X(004).                00034200
034300     03  W-APPO-RIF-COMP-ANNO          PIC X(004).                00034300
034400*---                                                              00034400
034500 01  W-ANNO-RIFERIMENTO                PIC 9(004).                00034500
034600*                      LINKAGE SECTION                            00034600
034700 LINKAGE SECTION.                                                 00034700
034800*                                                                 00034800
034900*---             AREA DI PASSAGGIO                                00034900
035000*                                                                 00035000
035100*---   FLAG INDICANTE LA PROVENIENZA:                             00035100
035200*---   .. "B" BANCA                                               00035200
035300*---   .. "C" CONCESSIONARIO                                      00035300
035400 01  W-PROV                        PIC X(001).                    00035400
035500*---   FLAG AGEVOLAZIONI IMPOSTATO DA BQVFB1                      00035500
035600 01  W-FLAG-AGEV                   PIC X(001).                    00035600
035700*---   SEZIONE RELATIVA AI DATI DEL FILE ESITO                    00035700
035800 01  W-DATI                        PIC X(512).                    00035800
035900*---   TABELLA RELATIVA AGLI IMPORTI                              00035900
036000 01  W-TABELLA                     PIC X(210).                    00036000
036100*---   FLAG REGIONE (SE E' ZERO, LA REGIONE E' ERRATA)            00036100
036200 01  W-REG                         PIC 9(001).                    00036200
036300*---   TIPO PERSONA DICHIARANTE (FISICA/NON FISICA)               00036300
036400 01  W-PERS                        PIC X(003).                    00036400
036500*---   DIVISA                                                     00036500
036600 01  W-DIVISA                      PIC X(003).                    00036600
036700*---   CONTATORE ERRORI NON BLOCCANTI                             00036700
036800 01  W-CTR1                        PIC 9(009).                    00036800
036900*---   CONTATORE ERRORI BLOCCANTI                                 00036900
037000 01  W-CTR2                        PIC 9(009).                    00037000
037100*---                                                              00037100
037200**TABELLA CONTENETE I CODICI TRIBUTI PRELEVATI DAL FILE BQVFTR    00037200
037300*---                                                              00037300
037400 01  W-TAB-TRIBUTI.                                               00037400
037500     03 W-TAB-TRIB-NUM-MAX     PIC 9(004)   VALUE 6900.           00037500
037600     03 W-TAB-TRIB-OCC.                                           00037600
037700        05 W-TAB-TRIB-EL OCCURS 6900 TIMES                        00037700
037800                              ASCENDING W-TAB-TRIB-KEY            00037800
037900                              INDEXED BY W-PUNT-TRIB.             00037900
038000           07 W-TAB-TRIB-KEY.                                     00038000
038100              09 W-TAB-TRIB-TIPO-TR  PIC X(001).                  00038100
038200              09 W-TAB-TRIB-COD      PIC X(004).                  00038200
038300              09 W-TAB-TRIB-INI-VAL  PIC X(008).                  00038300
038400           07 W-TAB-TRIB-FIN-VAL  PIC X(008).                     00038400
038500           07 W-TAB-TRIB-TIPO-PE  PIC X(008).                     00038500
038600           07 W-TAB-TRIB-FLAG-COMPEN  PIC X.                      00038600
038700           07 W-TAB-TRIB-FLAG-AGEV    PIC X.                      00038700
038800           07 W-TAB-TRIB-FLAG-CONC    PIC X.                      00038800
038900           07 W-TAB-TRIB-ELEM-IDENT   PIC X.                      00038900
039000           07 W-TAB-TRIB-COD-ATTO     PIC X(002).                 00039000
039100           07 W-TAB-TRIB-COD-UFF      PIC X(002).                 00039100
039200           07 W-TAB-TRIB-ANNO-RIF     PIC 9(002).                 00039200
039300           07 W-TAB-TRIB-IDENT-OPER   PIC X(002).                 00039300
039400           07 W-TAB-TRIB-TAB-ENTE-COMUNE-1  PIC X(002).           00039400
039500           07 W-TAB-TRIB-TAB-ENTE-COMUNE-2  PIC X(002).           00039500
039600           07 W-TAB-TRIB-TAB-ENTE-COMUNE-3  PIC X(002).           00039600
039700*---                                                              00039700
039800**TABELLA CONTENETE I CODICI REGIONI PRELEVATI DAL FILE BQVFRE    00039800
039900*---                                                              00039900
040000 01  W-TAB-REGIONI.                                               00040000
040100     03 W-TAB-REGIONI-NUM-MAX        PIC 9(002).                  00040100
040200     03 W-TAB-REGIONI-OCC.                                        00040200
040300        05 W-TAB-REGIONI-EL OCCURS    50 TIMES                    00040300
040400                                    ASCENDING W-TAB-REGIONI-COD   00040400
040500                                    INDEXED BY W-PUNT-REGIONI.    00040500
040600           07 W-TAB-REGIONI-COD      PIC X(002).                  00040600
040700*---                                                              00040700
040800**TABELLA CONTENENTE CODICI ENTI LOCALI PRELEVATI DAL FILE BQVFEL 00040800
040900*---                                                              00040900
041000*                                                                 00041000
041100 01  W-TAB-ENTE.                                                  00041100
041200     03 W-TAB-ENTE-NUM-MAX        PIC 9(004) VALUE 100.           00041200
041300     03 W-TAB-ENTE-OCC.                                           00041300
041400        05 W-TAB-ENTE-EL OCCURS    100 TIMES                      00041400
041500                                    ASCENDING W-TAB-ENTE-KEY      00041500
041600                                    INDEXED BY W-PUNT-ENTE.       00041600
041700           07 W-TAB-ENTE-KEY.                                     00041700
041800              09 W-TAB-ENTE-COD      PIC X(004).                  00041800
041900              09 W-TAB-ENTE-INIZ     PIC X(008).                  00041900
042000           07 W-TAB-ENTE-FINE        PIC X(008).                  00042000
042100*---                                                              00042100
042200**TABELLA CONTENENTE I CODICI PROVINCE PRELEVATI DAL FILE BQVFPR  00042200
042300*---                                                              00042300
042400 01  W-TAB-PROV.                                                  00042400
042500     03 W-TAB-PROV-NUM-MAX        PIC 9(003) VALUE 150.           00042500
042600     03 W-TAB-PROV-OCC.                                           00042600
042700        05 W-TAB-PROV-EL OCCURS   150 TIMES                       00042700
042800                                    ASCENDING W-TAB-PROV-COD      00042800
042900                                    INDEXED BY W-PUNT-PROV.       00042900
043000           07 W-TAB-PROV-COD      PIC X(002).                     00043000
043100*---                                                              00043100
043200**TABELLA CONTENETE I CODICI UFFICIO PRELEVATI DAL FILE BQVFTR    00043200
043300*---                                                              00043300
043400 01  W-TAB-UFFICIO.                                               00043400
043500     03 W-TAB-UFF-NUM-MAX           PIC 9(004) VALUE 3000.        00043500
043600     03 W-TAB-UFF-OCC.                                            00043600
043700        05 W-TAB-UFF-EL OCCURS  3000 TIMES                        00043700
043800                              ASCENDING W-TAB-UFF-KEY             00043800
043900                              INDEXED BY W-PUNT-UFF.              00043900
044000           07 W-TAB-UFF-KEY.                                      00044000
044100              09 W-TAB-UFF-COD       PIC X(003).                  00044100
044200              09 W-TAB-UFF-INI-VAL   PIC X(008).                  00044200
044300           07 W-TAB-UFF-SETTORE      PIC X(001).                  00044300
044400           07 W-TAB-UFF-DENOM        PIC X(039).                  00044400
044500           07 W-TAB-UFF-FINE-VAL     PIC X(008).                  00044500
044600*                                                                 00044600
044700 01  W-COMP-FISCO                 PIC 9(018).                     00044700
044800*                                                                 00044800
044900 01  W-COMP-REG                   PIC 9(018).                     00044900
045000*                                                                 00045000
045100 01  W-UFF-RIF                    PIC X(003).                     00045100
045200*                                                                 00045200
045300 01  W-NUM-RIF                    PIC X(011).                     00045300
045400*                                                                 00045400
045500 01  W-COD-FISC-KO                PIC X(001).                     00045500
045600*                                                                 00045600
045700 01  W-VERS                       PIC X(003).                     00045700
045800*                                                                 00045800
045900 01  W-TAB-COD-T3.                                                00045900
046000     03 W-TAB-COD-T3-NUM-MAX          PIC 9(004) VALUE 1000.      00046000
046100     03 W-TAB-COD-T3-OCC.                                         00046100
046200        05 W-TAB-COD-T3-EL OCCURS  1000 TIMES                     00046200
046300                                    ASCENDING W-TAB-T3-KEY        00046300
046400                                    INDEXED BY W-PUNT-T3.         00046400
046500           07 W-TAB-T3-KEY.                                       00046500
046600              09 W-TAB-T3-COD-FORMAL  PIC X(002).                 00046600
046700              09 W-TAB-T3-CODICE      PIC X(004).                 00046700
046800              09 W-TAB-T3-INIZIO-VAL  PIC X(008).                 00046800
046900           07 W-TAB-T3-FINE-VAL       PIC X(008).                 00046900
047000*                                                                 00047000
047100*---                                                              00047100
047200 01  W-TAB-COMP-TRIB.                                             00047200
047300     03 W-TAB-COMP-TRIB-NUM-MAX   PIC 9(004) VALUE 1000.          00047300
047400     03 W-TAB-COMP-TRIB-OCC.                                      00047400
047500        05 W-TAB-COMP-TRIB-EL OCCURS   1000 TIMES                 00047500
047600                                    ASCENDING W-TAB-COMP-TRIB-KEY 00047600
047700                                    INDEXED BY W-PUNT-COTR.       00047700
047800           07 W-TAB-COMP-TRIB-KEY.                                00047800
047900               09 W-TAB-COMP-TRIB-COD-COMP    PIC X(003).         00047900
048000               09 W-TAB-COMP-TRIB-COD-TRIB    PIC X(004).         00048000
048100               09 W-TAB-COMP-TRIB-ESP-TRIB    PIC X(001).         00048100
048200               09 W-TAB-COMP-TRIB-INIZIO-VAL  PIC X(008).         00048200
048300           07 W-TAB-COMP-TRIB-FINE-VAL        PIC X(008).         00048300
048400           07 W-TAB-COMP-TRIB-ANNO-RIF        PIC X(004).         00048400
048500           07 W-TAB-COMP-TRIB-INIZ-INTER      PIC 9(002).         00048500
048600           07 W-TAB-COMP-TRIB-FINE-INTER      PIC 9(002).         00048600
048700*                                                                 00048700
048800*---   CONTROLLO COMPENSAZIONI                                    00048800
048900*                                                                 00048900
049000 01  W-FLAG-RIF-V-T                PIC X(001).                    00049000
049100 01  W-FLAG-RIF-V-A                PIC X(001).                    00049100
049200 01  W-TOT-IMP-CRED-CONTR-V        PIC S9(015).                   00049200
049300*                                                                 00049300
049400 01  W-FLAG-RIF-R-T                PIC X(001).                    00049400
049500 01  W-FLAG-RIF-R-A                PIC X(001).                    00049500
049600 01  W-TOT-IMP-CRED-CONTR-R        PIC S9(015).                   00049600
049700*                                                                 00049700
049800 01  W-FLAG-RIF-I-T                PIC X(001).                    00049800
049900 01  W-FLAG-RIF-I-A                PIC X(001).                    00049900
050000 01  W-TOT-IMP-CRED-CONTR-I        PIC S9(015).                   00050000
050100*                                                                 00050100
050200 01  W-FLAG-RIF-M-T                PIC X(001).                    00050200
050300 01  W-FLAG-RIF-M-A                PIC X(001).                    00050300
050400 01  W-TOT-IMP-CRED-CONTR-M        PIC S9(015).                   00050400
050500*                                                                 00050500
050600 01  W-FLAG-RIF-IRF-T              PIC X(001).                    00050600
050700 01  W-FLAG-RIF-IRF-A              PIC X(001).                    00050700
050800 01  W-TOT-IMP-CRED-CONTR-IRF      PIC S9(015).                   00050800
050900*                                                                 00050900
051000 01  W-FLAG-RIF-ADX-T              PIC X(001).                    00051000
051100 01  W-FLAG-RIF-ADX-A              PIC X(001).                    00051100
051200 01  W-TOT-IMP-CRED-CONTR-ADX      PIC S9(015).                   00051200
051300*                                                                 00051300
051400 01  W-FLAG-RIF-IIE-T              PIC X(001).                    00051400
051500 01  W-FLAG-RIF-IIE-A              PIC X(001).                    00051500
051600 01  W-TOT-IMP-CRED-CONTR-IIE      PIC S9(015).                   00051600
051700*                                                                 00051700
051800 01  W-FLAG-RIF-IFE-T              PIC X(001).                    00051800
051900 01  W-FLAG-RIF-IFE-A              PIC X(001).                    00051900
052000 01  W-TOT-IMP-CRED-CONTR-IFE      PIC S9(015).                   00052000
052100*                                                                 00052100
052200 01  W-FLAG-RIF-FF1-T              PIC X(001).                    00052200
052300 01  W-FLAG-RIF-FF1-A              PIC X(001).                    00052300
052400 01  W-TOT-IMP-CRED-CONTR-FF1      PIC S9(015).                   00052400
052500*                                                                 00052500
052600 01  W-FLAG-RIF-FF2-T              PIC X(001).                    00052600
052700 01  W-FLAG-RIF-FF2-A              PIC X(001).                    00052700
052800 01  W-TOT-IMP-CRED-CONTR-FF2      PIC S9(015).                   00052800
052900*                                                                 00052900
053000 01  W-FLAG-RIF-FF3-T              PIC X(001).                    00053000
053100 01  W-FLAG-RIF-FF3-A              PIC X(001).                    00053100
053200 01  W-TOT-IMP-CRED-CONTR-FF3      PIC S9(015).                   00053200
053300*                                                                 00053300
053400 01  W-FLAG-RIF-ORO-T              PIC X(001).                    00053400
053500 01  W-FLAG-RIF-ORO-A              PIC X(001).                    00053500
053600 01  W-TOT-IMP-CRED-CONTR-ORO      PIC S9(015).                   00053600
053700*                                                                 00053700
053800 01  W-FLAG-RIF-SEC-T              PIC X(001).                    00053800
053900 01  W-FLAG-RIF-SEC-A              PIC X(001).                    00053900
054000 01  W-TOT-IMP-CRED-CONTR-SEC      PIC S9(015).                   00054000
054100*                                                                 00054100
054200 01  W-FLAG-RIF-IEC-T              PIC X(001).                    00054200
054300 01  W-FLAG-RIF-IEC-A              PIC X(001).                    00054300
054400 01  W-TOT-IMP-CRED-CONTR-IEC      PIC S9(015).                   00054400
054500*                                                                 00054500
054600 01  W-FLAG-RIF-LEZ-T              PIC X(001).                    00054600
054700 01  W-FLAG-RIF-LEZ-A              PIC X(001).                    00054700
054800 01  W-TOT-IMP-CRED-CONTR-LEZ      PIC S9(015).                   00054800
054900*                                                                 00054900
055000 01  W-FLAG-RIF-QR1-T              PIC X(001).                    00055000
055100 01  W-FLAG-RIF-QR1-A              PIC X(001).                    00055100
055200 01  W-TOT-IMP-CRED-CONTR-QR1      PIC S9(015).                   00055200
055300*                                                                 00055300
055310 01  W-FLAG-RIF-BTC-T              PIC X(001).                    00055310
055320 01  W-FLAG-RIF-BTC-A              PIC X(001).                    00055320
055330 01  W-TOT-IMP-CRED-CONTR-BTC      PIC S9(015).                   00055330
055340*                                                                 00055340
055400 01  W-FLAG-RIF-C                  PIC X(001).                    00055400
055500 01  W-FLAG-RIF-T-AA-MIN           PIC X(001).                    00055500
055600 01  W-FLAG-RIF-A-AA-MIN           PIC X(001).                    00055600
055700*---                                                              00055700
055800 01  W-FLAG-TRIB-CONC              PIC X(001).                    00055800
055900 01  W-FLAG-CRED                   PIC X(001).                    00055900
056000 01  W-FLAG-COMP-IVA               PIC X(001).                    00056000
056100 01  W-FLAG-COMP-IRP               PIC X(001).                    00056100
056200 01  W-FLAG-COMP-IRS               PIC X(001).                    00056200
056300 01  W-FLAG-COMP-IRM               PIC X(001).                    00056300
056400 01  W-FLAG-COMP-IRF               PIC X(001).                    00056400
056500 01  W-FLAG-COMP-ADX               PIC X(001).                    00056500
056600 01  W-FLAG-COMP-IIE               PIC X(001).                    00056600
056700 01  W-FLAG-COMP-IFE               PIC X(001).                    00056700
056800 01  W-FLAG-COMP-FF1               PIC X(001).                    00056800
056900 01  W-FLAG-COMP-FF2               PIC X(001).                    00056900
057000 01  W-FLAG-COMP-FF3               PIC X(001).                    00057000
057100 01  W-FLAG-COMP-ORO               PIC X(001).                    00057100
057200 01  W-FLAG-COMP-SEC               PIC X(001).                    00057200
057300 01  W-FLAG-COMP-IEC               PIC X(001).                    00057300
057400 01  W-FLAG-COMP-LEZ               PIC X(001).                    00057400
057500 01  W-FLAG-COMP-QR1               PIC X(001).                    00057500
057600 01  W-FLAG-COMP-BTC               PIC X(001).                    00057600
057700*---                                                              00057700
057800**TABELLA                                                         00057800
057900*CONTENENTE COPPIE CODICE CATASTALE - TRIBUTO                     00057900
058000**PRELEVATI DAL FILE BQVFTC                                       00058000
058100*                                                                 00058100
058200 01  W-TAB-CAT-TRIB.                                              00058200
058300     03 W-TAB-CAT-TRIB-NUM-MAX        PIC 9(005) VALUE 25000.     00058300
058400     03 W-TAB-CAT-TRIB-OCC.                                       00058400
058500        05 W-TAB-CAT-TRIB-EL OCCURS  25000 TIMES                  00058500
058600                          ASCENDING W-TAB-CAT-TRIB-KEY            00058600
058700                          INDEXED BY W-PUNT-CAT-TRIB.             00058700
058800           07 W-TAB-CAT-TRIB-KEY.                                 00058800
058900              09 W-TAB-CAT-TRIB-ENTE     PIC X(004).              00058900
059000              09 W-TAB-CAT-TRIB-TRIBUTO  PIC X(004).              00059000
059100              09 W-TAB-CAT-TRIB-INIZ     PIC X(008).              00059100
059200           07 W-TAB-CAT-TRIB-FINE        PIC X(008).              00059200
059300           07 W-TAB-CAT-TIPO-IMP         PIC X(010).              00059300
059400*---                                                              00059400
059500*                                                                 00059500
059600********************** PROCEDURE DIVISION ************************00059600
059700*                                                                 00059700
059800 PROCEDURE DIVISION   USING W-PROV W-FLAG-AGEV W-DATI W-TABELLA   00059800
059900               W-REG W-PERS W-DIVISA W-CTR1 W-CTR2 W-TAB-TRIBUTI  00059900
060000               W-TAB-UFFICIO                                      00060000
060100               W-TAB-REGIONI                                      00060100
060200               W-TAB-ENTE                                         00060200
060300               W-TAB-PROV                                         00060300
060400               W-COMP-FISCO                                       00060400
060500               W-COMP-REG                                         00060500
060600               W-UFF-RIF W-NUM-RIF W-COD-FISC-KO                  00060600
060700               W-VERS                                             00060700
060800               W-TAB-COD-T3                                       00060800
060900               W-FLAG-RIF-V-T                                     00060900
061000               W-FLAG-RIF-V-A                                     00061000
061100               W-TOT-IMP-CRED-CONTR-V                             00061100
061200               W-TAB-CAT-TRIB                                     00061200
061300               W-FLAG-RIF-C                                       00061300
061400               W-FLAG-RIF-T-AA-MIN                                00061400
061500               W-FLAG-RIF-A-AA-MIN                                00061500
061600               W-FLAG-TRIB-CONC                                   00061600
061700               W-FLAG-CRED                                        00061700
061800               W-TAB-COMP-TRIB                                    00061800
061900               W-FLAG-COMP-IVA                                    00061900
062000               W-FLAG-RIF-I-T                                     00062000
062100               W-FLAG-RIF-I-A                                     00062100
062200               W-TOT-IMP-CRED-CONTR-I                             00062200
062300               W-FLAG-COMP-IRS                                    00062300
062400               W-FLAG-RIF-R-T                                     00062400
062500               W-FLAG-RIF-R-A                                     00062500
062600               W-TOT-IMP-CRED-CONTR-R                             00062600
062700               W-FLAG-COMP-IRP                                    00062700
062800               W-FLAG-RIF-M-T                                     00062800
062900               W-FLAG-RIF-M-A                                     00062900
063000               W-TOT-IMP-CRED-CONTR-M                             00063000
063100               W-FLAG-COMP-IRM                                    00063100
063200               W-FLAG-RIF-IRF-T                                   00063200
063300               W-FLAG-RIF-IRF-A                                   00063300
063400               W-TOT-IMP-CRED-CONTR-IRF                           00063400
063500               W-FLAG-COMP-IRF                                    00063500
063600               W-FLAG-RIF-ADX-T                                   00063600
063700               W-FLAG-RIF-ADX-A                                   00063700
063800               W-TOT-IMP-CRED-CONTR-ADX                           00063800
063900               W-FLAG-COMP-ADX                                    00063900
064000               W-FLAG-RIF-IIE-T                                   00064000
064100               W-FLAG-RIF-IIE-A                                   00064100
064200               W-TOT-IMP-CRED-CONTR-IIE                           00064200
064300               W-FLAG-COMP-IIE                                    00064300
064400               W-FLAG-RIF-IFE-T                                   00064400
064500               W-FLAG-RIF-IFE-A                                   00064500
064600               W-TOT-IMP-CRED-CONTR-IFE                           00064600
064700               W-FLAG-COMP-IFE                                    00064700
064800               W-FLAG-RIF-FF1-T                                   00064800
064900               W-FLAG-RIF-FF1-A                                   00064900
065000               W-TOT-IMP-CRED-CONTR-FF1                           00065000
065100               W-FLAG-COMP-FF1                                    00065100
065200               W-FLAG-RIF-FF2-T                                   00065200
065300               W-FLAG-RIF-FF2-A                                   00065300
065400               W-TOT-IMP-CRED-CONTR-FF2                           00065400
065500               W-FLAG-COMP-FF2                                    00065500
065600               W-FLAG-RIF-FF3-T                                   00065600
065700               W-FLAG-RIF-FF3-A                                   00065700
065800               W-TOT-IMP-CRED-CONTR-FF3                           00065800
065900               W-FLAG-COMP-FF3                                    00065900
066000               W-FLAG-RIF-ORO-T                                   00066000
066100               W-FLAG-RIF-ORO-A                                   00066100
066200               W-TOT-IMP-CRED-CONTR-ORO                           00066200
066300               W-FLAG-COMP-ORO                                    00066300
066400               W-FLAG-RIF-SEC-T                                   00066400
066500               W-FLAG-RIF-SEC-A                                   00066500
066600               W-TOT-IMP-CRED-CONTR-SEC                           00066600
066700               W-FLAG-COMP-SEC                                    00066700
066800               W-FLAG-RIF-IEC-T                                   00066800
066900               W-FLAG-RIF-IEC-A                                   00066900
067000               W-TOT-IMP-CRED-CONTR-IEC                           00067000
067100               W-FLAG-COMP-IEC                                    00067100
067200               W-FLAG-RIF-LEZ-T                                   00067200
067300               W-FLAG-RIF-LEZ-A                                   00067300
067400               W-TOT-IMP-CRED-CONTR-LEZ                           00067400
067500               W-FLAG-COMP-LEZ                                    00067500
067600               W-FLAG-RIF-QR1-T                                   00067600
067700               W-FLAG-RIF-QR1-A                                   00067700
067800               W-TOT-IMP-CRED-CONTR-QR1                           00067800
067900               W-FLAG-COMP-QR1                                    00067900
067910               W-FLAG-RIF-BTC-T                                   00067910
067920               W-FLAG-RIF-BTC-A                                   00067920
067930               W-TOT-IMP-CRED-CONTR-BTC                           00067930
068000               W-FLAG-COMP-BTC.                                   00068000
068100 ML-010-INIZIO.                                                   00068100
068200*---   INIZIALIZZAZIONE DELLE AREE DI LAVORO                      00068200
068300*---                                                              00068300
068400     MOVE ZERO                      TO W-ANNO-DIFF.               00068400
068500     MOVE ZERO                      TO W-ERR.                     00068500
068600     MOVE ZERO                      TO W-SEGNAL.                  00068600
068700     MOVE ZERO                      TO W-NUM-RIF-KO.              00068700
068800     MOVE 'NO'                      TO W-TROVATO.                 00068800
068900     MOVE 'NO'                      TO W-ESER-A-CAV.              00068900
069000     MOVE SPACE                     TO W-INDICA.                  00069000
069100     MOVE W-TABELLA                 TO W-TAB.                     00069100
069200*---   IMPOSTAZIONE AREA DI PASSAGGIO RELATIVA AI DATI E          00069200
069300*---   ALLA TABELLA DI TOTALIZZAZIONE IN BASE AL FLAG DI          00069300
069400*---   PROVENIENZA                                                00069400
069500*---                                                              00069500
069600*    IF W-PROV EQUAL 'C'                                          00069600
069700*      GO TO ML-050.                                              00069700
069800 ML-020.                                                          00069800
069900     MOVE W-DATI                    TO BQVFB21.                   00069900
070000     MOVE BQVFB21-TIPO-RECORD       TO W-TIPO-RECORD.             00070000
070100*---   SI CONTROLLA IL TIPO RECORD                                00070100
070200*---                                                              00070200
070300     IF W-TIPO-RECORD EQUAL 'V01'                                 00070300
070400       GO TO ML-040.                                              00070400
070500 ML-030.                                                          00070500
070600*---   TIPO RECORD V03: IMPOSTAZIONE CAMPI IN AREE DI APPOGGIO    00070600
070700*---                                                              00070700
070800     MOVE BQVFB21-03-DATA-RISC        TO W-DATA-RISC.             00070800
070900     MOVE BQVFB21-03-COD-TRIB         TO W-COD-TRIB.              00070900
071000     MOVE BQVFB21-03-FLAG-ERR-TRIB    TO W-FLAG-TRIB.             00071000
071100     MOVE BQVFB21-03-PERIODO-RIF      TO W-PERIODO-RIF.           00071100
071200     MOVE BQVFB21-03-FLAG-ERR-PERIODO TO W-FLAG-PER.              00071200
071300     MOVE BQVFB21-03-IMP-PAGAMA       TO W-IMP-PAGAM1.            00071300
071400     MOVE BQVFB21-03-IMP-RIMBA        TO W-IMP-RIMB1.             00071400
071500     GO TO ML-080.                                                00071500
071600 ML-040.                                                          00071600
071700*---   TIPO RECORD V01: IMPOSTAZIONE CAMPI IN AREE DI APPOGGIO    00071700
071800*---                                                              00071800
071900     MOVE BQVFB21-01-DATA-RISC        TO W-DATA-RISC.             00071900
072000     MOVE BQVFB21-01-COD-TRIB         TO W-COD-TRIB.              00072000
072100     MOVE BQVFB21-01-FLAG-ERR-TRIB    TO W-FLAG-TRIB.             00072100
072200     MOVE BQVFB21-01-PERIODO-RIF      TO W-PERIODO-RIF.           00072200
072300     MOVE BQVFB21-01-FLAG-ERR-PERIODO TO W-FLAG-PER.              00072300
072400     MOVE BQVFB21-01-IMP-PAGAMA       TO W-IMP-PAGAM1.            00072400
072500     MOVE BQVFB21-01-IMP-RIMBA        TO W-IMP-RIMB1.             00072500
072600     MOVE BQVFB21-01-UFF-RIFER        TO W-UFFICIO-RIF.           00072600
072700     MOVE BQVFB21-01-FLAG-ERR-UFF     TO W-FLAG-ERR-UFFICIO.      00072700
072800     MOVE BQVFB21-01-NUM-RIFER        TO W-NUMERO-RIF.            00072800
072900     MOVE BQVFB21-01-FLAG-ERR-NUMRIF  TO W-FLAG-ERR-NUMERO.       00072900
073000     GO TO ML-080.                                                00073000
073100*ML-050.                                                          00073100
073200*    MOVE W-DATI                    TO BQVFD21.                   00073200
073300*    MOVE BQVFD21-TIPO-RECORDA      TO W-TIPO-RECORD.             00073300
073400*---   SI CONTROLLA IL TIPO RECORD                                00073400
073500*---                                                              00073500
073600*    IF W-TIPO-RECORD EQUAL '01 '                                 00073600
073700*      GO TO ML-070.                                              00073700
073800*ML-060.                                                          00073800
073900*---   TIPO RECORD V03: IMPOSTAZIONE CAMPI IN AREE DI APPOGGIO    00073900
074000*---                                                              00074000
074100*    MOVE 'V03'                       TO W-TIPO-RECORD.           00074100
074200*    MOVE BQVFD21-03-DATA-RISC        TO W-DATA-RISC.             00074200
074300*    MOVE BQVFD21-03-COD-TRIB         TO W-COD-TRIB.              00074300
074400*    MOVE BQVFD21-03-FLAG-ERR-TRIB    TO W-FLAG-TRIB.             00074400
074500*    MOVE BQVFD21-03-PERIODO-RIFA     TO W-PERIODO-RIF.           00074500
074600*    MOVE BQVFD21-03-FLAG-ERR-PERIODO TO W-FLAG-PER.              00074600
074700*    MOVE BQVFD21-03-IMP-PAGAMA       TO W-IMP-PAGAM1.            00074700
074800*    MOVE BQVFD21-03-IMP-RIMBA        TO W-IMP-RIMB1.             00074800
074900*    GO TO ML-080.                                                00074900
075000*ML-070.                                                          00075000
075100*---   TIPO RECORD V01: IMPOSTAZIONE CAMPI IN AREE DI APPOGGIO    00075100
075200*---                                                              00075200
075300*    MOVE 'V01'                       TO W-TIPO-RECORD.           00075300
075400*    MOVE BQVFD21-01-DATA-RISC        TO W-DATA-RISC.             00075400
075500*    MOVE BQVFD21-01-COD-TRIB         TO W-COD-TRIB.              00075500
075600*    MOVE BQVFD21-01-FLAG-ERR-TRIB    TO W-FLAG-TRIB.             00075600
075700*    MOVE BQVFD21-01-PERIODO-RIFA     TO W-PERIODO-RIF.           00075700
075800*    MOVE BQVFD21-01-FLAG-ERR-PERIODO TO W-FLAG-PER.              00075800
075900*    MOVE BQVFD21-01-IMP-PAGAMA       TO W-IMP-PAGAM1.            00075900
076000*    MOVE BQVFD21-01-IMP-RIMBA        TO W-IMP-RIMB1.             00076000
076100 ML-080.                                                          00076100
076200*---   ROUTINE DI CONTROLLO DEL FLAG AGEVOLAZIONI                 00076200
076300**** PERFORM E1-010-FLAG-AGEV THRU E1-010-FLAG-AGEV-EX.           00076300
076400*---   ROUTINE DI CONTROLLO DEL CODICE TRIBUTO E RELATIVO FLAG    00076400
076500     PERFORM A1-010-COD-TRIB THRU A1-010-COD-TRIB-EX.             00076500
076600*---   ROUTINE DI CONTROLLO DEL PERIODO RIFER. E RELATIVO FLAG    00076600
076700     PERFORM B1-010-PER-RIF  THRU B1-010-PER-RIF-EX.              00076700
076800*---   ROUTINE DI CONTROLLO DEI PAGAMENTI                         00076800
076900     PERFORM C1-010-PAGA  THRU C1-010-PAGA-EX.                    00076900
077000*---   ROUTINE DI CONTROLLO DEI RIMBORSI                          00077000
077100     PERFORM D1-010-RIMB  THRU D1-010-RIMB-EX.                    00077100
077200*---   ROUTINE DI CONTROLLO ESISTENZA CODICE UFFICIO E            00077200
077300*---   CONTROLLO FORMALE DEL NUMERO UFFICIO                       00077300
077400     PERFORM F1-010-UFF-NUM  THRU F1-010-UFF-NUM-EX.              00077400
077500*---   ROUTINE DI CONTROLLO CODICE UFFICIO E NUMERO UFFICIO       00077500
077600*---   PRESENTI SUL TIPO RECORD V01                               00077600
077700     PERFORM G1-010-TRIB-UFFNUM  THRU G1-010-TRIB-UFFNUM-EX.      00077700
077800*---   ROUTINE DI CONTROLLO CODICE FISCALE E NUMERO UFFICIO       00077800
077900*---   CONTEMPORANEAMENTE ERRATI                                  00077900
078000     PERFORM H1-010-FISC-NUM  THRU H1-010-FISC-NUM-EX.            00078000
078100*---                                                              00078100
078200     MOVE W-TAB               TO W-TABELLA.                       00078200
078300*    IF W-PROV EQUAL 'C'                                          00078300
078400*      GO TO ML-120.                                              00078400
078500 ML-090.                                                          00078500
078600     IF W-TIPO-RECORD EQUAL 'V03'                                 00078600
078700       GO TO ML-110.                                              00078700
078800 ML-100.                                                          00078800
078900*---   IMPOSTAZIONE ERRORI RELATIVI AL TIPO RECORD V01            00078900
079000*---                                                              00079000
079100     MOVE W-ERR-COD-TRIB      TO BQVFB21-01-ERR-COD-TRIB.         00079100
079200     MOVE W-ERR-FLAG-TRIB     TO BQVFB21-01-ERR-FLAG-ERR-TRIB.    00079200
079300     MOVE W-ERR-PERIODO       TO BQVFB21-01-ERR-PERIODO-RIF.      00079300
079400     MOVE W-ERR-FLAG-PER      TO BQVFB21-01-ERR-FLAG-ERR-PER.     00079400
079500     MOVE W-ERR-PAGAM         TO BQVFB21-01-ERR-IMP-PAGAM.        00079500
079600     MOVE W-ERR-RIMB          TO BQVFB21-01-ERR-IMP-RIMB.         00079600
079700     MOVE W-COD-TRIB          TO BQVFB21-01-COD-TRIB.             00079700
079800     MOVE W-ERR-UFFICIO-RIF   TO BQVFB21-01-ERR-UFF-RIFER.        00079800
079900     MOVE W-ERR-FLAG-ERR-UFFICIO TO BQVFB21-01-ERR-FLAG-ERR-UFF.  00079900
080000     MOVE W-ERR-NUMERO-RIF    TO BQVFB21-01-ERR-NUM-RIFER.        00080000
080100     MOVE W-ERR-FLAG-ERR-NUMERO TO BQVFB21-01-ERR-FLAG-ERR-NRIF.  00080100
080200*---   IMPOSTAZIONE SEGNALAZIONE TIPO ERRORE VERIFICATOSI         00080200
080300*---                 TIPO RECORD V01                              00080300
080400     MOVE W-SEGNAL-COD-TRIB   TO BQVFB21-01-ERR-COD-TRIB-A.       00080400
080500     MOVE W-SEGNAL-FLAG-TRIB  TO BQVFB21-01-ERR-FLAG-ERR-TRIB-A.  00080500
080600     MOVE W-SEGNAL-PERIODO    TO BQVFB21-01-ERR-PERIODO-RIF-A.    00080600
080700     MOVE W-SEGNAL-FLAG-PER   TO BQVFB21-01-ERR-FLAG-ERR-PER-A.   00080700
080800     MOVE W-SEGNAL-PAGAM      TO BQVFB21-01-ERR-IMP-PAGAM-A.      00080800
080900     MOVE W-SEGNAL-RIMB       TO BQVFB21-01-ERR-IMP-RIMB-A.       00080900
081000     MOVE W-SEGNAL-UFF-RIF    TO BQVFB21-01-ERR-UFF-RIFER-A.      00081000
081100     MOVE W-SEGNAL-FLAG-ERR-UFF                                   00081100
081200                              TO BQVFB21-01-ERR-FLAG-ERR-UFF-A.   00081200
081300     MOVE W-SEGNAL-NUM-RIF    TO BQVFB21-01-ERR-NUM-RIFER-A.      00081300
081400     MOVE W-SEGNAL-FLAG-ERR-NUM                                   00081400
081500                              TO BQVFB21-01-ERR-FLAG-ERR-NRIF-A.  00081500
081600     GO TO ML-115.                                                00081600
081700 ML-110.                                                          00081700
081800*---   IMPOSTAZIONE ERRORI RELATIVI AL TIPO RECORD V03            00081800
081900*---                                                              00081900
082000     MOVE W-ERR-COD-TRIB      TO BQVFB21-03-ERR-COD-TRIB.         00082000
082100     MOVE W-ERR-FLAG-TRIB     TO BQVFB21-03-ERR-FLAG-ERR-TRIB.    00082100
082200     MOVE W-ERR-PERIODO       TO BQVFB21-03-ERR-PERIODO-RIF.      00082200
082300     MOVE W-ERR-FLAG-PER      TO BQVFB21-03-ERR-FLAG-ERR-PER.     00082300
082400     MOVE W-ERR-PAGAM         TO BQVFB21-03-ERR-IMP-PAGAM.        00082400
082500     MOVE W-ERR-RIMB          TO BQVFB21-03-ERR-IMP-RIMB.         00082500
082600*---   IMPOSTAZIONE SEGNALAZIONE TIPO ERRORE VERIFICATOSI         00082600
082700*---                 TIPO RECORD V03                              00082700
082800     MOVE W-SEGNAL-COD-TRIB   TO BQVFB21-03-ERR-COD-TRIB-A.       00082800
082900     MOVE W-SEGNAL-FLAG-TRIB  TO BQVFB21-03-ERR-FLAG-ERR-TRIB-A.  00082900
083000     MOVE W-SEGNAL-PERIODO    TO BQVFB21-03-ERR-PERIODO-RIF-A.    00083000
083100     MOVE W-SEGNAL-FLAG-PER   TO BQVFB21-03-ERR-FLAG-ERR-PER-A.   00083100
083200     MOVE W-SEGNAL-PAGAM      TO BQVFB21-03-ERR-IMP-PAGAM-A.      00083200
083300     MOVE W-SEGNAL-RIMB       TO BQVFB21-03-ERR-IMP-RIMB-A.       00083300
083400 ML-115.                                                          00083400
083500     MOVE BQVFB21             TO W-DATI.                          00083500
083600     GO TO ML-990.                                                00083600
083700*ML-120.                                                          00083700
083800*    IF W-TIPO-RECORD EQUAL 'V03'                                 00083800
083900*      GO TO ML-140.                                              00083900
084000*ML-130.                                                          00084000
084100*---   IMPOSTAZIONE ERRORI RELATIVI AL TIPO RECORD V01            00084100
084200*---                                                              00084200
084300*    MOVE W-ERR-COD-TRIB      TO BQVFD21-01-ERR-COD-TRIB.         00084300
084400*    MOVE W-ERR-FLAG-TRIB     TO BQVFD21-01-ERR-FLAG-ERR-TRIB.    00084400
084500*    MOVE W-ERR-PERIODO       TO BQVFD21-01-ERR-PERIODO-RIF.      00084500
084600*    MOVE W-ERR-FLAG-PER      TO BQVFD21-01-ERR-FLAG-ERR-PER.     00084600
084700*    MOVE W-ERR-PAGAM         TO BQVFD21-01-ERR-IMP-PAGAM.        00084700
084800*    MOVE W-ERR-RIMB          TO BQVFD21-01-ERR-IMP-RIMB.         00084800
084900*    MOVE W-COD-TRIB          TO BQVFD21-01-COD-TRIB.             00084900
085000*---   IMPOSTAZIONE SEGNALAZIONE TIPO ERRORE VERIFICATOSI         00085000
085100*---                 TIPO RECORD V01                              00085100
085200*    MOVE W-SEGNAL-COD-TRIB   TO BQVFD21-01-ERR-COD-TRIB-A.       00085200
085300*    MOVE W-SEGNAL-FLAG-TRIB  TO BQVFD21-01-ERR-FLAG-ERR-TRIB-A.  00085300
085400*    MOVE W-SEGNAL-PERIODO    TO BQVFD21-01-ERR-PERIODO-RIF-A.    00085400
085500*    MOVE W-SEGNAL-FLAG-PER   TO BQVFD21-01-ERR-FLAG-ERR-PER-A.   00085500
085600*    MOVE W-SEGNAL-PAGAM      TO BQVFD21-01-ERR-IMP-PAGAM-A.      00085600
085700*    MOVE W-SEGNAL-RIMB       TO BQVFD21-01-ERR-IMP-RIMB-A.       00085700
085800*    GO TO ML-145.                                                00085800
085900*ML-140.                                                          00085900
086000*---   IMPOSTAZIONE ERRORI RELATIVI AL TIPO RECORD V03            00086000
086100*---                                                              00086100
086200*    MOVE W-ERR-COD-TRIB      TO BQVFD21-03-ERR-COD-TRIB.         00086200
086300*    MOVE W-ERR-FLAG-TRIB     TO BQVFD21-03-ERR-FLAG-ERR-TRIB.    00086300
086400*    MOVE W-ERR-PERIODO       TO BQVFD21-03-ERR-PERIODO-RIF.      00086400
086500*    MOVE W-ERR-FLAG-PER      TO BQVFD21-03-ERR-FLAG-ERR-PER.     00086500
086600*    MOVE W-ERR-PAGAM         TO BQVFD21-03-ERR-IMP-PAGAM.        00086600
086700*    MOVE W-ERR-RIMB          TO BQVFD21-03-ERR-IMP-RIMB.         00086700
086800*---   IMPOSTAZIONE SEGNALAZIONE TIPO ERRORE VERIFICATOSI         00086800
086900*---                 TIPO RECORD V03                              00086900
087000*    MOVE W-SEGNAL-COD-TRIB   TO BQVFD21-03-ERR-COD-TRIB-A.       00087000
087100*    MOVE W-SEGNAL-FLAG-TRIB  TO BQVFD21-03-ERR-FLAG-ERR-TRIB-A.  00087100
087200*    MOVE W-SEGNAL-PERIODO    TO BQVFD21-03-ERR-PERIODO-RIF-A.    00087200
087300*    MOVE W-SEGNAL-FLAG-PER   TO BQVFD21-03-ERR-FLAG-ERR-PER-A.   00087300
087400*    MOVE W-SEGNAL-PAGAM      TO BQVFD21-03-ERR-IMP-PAGAM-A.      00087400
087500*    MOVE W-SEGNAL-RIMB       TO BQVFD21-03-ERR-IMP-RIMB-A.       00087500
087600*ML-145.                                                          00087600
087700*    MOVE BQVFD21             TO W-DATI.                          00087700
087800 ML-990.                                                          00087800
087900     GOBACK.                                                      00087900
088000*---              CONTROLLO CODICE TRIBUTO                        00088000
088100 A1-010-COD-TRIB.                                                 00088100
088200*---   CONTROLLO CORRETTEZZA DEL FLAG RELATIVO A CODICE TRIBUTO   00088200
088300*---                                                              00088300
088400     IF W-FLAG-TRIB EQUAL '0' OR                                  00088400
088500        W-FLAG-TRIB EQUAL '1'                                     00088500
088600       GO TO A1-035.                                              00088600
088700 A1-030.                                                          00088700
088800*---   ERRORE BLOCCANTE                                           00088800
088900     ADD 1                        TO W-CTR2.                      00088900
089000     MOVE 55                      TO W-ERR-FLAG-TRIB.             00089000
089100     MOVE 'E'                     TO W-SEGNAL-FLAG-TRIB.          00089100
089200 A1-035.                                                          00089200
089300*---   RICERCA SULL'ARCHIVIO TRIBUTI: SI CERCA CON IL TIPO TRIBUTO00089300
089400*---   IL CODICE E LA DATA RISCOSSIONE COMPRESA TRA INIZIO-VAL E  00089400
089500*---   FINE-VAL, INDIPENDENTEMENTE DALLA SUA CORRETTA IMPOSTAZIONE00089500
089600*---   IN QUANTO:                                                 00089600
089700*---   .. SE ERRATA NON SARA' TROVATA ALCUNA OCCORRENZA (ED INFATT00089700
089800*---      NON AVENDO A DISPOSIZIONE UN DATA RISCOSSIONE CORRETTA N00089800
089900*---      POTREI CONTROLLARNE LA VALIDITA' CON LE DATE DI TABELLA)00089900
090000*---   .. SE CORRETTA SARA' TROVATA AL MASSIMO 1 OCCORRENZA.      00090000
090100*---                                                              00090100
090200     MOVE SPACE                   TO W-TIPO-PER-OUT.              00090200
090300*    MOVE 'R'                     TO W-TIPO-TRI-INP.              00090300
090400     MOVE 'R'                     TO W-TIPO-TRIB-MIN.             00090400
090500     MOVE 'R'                     TO W-TIPO-TRIB-MAX.             00090500
090600     IF W-TIPO-RECORD  = 'V01'                                    00090600
090700*       MOVE 'F'                  TO W-TIPO-TRI-INP.              00090700
090800*AN INIZIO MODIFICA 05/2004 -INPDAP                               00090800
090900*       MOVE 'F'                  TO W-TIPO-TRIB-MIN              00090900
091000        MOVE 'E'                  TO W-TIPO-TRIB-MIN              00091000
091100*AN FINE   MODIFICA 05/2004 -INPDAP                               00091100
091200        MOVE 'L'                  TO W-TIPO-TRIB-MAX.             00091200
091300     SET W-PUNT-TRIB TO 1.                                        00091300
091400     SEARCH W-TAB-TRIB-EL                                         00091400
091500            AT END MOVE ZERO TO W-FLAG-TROVATO                    00091500
091600     WHEN W-TAB-TRIB-TIPO-TR(W-PUNT-TRIB) NOT < W-TIPO-TRIB-MIN   00091600
091700      AND W-TAB-TRIB-TIPO-TR(W-PUNT-TRIB) NOT > W-TIPO-TRIB-MAX   00091700
091800      AND W-TAB-TRIB-COD(W-PUNT-TRIB)     = W-COD-TRIB      AND   00091800
091900          W-TAB-TRIB-INI-VAL(W-PUNT-TRIB) NOT > W-DATA-RISC AND   00091900
092000          W-TAB-TRIB-FIN-VAL(W-PUNT-TRIB) NOT < W-DATA-RISC       00092000
092100     MOVE W-TAB-TRIB-TIPO-PE(W-PUNT-TRIB) TO W-TIPO-PER-OUT       00092100
092200     MOVE W-TAB-TRIB-TIPO-TR(W-PUNT-TRIB) TO W-TIPO-TRIB-OUT      00092200
092300     MOVE W-TAB-TRIB-FLAG-COMPEN(W-PUNT-TRIB) TO FLAG-COMPEN      00092300
092400     MOVE W-TAB-TRIB-FLAG-AGEV(W-PUNT-TRIB) TO FLAG-TRIB-AGEV     00092400
092500     MOVE W-TAB-TRIB-FLAG-CONC(W-PUNT-TRIB) TO FLAG-TRIB-CONC     00092500
092600     MOVE W-TAB-TRIB-COD-ATTO(W-PUNT-TRIB) TO COD-ATTO            00092600
092700     MOVE W-TAB-TRIB-ANNO-RIF(W-PUNT-TRIB) TO ANNO-RIF            00092700
092800     MOVE 1                               TO W-FLAG-TROVATO.      00092800
092900*                                                                 00092900
093000*                                                                 00093000
093100*---   SI EFFETTUA IL TRATTAMENTO DEI TRIBUTI RELATIVI ALL'       00093100
093200*---   AGEVOLAZIONE FISCALE CHE DEVONO ESSERE RITENUTI VALIDI     00093200
093300*---   SOLO PER I CONCESSIONARI                                   00093300
093400*---   E SOLO SE IL FLAG AGEVOLAZIONE VALE ZERO                   00093400
093500     PERFORM X1-010-AGEV THRU X1-010-AGEV-EX.                     00093500
093600     IF W-FLAG-TROVATO = 1                                        00093600
093700       GO TO A1-090.                                              00093700
093800 A1-040.                                                          00093800
093900*---   IL TRIBUTO NON E' STATO TROVATO IN TABELLA                 00093900
094000*---                                                              00094000
094100     IF W-FLAG-TROVATO = 0 AND                                    00094100
094200*AN INIZIO MODIFICA 05/2004 MONOPOLI                              00094200
094300        W-VERS > 'R04'                                            00094300
094400           PERFORM TRIB-010 THRU TRIB-EXIT.                       00094400
094500*AN FINE   MODIFICA 05/2004 MONOPOLI                              00094500
094600*---                                                              00094600
094700     IF W-FLAG-TRIB EQUAL '1'                                     00094700
094800       GO TO A1-010-COD-TRIB-EX.                                  00094800
094900 A1-070.                                                          00094900
095000*---   ERRORI SUL CODICE TRIBUTO                                  00095000
095100     MOVE 504                     TO W-ERR-COD-TRIB.              00095100
095200     ADD 1                        TO W-CTR2.                      00095200
095300     MOVE 'E'                     TO W-SEGNAL-COD-TRIB.           00095300
095400     IF W-PROV = 'C' AND W-KO-AGEV = '1'                          00095400
095500        MOVE 24                     TO W-ERR-COD-TRIB.            00095500
095600*---   ERRORE SUL FLAG ERRORE TRIBUTO SOLO SE NON E' GIA IMPOSTATO00095600
095700*---   IN QUANTO SI PUO' VERIFICARE CHE IL FLAG E' ERRATO (DIVERSO00095700
095800*---   DA '0' E DA '1'), ED IN TAL CASO  L'ERRORE E' GIA' STATO   00095800
095900*---   RILEVATO                                                   00095900
096000     IF W-ERR-FLAG-TRIB EQUAL ZERO                                00096000
096100        ADD 1                     TO W-CTR2                       00096100
096200        MOVE 24                   TO W-ERR-FLAG-TRIB              00096200
096300        MOVE 'E'                  TO W-SEGNAL-FLAG-TRIB.          00096300
096400     GO TO A1-010-COD-TRIB-EX.                                    00096400
096500 A1-090.                                                          00096500
096600     MOVE 'SI'                TO W-TROVATO.                       00096600
096700     IF W-TIPO-RECORD EQUAL 'V01'                                 00096700
096800        PERFORM J2-010  THRU J2-EXIT                              00096800
096900        PERFORM J3-010  THRU J3-EXIT                              00096900
097000        PERFORM J5-010  THRU J5-EXIT                              00097000
097100        PERFORM J6-010  THRU J6-EXIT                              00097100
097200        PERFORM J7-010  THRU J7-EXIT                              00097200
097300        PERFORM J8-010  THRU J8-EXIT                              00097300
097400        PERFORM J9-010  THRU J9-EXIT                              00097400
097500        PERFORM J10-010  THRU J10-EXIT                            00097500
097600        PERFORM J11-010  THRU J11-EXIT                            00097600
097700        PERFORM J12-010  THRU J12-EXIT                            00097700
097800        PERFORM J13-010  THRU J13-EXIT                            00097800
097900        PERFORM J14-010  THRU J14-EXIT                            00097900
098000        PERFORM J15-010  THRU J15-EXIT                            00098000
098100        PERFORM J16-010  THRU J16-EXIT                            00098100
098200        PERFORM J17-010  THRU J17-EXIT                            00098200
098300       ELSE                                                       00098300
098400        PERFORM J4-010  THRU J4-EXIT                              00098400
098500        PERFORM J18-010  THRU J18-EXIT                            00098500
098600     END-IF.                                                      00098600
098700*---   IL CODICE TRIBUTO ESISTE IN BASE INFORMATIVA;              00098700
098800*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00098800
098900*---   RELATIVO AL CODICE TRIBUTO                                 00098900
099000*---                                                              00099000
099100     IF W-FLAG-TRIB NOT EQUAL '1'                                 00099100
099200       GO TO A1-010-COD-TRIB-EX.                                  00099200
099300 A1-110.                                                          00099300
099400*---   ERRORE NON BLOCCANTE                                       00099400
099500     ADD 1                        TO W-CTR1.                      00099500
099600     MOVE 24                      TO W-ERR-FLAG-TRIB.             00099600
099700     MOVE 'W'                     TO W-SEGNAL-FLAG-TRIB.          00099700
099800 A1-010-COD-TRIB-EX.                                              00099800
099900     EXIT.                                                        00099900
100000*---        CONTROLLO PERIODO RIFERIMENTO                         00100000
100100*                                                                 00100100
100200*A MODIFICA 10/02/2005                                            00100200
100300*                                                                 00100300
100400 B1-010-PER-RIF.                                                  00100400
100500*---                                                              00100500
100600     COMPUTE W-DATA-RISC-AA-PIU1 = W-DATA-RISC-AA + ANNO-RIF.     00100600
100700*---                                                              00100700
100800*---   CONTROLLO CORRETTEZZA DEL FLAG RELATIVO A PERIODO RIF.     00100800
100900*---                                                              00100900
101000     IF W-FLAG-PER EQUAL '0' OR                                   00101000
101100        W-FLAG-PER EQUAL '1'                                      00101100
101200        GO TO B1-030.                                             00101200
101300 B1-020.                                                          00101300
101400*---   ERRORE BLOCCANTE                                           00101400
101500     MOVE 55                      TO W-ERR-FLAG-PER.              00101500
101600     ADD 1                        TO W-CTR2.                      00101600
101700     MOVE 'E'                     TO W-SEGNAL-FLAG-PER.           00101700
101800*---                                                              00101800
101900 B1-030.                                                          00101900
102000*---                                                              00102000
102100*---                                                              00102100
102200 B1-050.                                                          00102200
102300*---   SI CONTROLLA SE IL CODICE TRIBUTO E' CENSITO IN B.I.       00102300
102400*---                                                              00102400
102500     MOVE W-PERIODO-RIF           TO W-APPO-PER-RIF.              00102500
102600     IF W-TROVATO EQUAL 'NO'                                      00102600
102700        GO TO B1-450.                                             00102700
102800 B1-060.                                                          00102800
102900*---   SI CONTROLLA IL FORMATO DEL PERIODO DI RIFERIMENTO         00102900
103000*---   PARTENDO DAL TIPO PERIODO                                  00103000
103100*---   TIPO PERIODO NEL FORMATO '00TRAAAA'                        00103100
103200*---                                                              00103200
103300     IF W-TIPO-PER-OUT EQUAL '00T0AAAA' OR                        00103300
103400        W-TIPO-PER-OUT EQUAL '00T1AAAA' OR                        00103400
103500        W-TIPO-PER-OUT EQUAL '00T2AAAA' OR                        00103500
103600        (W-APPO-PER-RIF-NU NOT EQUAL '  '    AND                  00103600
103700            W-APPO-PER-RIF-NU NOT EQUAL '00' AND                  00103700
103800            (W-COD-TRIB = 'T010' OR                               00103800
103900             W-COD-TRIB = '806T'))            OR                  00103900
104000        W-TIPO-PER-OUT EQUAL '00T3AAAA' OR                        00104000
104100        W-TIPO-PER-OUT EQUAL '00T4AAAA' OR                        00104100
104200        W-TIPO-PER-OUT EQUAL '00T5AAAA' OR                        00104200
104300        W-TIPO-PER-OUT EQUAL '00T6AAAA' OR                        00104300
104400        W-TIPO-PER-OUT EQUAL '00T7AAAA' OR                        00104400
104500        W-TIPO-PER-OUT EQUAL '00T8AAAA' OR                        00104500
104600        W-TIPO-PER-OUT EQUAL '00T9AAAA'                           00104600
104700        GO TO B1-260.                                             00104700
104800 B1-070.                                                          00104800
104900*---   SI CONTROLLA IL FORMATO DEL PERIODO DI RIFERIMENTO         00104900
105000*---   PARTENDO DAL TIPO PERIODO                                  00105000
105100*---   TIPO PERIODO NEL FORMATO 'NNMMAAAA'                        00105100
105200*---                                                              00105200
105300     IF W-TIPO-PER-OUT EQUAL 'NNMMAAAA'                           00105300
105400       GO TO B1-190.                                              00105400
105500 B1-080.                                                          00105500
105600*---   SI CONTROLLA IL FORMATO DEL PERIODO DI RIFERIMENTO         00105600
105700*---   PARTENDO DAL TIPO PERIODO                                  00105700
105800*---   TIPO PERIODO NEL FORMATO                                   00105800
105900*---                                                              00105900
106000*---   '0000AAAA' OPPURE '00000000'                               00106000
106100*---                                                              00106100
106200     IF (W-APPO-PER-RIF-RA    EQUAL      ZERO    AND              00106200
106300         W-APPO-PER-RIF-NU    EQUAL      ZERO    AND              00106300
106400         W-APPO-PER-RIF-ANNO  GREATER    '1900'      AND          00106400
106500         W-APPO-PER-RIF-ANNO  NUMERIC                AND          00106500
106600         W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1 AND  00106600
106700         W-TIPO-PER-OUT = '0000AAAA') OR                          00106700
106800*                                                                 00106800
106900        (W-APPO-PER-RIF-RA    EQUAL      ZERO    AND              00106900
107000         W-APPO-PER-RIF-NU    EQUAL      ZERO    AND              00107000
107100         W-APPO-PER-RIF-ANNO  EQUAL      ZERO    AND              00107100
107200         W-TIPO-PER-OUT = '00000000')                             00107200
107300        GO TO  B1-160.                                            00107300
107400 B1-085.                                                          00107400
107500*---   SI CONTROLLA IL FORMATO DEL PERIODO DI RIFERIMENTO         00107500
107600*---   PARTENDO DAL TIPO PERIODO                                  00107600
107700*---                                                              00107700
107800     IF W-TIPO-PER-OUT EQUAL '00MMAAAA'                           00107800
107900         PERFORM B9-010-PER-RIF  THRU B9-010-PER-RIF-EX           00107900
108000         GO TO B1-010-PER-RIF-EX.                                 00108000
108100 B1-087.                                                          00108100
108200*---   SI CONTROLLA IL FORMATO DEL PERIODO DI RIFERIMENTO         00108200
108300*---   PARTENDO DAL TIPO PERIODO                                  00108300
108400*---                                                              00108400
108500     IF W-TIPO-PER-OUT EQUAL 'FFFFAAAA'                           00108500
108600         PERFORM FF-010-PER-RIF  THRU FF-010-PER-RIF-EX           00108600
108700         GO TO B1-010-PER-RIF-EX.                                 00108700
108800 B1-130.                                                          00108800
108900*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00108900
109000*---                                                              00109000
109100     IF W-FLAG-PER EQUAL '1'                                      00109100
109200       GO TO B1-150.                                              00109200
109300 B1-140.                                                          00109300
109400*---   ERRORI                                                     00109400
109500     MOVE 96                      TO W-ERR-PERIODO.               00109500
109600     ADD 1                        TO W-CTR2.                      00109600
109700     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00109700
109800     IF W-ERR-FLAG-PER EQUAL ZERO                                 00109800
109900       MOVE 24                      TO W-ERR-FLAG-PER             00109900
110000       ADD 1                        TO W-CTR2                     00110000
110100       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00110100
110200     GO TO B1-010-PER-RIF-EX.                                     00110200
110300 B1-150.                                                          00110300
110400*---                                                              00110400
110500     GO TO B1-010-PER-RIF-EX.                                     00110500
110600 B1-160.                                                          00110600
110700*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00110700
110800*---   RELATIVO AL PERIODO                                        00110800
110900*---                                                              00110900
111000     IF W-FLAG-PER EQUAL ZERO                                     00111000
111100        GO TO B1-010-PER-RIF-EX.                                  00111100
111200 B1-170.                                                          00111200
111300     IF W-FLAG-PER NOT EQUAL '1'                                  00111300
111400        GO TO B1-010-PER-RIF-EX.                                  00111400
111500 B1-180.                                                          00111500
111600*---   ERRORE NON BLOCCANTE                                       00111600
111700     ADD 1                        TO W-CTR1.                      00111700
111800     MOVE 24                      TO W-ERR-FLAG-PER.              00111800
111900     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00111900
112000     GO TO B1-010-PER-RIF-EX.                                     00112000
112100*---                                                              00112100
112200*---                                                              00112200
112300*---   PERIODO IN FORMATO NNMMAAAA                                00112300
112400*---                                                              00112400
112500 B1-190.                                                          00112500
112600*---   PERIODO IN FORMATO NNMMAAAA                                00112600
112700*---   SI ATTIVA LA PERFORM CHE EFFETTUA I CONTROLLI RELATIVI     00112700
112800*---                                                              00112800
112900     IF W-APPO-PER-RIF-RA    NOT LESS     '01'  AND               00112900
113000        W-APPO-PER-RIF-RA    NOT GREATER  '99'  AND               00113000
113100        W-APPO-PER-RIF-RA    NUMERIC            AND               00113100
113200        W-APPO-PER-RIF-NU    NOT LESS     '01'  AND               00113200
113300        W-APPO-PER-RIF-NU    NOT GREATER  '99'  AND               00113300
113400        W-APPO-PER-RIF-NU    NUMERIC            AND               00113400
113500         W-APPO-PER-RIF-ANNO  GREATER    '1900'      AND          00113500
113600         W-APPO-PER-RIF-ANNO  NUMERIC                AND          00113600
113700***       W-APPO-PER-RIF-ANNO  NOT GREATER W-ANNO-APPO            00113700
113800        W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1       00113800
113900        GO TO  B1-230.                                            00113900
114000*---                                                              00114000
114100 B1-200.                                                          00114100
114200*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00114200
114300*---                                                              00114300
114400     IF W-FLAG-PER EQUAL '1'                                      00114400
114500       GO TO B1-220.                                              00114500
114600 B1-210.                                                          00114600
114700*---   ERRORI                                                     00114700
114800     MOVE 96                      TO W-ERR-PERIODO.               00114800
114900     ADD 1                        TO W-CTR2.                      00114900
115000     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00115000
115100     IF W-ERR-FLAG-PER EQUAL ZERO                                 00115100
115200       MOVE 24                      TO W-ERR-FLAG-PER             00115200
115300       ADD 1                        TO W-CTR2                     00115300
115400       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00115400
115500     GO TO B1-010-PER-RIF-EX.                                     00115500
115600 B1-220.                                                          00115600
115700*---                                                              00115700
115800     GO TO B1-010-PER-RIF-EX.                                     00115800
115900 B1-230.                                                          00115900
116000*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00116000
116100*---   RELATIVO AL PERIODO                                        00116100
116200*---                                                              00116200
116300     IF W-FLAG-PER EQUAL ZERO                                     00116300
116400       GO TO B1-010-PER-RIF-EX.                                   00116400
116500 B1-240.                                                          00116500
116600     IF W-FLAG-PER NOT EQUAL '1'                                  00116600
116700       GO TO B1-010-PER-RIF-EX.                                   00116700
116800 B1-250.                                                          00116800
116900*---   ERRORE NON BLOCCANTE                                       00116900
117000     ADD 1                        TO W-CTR1.                      00117000
117100     MOVE 24                      TO W-ERR-FLAG-PER.              00117100
117200     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00117200
117300     GO TO B1-010-PER-RIF-EX.                                     00117300
117400*---                                                              00117400
117500*---                                                              00117500
117600*---   PERIODO IN FORMATO 00TRAAAA                                00117600
117700*---                                                              00117700
117800 B1-260.                                                          00117800
117900*---   PERIODO IN FORMATO 00TRAAAA                                00117900
118000*---   SI ATTIVA LA PERFORM CHE EFFETTUA I CONTROLLI RELATIVI     00118000
118100*---                                                              00118100
118200     PERFORM B4-010-00TRAAAA THRU  B4-990-EX.                     00118200
118300     GO TO B1-010-PER-RIF-EX.                                     00118300
118400*                                                                 00118400
118500*---                                                              00118500
118600*-------------------------------------------------------          00118600
118700 B1-450.                                                          00118700
118800*---                                                              00118800
118900***     IF W-APPO-PER-RIF-ANNO  NOT GREATER W-ANNO-APPO           00118900
119000     IF (W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1 AND  00119000
119100          W-APPO-PER-RIF-ANNO  GREATER    '1900'           AND    00119100
119200          W-APPO-PER-RIF-ANNO  NUMERIC                )    OR     00119200
119300        W-APPO-PER-RIF-ANNO  EQUAL ZERO                           00119300
119400        GO TO B1-490.                                             00119400
119500*---                                                              00119500
119600 B1-460.                                                          00119600
119700*---                                                              00119700
119800*---   TIPO PERIODO ERRATO  :                                     00119800
119900*---   SI CONTROLLA IL FLAG RELATIVO AL PERIODO                   00119900
120000*---                                                              00120000
120100     IF W-FLAG-PER EQUAL '1'                                      00120100
120200       GO TO B1-480.                                              00120200
120300*---                                                              00120300
120400 B1-470.                                                          00120400
120500*---   ERRORE BLOCCANTE                                           00120500
120600     MOVE 96                      TO W-ERR-PERIODO.               00120600
120700     ADD 1                        TO W-CTR2.                      00120700
120800     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00120800
120900     IF W-ERR-FLAG-PER EQUAL ZERO                                 00120900
121000       MOVE 24                      TO W-ERR-FLAG-PER             00121000
121100       ADD 1                        TO W-CTR2                     00121100
121200       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00121200
121300     GO TO B1-010-PER-RIF-EX.                                     00121300
121400*---                                                              00121400
121500 B1-480.                                                          00121500
121600     GO TO B1-010-PER-RIF-EX.                                     00121600
121700*---                                                              00121700
121800 B1-490.                                                          00121800
121900*---                                                              00121900
122000     IF W-FLAG-PER NOT EQUAL '1'                                  00122000
122100        GO TO B1-010-PER-RIF-EX.                                  00122100
122200*---                                                              00122200
122300 B1-500.                                                          00122300
122400*---   ERRORE NON BLOCCANTE                                       00122400
122500     ADD 1                        TO W-CTR1.                      00122500
122600     MOVE 24                      TO W-ERR-FLAG-PER.              00122600
122700     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00122700
122800*---                                                              00122800
122900*---                                                              00122900
123000 B1-010-PER-RIF-EX.                                               00123000
123100     EXIT.                                                        00123100
123200*---         CONTROLLO PAGAMENTI                                  00123200
123300 C1-010-PAGA.                                                     00123300
123400     IF W-IMP-PAGAM1 NUMERIC                                      00123400
123500       GO TO C1-030.                                              00123500
123600 C1-020.                                                          00123600
123700*---   ERRORE BLOCCANTE                                           00123700
123800     ADD 1                        TO W-CTR2.                      00123800
123900     MOVE 'E'                     TO W-SEGNAL-PAGAM.              00123900
124000     MOVE 33                      TO W-ERR-PAGAM.                 00124000
124100     GO TO C1-010-PAGA-EX.                                        00124100
124200 C1-030.                                                          00124200
124300*F INIZIO MODIFICA 30/05/2003 - AGGIUNTO CONTROLLO FLAG-COMPEN    00124300
124400     IF W-TROVATO = 'SI'       AND                                00124400
124500        W-IMP-PAGAM GREATER ZERO AND                              00124500
124600        FLAG-COMPEN = 'R'                                         00124600
124700          ADD 1                   TO W-CTR1                       00124700
124800          MOVE 96                 TO W-ERR-PAGAM                  00124800
124900          MOVE 'W'                TO W-SEGNAL-PAGAM.              00124900
125000*F FINE MODIFICA 30/05/2003 - AGGIUNTO CONTROLLO FLAG-COMPEN      00125000
125100     IF W-IMP-PAGAM GREATER ZERO                                  00125100
125200       GO TO C1-055.                                              00125200
125300 C1-040.                                                          00125300
125400*---   IMPORTO PAGAMENTI E' ZERO ED E' AMMESSO SOLO SE E'         00125400
125500*---   STATO IMPOSTATO RIMBORSI                                   00125500
125600*---                                                              00125600
125700     IF W-IMP-RIMB1 IS NOT NUMERIC OR                             00125700
125800        W-IMP-RIMB GREATER ZERO                                   00125800
125900       GO TO C1-010-PAGA-EX.                                      00125900
126000 C1-050.                                                          00126000
126100*---   ERRORE BLOCCANTE                                           00126100
126200     ADD 1                        TO W-CTR2.                      00126200
126300     MOVE 39                      TO W-ERR-PAGAM.                 00126300
126400     MOVE 'E'                     TO W-SEGNAL-PAGAM.              00126400
126500     GO TO C1-010-PAGA-EX.                                        00126500
126600 C1-055.                                                          00126600
126700*---   S'INCREMENTA L'IMPORTO NELLA TABELLA DI TOTALIZZAZIONE     00126700
126800*---                                                              00126800
126900     IF W-TIPO-RECORD EQUAL 'V03'                                 00126900
127000       GO TO C1-063.                                              00127000
127100 C1-060.                                                          00127100
127200     ADD W-IMP-PAGAM           TO W-TAB-EL-PAG(1).                00127200
127300     GO TO C1-068.                                                00127300
127400 C1-063.                                                          00127400
127500     IF W-REG EQUAL ZERO                                          00127500
127600       GO TO C1-068.                                              00127600
127700 C1-065.                                                          00127700
127800     ADD W-IMP-PAGAM           TO W-TAB-EL-PAG(3).                00127800
127900 C1-068.                                                          00127900
128000*---   SI CONTROLLA CHE NON SIA IMPOSTATO L'IMPORTO RIMBORSI      00128000
128100*---                                                              00128100
128200     IF W-IMP-RIMB NUMERIC AND                                    00128200
128300        W-IMP-RIMB = ZERO                                         00128300
128400       GO TO C1-078.                                              00128400
128500 C1-070.                                                          00128500
128600*---   ERRORE NON BLOCCANTE                                       00128600
128700*---                                                              00128700
128800     ADD 1                        TO W-CTR2.                      00128800
128900     MOVE 96                      TO W-ERR-RIMB.                  00128900
129000     MOVE 'E'                     TO W-SEGNAL-RIMB.               00129000
129100     GO TO C1-010-PAGA-EX.                                        00129100
129200 C1-078.                                                          00129200
129300*---   SI CONTROLLA IL TIPO DI DIVISA                             00129300
129400*---                                                              00129400
129500     IF W-DIVISA EQUAL SPACE      OR                              00129500
129600        W-DIVISA EQUAL LOW-VALUE                                  00129600
129700       GO TO C1-010-PAGA-EX.                                      00129700
129800 C1-080.                                                          00129800
129900*---   SE LA DIVISA E' 'ITL' LE ULTIME TRE CIFRE DEL PAGAMENTO    00129900
130000*---   DEVONO ESSERE NON IMPOSTATE                                00130000
130100*---   SE LA DIVISA E' 'EUR' LE ULTIME DUE CIFRE DEL PAGAMENTO    00130100
130200*---   DEVONO ESSERE NON IMPOSTATE                                00130200
130300*---                                                              00130300
130400*INIZIO MODIFICA EURO                                             00130400
130500*CB 29/11/2001                                                    00130500
130600     IF W-DATA-RISC <= '20011231'                                 00130600
130700          IF (W-DIVISA = 'ITL'           AND                      00130700
130800              W-IMP-PAGAM1-03 EQUAL ZERO)    OR                   00130800
130900             (W-DIVISA = 'EUR'           AND                      00130900
131000             (BQVFB21-DATA-BONIF > '20011231' OR                  00131000
131100              W-IMP-PAGAM1-02 EQUAL ZERO))                        00131100
131200              GO TO C1-010-PAGA-EX                                00131200
131300          ELSE                                                    00131300
131400              GO TO C1-090                                        00131400
131500          END-IF                                                  00131500
131600     END-IF.                                                      00131600
131700              GO TO C1-010-PAGA-EX.                               00131700
131800*CB 29/11/2001                                                    00131800
131900*FINE   MODIFICA EURO                                             00131900
132000 C1-090.                                                          00132000
132100*---   ERRORE BLOCCANTE                                           00132100
132200     ADD 1                        TO W-CTR2.                      00132200
132300     MOVE 96                      TO W-ERR-PAGAM.                 00132300
132400     MOVE 'E'                     TO W-SEGNAL-PAGAM.              00132400
132500 C1-010-PAGA-EX.                                                  00132500
132600     EXIT.                                                        00132600
132700*---      CONTROLLO RIMBORSI                                      00132700
132800 D1-010-RIMB.                                                     00132800
132900     IF W-IMP-RIMB1 NUMERIC                                       00132900
133000        GO TO D1-030.                                             00133000
133100 D1-020.                                                          00133100
133200*---   ERRORE BLOCCANTE                                           00133200
133300     ADD 1                        TO W-CTR2.                      00133300
133400     MOVE 33                      TO W-ERR-RIMB.                  00133400
133500     MOVE 'E'                     TO W-SEGNAL-RIMB.               00133500
133600     GO TO D1-010-RIMB-EX.                                        00133600
133700*---                                                              00133700
133800 D1-030.                                                          00133800
133900     IF W-IMP-RIMB GREATER ZERO                                   00133900
134000        MOVE '1' TO W-FLAG-CRED                                   00134000
134100     END-IF.                                                      00134100
134200*F INIZIO MODIFICA 30/05/2003 - AGGIUNTO CONTROLLO FLAG-COMPEN    00134200
134300     IF W-TROVATO = 'SI'       AND                                00134300
134400        W-IMP-RIMB GREATER ZERO AND                               00134400
134500        FLAG-COMPEN = 'D'                                         00134500
134600          ADD 1                   TO W-CTR2                       00134600
134700          MOVE 96                 TO W-ERR-RIMB                   00134700
134800          MOVE 'E'                TO W-SEGNAL-RIMB.               00134800
134900*F FINE MODIFICA 30/05/2003 - AGGIUNTO CONTROLLO FLAG-COMPEN      00134900
135000*---                                                              00135000
135100     IF W-TROVATO = 'NO'       AND                                00135100
135200        W-IMP-RIMB GREATER ZERO                                   00135200
135300          ADD 1                   TO W-CTR2                       00135300
135400          MOVE 96                 TO W-ERR-RIMB                   00135400
135500          MOVE 'E'                TO W-SEGNAL-RIMB                00135500
135600     END-IF.                                                      00135600
135700*---                                                              00135700
135800*---   S'INCREMENTA IL RIMBORSO NELLA TABELLA DI TOTALIZZAZIONE   00135800
135900*---                                                              00135900
136000     IF W-TIPO-RECORD EQUAL 'V03'                                 00136000
136100        GO TO D1-033.                                             00136100
136200*---                                                              00136200
136300 D1-031.                                                          00136300
136400*---                                                              00136400
136500     ADD W-IMP-RIMB            TO W-TAB-EL-RIM(1).                00136500
136600*** INIZIO MODIFICA TRIBUTI AGEVOLATI                             00136600
136700*    MOVE W-COD-TRIB           TO W-TRIB-AGEV-V01.                00136700
136800*    IF W-TRIB-AGEV-V01-OK                                        00136800
136900*       GO TO D1-038.                                             00136900
137000     IF W-TROVATO = 'SI' AND                                      00137000
137100        FLAG-TRIB-AGEV = '1'                                      00137100
137200           GO TO D1-038                                           00137200
137300     END-IF.                                                      00137300
137400*                                                                 00137400
137500*** FINE MODIFICA TRIBUTI AGEVOLATI                               00137500
137600*---                                                              00137600
137700 D1-032.                                                          00137700
137800*--- S'INCREMENTA IL RIMBORSO NEL TOTALE IMPORTO COMPENSABILE     00137800
137900*--- SOLO SE IL TRIBUTO NON E' AGEVOLATO (FISCO)                  00137900
138000     ADD W-IMP-RIMB            TO W-COMP-FISCO.                   00138000
138100     GO TO D1-038.                                                00138100
138200*---                                                              00138200
138300 D1-033.                                                          00138300
138400*---                                                              00138400
138500*--- SE IL FLAG REGIONE VALE ZERO, NON E' STATO IMPOSTATO         00138500
138600*--- UN CODICE REGIONE VALIDO: SI SALTA IL CONTROLLO SUL          00138600
138700*--- LIMITE COMPENSABILE E L'INCREMENTO DEL TOTALE A RIMBORSO     00138700
138800     IF W-REG EQUAL ZERO                                          00138800
138900        GO TO D1-038.                                             00138900
139000*---                                                              00139000
139100 D1-035.                                                          00139100
139200*---                                                              00139200
139300     ADD W-IMP-RIMB            TO W-TAB-EL-RIM(3).                00139300
139400*** INIZIO MODIFICA TRIBUTI AGEVOLATI                             00139400
139500*    MOVE W-COD-TRIB           TO W-TRIB-AGEV-V03.                00139500
139600*    IF W-TRIB-AGEV-V03-OK                                        00139600
139700*       GO TO D1-038.                                             00139700
139800     IF W-TROVATO = 'SI' AND                                      00139800
139900        FLAG-TRIB-AGEV = '1'                                      00139900
140000           GO TO D1-038                                           00140000
140100     END-IF.                                                      00140100
140200*** FINE MODIFICA TRIBUTI AGEVOLATI                               00140200
140300*---                                                              00140300
140400 D1-036.                                                          00140400
140500*--- SI INCREMENTA IL RIMBORSO NEL TOTALE IMPORTO COMPENSABILE    00140500
140600*--- SOLO SE IL TRIBUTO NON E' AGEVOLATO (REGIONI)                00140600
140700     ADD W-IMP-RIMB            TO W-COMP-REG.                     00140700
140800     GO TO D1-038.                                                00140800
140900*---                                                              00140900
141000 D1-038.                                                          00141000
141100*---                                                              00141100
141200     IF W-ERR-PERIODO EQUAL 96    OR                              00141200
141300       (W-FLAG-PER    EQUAL 1 AND                                 00141300
141400        W-ERR-FLAG-PER EQUAL ZERO)                                00141400
141500        GO TO D1-010-RIMB-EX.                                     00141500
141600*---                                                              00141600
141700 D1-040.                                                          00141700
141800*---                                                              00141800
141900     MOVE W-PERIODO-RIF           TO W-DATA-APPO.                 00141900
142000*                                                                 00142000
142100*---   SI CONTROLLA CHE L'ANNO RELATIVO AL PERIODO DI RIFERIMENTO 00142100
142200*---   SIA MAGGIORE DELL'ANNO 1996                                00142200
142300*---                                                              00142300
142400     IF W-APP-ANNO  NOT GREATER  1996 AND                         00142400
142500        W-APP-ANNO  NOT EQUAL    ZERO                             00142500
142600       GO TO D1-060.                                              00142600
142700 D1-050.                                                          00142700
142800     GO TO D1-070.                                                00142800
142900 D1-060.                                                          00142900
143000*---   NON E' POSSIBILE CHIEDERE RIMBORSI                         00143000
143100*---                                                              00143100
143200     MOVE 'NO'                       TO W-INDICA.                 00143200
143300     GO TO D1-090.                                                00143300
143400 D1-070.                                                          00143400
143500*---   E' POSSIBILE CHIEDERE RIMBORSI                             00143500
143600*---                                                              00143600
143700     MOVE 'SI'                       TO W-INDICA.                 00143700
143800     GO TO D1-090.                                                00143800
143900 D1-090.                                                          00143900
144000*---   SI CONTROLLA SE E' STATO CHIESTO IL RIMBORSO               00144000
144100*---                                                              00144100
144200     IF W-IMP-RIMB EQUAL ZERO                                     00144200
144300       GO TO D1-150.                                              00144300
144400 D1-100.                                                          00144400
144500     IF W-INDICA EQUAL 'SI'                                       00144500
144600       GO TO D1-180.                                              00144600
144700 D1-110.                                                          00144700
144800*---   ERRORE NON BLOCCANTE                                       00144800
144900*---                                                              00144900
145000     IF W-ERR-RIMB EQUAL ZERO                                     00145000
145100         ADD 1                        TO W-CTR2                   00145100
145200         MOVE 96                      TO W-ERR-RIMB               00145200
145300         MOVE 'E'                     TO W-SEGNAL-RIMB            00145300
145400     END-IF.                                                      00145400
145500     GO TO D1-180.                                                00145500
145600 D1-150.                                                          00145600
145700*---   RIMBORSO NON IMPOSTATO, PER CUI DEV'ESSERE IMPOSTATA       00145700
145800*---   LA SEZIONE IL PAGAMENTI                                    00145800
145900*---                                                              00145900
146000     IF W-IMP-PAGAM1 NOT NUMERIC         OR                       00146000
146100        W-IMP-PAGAM GREATER ZERO                                  00146100
146200       GO TO D1-180.                                              00146200
146300 D1-160.                                                          00146300
146400*---   ERRORE BLOCCANTE                                           00146400
146500     ADD 1                        TO W-CTR2.                      00146500
146600     MOVE 39                      TO W-ERR-RIMB.                  00146600
146700     MOVE 'E'                     TO W-SEGNAL-RIMB.               00146700
146800     GO TO D1-180.                                                00146800
146900 D1-180.                                                          00146900
147000*---                                                              00147000
147100     IF  (W-SEGNAL-RIMB EQUAL 'E')                                00147100
147200         GO TO D1-010-RIMB-EX.                                    00147200
147300*---                                                              00147300
147400 D1-190.                                                          00147400
147500*---   SI CONTROLLA IL TIPO DIVISA IMPOSTATO DAL PGM CHIAMANTE    00147500
147600*---                                                              00147600
147700     IF W-DIVISA EQUAL SPACE                                      00147700
147800        GO TO D1-010-RIMB-EX.                                     00147800
147900 D1-200.                                                          00147900
148000*---   SE DIVISA = 'ITL', LE ULTIME TRE CIFRE DEVONO ESSERE ZERO  00148000
148100*---   SE DIVISA = 'EUR', LE ULTIME DUE CIFRE DEVONO ESSERE ZERO  00148100
148200*---                                                              00148200
148300*INIZIO MODIFICA EURO                                             00148300
148400*CB 29/11/2001                                                    00148400
148500     IF W-DATA-RISC <= '20011231'                                 00148500
148600          IF (W-DIVISA EQUAL 'ITL'      AND                       00148600
148700              W-IMP-RIMB1-03 EQUAL ZERO)         OR               00148700
148800             (W-DIVISA EQUAL 'EUR'      AND                       00148800
148900             (BQVFB21-DATA-BONIF > '20011231' OR                  00148900
149000              W-IMP-RIMB1-02 EQUAL ZERO))                         00149000
149100             GO TO D1-010-RIMB-EX                                 00149100
149200          ELSE                                                    00149200
149300             GO TO D1-210                                         00149300
149400          END-IF                                                  00149400
149500     END-IF.                                                      00149500
149600             GO TO D1-010-RIMB-EX.                                00149600
149700*CB 29/11/2001                                                    00149700
149800*FINE   MODIFICA EURO                                             00149800
149900 D1-210.                                                          00149900
150000*---   ERRORE BLOCCANTE                                           00150000
150100*---                                                              00150100
150200     ADD 1                        TO W-CTR2.                      00150200
150300     MOVE 96                      TO W-ERR-RIMB.                  00150300
150400     MOVE 'E'                     TO W-SEGNAL-RIMB.               00150400
150500     GO TO D1-010-RIMB-EX.                                        00150500
150600 D1-010-RIMB-EX.                                                  00150600
150700     EXIT.                                                        00150700
150800*---   ROUTINE DI CONTROLLO DEL FLAG AGEVOLAZIONI                 00150800
150900*E1-010-FLAG-AGEV.                                                00150900
151000*---   CONTROLLO SE SI TRATTA DI CONCESSIONARIO  E DI TIPO        00151000
151100*---   RECORD 01                                                  00151100
151200*---                                                              00151200
151300*    IF W-PROV        EQUAL 'B'             OR                    00151300
151400*       W-PROV        EQUAL 'C'             OR                    00151400
151500*       W-TIPO-RECORD EQUAL 'V03'                                 00151500
151600*      GO TO E1-010-FLAG-AGEV-EX.                                 00151600
151700*E1-015.                                                          00151700
151800*---   CONTROLLO SE SI TRATTA DEL PRIMO RECORD 01 DELLA DELEGA    00151800
151900*---                                                              00151900
152000*    IF W-FLAG-AGEV EQUAL '9'                                     00152000
152100*      GO TO E1-110.                                              00152100
152200*E1-020.                                                          00152200
152300*    IF W-FLAG-AGEV EQUAL '1'                                     00152300
152400*      GO TO E1-070.                                              00152400
152500*E1-030.                                                          00152500
152600*---   IL PRIMO RECORD 01 AVEVA FLAG AGEVOL. IMPOSTATO A 0        00152600
152700*---   PER CUI ANCHE I SUCCESSIVI DEVONO AVERE LO STESSO VALORE   00152700
152800*    IF BQVFB21-01-FLAG-AGEV EQUAL '0'                            00152800
152900*      GO TO E1-010-FLAG-AGEV-EX.                                 00152900
153000*E1-040.                                                          00153000
153100*    IF BQVFB21-01-FLAG-AGEV EQUAL '1'                            00153100
153200*      GO TO E1-060.                                              00153200
153300*E1-050.                                                          00153300
153400*---   ERRORE BLOCCANTE                                           00153400
153500*    ADD 1                        TO W-CTR2.                      00153500
153600*    MOVE 55                      TO BQVFB21-01-ERR-FLAG-AGEV.    00153600
153700*    MOVE 'E'                     TO BQVFB21-01-ERR-FLAG-AGEV-A.  00153700
153800*    GO TO E1-010-FLAG-AGEV-EX.                                   00153800
153900*E1-060.                                                          00153900
154000*---   ERRORE BLOCCANTE                                           00154000
154100*    ADD 1                        TO W-CTR2.                      00154100
154200*    MOVE 506                     TO BQVFB21-01-ERR-FLAG-AGEV.    00154200
154300*    MOVE 'E'                     TO BQVFB21-01-ERR-FLAG-AGEV-A.  00154300
154400*    GO TO E1-010-FLAG-AGEV-EX.                                   00154400
154500*E1-070.                                                          00154500
154600*---   IL PRIMO RECORD 01 AVEVA FLAG AGEVOL. IMPOSTATO A 1        00154600
154700*---   PER CUI ANCHE I SUCCESSIVI DEVONO AVERE LO STESSO VALORE   00154700
154800*    IF BQVFB21-01-FLAG-AGEV EQUAL '1'                            00154800
154900*      GO TO E1-010-FLAG-AGEV-EX.                                 00154900
155000*E1-080.                                                          00155000
155100*    IF BQVFB21-01-FLAG-AGEV EQUAL '0'                            00155100
155200*      GO TO E1-100.                                              00155200
155300*E1-090.                                                          00155300
155400*---   ERRORE BLOCCANTE                                           00155400
155500*    ADD 1                        TO W-CTR2.                      00155500
155600*    MOVE 55                      TO BQVFB21-01-ERR-FLAG-AGEV.    00155600
155700*    MOVE 'E'                     TO BQVFB21-01-ERR-FLAG-AGEV-A.  00155700
155800*    GO TO E1-010-FLAG-AGEV-EX.                                   00155800
155900*E1-100.                                                          00155900
156000*---   ERRORE BLOCCANTE                                           00156000
156100*    ADD 1                        TO W-CTR2.                      00156100
156200*    MOVE 506                     TO BQVFB21-01-ERR-FLAG-AGEV.    00156200
156300*    MOVE 'E'                     TO BQVFB21-01-ERR-FLAG-AGEV-A.  00156300
156400*    GO TO E1-010-FLAG-AGEV-EX.                                   00156400
156500*E1-110.                                                          00156500
156600*    IF BQVFB21-01-FLAG-AGEV EQUAL '1'                            00156600
156700*      GO TO E1-150.                                              00156700
156800*E1-120.                                                          00156800
156900*    IF BQVFB21-01-FLAG-AGEV EQUAL '0'                            00156900
157000*      GO TO E1-140.                                              00157000
157100*E1-130.                                                          00157100
157200*---   ERRORE BLOCCANTE                                           00157200
157300*    ADD 1                        TO W-CTR2.                      00157300
157400*    MOVE 55                      TO BQVFB21-01-ERR-FLAG-AGEV.    00157400
157500*    MOVE 'E'                     TO BQVFB21-01-ERR-FLAG-AGEV-A.  00157500
157600*    MOVE ZERO                    TO W-FLAG-AGEV.                 00157600
157700*    GO TO E1-010-FLAG-AGEV-EX.                                   00157700
157800*E1-140.                                                          00157800
157900*    MOVE ZERO                    TO W-FLAG-AGEV.                 00157900
158000*    GO TO E1-010-FLAG-AGEV-EX.                                   00158000
158100*E1-150.                                                          00158100
158200*    MOVE '1'                     TO W-FLAG-AGEV.                 00158200
158300*E1-010-FLAG-AGEV-EX.                                             00158300
158400*    EXIT.                                                        00158400
158500*                                                                 00158500
158600 FF-010-PER-RIF.                                                  00158600
158700*---   PERIODO IN FORMATO FFFFAAAA                                00158700
158800*---   SI ATTIVA LA PERFORM CHE EFFETTUA I CONTROLLI RELATIVI     00158800
158900*---                                                              00158900
159000     IF ((W-APPO-PER-RIF-RA    NOT LESS     '01'  AND             00159000
159100          W-APPO-PER-RIF-RA    NOT GREATER  '99'  AND             00159100
159200          W-APPO-PER-RIF-RA    NUMERIC            AND             00159200
159300          W-APPO-PER-RIF-NU    NOT LESS     '01'  AND             00159300
159400          W-APPO-PER-RIF-NU    NOT GREATER  '99'  AND             00159400
159500          W-APPO-PER-RIF-NU    NUMERIC               ) OR         00159500
159600         (W-APPO-PER-RIF-RA    EQUAL '00'         AND             00159600
159700         W-APPO-PER-RIF-NU    EQUAL '00'             )) AND       00159700
159800        W-APPO-PER-RIF-ANNO  GREATER    '1900'  AND               00159800
159900        W-APPO-PER-RIF-ANNO  NUMERIC            AND               00159900
160000        W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1       00160000
160100        GO TO  FF-160.                                            00160100
160200 FF-130.                                                          00160200
160300*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00160300
160400*---                                                              00160400
160500     IF W-FLAG-PER EQUAL '1'                                      00160500
160600       GO TO FF-150.                                              00160600
160700 FF-140.                                                          00160700
160800*---   ERRORI                                                     00160800
160900     MOVE 96                      TO W-ERR-PERIODO.               00160900
161000     ADD 1                        TO W-CTR2.                      00161000
161100     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00161100
161200     IF W-ERR-FLAG-PER EQUAL ZERO                                 00161200
161300       MOVE 24                      TO W-ERR-FLAG-PER             00161300
161400       ADD 1                        TO W-CTR2                     00161400
161500       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00161500
161600     GO TO FF-010-PER-RIF-EX.                                     00161600
161700 FF-150.                                                          00161700
161800*---   OMOGENEITA'                                                00161800
161900     ADD 1                        TO W-CTR1.                      00161900
162000     GO TO FF-010-PER-RIF-EX.                                     00162000
162100 FF-160.                                                          00162100
162200*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00162200
162300*---   RELATIVO AL PERIODO                                        00162300
162400*---                                                              00162400
162500     IF W-FLAG-PER EQUAL ZERO                                     00162500
162600        GO TO FF-010-PER-RIF-EX.                                  00162600
162700 FF-170.                                                          00162700
162800     IF W-FLAG-PER NOT EQUAL '1'                                  00162800
162900        GO TO FF-010-PER-RIF-EX.                                  00162900
163000 FF-180.                                                          00163000
163100*---   ERRORE NON BLOCCANTE                                       00163100
163200     ADD 1                        TO W-CTR1.                      00163200
163300     MOVE 24                      TO W-ERR-FLAG-PER.              00163300
163400     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00163400
163500     GO TO FF-010-PER-RIF-EX.                                     00163500
163600 FF-010-PER-RIF-EX.                                               00163600
163700     EXIT.                                                        00163700
163800*                                                                 00163800
163900*                                                                 00163900
164000************************************************************      00164000
164100*----                                                             00164100
164200*--- PERFORM DI CONTROLLO PER IL CODICE UFFICIO E IL              00164200
164300*--- NUMERO UFFICIO                                               00164300
164400 F1-010-UFF-NUM.                                                  00164400
164500     MOVE SPACES                  TO W-UFF-KO.                    00164500
164600     MOVE SPACES                  TO W-NUM-KO.                    00164600
164700*---   CONTROLLO SE SI TRATTA DI TIPO RECORD V01                  00164700
164800*---                                                              00164800
164900     IF W-TIPO-RECORD EQUAL 'V03'                                 00164900
165000        GO TO F1-010-UFF-NUM-EX.                                  00165000
165100*---                                                              00165100
165200 F1-020.                                                          00165200
165300*---                                                              00165300
165400*---   CONTROLLO CORRETTEZZA DEL FLAG UFFICIO.                    00165400
165500*---                                                              00165500
165600     IF W-FLAG-ERR-UFFICIO EQUAL '0' OR                           00165600
165700        W-FLAG-ERR-UFFICIO EQUAL '1'                              00165700
165800        GO TO F1-050.                                             00165800
165900*---                                                              00165900
166000 F1-030.                                                          00166000
166100*---   ERRORE BLOCCANTE                                           00166100
166200     MOVE 55                      TO W-ERR-FLAG-ERR-UFFICIO.      00166200
166300     ADD 1                        TO W-CTR2.                      00166300
166400     MOVE 'E'                     TO W-SEGNAL-FLAG-ERR-UFF.       00166400
166500*---                                                              00166500
166600 F1-050.                                                          00166600
166700*---   CONTROLLO CORRETTEZZA DEL FLAG NUMERO UFFICIO              00166700
166800*---                                                              00166800
166900     IF W-FLAG-ERR-NUMERO  EQUAL '0' OR                           00166900
167000        W-FLAG-ERR-NUMERO  EQUAL '1'                              00167000
167100        GO TO F1-080.                                             00167100
167200 F1-060.                                                          00167200
167300*---   ERRORE BLOCCANTE                                           00167300
167400     MOVE 55                      TO W-ERR-FLAG-ERR-NUMERO.       00167400
167500     ADD 1                        TO W-CTR2.                      00167500
167600     MOVE 'E'                     TO W-SEGNAL-FLAG-ERR-NUM.       00167600
167700*---                                                              00167700
167800 F1-080.                                                          00167800
167900*--                                                               00167900
168000     MOVE   ZERO             TO   W-COD-NUM-RIF.                  00168000
168100*---                                                              00168100
168200*--- CONTROLLO ESISTENZA DEL CODICE UFFICIO                       00168200
168300*--- ACCEDO ALLA TABELLA UFFICI BQVX29                            00168300
168400*---                                                              00168400
168500     IF W-UFFICIO-RIF NOT EQUAL SPACES   AND                      00168500
168600        W-UFFICIO-RIF NOT EQUAL ZERO                              00168600
168700        GO TO F1-100.                                             00168700
168800*---                                                              00168800
168900 F1-090.                                                          00168900
169000*--                                                               00169000
169100*--   PASSO AL CONTROLLO DEL NUMERO RIFERIMENTO                   00169100
169200*--                                                               00169200
169300     GO TO F1-230.                                                00169300
169400*---                                                              00169400
169500 F1-100.                                                          00169500
169600*---                                                              00169600
169700*--- CONTROLLO ESISTENZA DEL CODICE UFFICIO                       00169700
169800*--- NEL CAMPO DI LINK  W-UFF-RIF.                                00169800
169900*--- ACCEDO ALLA TABELLA UFFICI BQVX29                            00169900
170000*---                                                              00170000
170100     IF W-UFF-RIF  NOT EQUAL SPACES   AND                         00170100
170200        W-UFF-RIF  NOT EQUAL ZERO                                 00170200
170300        GO TO F1-200.                                             00170300
170400*---                                                              00170400
170500 F1-110.                                                          00170500
170600     SET W-PUNT-UFF TO 1.                                         00170600
170700     SEARCH W-TAB-UFF-EL                                          00170700
170800            AT END MOVE ZERO TO W-FLAG-TROVATO                    00170800
170900     WHEN W-TAB-UFF-COD(W-PUNT-UFF)     = W-UFFICIO-RIF   AND     00170900
171000          W-TAB-UFF-INI-VAL(W-PUNT-UFF) NOT > W-DATA-RISC AND     00171000
171100          W-TAB-UFF-FINE-VAL(W-PUNT-UFF) NOT < W-DATA-RISC        00171100
171200     MOVE W-TAB-UFF-KEY(W-PUNT-UFF)     TO W-KEY-UFF-OUT          00171200
171300     MOVE 1                                TO W-FLAG-TROVATO.     00171300
171400*---                                                              00171400
171500*---  TROVATO                                                     00171500
171600     IF W-FLAG-TROVATO = 1                                        00171600
171700        GO TO F1-180.                                             00171700
171800*---                                                              00171800
171900 F1-140.                                                          00171900
172000     MOVE W-UFFICIO-RIF      TO   W-UFF-RIF.                      00172000
172100     MOVE 'KO'                    TO W-UFF-KO.                    00172100
172200*---                                                              00172200
172300*---   IL CODICE UFFICIO                                          00172300
172400*---   NON ESISTE IN BASE INFORMATIVA;                            00172400
172500*---   SI CONTROLLA SE L'ERRORE ERA STATO SEGNALATO NEL FLAG      00172500
172600*---   RELATIVO AL CODICE UFFICIO                                 00172600
172700*---                                                              00172700
172800     IF W-FLAG-ERR-UFFICIO EQUAL '1'                              00172800
172900        GO TO F1-160.                                             00172900
173000*---                                                              00173000
173100 F1-150.                                                          00173100
173200*---   ERRORI                                                     00173200
173300*---                                                              00173300
173400     MOVE 504                     TO W-ERR-UFFICIO-RIF.           00173400
173500     ADD 1                        TO W-CTR2                       00173500
173600     MOVE 'E'                     TO W-SEGNAL-UFF-RIF.            00173600
173700*---                                                              00173700
173800*--- CONTROLLO SE IL CAMPO ERRORE DEL FLAG                        00173800
173900*--- E' IMPOSTATO O NO.                                           00173900
174000     IF W-ERR-FLAG-ERR-UFFICIO EQUAL ZERO                         00174000
174100        MOVE 24                      TO W-ERR-FLAG-ERR-UFFICIO    00174100
174200        ADD 1                        TO W-CTR2                    00174200
174300        MOVE 'E'                     TO W-SEGNAL-FLAG-ERR-UFF.    00174300
174400     GO TO F1-230.                                                00174400
174500*---                                                              00174500
174600 F1-160.                                                          00174600
174700*---                                                              00174700
174800     GO TO F1-230.                                                00174800
174900*---                                                              00174900
175000 F1-180.                                                          00175000
175100*---                                                              00175100
175200*---   MEMORIZZO IL CODICE UFFICIO IN AREA DI LINK                00175200
175300*---   IL CODICE UFFICIO                                          00175300
175400*---   ESISTE IN BASE INFORMATIVA;                                00175400
175500*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00175500
175600*---                                                              00175600
175700     MOVE W-UFFICIO-RIF      TO   W-UFF-RIF.                      00175700
175800*---                                                              00175800
175900*     IF W-FLAG-ERR-UFFICIO EQUAL ZERO                            00175900
176000*        GO TO F1-230.                                            00176000
176100*---                                                              00176100
176200* F1-190.                                                         00176200
176300*---                                                              00176300
176400*     IF W-FLAG-ERR-UFFICIO EQUAL '1'                             00176400
176500*---   ERRORE NON BLOCCANTE                                       00176500
176600*        ADD 1                        TO W-CTR1                   00176600
176700*        MOVE 24                      TO W-ERR-FLAG-ERR-UFFICIO   00176700
176800*        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-UFF.   00176800
176900     GO TO F1-230.                                                00176900
177000*---                                                              00177000
177100 F1-200.                                                          00177100
177200*---                                                              00177200
177300     PERFORM CONTR-UFF-010 THRU CONTR-UFF-EXIT.                   00177300
177400*---                                                              00177400
177500     IF  W-UFFICIO-RIF   EQUAL   W-UFF-RIF                        00177500
177600*         GO TO F1-220.                                           00177600
177700         GO TO F1-230.                                            00177700
177800*---                                                              00177800
177900 F1-210.                                                          00177900
178000*---   ERRORE BLOCCANTE                                           00178000
178100     MOVE  '1'                    TO W-COD-NUM-RIF.               00178100
178200*---                                                              00178200
178300     MOVE 509                     TO W-ERR-UFFICIO-RIF.           00178300
178400     ADD 1                        TO W-CTR2.                      00178400
178500     MOVE 'E'                     TO W-SEGNAL-UFF-RIF.            00178500
178600     GO TO F1-230.                                                00178600
178700*---                                                              00178700
178800* F1-220.                                                         00178800
178900*     IF W-FLAG-ERR-UFFICIO EQUAL ZERO                            00178900
179000*        GO TO F1-230.                                            00179000
179100*---                                                              00179100
179200* F1-225.                                                         00179200
179300*---                                                              00179300
179400*     IF W-FLAG-ERR-UFFICIO EQUAL '1'                             00179400
179500*---   ERRORE NON BLOCCANTE                                       00179500
179600*        ADD 1                        TO W-CTR1                   00179600
179700*        MOVE 24                      TO W-ERR-FLAG-ERR-UFFICIO   00179700
179800*        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-UFF.   00179800
179900*---                                                              00179900
180000 F1-230.                                                          00180000
180100*---                                                              00180100
180200     IF W-NUMERO-RIF NUMERIC                                      00180200
180300       GO TO F1-250.                                              00180300
180400*---                                                              00180400
180500 F1-240.                                                          00180500
180600*---   ERRORE BLOCCANTE                                           00180600
180700     ADD 1                        TO W-CTR2.                      00180700
180800     MOVE 'E'                     TO W-SEGNAL-NUM-RIF.            00180800
180900     MOVE 33                      TO W-ERR-NUMERO-RIF.            00180900
181000     MOVE '1'                     TO W-NUM-RIF-KO.                00181000
181100     GO TO F1-010-UFF-NUM-EX.                                     00181100
181200*---                                                              00181200
181300 F1-250.                                                          00181300
181400*---   ERRORE NON BLOCCANTE                                       00181400
181500*--- CONTROLLO ESISTENZA DEL NUMERO UFFICIO                       00181500
181600*--- UTILIZZO LA ROUTINE ASSEMBLER  XAWX107A                      00181600
181700*---                                                              00181700
181800     IF W-NUMERO-RIF  NOT EQUAL SPACES   AND                      00181800
181900        W-NUMERO-RIF  NOT EQUAL ZERO                              00181900
182000        GO TO F1-270.                                             00182000
182100*---                                                              00182100
182200 F1-260.                                                          00182200
182300*---                                                              00182300
182400     GO TO F1-010-UFF-NUM-EX.                                     00182400
182500*---                                                              00182500
182600 F1-270.                                                          00182600
182700*---                                                              00182700
182800*--- CONTROLLO ESISTENZA DEL NUMERO UFFICIO                       00182800
182900*--- DEL CAMPO DI LINK  W-NUM-RIF.                                00182900
183000*---                                                              00183000
183100     IF W-NUM-RIF  NOT EQUAL SPACES   AND                         00183100
183200        W-NUM-RIF  NOT EQUAL ZERO                                 00183200
183300        GO TO F1-340.                                             00183300
183400*---                                                              00183400
183500 F1-280.                                                          00183500
183600*---                                                              00183600
183700*--- CONTROLLO FORMALE DEL CAMPO NUMERO RIFERIMENTO               00183700
183800*---                                                              00183800
183900     MOVE SPACE                TO  W-BQVFB3-COD-FISC.             00183900
184000     MOVE W-NUMERO-RIF         TO  W-BQVFB3-COD-FISC.             00184000
184100     CALL 'BQVFB3'        USING    W-PARAM-BQVFB3.                00184100
184200*---                                                              00184200
184300     IF W-BQVFB3-COD-RIT  EQUAL    ZERO                           00184300
184400        GO TO F1-320.                                             00184400
184500*---                                                              00184500
184600 F1-290.                                                          00184600
184700*---                                                              00184700
184800*---   IL NUMERO RIFERIMENTO                                      00184800
184900*---   NON E' CORRETTO                                            00184900
185000*---   SI CONTROLLA SE L'ERRORE ERA STATO SEGNALATO NEL FLAG      00185000
185100*---   RELATIVO AL NUMERO RIFERIMENTO                             00185100
185200*---                                                              00185200
185300     MOVE    W-NUMERO-RIF        TO  W-NUM-RIF.                   00185300
185400     MOVE 'KO'                    TO W-NUM-KO.                    00185400
185500*---                                                              00185500
185600     MOVE '1'                     TO W-NUM-RIF-KO.                00185600
185700     IF W-FLAG-ERR-NUMERO  EQUAL '1'                              00185700
185800        GO TO F1-310.                                             00185800
185900 F1-300.                                                          00185900
186000*---   ERRORI                                                     00186000
186100     MOVE 36                      TO W-ERR-NUMERO-RIF.            00186100
186200     ADD 1                        TO W-CTR2.                      00186200
186300     MOVE 'E'                     TO W-SEGNAL-NUM-RIF.            00186300
186400*---                                                              00186400
186500*--- CONTROLLO SE IL CAMPO ERRORE DEL FLAG                        00186500
186600*--- E' IMPOSTATO O NO.                                           00186600
186700     IF W-ERR-FLAG-ERR-NUMERO EQUAL ZERO                          00186700
186800       MOVE 24                      TO W-ERR-FLAG-ERR-NUMERO      00186800
186900       ADD 1                        TO W-CTR2                     00186900
187000       MOVE 'E'                     TO W-SEGNAL-FLAG-ERR-NUM.     00187000
187100     GO TO F1-010-UFF-NUM-EX.                                     00187100
187200*---                                                              00187200
187300 F1-310.                                                          00187300
187400*---   OMOGENEITA'                                                00187400
187500     GO TO F1-010-UFF-NUM-EX.                                     00187500
187600*---                                                              00187600
187700*---                                                              00187700
187800 F1-320.                                                          00187800
187900*---                                                              00187900
188000*---   MEMORIZZO IL NUMERO UFFICIO IN AREA DI LINK                00188000
188100*---   IL NUMERO UFFICIO                                          00188100
188200*---   ESISTE IN BASE INFORMATIVA;                                00188200
188300*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00188300
188400*---                                                              00188400
188500     MOVE    W-NUMERO-RIF        TO  W-NUM-RIF.                   00188500
188600*     IF W-FLAG-ERR-NUMERO EQUAL ZERO                             00188600
188700*        GO TO F1-010-UFF-NUM-EX.                                 00188700
188800*---                                                              00188800
188900* F1-330.                                                         00188900
189000*---                                                              00189000
189100*     IF W-FLAG-ERR-NUMERO EQUAL '1'                              00189100
189200*---   ERRORE NON BLOCCANTE                                       00189200
189300*        ADD 1                        TO W-CTR1                   00189300
189400*        MOVE 24                      TO W-ERR-FLAG-ERR-NUMERO    00189400
189500*        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-NUM.   00189500
189600     GO TO F1-010-UFF-NUM-EX.                                     00189600
189700 F1-340.                                                          00189700
189800*---                                                              00189800
189900     PERFORM CONTR-ATTO-010 THRU CONTR-ATTO-EXIT.                 00189900
190000     IF  W-NUMERO-RIF   EQUAL   W-NUM-RIF                         00190000
190100*         GO TO F1-360.                                           00190100
190200         GO TO F1-010-UFF-NUM-EX.                                 00190200
190300*---                                                              00190300
190400 F1-350.                                                          00190400
190500*---   ERRORE BLOCCANTE                                           00190500
190600     MOVE '1'                     TO W-NUM-RIF-KO.                00190600
190700     MOVE  '1'                    TO W-COD-NUM-RIF.               00190700
190800*---                                                              00190800
190900     MOVE 509                     TO W-ERR-NUMERO-RIF.            00190900
191000     ADD 1                        TO W-CTR2.                      00191000
191100     MOVE 'E'                     TO W-SEGNAL-NUM-RIF.            00191100
191200     GO TO F1-010-UFF-NUM-EX.                                     00191200
191300*---                                                              00191300
191400* F1-360.                                                         00191400
191500*     IF W-FLAG-ERR-NUMERO EQUAL ZERO                             00191500
191600*        GO TO F1-010-UFF-NUM-EX.                                 00191600
191700*---                                                              00191700
191800* F1-370.                                                         00191800
191900*---                                                              00191900
192000*     IF W-FLAG-ERR-NUMERO EQUAL '1'                              00192000
192100*---   ERRORE NON BLOCCANTE                                       00192100
192200*        ADD 1                        TO W-CTR1                   00192200
192300*        MOVE 24                      TO W-ERR-FLAG-ERR-NUMERO    00192300
192400*        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-NUM.   00192400
192500*---                                                              00192500
192600 F1-010-UFF-NUM-EX.                                               00192600
192700     EXIT.                                                        00192700
192800*-----------------------------------------------------------      00192800
192900*---      NUOVA PERFORM PER IL CONTROLLO DEL TIPO TRIBUTO         00192900
193000*----------------------------------------------------------       00193000
193100 G1-010-TRIB-UFFNUM.                                              00193100
193200*----                                                             00193200
193300*--- CASO 1 UFFICIO NON IMPOSTATO E NUMERO UFFICIO NON IMPOSTATO  00193300
193400*--- CASO 2 UFFICIO IMPOSTATO E NUMERO UFFICIO IMPOSTATO          00193400
193500*--- CASO 3 UFFICIO NON IMPOSTATO E NUMERO UFFICIO IMPOSTATO      00193500
193600*--- CASO 4 UFFICIO IMPOSTATO E NUMERO UFFICIO NON IMPOSTATO      00193600
193700*---                                                              00193700
193800     IF W-TIPO-RECORD      EQUAL  'V03'  OR                       00193800
193900        W-COD-NUM-RIF      EQUAL  '1'    OR                       00193900
194000        W-TROVATO          EQUAL  'NO'                            00194000
194100        GO TO G1-010-TRIB-UFFNUM-EX.                              00194100
194200*---                                                              00194200
194300 G1-020.                                                          00194300
194400     IF W-TIPO-TRIB-OUT  EQUAL 'F'                                00194400
194500        MOVE 'N'           TO W-FLAG-OBBL-UFF                     00194500
194600        MOVE 'N'           TO W-FLAG-OBBL-NUM.                    00194600
194700*AN INIZIO MODIFICA MAGGIO 2004 - INPDAP                          00194700
194800     IF W-TIPO-TRIB-OUT EQUAL 'E'                                 00194800
194900        MOVE 'N'           TO W-FLAG-OBBL-UFF                     00194900
195000        MOVE 'S'           TO W-FLAG-OBBL-NUM.                    00195000
195100*AN FINE   MODIFICA MAGGIO 2004 - INPDAP                          00195100
195200*---                                                              00195200
195300 G1-030.                                                          00195300
195400     IF W-TIPO-TRIB-OUT  EQUAL 'G'                                00195400
195500        MOVE 'S'           TO W-FLAG-OBBL-UFF                     00195500
195600        MOVE 'N'           TO W-FLAG-OBBL-NUM.                    00195600
195700*---                                                              00195700
195800 G1-040.                                                          00195800
195900     IF W-TIPO-TRIB-OUT  EQUAL 'H' OR                             00195900
196000        W-TIPO-TRIB-OUT  EQUAL 'J' OR                             00196000
196100        W-TIPO-TRIB-OUT  EQUAL 'K'                                00196100
196200        MOVE 'N'           TO W-FLAG-OBBL-UFF                     00196200
196300        MOVE 'S'           TO W-FLAG-OBBL-NUM.                    00196300
196400*---                                                              00196400
196500 G1-050.                                                          00196500
196600     IF W-TIPO-TRIB-OUT  EQUAL 'I'                                00196600
196700        MOVE 'S'           TO W-FLAG-OBBL-UFF                     00196700
196800        MOVE 'S'           TO W-FLAG-OBBL-NUM.                    00196800
196900*---                                                              00196900
197000 G1-060.                                                          00197000
197100     IF W-TIPO-TRIB-OUT  EQUAL 'L'                                00197100
197200        MOVE 'N'           TO W-FLAG-OBBL-UFF                     00197200
197300        MOVE 'S'           TO W-FLAG-OBBL-NUM.                    00197300
197400*                                                                 00197400
197500     IF  W-TIPO-TRIB-OUT  EQUAL 'L'                               00197500
197600     AND (W-COD-TRIB = '8065' OR '8066' OR '8067'                 00197600
197700                    OR '8068' OR '8069' OR '8060'                 00197700
197800                    OR '8071' OR '8072' OR '8073'                 00197800
197900                    OR '8074' OR '8081'                           00197900
198000                    OR '8090' OR '8091' OR '8092'                 00198000
198100                    OR '8093' OR '8094' OR '8101'                 00198100
198200                    OR '8102' OR '8103' OR '8104'                 00198200
198300                    OR '8105' OR '8106')                          00198300
198400        MOVE 'N'           TO W-FLAG-OBBL-UFF                     00198400
198500        MOVE 'N'           TO W-FLAG-OBBL-NUM.                    00198500
198600*---                                                              00198600
198700 G1-070.                                                          00198700
198800*---                                                              00198800
198900     PERFORM A2-010-OBBL-UFF THRU A2-010-OBBL-UFF-EX.             00198900
199000     PERFORM B2-010-OBBL-NUM THRU B2-010-OBBL-NUM-EX.             00199000
199100*---                                                              00199100
199200 G1-010-TRIB-UFFNUM-EX.                                           00199200
199300     EXIT.                                                        00199300
199400*-----------------------------------------------------------      00199400
199500*---      PERFORM PER IL CONTROLLO DEL CODICE FISCALE E           00199500
199600*---      NUMERO DI RIFERIMENTO CONTEMPORANEAMENTE ERRATI         00199600
199700*----------------------------------------------------------       00199700
199800 H1-010-FISC-NUM.                                                 00199800
199900*----                                                             00199900
200000*--- SE IL TIPO RECORD E' V03 (REGIONI) NON SI EFFETTUA           00200000
200100*--- IL CONTROLLO                                                 00200100
200200     IF W-TIPO-RECORD      EQUAL  'V03'                           00200200
200300        GO TO H1-010-FISC-NUM-EX.                                 00200300
200400*---                                                              00200400
200500*--- SE IL TIPO TRIBUTO NON PREVEDE IL NUMERO DI RIFERIMENTO      00200500
200600*--- NON SI EFFETTUA IL CONTROLLO                                 00200600
200700 H1-020.                                                          00200700
200800     IF W-TIPO-TRIB-OUT  EQUAL 'F' OR                             00200800
200900        W-TIPO-TRIB-OUT  EQUAL 'G' OR                             00200900
201000*AN INIZIO MODIFICA MAGGIO 2004 - INPDAP                          00201000
201100        W-TIPO-TRIB-OUT  EQUAL 'E' OR                             00201100
201200*AN FINE   MODIFICA MAGGIO 2004 - INPDAP                          00201200
201300        W-TIPO-TRIB-OUT  EQUAL SPACE                              00201300
201400        GO TO H1-010-FISC-NUM-EX.                                 00201400
201500*---                                                              00201500
201600*--- SE IL CODICE FISCALE E IL NUMERO RIFERIMENTO SONO ERRATI     00201600
201700*--- ERRORE                                                       00201700
201800 H1-030.                                                          00201800
201900     IF W-COD-FISC-KO NOT = '1' OR                                00201900
202000        W-NUM-RIF-KO  NOT = '1'                                   00202000
202100        GO TO H1-010-FISC-NUM-EX.                                 00202100
202200 H1-040.                                                          00202200
202300     IF W-SEGNAL-NUM-RIF EQUAL '0' OR SPACE                       00202300
202400        ADD 1                     TO W-CTR2.                      00202400
202500     MOVE 888                     TO W-ERR-NUMERO-RIF             00202500
202600     MOVE 'E'                     TO W-SEGNAL-NUM-RIF.            00202600
202700*---                                                              00202700
202800 H1-010-FISC-NUM-EX.                                              00202800
202900     EXIT.                                                        00202900
203000*---                                                              00203000
203100 A2-010-OBBL-UFF.                                                 00203100
203200*----                                                             00203200
203300     IF W-FLAG-OBBL-UFF = 'S'                                     00203300
203400         GO TO A2-070.                                            00203400
203500 A2-020.                                                          00203500
203600*----                                                             00203600
203700     IF W-UFFICIO-RIF EQUAL SPACES  OR                            00203700
203800        W-UFFICIO-RIF EQUAL ZERO                                  00203800
203900        GO TO A2-050.                                             00203900
204000*---                                                              00204000
204100 A2-030.                                                          00204100
204200*---                                                              00204200
204300     IF W-FLAG-ERR-UFFICIO EQUAL '1'                              00204300
204400        GO TO A2-010-OBBL-UFF-EX.                                 00204400
204500*---                                                              00204500
204600 A2-040.                                                          00204600
204700*---   ERRORE NON BLOCCANTE                                       00204700
204800     IF W-ERR-FLAG-ERR-UFFICIO EQUAL ZERO                         00204800
204900        MOVE 24                      TO W-ERR-FLAG-ERR-UFFICIO    00204900
205000        ADD 1                        TO W-CTR1                    00205000
205100        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-UFF.    00205100
205200     GO TO A2-010-OBBL-UFF-EX.                                    00205200
205300*---                                                              00205300
205400 A2-050.                                                          00205400
205500*---                                                              00205500
205600     IF W-FLAG-ERR-UFFICIO EQUAL ZERO                             00205600
205700        GO TO A2-010-OBBL-UFF-EX.                                 00205700
205800 A2-060.                                                          00205800
205900*---   ERRORE NON BLOCCANTE                                       00205900
206000     IF W-ERR-FLAG-ERR-UFFICIO EQUAL ZERO                         00206000
206100        MOVE 24                      TO W-ERR-FLAG-ERR-UFFICIO    00206100
206200        ADD 1                        TO W-CTR1                    00206200
206300        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-UFF.    00206300
206400     GO TO A2-010-OBBL-UFF-EX.                                    00206400
206500*----                                                             00206500
206600 A2-070.                                                          00206600
206700*---                                                              00206700
206800     IF W-UFFICIO-RIF NOT EQUAL SPACES  AND                       00206800
206900        W-UFFICIO-RIF NOT EQUAL ZERO                              00206900
207000        GO TO A2-100.                                             00207000
207100*---                                                              00207100
207200 A2-080.                                                          00207200
207300*---                                                              00207300
207400     IF W-FLAG-ERR-UFFICIO   EQUAL  '1'                           00207400
207500        GO TO A2-010-OBBL-UFF-EX.                                 00207500
207600*---                                                              00207600
207700 A2-090.                                                          00207700
207800*---                                                              00207800
207900*     EVIDENZIARE L'ERRORE                                        00207900
208000*---   ERRORI                                                     00208000
208100     MOVE 96                      TO W-ERR-UFFICIO-RIF.           00208100
208200     ADD 1                        TO W-CTR2.                      00208200
208300     MOVE 'E'                     TO W-SEGNAL-UFF-RIF.            00208300
208400     IF W-ERR-FLAG-ERR-UFFICIO EQUAL ZERO                         00208400
208500       MOVE 24                      TO W-ERR-FLAG-ERR-UFFICIO     00208500
208600       ADD 1                        TO W-CTR2                     00208600
208700       MOVE 'E'                     TO W-SEGNAL-FLAG-ERR-UFF.     00208700
208800     GO TO A2-010-OBBL-UFF-EX.                                    00208800
208900*---                                                              00208900
209000 A2-100.                                                          00209000
209100*---                                                              00209100
209200     IF W-FLAG-ERR-UFFICIO EQUAL ZERO                             00209200
209300        GO TO A2-010-OBBL-UFF-EX.                                 00209300
209400*---                                                              00209400
209500 A2-110.                                                          00209500
209600*---   ERRORE NON BLOCCANTE                                       00209600
209700     IF W-ERR-FLAG-ERR-UFFICIO EQUAL ZERO AND                     00209700
209800        W-UFF-KO           NOT EQUAL 'KO'                         00209800
209900        MOVE 24                      TO W-ERR-FLAG-ERR-UFFICIO    00209900
210000        ADD 1                        TO W-CTR1                    00210000
210100        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-UFF.    00210100
210200*---                                                              00210200
210300 A2-010-OBBL-UFF-EX.                                              00210300
210400     EXIT.                                                        00210400
210500 B2-010-OBBL-NUM.                                                 00210500
210600*----                                                             00210600
210700     IF W-NUMERO-RIF NOT NUMERIC                                  00210700
210800        GO TO B2-010-OBBL-NUM-EX.                                 00210800
210900 B2-020.                                                          00210900
211000*----                                                             00211000
211100     IF W-FLAG-OBBL-NUM = 'S'                                     00211100
211200        GO TO B2-080.                                             00211200
211300 B2-030.                                                          00211300
211400*----                                                             00211400
211500     IF W-NUMERO-RIF EQUAL ZERO                                   00211500
211600        GO TO B2-060.                                             00211600
211700*---                                                              00211700
211800 B2-040.                                                          00211800
211900*---                                                              00211900
212000*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00212000
212100*---   RELATIVO AL NUMERO                                         00212100
212200     IF W-FLAG-ERR-NUMERO EQUAL '1'                               00212200
212300        GO TO B2-010-OBBL-NUM-EX.                                 00212300
212400*---                                                              00212400
212500 B2-050.                                                          00212500
212600*---   ERRORE NON BLOCCANTE                                       00212600
212700     IF W-ERR-FLAG-ERR-NUMERO EQUAL ZERO                          00212700
212800        MOVE 24                      TO W-ERR-FLAG-ERR-NUMERO     00212800
212900        ADD 1                        TO W-CTR1                    00212900
213000        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-NUM.    00213000
213100     GO TO B2-010-OBBL-NUM-EX.                                    00213100
213200*---                                                              00213200
213300 B2-060.                                                          00213300
213400*---                                                              00213400
213500*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00213500
213600*---   RELATIVO AL NUMERO                                         00213600
213700*---                                                              00213700
213800     IF W-FLAG-ERR-NUMERO EQUAL ZERO                              00213800
213900        GO TO B2-010-OBBL-NUM-EX.                                 00213900
214000 B2-070.                                                          00214000
214100*---   ERRORE NON BLOCCANTE                                       00214100
214200     IF W-ERR-FLAG-ERR-NUMERO EQUAL ZERO                          00214200
214300        MOVE 24                      TO W-ERR-FLAG-ERR-NUMERO     00214300
214400        ADD 1                        TO W-CTR1                    00214400
214500        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-NUM.    00214500
214600     GO TO B2-010-OBBL-NUM-EX.                                    00214600
214700*---                                                              00214700
214800 B2-080.                                                          00214800
214900     IF W-NUMERO-RIF NOT EQUAL ZERO OR                            00214900
215000        COD-ATTO = 'FA'                                           00215000
215100        GO TO B2-110                                              00215100
215200     END-IF.                                                      00215200
215300*---                                                              00215300
215400 B2-090.                                                          00215400
215500*---                                                              00215500
215600     MOVE '1'                     TO W-NUM-RIF-KO.                00215600
215700     IF W-FLAG-ERR-NUMERO  EQUAL '1'                              00215700
215800        GO TO B2-010-OBBL-NUM-EX.                                 00215800
215900*---                                                              00215900
216000 B2-100.                                                          00216000
216100*---   ERRORI                                                     00216100
216200     MOVE 96                      TO W-ERR-NUMERO-RIF.            00216200
216300     ADD 1                        TO W-CTR2.                      00216300
216400     MOVE 'E'                     TO W-SEGNAL-NUM-RIF.            00216400
216500*---                                                              00216500
216600*--- CONTROLLO SE IL CAMPO ERRORE DEL FLAG                        00216600
216700*--- E' IMPOSTATO O NO.                                           00216700
216800     IF W-ERR-FLAG-ERR-NUMERO EQUAL ZERO                          00216800
216900        MOVE 24                      TO W-ERR-FLAG-ERR-NUMERO     00216900
217000        ADD 1                        TO W-CTR2                    00217000
217100        MOVE 'E'                     TO W-SEGNAL-FLAG-ERR-NUM.    00217100
217200     GO TO B2-010-OBBL-NUM-EX.                                    00217200
217300*---                                                              00217300
217400 B2-110.                                                          00217400
217500     IF W-FLAG-ERR-NUMERO EQUAL ZERO                              00217500
217600        GO TO B2-010-OBBL-NUM-EX.                                 00217600
217700*---                                                              00217700
217800 B2-120.                                                          00217800
217900*---   ERRORE NON BLOCCANTE                                       00217900
218000     IF W-ERR-FLAG-ERR-NUMERO EQUAL ZERO AND                      00218000
218100        W-NUM-KO          NOT EQUAL 'KO'                          00218100
218200        MOVE 24                      TO W-ERR-FLAG-ERR-NUMERO     00218200
218300        ADD 1                        TO W-CTR1                    00218300
218400        MOVE 'W'                     TO W-SEGNAL-FLAG-ERR-NUM.    00218400
218500*---                                                              00218500
218600 B2-010-OBBL-NUM-EX.                                              00218600
218700     EXIT.                                                        00218700
218800*---------------------------------------------------------        00218800
218900*--- PERFORM DI CONTROLLO DEL PERIODO 00TRAAAA          -*        00218900
219000*---------------------------------------------------------        00219000
219100 B4-010-00TRAAAA.                                                 00219100
219200*---                                                              00219200
219300*A -- MODIFICA 3/2/2006 - FORMALISMO T3                           00219300
219400*---                                                              00219400
219500*--- PER FORMALISMI T0, T1, T2 SI UTILIZZA LA PERFORM B4          00219500
219600*--- PER I FORMALISMI DA T3 IN POI SI RICHIAMA LA B5              00219600
219700*                                                                 00219700
219800     MOVE W-TIPO-PER-OUT TO  W-APPO-FORMAL.                       00219800
219900     IF W-APPO-FORMAL-R EQUAL 3                                   00219900
220000         PERFORM B5-010-00T3AAAA   THRU  B5-990-EX                00220000
220100         GO TO B4-990-EX                                          00220100
220200     END-IF.                                                      00220200
220300*---                                                              00220300
220400     IF W-APPO-FORMAL-R EQUAL 4                                   00220400
220500         PERFORM B6-010-00T4AAAA   THRU  B6-990-EX                00220500
220600         GO TO B4-990-EX                                          00220600
220700     END-IF.                                                      00220700
220800*                                                                 00220800
220900     IF W-APPO-FORMAL-R EQUAL 2 OR                                00220900
221000        (W-APPO-PER-RIF-NU NOT EQUAL '  ' AND                     00221000
221100         W-APPO-PER-RIF-NU NOT EQUAL '00' AND                     00221100
221200         (W-COD-TRIB = 'T010' OR                                  00221200
221300          W-COD-TRIB = '806T'))                                   00221300
221400         PERFORM T2-010   THRU  T2-990-EX                         00221400
221500         GO TO B4-990-EX                                          00221500
221600     END-IF.                                                      00221600
221700*                                                                 00221700
221800     IF W-APPO-FORMAL-R EQUAL 0                                   00221800
221900         PERFORM T0-010   THRU  T0-990-EX                         00221900
222000         GO TO B4-990-EX                                          00222000
222100     END-IF.                                                      00222100
222200*                                                                 00222200
222300     IF W-APPO-FORMAL-R EQUAL 1                                   00222300
222400         PERFORM T1-010   THRU  T1-990-EX                         00222400
222500         GO TO B4-990-EX                                          00222500
222600     END-IF.                                                      00222600
222700*                                                                 00222700
222800     IF W-APPO-FORMAL-R EQUAL 7                                   00222800
222900         PERFORM T7-010   THRU  T7-990-EX                         00222900
223000         GO TO B4-990-EX                                          00223000
223100     END-IF.                                                      00223100
223200*                                                                 00223200
223300 B4-990-EX.                                                       00223300
223400     EXIT.                                                        00223400
223500*---------------------------------------------------------        00223500
223600*--- PERFORM DI CONTROLLO DEL PERIODO 00TRAAAA - DA T3  -*        00223600
223700*---------------------------------------------------------        00223700
223800 B5-010-00T3AAAA.                                                 00223800
223900*---                                                              00223900
224000*---  SI ACCEDE PER CODICE FORMALISMO ALLA TABELLA COD-T3         00224000
224100*---                                                              00224100
224200     SET W-PUNT-T3 TO 1.                                          00224200
224300     SEARCH W-TAB-COD-T3-EL                                       00224300
224400            AT END MOVE ZERO TO W-FLAG-TROVATO                    00224400
224500     WHEN W-TAB-T3-COD-FORMAL(W-PUNT-T3) = W-APPO-FORMAL-TR AND   00224500
224600          W-TAB-T3-CODICE(W-PUNT-T3)     = W-APPO-PER-RIF-XXXX    00224600
224700          AND                                                     00224700
224800          W-TAB-T3-INIZIO-VAL(W-PUNT-T3) NOT > W-DATA-RISC AND    00224800
224900          W-TAB-T3-FINE-VAL(W-PUNT-T3)   NOT < W-DATA-RISC        00224900
225000                   MOVE 1    TO W-FLAG-TROVATO.                   00225000
225100*                                                                 00225100
225200 B5-020.                                                          00225200
225300*                                                                 00225300
225400*---   SI CONTROLLA SE NON E' STATO TROVATO IN TABELLA            00225400
225500*---   ERRORI SU PERIODO E SU FLAG (SEMPRE)                       00225500
225600*---                                                              00225600
225700     IF W-FLAG-TROVATO = ZERO                                     00225700
225800         MOVE 96                      TO W-ERR-PERIODO            00225800
225900         ADD 1                        TO W-CTR2                   00225900
226000         MOVE 'E'                     TO W-SEGNAL-PERIODO         00226000
226100         IF W-ERR-FLAG-PER  EQUAL ZERO                            00226100
226200             MOVE 24                  TO W-ERR-FLAG-PER           00226200
226300             ADD 1                    TO W-CTR2                   00226300
226400             MOVE 'E'                 TO W-SEGNAL-FLAG-PER        00226400
226500         END-IF                                                   00226500
226600         GO TO B5-990-EX                                          00226600
226700     END-IF.                                                      00226700
226800*                                                                 00226800
226900 B5-030.                                                          00226900
227000*---                                                              00227000
227100*---  CODICE TROVATO                                              00227100
227200*--- (GLI EVENTUALI ALTRI ERRORI SUL PERIODO DI RIFERIMENTO       00227200
227300*---  - SOLO SU ANNO - SONO FORZABILI IMPOSTANDO IL FLAG)         00227300
227400*---                                                              00227400
227500     IF W-APPO-PER-RIF-ANNO  GREATER    '1900'          AND       00227500
227600        W-APPO-PER-RIF-ANNO  NUMERIC                    AND       00227600
227700        W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1       00227700
227800        GO TO  B5-090.                                            00227800
227900 B5-040.                                                          00227900
228000*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00228000
228100*--- (ERRORE SOLO SU ANNO)                                        00228100
228200*---                                                              00228200
228300     IF W-FLAG-PER EQUAL '1'                                      00228300
228400       GO TO B5-080.                                              00228400
228500 B5-070.                                                          00228500
228600*---   ERRORI                                                     00228600
228700     MOVE 96                      TO W-ERR-PERIODO.               00228700
228800     ADD 1                        TO W-CTR2.                      00228800
228900     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00228900
229000     IF W-ERR-FLAG-PER EQUAL ZERO                                 00229000
229100       MOVE 24                      TO W-ERR-FLAG-PER             00229100
229200       ADD 1                        TO W-CTR2                     00229200
229300       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00229300
229400     GO TO B5-990-EX.                                             00229400
229500*                                                                 00229500
229600 B5-080.                                                          00229600
229700*                                                                 00229700
229800     GO TO B5-990-EX.                                             00229800
229900*---                                                              00229900
230000 B5-090.                                                          00230000
230100*---                                                              00230100
230200*---   IL CODICE TERRITORIALITA' ESISTE IN TABELLA                00230200
230300*---   E NON CI SONO ALTRI ERRORI                                 00230300
230400*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00230400
230500*---   RELATIVO AL PERIODO                                        00230500
230600*---                                                              00230600
230700     IF W-FLAG-PER NOT EQUAL '1'                                  00230700
230800       GO TO B5-990-EX.                                           00230800
230900 B5-100.                                                          00230900
231000*---   ERRORE NON BLOCCANTE                                       00231000
231100     ADD 1                        TO W-CTR1.                      00231100
231200     MOVE 24                      TO W-ERR-FLAG-PER.              00231200
231300     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00231300
231400*                                                                 00231400
231500 B5-990-EX.                                                       00231500
231600     EXIT.                                                        00231600
231700*---                                                              00231700
231800*-------------------------------------------------------------    00231800
231900*---   I TRIBUTI 6706 E 6707 SONO RELATIVI ALLE AGEVOLAZIONI      00231900
232000*---   FISCALI E SONO VALIDI SOLO PER I CONCESSIONARI             00232000
232100*--- SE FLAG AGEVOLAZIONE VALE ZERO                               00232100
232200 X1-010-AGEV.                                                     00232200
232300     MOVE ZERO TO W-KO-AGEV.                                      00232300
232400*    IF W-TIPO-RECORD = 'V03'                                     00232400
232500*       GO TO X1-010-AGEV-EX.                                     00232500
232600 X1-020-AGEV.                                                     00232600
232700     IF W-FLAG-TROVATO = ZERO                                     00232700
232800        GO TO X1-010-AGEV-EX.                                     00232800
232900 X1-030-AGEV.                                                     00232900
233000     MOVE W-COD-TRIB TO W-TRIBUTI-AGEV.                           00233000
233100*** INIZIO MODIFICA TRIBUTI CONCESSIONARI                         00233100
233200*    IF ( W-TIPO-RECORD = 'V01' AND                               00233200
233300*           W-TRIBUTI-AGEV NOT = W-TRIB-6603 AND                  00233300
233400*           W-TRIBUTI-AGEV NOT = W-TRIB-6706 AND                  00233400
233500*           W-TRIBUTI-AGEV NOT = W-TRIB-6707 )                    00233500
233600*    OR ( W-TIPO-RECORD = 'V03' AND                               00233600
233700*           W-TRIBUTI-AGEV NOT = W-TRIB-3888 AND                  00233700
233800*           W-TRIBUTI-AGEV NOT = W-TRIB-3889 AND                  00233800
233900*           W-TRIBUTI-AGEV NOT = W-TRIB-3890 )                    00233900
234000     IF W-FLAG-TROVATO = 1 AND                                    00234000
234100        FLAG-TRIB-CONC = '0'                                      00234100
234200     THEN                                                         00234200
234300        GO TO X1-010-AGEV-EX                                      00234300
234400     END-IF.                                                      00234400
234500     IF W-FLAG-TROVATO = 1 AND                                    00234500
234600        FLAG-TRIB-CONC = '1'                                      00234600
234700     THEN                                                         00234700
234800            MOVE '1' TO W-FLAG-TRIB-CONC                          00234800
234900     END-IF.                                                      00234900
235000*** FINE MODIFICA TRIBUTI CONCESSIONARI                           00235000
235100 X1-040-AGEV.                                                     00235100
235200     IF W-PROV = 'B'                                              00235200
235300        MOVE ZERO TO W-FLAG-TROVATO                               00235300
235400        GO TO X1-010-AGEV-EX.                                     00235400
235500     IF W-TIPO-RECORD = 'V03' THEN                                00235500
235600        GO TO X1-010-AGEV-EX.                                     00235600
235700 X1-050-AGEV.                                                     00235700
235800*--- W-PROV = 'C' CONTROLLO CHE FLAG-AGEVOLAZIONE VALE ZERO       00235800
235900*--- (SOLO PER RECORD V01)                                        00235900
236000     IF BQVFB21-01-FLAG-AGEV EQUAL '1'                            00236000
236100        MOVE ZERO TO W-FLAG-TROVATO                               00236100
236200        MOVE '1' TO W-KO-AGEV                                     00236200
236300        GO TO X1-010-AGEV-EX.                                     00236300
236400 X1-010-AGEV-EX.                                                  00236400
236500     EXIT.                                                        00236500
236600******************************************************************00236600
236700*                                                                 00236700
236800 TRIB-010.                                                        00236800
236900*                                                                 00236900
237000     SET W-PUNT-TRIB TO 1.                                        00237000
237100     SEARCH W-TAB-TRIB-EL                                         00237100
237200            AT END MOVE ZERO TO W-FLAG-TROVATO                    00237200
237300     WHEN W-TAB-TRIB-COD(W-PUNT-TRIB)     = W-COD-TRIB      AND   00237300
237400          W-TAB-TRIB-INI-VAL(W-PUNT-TRIB) NOT > W-DATA-RISC AND   00237400
237500          W-TAB-TRIB-FIN-VAL(W-PUNT-TRIB) NOT < W-DATA-RISC       00237500
237600     MOVE 1                               TO W-FLAG-TROVATO.      00237600
237700*                                                                 00237700
237800     IF W-FLAG-TROVATO = 0                                        00237800
237900        GO TO TRIB-EXIT.                                          00237900
238000*                                                                 00238000
238100 TRIB-020.                                                        00238100
238200*                                                                 00238200
238300     IF W-FLAG-TROVATO = 1                                        00238300
238400        MOVE '0' TO W-FLAG-TRIB                                   00238400
238500        GO TO TRIB-EXIT.                                          00238500
238600*                                                                 00238600
238700 TRIB-EXIT.                                                       00238700
238800     EXIT.                                                        00238800
238900*                                                                 00238900
239000     EXIT.                                                        00239000
239100 B9-010-PER-RIF.                                                  00239100
239200*---   PERIODO IN FORMATO 00MMAAAA                                00239200
239300*---   SI ATTIVA LA PERFORM CHE EFFETTUA I CONTROLLI RELATIVI     00239300
239400*---                                                              00239400
239500     IF W-APPO-PER-RIF-RA    EQUAL      ZERO    AND               00239500
239600        W-APPO-PER-RIF-NU    NOT LESS    '01'   AND               00239600
239700        W-APPO-PER-RIF-NU    NOT GREATER '12'   AND               00239700
239800        W-APPO-PER-RIF-NU    NUMERIC            AND               00239800
239900        W-APPO-PER-RIF-ANNO  GREATER    '1900'  AND               00239900
240000        W-APPO-PER-RIF-ANNO  NUMERIC            AND               00240000
240100        W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1       00240100
240200        GO TO  B9-160.                                            00240200
240300 B9-130.                                                          00240300
240400*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00240400
240500*---                                                              00240500
240600     IF W-FLAG-PER EQUAL '1'                                      00240600
240700       GO TO B9-150.                                              00240700
240800 B9-140.                                                          00240800
240900*---   ERRORI                                                     00240900
241000     MOVE 96                      TO W-ERR-PERIODO.               00241000
241100     ADD 1                        TO W-CTR2.                      00241100
241200     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00241200
241300     IF W-ERR-FLAG-PER EQUAL ZERO                                 00241300
241400       MOVE 24                      TO W-ERR-FLAG-PER             00241400
241500       ADD 1                        TO W-CTR2                     00241500
241600       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00241600
241700     GO TO B9-010-PER-RIF-EX.                                     00241700
241800 B9-150.                                                          00241800
241900*---   OMOGENEITA'                                                00241900
242000     GO TO B9-010-PER-RIF-EX.                                     00242000
242100 B9-160.                                                          00242100
242200*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00242200
242300*---   RELATIVO AL PERIODO                                        00242300
242400*---                                                              00242400
242500     IF W-FLAG-PER EQUAL ZERO                                     00242500
242600        GO TO B9-010-PER-RIF-EX.                                  00242600
242700 B9-170.                                                          00242700
242800     IF W-FLAG-PER NOT EQUAL '1'                                  00242800
242900        GO TO B9-010-PER-RIF-EX.                                  00242900
243000 B9-180.                                                          00243000
243100*---   ERRORE NON BLOCCANTE                                       00243100
243200     ADD 1                        TO W-CTR1.                      00243200
243300     MOVE 24                      TO W-ERR-FLAG-PER.              00243300
243400     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00243400
243500     GO TO B9-010-PER-RIF-EX.                                     00243500
243600 B9-010-PER-RIF-EX.                                               00243600
243700     EXIT.                                                        00243700
243800*                                                                 00243800
243900 J2-010.                                                          00243900
244000*                                                                 00244000
244100     SET W-PUNT-COTR TO 1.                                        00244100
244200     SEARCH W-TAB-COMP-TRIB-EL                                    00244200
244300            AT END MOVE ZERO TO W-FLAG-TROVATO                    00244300
244400     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00244400
244500          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00244500
244600                   W-DATA-RISC                                AND 00244600
244700          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00244700
244800                   W-DATA-RISC                                AND 00244800
244900          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00244900
245000          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IVA'           00245000
245100     MOVE 1                               TO W-FLAG-TROVATO.      00245100
245200*                                                                 00245200
245300     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00245300
245400*                                                                 00245400
245500     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00245500
245600*                                                                 00245600
245700 J2-020.                                                          00245700
245800*                                                                 00245800
245900*                                                                 00245900
246000     IF W-FLAG-TROVATO = 0                                        00246000
246100       GO TO J2-050.                                              00246100
246200*                                                                 00246200
246300 J2-030.                                                          00246300
246400*                                                                 00246400
246500*                                                                 00246500
246600 J2-040.                                                          00246600
246700*                                                                 00246700
246800     MOVE '1' TO W-FLAG-COMP-IVA.                                 00246800
246900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00246900
247000        W-IMP-RIMB > ZERO AND                                     00247000
247100        W-ANNO-RIFERIMENTO NOT LESS                               00247100
247200                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00247200
247300        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-V                  00247300
247400        MOVE '1' TO W-FLAG-RIF-V-T                                00247400
247500     END-IF.                                                      00247500
247600*                                                                 00247600
247700     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00247700
247800        W-IMP-RIMB > ZERO AND                                     00247800
247900        W-ANNO-RIFERIMENTO NOT LESS                               00247900
248000                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00248000
248100        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-V                  00248100
248200        MOVE '1' TO W-FLAG-RIF-V-A                                00248200
248300     END-IF.                                                      00248300
248400*                                                                 00248400
248500     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00248500
248600        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00248600
248700          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00248700
248800         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00248800
248900          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00248900
249000         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00249000
249100          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00249100
249200        W-IMP-RIMB > ZERO                                         00249200
249300          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00249300
249400                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00249400
249500          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00249500
249600                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00249600
249700          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00249700
249800             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00249800
249900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-V           00249900
250000               MOVE '1' TO W-FLAG-RIF-V-T                         00250000
250100          END-IF                                                  00250100
250200          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00250200
250300             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00250300
250400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-V           00250400
250500               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00250500
250600          END-IF                                                  00250600
250700     END-IF.                                                      00250700
250800*                                                                 00250800
250900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00250900
251000        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00251000
251100        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00251100
251200        W-IMP-RIMB > ZERO                                         00251200
251300          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00251300
251400                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00251400
251500          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00251500
251600                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00251600
251700          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00251700
251800             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00251800
251900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-V           00251900
252000               MOVE '1' TO W-FLAG-RIF-V-A                         00252000
252100          END-IF                                                  00252100
252200          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00252200
252300             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00252300
252400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-V           00252400
252500               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00252500
252600          END-IF                                                  00252600
252700     END-IF.                                                      00252700
252800*                                                                 00252800
252900 J2-050.                                                          00252900
253000*                                                                 00253000
253100     SET W-PUNT-COTR TO 1.                                        00253100
253200     SEARCH W-TAB-COMP-TRIB-EL                                    00253200
253300            AT END MOVE ZERO TO W-FLAG-TROVATO                    00253300
253400     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00253400
253500                                          = W-COD-TRIB AND        00253500
253600          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IVA'AND        00253600
253700          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00253700
253800                   W-DATA-RISC                         AND        00253800
253900          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00253900
254000                   W-DATA-RISC                         AND        00254000
254100          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00254100
254200     MOVE 1                               TO W-FLAG-TROVATO.      00254200
254300*                                                                 00254300
254400 J2-060.                                                          00254400
254500*                                                                 00254500
254600     IF W-FLAG-TROVATO = 0                                        00254600
254700       GO TO J2-090.                                              00254700
254800*                                                                 00254800
254900 J2-070.                                                          00254900
255000*                                                                 00255000
255100*                                                                 00255100
255200 J2-080.                                                          00255200
255300*                                                                 00255300
255400     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-V.            00255400
255500*                                                                 00255500
255600 J2-090.                                                          00255600
255700*                                                                 00255700
255800     SET W-PUNT-COTR TO 1.                                        00255800
255900     SEARCH W-TAB-COMP-TRIB-EL                                    00255900
256000            AT END MOVE ZERO TO W-FLAG-TROVATO                    00256000
256100     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00256100
256200                                          = W-COD-TRIB  AND       00256200
256300          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR)   = 'C' AND       00256300
256400          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00256400
256500                   W-DATA-RISC                          AND       00256500
256600          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00256600
256700                   W-DATA-RISC                          AND       00256700
256800          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IVA' AND   00256800
256900          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IRS' AND   00256900
257000          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IRP' AND   00257000
257100          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IRM' AND   00257100
257200          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IRF' AND   00257200
257300          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'ADX' AND   00257300
257400          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IIE' AND   00257400
257500          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IFE' AND   00257500
257600          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'FF1' AND   00257600
257700          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'FF2' AND   00257700
257800          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'FF3' AND   00257800
257900          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'ORO' AND   00257900
258000          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'SEC' AND   00258000
258100          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IEC' AND   00258100
258200          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'LEZ' AND   00258200
258300          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'QR1' AND   00258300
258400          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'BTC'       00258400
258500     MOVE 1                               TO W-FLAG-TROVATO.      00258500
258600*                                                                 00258600
259100 J2-100.                                                          00259100
259200*                                                                 00259200
259300     IF W-FLAG-TROVATO = 0                                        00259300
259400       GO TO J2-EXIT.                                             00259400
259500*                                                                 00259500
259600 J2-110.                                                          00259600
259700*                                                                 00259700
259800*                                                                 00259800
259900 J2-120.                                                          00259900
260000*                                                                 00260000
260400     IF W-IMP-RIMB > ZERO                                         00260400
260500        MOVE '1' TO W-FLAG-RIF-C.                                 00260500
260600*                                                                 00260600
260700 J2-EXIT.                                                         00260700
260800*                                                                 00260800
260900     EXIT.                                                        00260900
261000*                                                                 00261000
261100*                                                                 00261100
261200 J3-010.                                                          00261200
261300*                                                                 00261300
261400     SET W-PUNT-COTR TO 1.                                        00261400
261500     SEARCH W-TAB-COMP-TRIB-EL                                    00261500
261600            AT END MOVE ZERO TO W-FLAG-TROVATO                    00261600
261700     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00261700
261800          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00261800
261900                   W-DATA-RISC                                AND 00261900
262000          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00262000
262100                   W-DATA-RISC                                AND 00262100
262200          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00262200
262300          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IRS'           00262300
262400     MOVE 1                               TO W-FLAG-TROVATO.      00262400
262500*                                                                 00262500
262600     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00262600
262700*                                                                 00262700
262800     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00262800
262900*                                                                 00262900
263000 J3-020.                                                          00263000
263100*                                                                 00263100
263200*                                                                 00263200
263300     IF W-FLAG-TROVATO = 0                                        00263300
263400       GO TO J3-050.                                              00263400
263500*                                                                 00263500
263600 J3-030.                                                          00263600
263700*                                                                 00263700
263800*                                                                 00263800
263900 J3-040.                                                          00263900
264000*                                                                 00264000
264100     MOVE '1' TO W-FLAG-COMP-IRS.                                 00264100
264200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00264200
264300        W-IMP-RIMB > ZERO AND                                     00264300
264400        W-ANNO-RIFERIMENTO NOT LESS                               00264400
264500                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00264500
264600        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-I                  00264600
264700        MOVE '1' TO W-FLAG-RIF-I-T                                00264700
264800     END-IF.                                                      00264800
264900*                                                                 00264900
265000     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00265000
265100        W-IMP-RIMB > ZERO AND                                     00265100
265200        W-ANNO-RIFERIMENTO NOT LESS                               00265200
265300                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00265300
265400        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-I                  00265400
265500        MOVE '1' TO W-FLAG-RIF-I-A                                00265500
265600     END-IF.                                                      00265600
265700*                                                                 00265700
265800     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00265800
265900        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00265900
266000          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00266000
266100         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00266100
266200          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00266200
266300         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00266300
266400          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00266400
266500        W-IMP-RIMB > ZERO                                         00266500
266600          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00266600
266700                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00266700
266800          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00266800
266900                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00266900
267000          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00267000
267100             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00267100
267200               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-I           00267200
267300               MOVE '1' TO W-FLAG-RIF-I-T                         00267300
267400          END-IF                                                  00267400
267500          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00267500
267600             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00267600
267700               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-I           00267700
267800               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00267800
267900          END-IF                                                  00267900
268000     END-IF.                                                      00268000
268100*                                                                 00268100
268200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00268200
268300        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00268300
268400        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00268400
268500        W-IMP-RIMB > ZERO                                         00268500
268600          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00268600
268700                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00268700
268800          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00268800
268900                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00268900
269000          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00269000
269100             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00269100
269200               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-I           00269200
269300               MOVE '1' TO W-FLAG-RIF-I-A                         00269300
269400          END-IF                                                  00269400
269500          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00269500
269600             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00269600
269700               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-I           00269700
269800               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00269800
269900          END-IF                                                  00269900
270000     END-IF.                                                      00270000
270100*                                                                 00270100
270200 J3-050.                                                          00270200
270300*                                                                 00270300
270400     SET W-PUNT-COTR TO 1.                                        00270400
270500     SEARCH W-TAB-COMP-TRIB-EL                                    00270500
270600            AT END MOVE ZERO TO W-FLAG-TROVATO                    00270600
270700     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00270700
270800                                          = W-COD-TRIB AND        00270800
270900          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IRS'AND        00270900
271000          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00271000
271100                   W-DATA-RISC                         AND        00271100
271200          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00271200
271300                   W-DATA-RISC                         AND        00271300
271400          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00271400
271500     MOVE 1                               TO W-FLAG-TROVATO.      00271500
271600*                                                                 00271600
271700 J3-060.                                                          00271700
271800*                                                                 00271800
271900     IF W-FLAG-TROVATO = 0                                        00271900
272000       GO TO J3-EXIT.                                             00272000
272100*                                                                 00272100
272200 J3-070.                                                          00272200
272300*                                                                 00272300
272400*                                                                 00272400
272500 J3-080.                                                          00272500
272600*                                                                 00272600
272700     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-I.            00272700
272800*                                                                 00272800
272900 J3-EXIT.                                                         00272900
273000*                                                                 00273000
273100     EXIT.                                                        00273100
273200*                                                                 00273200
273300*                                                                 00273300
273400 J4-010.                                                          00273400
273500*                                                                 00273500
273600     SET W-PUNT-COTR TO 1.                                        00273600
273700     SEARCH W-TAB-COMP-TRIB-EL                                    00273700
273800            AT END MOVE ZERO TO W-FLAG-TROVATO                    00273800
273900     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00273900
274000          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00274000
274100                   W-DATA-RISC                                AND 00274100
274200          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00274200
274300                   W-DATA-RISC                                AND 00274300
274400          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00274400
274500          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IRP'           00274500
274600     MOVE 1                               TO W-FLAG-TROVATO.      00274600
274700*                                                                 00274700
274800     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00274800
274900*                                                                 00274900
275000     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00275000
275100*                                                                 00275100
275200 J4-020.                                                          00275200
275300*                                                                 00275300
275400*                                                                 00275400
275500     IF W-FLAG-TROVATO = 0                                        00275500
275600       GO TO J4-050.                                              00275600
275700*                                                                 00275700
275800 J4-030.                                                          00275800
275900*                                                                 00275900
276000*                                                                 00276000
276100 J4-040.                                                          00276100
276200*                                                                 00276200
276300     MOVE '1' TO W-FLAG-COMP-IRP.                                 00276300
276400     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00276400
276500        W-IMP-RIMB > ZERO AND                                     00276500
276600        W-ANNO-RIFERIMENTO NOT LESS                               00276600
276700                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00276700
276800        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-R                  00276800
276900        MOVE '1' TO W-FLAG-RIF-R-T                                00276900
277000     END-IF.                                                      00277000
277100*                                                                 00277100
277200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00277200
277300        W-IMP-RIMB > ZERO AND                                     00277300
277400        W-ANNO-RIFERIMENTO NOT LESS                               00277400
277500                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00277500
277600        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-R                  00277600
277700        MOVE '1' TO W-FLAG-RIF-R-A                                00277700
277800     END-IF.                                                      00277800
277900*                                                                 00277900
278000     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00278000
278100        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00278100
278200          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00278200
278300         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00278300
278400          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00278400
278500         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00278500
278600          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00278600
278700        W-IMP-RIMB > ZERO                                         00278700
278800          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00278800
278900                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00278900
279000          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00279000
279100                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00279100
279200          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00279200
279300             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00279300
279400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-R           00279400
279500               MOVE '1' TO W-FLAG-RIF-R-T                         00279500
279600          END-IF                                                  00279600
279700          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00279700
279800             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00279800
279900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-R           00279900
280000               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00280000
280100          END-IF                                                  00280100
280200     END-IF.                                                      00280200
280300*                                                                 00280300
280400     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00280400
280500        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00280500
280600        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00280600
280700        W-IMP-RIMB > ZERO                                         00280700
280800          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00280800
280900                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00280900
281000          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00281000
281100                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00281100
281200          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00281200
281300             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00281300
281400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-R           00281400
281500               MOVE '1' TO W-FLAG-RIF-R-A                         00281500
281600          END-IF                                                  00281600
281700          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00281700
281800             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00281800
281900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-R           00281900
282000               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00282000
282100          END-IF                                                  00282100
282200     END-IF.                                                      00282200
282300*                                                                 00282300
282400 J4-050.                                                          00282400
282500*                                                                 00282500
282600     SET W-PUNT-COTR TO 1.                                        00282600
282700     SEARCH W-TAB-COMP-TRIB-EL                                    00282700
282800            AT END MOVE ZERO TO W-FLAG-TROVATO                    00282800
282900     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00282900
283000                                          = W-COD-TRIB AND        00283000
283100          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IRP'AND        00283100
283200          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00283200
283300                   W-DATA-RISC                         AND        00283300
283400          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00283400
283500                   W-DATA-RISC                         AND        00283500
283600          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00283600
283700     MOVE 1                               TO W-FLAG-TROVATO.      00283700
283800*                                                                 00283800
283900 J4-060.                                                          00283900
284000*                                                                 00284000
284100     IF W-FLAG-TROVATO = 0                                        00284100
284200       GO TO J4-090.                                              00284200
284300*                                                                 00284300
284400 J4-070.                                                          00284400
284500*                                                                 00284500
284600*                                                                 00284600
284700 J4-080.                                                          00284700
284800*                                                                 00284800
284900     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-R.            00284900
285000*                                                                 00285000
285100 J4-090.                                                          00285100
285200*                                                                 00285200
285300     SET W-PUNT-COTR TO 1.                                        00285300
285400     SEARCH W-TAB-COMP-TRIB-EL                                    00285400
285500            AT END MOVE ZERO TO W-FLAG-TROVATO                    00285500
285600     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00285600
285700                                          = W-COD-TRIB  AND       00285700
285800          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR)   = 'C' AND       00285800
285900          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00285900
286000                   W-DATA-RISC                          AND       00286000
286100          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00286100
286200                   W-DATA-RISC                          AND       00286200
286300          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IVA' AND   00286300
286400          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IRS' AND   00286400
286500          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IRP' AND   00286500
286600          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IRM' AND   00286600
286700          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IRF' AND   00286700
286800          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'ADX' AND   00286800
286900          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IIE' AND   00286900
287000          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IFE' AND   00287000
287100          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'FF1' AND   00287100
287200          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'FF2' AND   00287200
287300          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'FF3' AND   00287300
287400          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'ORO' AND   00287400
287500          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'SEC' AND   00287500
287600          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'IEC' AND   00287600
287700          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'LEZ' AND   00287700
287800          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'QR1' AND   00287800
287900          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) NOT = 'BTC'       00287900
288000     MOVE 1                               TO W-FLAG-TROVATO.      00288000
288100*                                                                 00288100
288200 J4-100.                                                          00288200
288300*                                                                 00288300
288400     IF W-FLAG-TROVATO = 0                                        00288400
288500       GO TO J4-EXIT.                                             00288500
288600*                                                                 00288600
288700 J4-110.                                                          00288700
288800*                                                                 00288800
288900*                                                                 00288900
289000 J4-120.                                                          00289000
289100*                                                                 00289100
289200     IF W-IMP-RIMB > ZERO                                         00289200
289300        MOVE '1' TO W-FLAG-RIF-C.                                 00289300
289400*                                                                 00289400
289500 J4-EXIT.                                                         00289500
289600*                                                                 00289600
289700     EXIT.                                                        00289700
289800*                                                                 00289800
289900 J5-010.                                                          00289900
290000*                                                                 00290000
290100     SET W-PUNT-COTR TO 1.                                        00290100
290200     SEARCH W-TAB-COMP-TRIB-EL                                    00290200
290300            AT END MOVE ZERO TO W-FLAG-TROVATO                    00290300
290400     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00290400
290500          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00290500
290600                   W-DATA-RISC                                AND 00290600
290700          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00290700
290800                   W-DATA-RISC                                AND 00290800
290900          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00290900
291000          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IRM'           00291000
291100     MOVE 1                               TO W-FLAG-TROVATO.      00291100
291200*                                                                 00291200
291300     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00291300
291400*                                                                 00291400
291500     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00291500
291600*                                                                 00291600
291700 J5-020.                                                          00291700
291800*                                                                 00291800
291900*                                                                 00291900
292000     IF W-FLAG-TROVATO = 0                                        00292000
292100       GO TO J5-050.                                              00292100
292200*                                                                 00292200
292300 J5-030.                                                          00292300
292400*                                                                 00292400
292500*                                                                 00292500
292600 J5-040.                                                          00292600
292700*                                                                 00292700
292800     MOVE '1' TO W-FLAG-COMP-IRM.                                 00292800
292900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00292900
293000        W-IMP-RIMB > ZERO AND                                     00293000
293100        W-ANNO-RIFERIMENTO NOT LESS                               00293100
293200                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00293200
293300        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-M                  00293300
293400        MOVE '1' TO W-FLAG-RIF-M-T                                00293400
293500     END-IF.                                                      00293500
293600*                                                                 00293600
293700     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00293700
293800        W-IMP-RIMB > ZERO AND                                     00293800
293900        W-ANNO-RIFERIMENTO NOT LESS                               00293900
294000                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00294000
294100        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-M                  00294100
294200        MOVE '1' TO W-FLAG-RIF-M-A                                00294200
294300     END-IF.                                                      00294300
294400*                                                                 00294400
294500     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00294500
294600        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00294600
294700          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00294700
294800         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00294800
294900          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00294900
295000         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00295000
295100          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00295100
295200        W-IMP-RIMB > ZERO                                         00295200
295300          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00295300
295400                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00295400
295500          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00295500
295600                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00295600
295700          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00295700
295800             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00295800
295900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-M           00295900
296000               MOVE '1' TO W-FLAG-RIF-M-T                         00296000
296100          END-IF                                                  00296100
296200          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00296200
296300             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00296300
296400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-M           00296400
296500               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00296500
296600          END-IF                                                  00296600
296700     END-IF.                                                      00296700
296800*                                                                 00296800
296900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00296900
297000        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00297000
297100        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00297100
297200        W-IMP-RIMB > ZERO                                         00297200
297300          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00297300
297400                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00297400
297500          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00297500
297600                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00297600
297700          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00297700
297800             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00297800
297900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-M           00297900
298000               MOVE '1' TO W-FLAG-RIF-M-A                         00298000
298100          END-IF                                                  00298100
298200          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00298200
298300             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00298300
298400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-M           00298400
298500               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00298500
298600          END-IF                                                  00298600
298700     END-IF.                                                      00298700
298800*                                                                 00298800
298900 J5-050.                                                          00298900
299000*                                                                 00299000
299100     SET W-PUNT-COTR TO 1.                                        00299100
299200     SEARCH W-TAB-COMP-TRIB-EL                                    00299200
299300            AT END MOVE ZERO TO W-FLAG-TROVATO                    00299300
299400     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00299400
299500                                          = W-COD-TRIB AND        00299500
299600          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IRM'AND        00299600
299700          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00299700
299800                   W-DATA-RISC                         AND        00299800
299900          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00299900
300000                   W-DATA-RISC                         AND        00300000
300100          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00300100
300200     MOVE 1                               TO W-FLAG-TROVATO.      00300200
300300*                                                                 00300300
300400 J5-060.                                                          00300400
300500*                                                                 00300500
300600     IF W-FLAG-TROVATO = 0                                        00300600
300700       GO TO J5-EXIT.                                             00300700
300800*                                                                 00300800
300900 J5-070.                                                          00300900
301000*                                                                 00301000
301100*                                                                 00301100
301200 J5-080.                                                          00301200
301300*                                                                 00301300
301400     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-M.            00301400
301500*                                                                 00301500
301600 J5-EXIT.                                                         00301600
301700*                                                                 00301700
301800     EXIT.                                                        00301800
301900*                                                                 00301900
302000 J6-010.                                                          00302000
302100*                                                                 00302100
302200     SET W-PUNT-COTR TO 1.                                        00302200
302300     SEARCH W-TAB-COMP-TRIB-EL                                    00302300
302400            AT END MOVE ZERO TO W-FLAG-TROVATO                    00302400
302500     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00302500
302600          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00302600
302700                   W-DATA-RISC                                AND 00302700
302800          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00302800
302900                   W-DATA-RISC                                AND 00302900
303000          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00303000
303100          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IRF'           00303100
303200     MOVE 1                               TO W-FLAG-TROVATO.      00303200
303300*                                                                 00303300
303400     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00303400
303500*                                                                 00303500
303600     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00303600
303700*                                                                 00303700
303800 J6-020.                                                          00303800
303900*                                                                 00303900
304000*                                                                 00304000
304100     IF W-FLAG-TROVATO = 0                                        00304100
304200       GO TO J6-050.                                              00304200
304300*                                                                 00304300
304400 J6-030.                                                          00304400
304500*                                                                 00304500
304600*                                                                 00304600
304700 J6-040.                                                          00304700
304800*                                                                 00304800
304900     MOVE '1' TO W-FLAG-COMP-IRF.                                 00304900
305000     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00305000
305100        W-IMP-RIMB > ZERO AND                                     00305100
305200        W-ANNO-RIFERIMENTO NOT LESS                               00305200
305300                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00305300
305400        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IRF                00305400
305500        MOVE '1' TO W-FLAG-RIF-IRF-T                              00305500
305600     END-IF.                                                      00305600
305700*                                                                 00305700
305800     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00305800
305900        W-IMP-RIMB > ZERO AND                                     00305900
306000        W-ANNO-RIFERIMENTO NOT LESS                               00306000
306100                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00306100
306200        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IRF                00306200
306300        MOVE '1' TO W-FLAG-RIF-IRF-A                              00306300
306400     END-IF.                                                      00306400
306500*                                                                 00306500
306600     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00306600
306700        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00306700
306800          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00306800
306900         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00306900
307000          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00307000
307100         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00307100
307200          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00307200
307300        W-IMP-RIMB > ZERO                                         00307300
307400          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00307400
307500                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00307500
307600          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00307600
307700                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00307700
307800          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00307800
307900             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00307900
308000               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IRF         00308000
308100               MOVE '1' TO W-FLAG-RIF-IRF-T                       00308100
308200          END-IF                                                  00308200
308300          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00308300
308400             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00308400
308500               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IRF         00308500
308600               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00308600
308700          END-IF                                                  00308700
308800     END-IF.                                                      00308800
308900*                                                                 00308900
309000     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00309000
309100        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00309100
309200        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00309200
309300        W-IMP-RIMB > ZERO                                         00309300
309400          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00309400
309500                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00309500
309600          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00309600
309700                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00309700
309800          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00309800
309900             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00309900
310000               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IRF         00310000
310100               MOVE '1' TO W-FLAG-RIF-IRF-A                       00310100
310200          END-IF                                                  00310200
310300          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00310300
310400             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00310400
310500               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IRF         00310500
310600               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00310600
310700          END-IF                                                  00310700
310800     END-IF.                                                      00310800
310900*                                                                 00310900
311000 J6-050.                                                          00311000
311100*                                                                 00311100
311200     SET W-PUNT-COTR TO 1.                                        00311200
311300     SEARCH W-TAB-COMP-TRIB-EL                                    00311300
311400            AT END MOVE ZERO TO W-FLAG-TROVATO                    00311400
311500     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00311500
311600                                          = W-COD-TRIB AND        00311600
311700          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IRF'AND        00311700
311800          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00311800
311900                   W-DATA-RISC                         AND        00311900
312000          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00312000
312100                   W-DATA-RISC                         AND        00312100
312200          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00312200
312300     MOVE 1                               TO W-FLAG-TROVATO.      00312300
312400*                                                                 00312400
312500 J6-060.                                                          00312500
312600*                                                                 00312600
312700     IF W-FLAG-TROVATO = 0                                        00312700
312800       GO TO J6-EXIT.                                             00312800
312900*                                                                 00312900
313000 J6-070.                                                          00313000
313100*                                                                 00313100
313200*                                                                 00313200
313300 J6-080.                                                          00313300
313400*                                                                 00313400
313500     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-IRF.          00313500
313600*                                                                 00313600
313700 J6-EXIT.                                                         00313700
313800*                                                                 00313800
313900     EXIT.                                                        00313900
314000*                                                                 00314000
314100 J7-010.                                                          00314100
314200*                                                                 00314200
314300     SET W-PUNT-COTR TO 1.                                        00314300
314400     SEARCH W-TAB-COMP-TRIB-EL                                    00314400
314500            AT END MOVE ZERO TO W-FLAG-TROVATO                    00314500
314600     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00314600
314700          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00314700
314800                   W-DATA-RISC                                AND 00314800
314900          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00314900
315000                   W-DATA-RISC                                AND 00315000
315100          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00315100
315200          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'ADX'           00315200
315300     MOVE 1                               TO W-FLAG-TROVATO.      00315300
315400*                                                                 00315400
315500     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00315500
315600*                                                                 00315600
315700     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00315700
315800*                                                                 00315800
315900 J7-020.                                                          00315900
316000*                                                                 00316000
316100*                                                                 00316100
316200     IF W-FLAG-TROVATO = 0                                        00316200
316300       GO TO J7-050.                                              00316300
316400*                                                                 00316400
316500 J7-030.                                                          00316500
316600*                                                                 00316600
316700*                                                                 00316700
316800 J7-040.                                                          00316800
316900*                                                                 00316900
317000     MOVE '1' TO W-FLAG-COMP-ADX.                                 00317000
317100     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00317100
317200        W-IMP-RIMB > ZERO AND                                     00317200
317300        W-ANNO-RIFERIMENTO NOT LESS                               00317300
317400                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00317400
317500        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ADX                00317500
317600        MOVE '1' TO W-FLAG-RIF-ADX-T                              00317600
317700     END-IF.                                                      00317700
317800*                                                                 00317800
317900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00317900
318000        W-IMP-RIMB > ZERO AND                                     00318000
318100        W-ANNO-RIFERIMENTO NOT LESS                               00318100
318200                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00318200
318300        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ADX                00318300
318400        MOVE '1' TO W-FLAG-RIF-ADX-A                              00318400
318500     END-IF.                                                      00318500
318600*                                                                 00318600
318700     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00318700
318800        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00318800
318900          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00318900
319000         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00319000
319100          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00319100
319200         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00319200
319300          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00319300
319400        W-IMP-RIMB > ZERO                                         00319400
319500          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00319500
319600                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00319600
319700          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00319700
319800                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00319800
319900          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00319900
320000             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00320000
320100               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ADX         00320100
320200               MOVE '1' TO W-FLAG-RIF-ADX-T                       00320200
320300          END-IF                                                  00320300
320400          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00320400
320500             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00320500
320600               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ADX         00320600
320700               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00320700
320800          END-IF                                                  00320800
320900     END-IF.                                                      00320900
321000*                                                                 00321000
321100     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00321100
321200        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00321200
321300        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00321300
321400        W-IMP-RIMB > ZERO                                         00321400
321500          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00321500
321600                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00321600
321700          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00321700
321800                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00321800
321900          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00321900
322000             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00322000
322100               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ADX         00322100
322200               MOVE '1' TO W-FLAG-RIF-ADX-A                       00322200
322300          END-IF                                                  00322300
322400          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00322400
322500             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00322500
322600               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ADX         00322600
322700               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00322700
322800          END-IF                                                  00322800
322900     END-IF.                                                      00322900
323000*                                                                 00323000
323100 J7-050.                                                          00323100
323200*                                                                 00323200
323300     SET W-PUNT-COTR TO 1.                                        00323300
323400     SEARCH W-TAB-COMP-TRIB-EL                                    00323400
323500            AT END MOVE ZERO TO W-FLAG-TROVATO                    00323500
323600     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00323600
323700                                          = W-COD-TRIB AND        00323700
323800          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'ADX'AND        00323800
323900          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00323900
324000                   W-DATA-RISC                         AND        00324000
324100          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00324100
324200                   W-DATA-RISC                         AND        00324200
324300          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00324300
324400     MOVE 1                               TO W-FLAG-TROVATO.      00324400
324500*                                                                 00324500
324600 J7-060.                                                          00324600
324700*                                                                 00324700
324800     IF W-FLAG-TROVATO = 0                                        00324800
324900       GO TO J7-EXIT.                                             00324900
325000*                                                                 00325000
325100 J7-070.                                                          00325100
325200*                                                                 00325200
325300*                                                                 00325300
325400 J7-080.                                                          00325400
325500*                                                                 00325500
325600     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-ADX.          00325600
325700*                                                                 00325700
325800 J7-EXIT.                                                         00325800
325900*                                                                 00325900
326000     EXIT.                                                        00326000
326100*                                                                 00326100
326200 J8-010.                                                          00326200
326300*                                                                 00326300
326400     SET W-PUNT-COTR TO 1.                                        00326400
326500     SEARCH W-TAB-COMP-TRIB-EL                                    00326500
326600            AT END MOVE ZERO TO W-FLAG-TROVATO                    00326600
326700     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00326700
326800          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00326800
326900                   W-DATA-RISC                                AND 00326900
327000          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00327000
327100                   W-DATA-RISC                                AND 00327100
327200          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00327200
327300          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IIE'           00327300
327400     MOVE 1                               TO W-FLAG-TROVATO.      00327400
327500*                                                                 00327500
327600     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00327600
327700*                                                                 00327700
327800     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00327800
327900*                                                                 00327900
328000 J8-020.                                                          00328000
328100*                                                                 00328100
328200*                                                                 00328200
328300     IF W-FLAG-TROVATO = 0                                        00328300
328400       GO TO J8-050.                                              00328400
328500*                                                                 00328500
328600 J8-030.                                                          00328600
328700*                                                                 00328700
328800*                                                                 00328800
328900 J8-040.                                                          00328900
329000*                                                                 00329000
329100     MOVE '1' TO W-FLAG-COMP-IIE.                                 00329100
329200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00329200
329300        W-IMP-RIMB > ZERO AND                                     00329300
329400        W-ANNO-RIFERIMENTO NOT LESS                               00329400
329500                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00329500
329600        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IIE                00329600
329700        MOVE '1' TO W-FLAG-RIF-IIE-T                              00329700
329800     END-IF.                                                      00329800
329900*                                                                 00329900
330000     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00330000
330100        W-IMP-RIMB > ZERO AND                                     00330100
330200        W-ANNO-RIFERIMENTO NOT LESS                               00330200
330300                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00330300
330400        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IIE                00330400
330500        MOVE '1' TO W-FLAG-RIF-IIE-A                              00330500
330600     END-IF.                                                      00330600
330700*                                                                 00330700
330800     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00330800
330900        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00330900
331000          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00331000
331100         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00331100
331200          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00331200
331300         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00331300
331400          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00331400
331500        W-IMP-RIMB > ZERO                                         00331500
331600          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00331600
331700                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00331700
331800          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00331800
331900                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00331900
332000          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00332000
332100             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00332100
332200               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IIE         00332200
332300               MOVE '1' TO W-FLAG-RIF-IIE-T                       00332300
332400          END-IF                                                  00332400
332500          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00332500
332600             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00332600
332700               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IIE         00332700
332800               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00332800
332900          END-IF                                                  00332900
333000     END-IF.                                                      00333000
333100*                                                                 00333100
333200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00333200
333300        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00333300
333400        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00333400
333500        W-IMP-RIMB > ZERO                                         00333500
333600          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00333600
333700                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00333700
333800          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00333800
333900                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00333900
334000          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00334000
334100             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00334100
334200               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IIE         00334200
334300               MOVE '1' TO W-FLAG-RIF-IIE-A                       00334300
334400          END-IF                                                  00334400
334500          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00334500
334600             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00334600
334700               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IIE         00334700
334800               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00334800
334900          END-IF                                                  00334900
335000     END-IF.                                                      00335000
335100*                                                                 00335100
335200 J8-050.                                                          00335200
335300*                                                                 00335300
335400     SET W-PUNT-COTR TO 1.                                        00335400
335500     SEARCH W-TAB-COMP-TRIB-EL                                    00335500
335600            AT END MOVE ZERO TO W-FLAG-TROVATO                    00335600
335700     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00335700
335800                                          = W-COD-TRIB AND        00335800
335900          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IIE'AND        00335900
336000          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00336000
336100                   W-DATA-RISC                         AND        00336100
336200          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00336200
336300                   W-DATA-RISC                         AND        00336300
336400          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00336400
336500     MOVE 1                               TO W-FLAG-TROVATO.      00336500
336600*                                                                 00336600
336700 J8-060.                                                          00336700
336800*                                                                 00336800
336900     IF W-FLAG-TROVATO = 0                                        00336900
337000       GO TO J8-EXIT.                                             00337000
337100*                                                                 00337100
337200 J8-070.                                                          00337200
337300*                                                                 00337300
337400*                                                                 00337400
337500 J8-080.                                                          00337500
337600*                                                                 00337600
337700     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-IIE.          00337700
337800*                                                                 00337800
337900 J8-EXIT.                                                         00337900
338000*                                                                 00338000
338100     EXIT.                                                        00338100
338200*                                                                 00338200
338300 J9-010.                                                          00338300
338400*                                                                 00338400
338500     SET W-PUNT-COTR TO 1.                                        00338500
338600     SEARCH W-TAB-COMP-TRIB-EL                                    00338600
338700            AT END MOVE ZERO TO W-FLAG-TROVATO                    00338700
338800     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00338800
338900          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00338900
339000                   W-DATA-RISC                                AND 00339000
339100          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00339100
339200                   W-DATA-RISC                                AND 00339200
339300          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00339300
339400          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IFE'           00339400
339500     MOVE 1                               TO W-FLAG-TROVATO.      00339500
339600*                                                                 00339600
339700     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00339700
339800*                                                                 00339800
339900     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00339900
340000*                                                                 00340000
340100 J9-020.                                                          00340100
340200*                                                                 00340200
340300*                                                                 00340300
340400     IF W-FLAG-TROVATO = 0                                        00340400
340500       GO TO J9-050.                                              00340500
340600*                                                                 00340600
340700 J9-030.                                                          00340700
340800*                                                                 00340800
340900*                                                                 00340900
341000 J9-040.                                                          00341000
341100*                                                                 00341100
341200     MOVE '1' TO W-FLAG-COMP-IFE.                                 00341200
341300     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00341300
341400        W-IMP-RIMB > ZERO AND                                     00341400
341500        W-ANNO-RIFERIMENTO NOT LESS                               00341500
341600                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00341600
341700        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IFE                00341700
341800        MOVE '1' TO W-FLAG-RIF-IFE-T                              00341800
341900     END-IF.                                                      00341900
342000*                                                                 00342000
342100     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00342100
342200        W-IMP-RIMB > ZERO AND                                     00342200
342300        W-ANNO-RIFERIMENTO NOT LESS                               00342300
342400                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00342400
342500        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IFE                00342500
342600        MOVE '1' TO W-FLAG-RIF-IFE-A                              00342600
342700     END-IF.                                                      00342700
342800*                                                                 00342800
342900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00342900
343000        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00343000
343100          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00343100
343200         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00343200
343300          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00343300
343400         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00343400
343500          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00343500
343600        W-IMP-RIMB > ZERO                                         00343600
343700          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00343700
343800                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00343800
343900          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00343900
344000                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00344000
344100          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00344100
344200             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00344200
344300               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IFE         00344300
344400               MOVE '1' TO W-FLAG-RIF-IFE-T                       00344400
344500          END-IF                                                  00344500
344600          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00344600
344700             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00344700
344800               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IFE         00344800
344900               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00344900
345000          END-IF                                                  00345000
345100     END-IF.                                                      00345100
345200*                                                                 00345200
345300     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00345300
345400        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00345400
345500        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00345500
345600        W-IMP-RIMB > ZERO                                         00345600
345700          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00345700
345800                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00345800
345900          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00345900
346000                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00346000
346100          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00346100
346200             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00346200
346300               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IFE         00346300
346400               MOVE '1' TO W-FLAG-RIF-IFE-A                       00346400
346500          END-IF                                                  00346500
346600          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00346600
346700             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00346700
346800               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IFE         00346800
346900               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00346900
347000          END-IF                                                  00347000
347100     END-IF.                                                      00347100
347200*                                                                 00347200
347300 J9-050.                                                          00347300
347400*                                                                 00347400
347500     SET W-PUNT-COTR TO 1.                                        00347500
347600     SEARCH W-TAB-COMP-TRIB-EL                                    00347600
347700            AT END MOVE ZERO TO W-FLAG-TROVATO                    00347700
347800     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00347800
347900                                          = W-COD-TRIB AND        00347900
348000          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IFE'AND        00348000
348100          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00348100
348200                   W-DATA-RISC                         AND        00348200
348300          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00348300
348400                   W-DATA-RISC                         AND        00348400
348500          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00348500
348600     MOVE 1                               TO W-FLAG-TROVATO.      00348600
348700*                                                                 00348700
348800 J9-060.                                                          00348800
348900*                                                                 00348900
349000     IF W-FLAG-TROVATO = 0                                        00349000
349100       GO TO J9-EXIT.                                             00349100
349200*                                                                 00349200
349300 J9-070.                                                          00349300
349400*                                                                 00349400
349500*                                                                 00349500
349600 J9-080.                                                          00349600
349700*                                                                 00349700
349800     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-IFE.          00349800
349900*                                                                 00349900
350000 J9-EXIT.                                                         00350000
350100*                                                                 00350100
350200     EXIT.                                                        00350200
350300*                                                                 00350300
350400 J10-010.                                                         00350400
350500*                                                                 00350500
350600     SET W-PUNT-COTR TO 1.                                        00350600
350700     SEARCH W-TAB-COMP-TRIB-EL                                    00350700
350800            AT END MOVE ZERO TO W-FLAG-TROVATO                    00350800
350900     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00350900
351000          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00351000
351100                   W-DATA-RISC                                AND 00351100
351200          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00351200
351300                   W-DATA-RISC                                AND 00351300
351400          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00351400
351500          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'FF1'           00351500
351600     MOVE 1                               TO W-FLAG-TROVATO.      00351600
351700*                                                                 00351700
351800     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00351800
351900*                                                                 00351900
352000     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00352000
352100*                                                                 00352100
352200 J10-020.                                                         00352200
352300*                                                                 00352300
352400*                                                                 00352400
352500     IF W-FLAG-TROVATO = 0                                        00352500
352600       GO TO J10-050.                                             00352600
352700*                                                                 00352700
352800 J10-030.                                                         00352800
352900*                                                                 00352900
353000*                                                                 00353000
353100 J10-040.                                                         00353100
353200*                                                                 00353200
353300     MOVE '1' TO W-FLAG-COMP-FF1.                                 00353300
353400     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00353400
353500        W-IMP-RIMB > ZERO AND                                     00353500
353600        W-ANNO-RIFERIMENTO NOT LESS                               00353600
353700                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00353700
353800        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF1                00353800
353900        MOVE '1' TO W-FLAG-RIF-FF1-T                              00353900
354000     END-IF.                                                      00354000
354100*                                                                 00354100
354200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00354200
354300        W-IMP-RIMB > ZERO AND                                     00354300
354400        W-ANNO-RIFERIMENTO NOT LESS                               00354400
354500                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00354500
354600        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF1                00354600
354700        MOVE '1' TO W-FLAG-RIF-FF1-A                              00354700
354800     END-IF.                                                      00354800
354900*                                                                 00354900
355000     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00355000
355100        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00355100
355200          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00355200
355300         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00355300
355400          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00355400
355500         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00355500
355600          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00355600
355700        W-IMP-RIMB > ZERO                                         00355700
355800          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00355800
355900                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00355900
356000          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00356000
356100                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00356100
356200          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00356200
356300             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00356300
356400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF1         00356400
356500               MOVE '1' TO W-FLAG-RIF-FF1-T                       00356500
356600          END-IF                                                  00356600
356700          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00356700
356800             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00356800
356900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF1         00356900
357000               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00357000
357100          END-IF                                                  00357100
357200     END-IF.                                                      00357200
357300*                                                                 00357300
357400     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00357400
357500        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00357500
357600        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00357600
357700        W-IMP-RIMB > ZERO                                         00357700
357800          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00357800
357900                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00357900
358000          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00358000
358100                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00358100
358200          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00358200
358300             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00358300
358400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF1         00358400
358500               MOVE '1' TO W-FLAG-RIF-FF1-A                       00358500
358600          END-IF                                                  00358600
358700          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00358700
358800             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00358800
358900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF1         00358900
359000               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00359000
359100          END-IF                                                  00359100
359200     END-IF.                                                      00359200
359300*                                                                 00359300
359400 J10-050.                                                         00359400
359500*                                                                 00359500
359600     SET W-PUNT-COTR TO 1.                                        00359600
359700     SEARCH W-TAB-COMP-TRIB-EL                                    00359700
359800            AT END MOVE ZERO TO W-FLAG-TROVATO                    00359800
359900     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00359900
360000                                          = W-COD-TRIB AND        00360000
360100          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'FF1'AND        00360100
360200          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00360200
360300                   W-DATA-RISC                         AND        00360300
360400          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00360400
360500                   W-DATA-RISC                         AND        00360500
360600          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00360600
360700     MOVE 1                               TO W-FLAG-TROVATO.      00360700
360800*                                                                 00360800
360900 J10-060.                                                         00360900
361000*                                                                 00361000
361100     IF W-FLAG-TROVATO = 0                                        00361100
361200       GO TO J10-EXIT.                                            00361200
361300*                                                                 00361300
361400 J10-070.                                                         00361400
361500*                                                                 00361500
361600*                                                                 00361600
361700 J10-080.                                                         00361700
361800*                                                                 00361800
361900     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-FF1.          00361900
362000*                                                                 00362000
362100 J10-EXIT.                                                        00362100
362200*                                                                 00362200
362300     EXIT.                                                        00362300
362400*                                                                 00362400
362500 J11-010.                                                         00362500
362600*                                                                 00362600
362700     SET W-PUNT-COTR TO 1.                                        00362700
362800     SEARCH W-TAB-COMP-TRIB-EL                                    00362800
362900            AT END MOVE ZERO TO W-FLAG-TROVATO                    00362900
363000     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00363000
363100          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00363100
363200                   W-DATA-RISC                                AND 00363200
363300          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00363300
363400                   W-DATA-RISC                                AND 00363400
363500          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00363500
363600          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'FF2'           00363600
363700     MOVE 1                               TO W-FLAG-TROVATO.      00363700
363800*                                                                 00363800
363900     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00363900
364000*                                                                 00364000
364100     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00364100
364200*                                                                 00364200
364300 J11-020.                                                         00364300
364400*                                                                 00364400
364500*                                                                 00364500
364600     IF W-FLAG-TROVATO = 0                                        00364600
364700       GO TO J11-050.                                             00364700
364800*                                                                 00364800
364900 J11-030.                                                         00364900
365000*                                                                 00365000
365100*                                                                 00365100
365200 J11-040.                                                         00365200
365300*                                                                 00365300
365400     MOVE '1' TO W-FLAG-COMP-FF2.                                 00365400
365500     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00365500
365600        W-IMP-RIMB > ZERO AND                                     00365600
365700        W-ANNO-RIFERIMENTO NOT LESS                               00365700
365800                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00365800
365900        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF2                00365900
366000        MOVE '1' TO W-FLAG-RIF-FF2-T                              00366000
366100     END-IF.                                                      00366100
366200*                                                                 00366200
366300     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00366300
366400        W-IMP-RIMB > ZERO AND                                     00366400
366500        W-ANNO-RIFERIMENTO NOT LESS                               00366500
366600                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00366600
366700        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF2                00366700
366800        MOVE '1' TO W-FLAG-RIF-FF2-A                              00366800
366900     END-IF.                                                      00366900
367000*                                                                 00367000
367100     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00367100
367200        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00367200
367300          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00367300
367400         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00367400
367500          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00367500
367600         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00367600
367700          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00367700
367800        W-IMP-RIMB > ZERO                                         00367800
367900          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00367900
368000                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00368000
368100          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00368100
368200                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00368200
368300          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00368300
368400             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00368400
368500               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF2         00368500
368600               MOVE '1' TO W-FLAG-RIF-FF2-T                       00368600
368700          END-IF                                                  00368700
368800          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00368800
368900             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00368900
369000               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF2         00369000
369100               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00369100
369200          END-IF                                                  00369200
369300     END-IF.                                                      00369300
369400*                                                                 00369400
369500     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00369500
369600        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00369600
369700        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00369700
369800        W-IMP-RIMB > ZERO                                         00369800
369900          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00369900
370000                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00370000
370100          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00370100
370200                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00370200
370300          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00370300
370400             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00370400
370500               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF2         00370500
370600               MOVE '1' TO W-FLAG-RIF-FF2-A                       00370600
370700          END-IF                                                  00370700
370800          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00370800
370900             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00370900
371000               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF2         00371000
371100               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00371100
371200          END-IF                                                  00371200
371300     END-IF.                                                      00371300
371400*                                                                 00371400
371500 J11-050.                                                         00371500
371600*                                                                 00371600
371700     SET W-PUNT-COTR TO 1.                                        00371700
371800     SEARCH W-TAB-COMP-TRIB-EL                                    00371800
371900            AT END MOVE ZERO TO W-FLAG-TROVATO                    00371900
372000     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00372000
372100                                          = W-COD-TRIB AND        00372100
372200          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'FF2'AND        00372200
372300          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00372300
372400                   W-DATA-RISC                         AND        00372400
372500          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00372500
372600                   W-DATA-RISC                         AND        00372600
372700          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00372700
372800     MOVE 1                               TO W-FLAG-TROVATO.      00372800
372900*                                                                 00372900
373000 J11-060.                                                         00373000
373100*                                                                 00373100
373200     IF W-FLAG-TROVATO = 0                                        00373200
373300       GO TO J11-EXIT.                                            00373300
373400*                                                                 00373400
373500 J11-070.                                                         00373500
373600*                                                                 00373600
373700*                                                                 00373700
373800 J11-080.                                                         00373800
373900*                                                                 00373900
374000     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-FF2.          00374000
374100*                                                                 00374100
374200 J11-EXIT.                                                        00374200
374300*                                                                 00374300
374400     EXIT.                                                        00374400
374500*                                                                 00374500
374600 J12-010.                                                         00374600
374700*                                                                 00374700
374800     SET W-PUNT-COTR TO 1.                                        00374800
374900     SEARCH W-TAB-COMP-TRIB-EL                                    00374900
375000            AT END MOVE ZERO TO W-FLAG-TROVATO                    00375000
375100     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00375100
375200          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00375200
375300                   W-DATA-RISC                                AND 00375300
375400          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00375400
375500                   W-DATA-RISC                                AND 00375500
375600          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00375600
375700          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'FF3'           00375700
375800     MOVE 1                               TO W-FLAG-TROVATO.      00375800
375900*                                                                 00375900
376000     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00376000
376100*                                                                 00376100
376200     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00376200
376300*                                                                 00376300
376400 J12-020.                                                         00376400
376500*                                                                 00376500
376600*                                                                 00376600
376700     IF W-FLAG-TROVATO = 0                                        00376700
376800       GO TO J12-050.                                             00376800
376900*                                                                 00376900
377000 J12-030.                                                         00377000
377100*                                                                 00377100
377200*                                                                 00377200
377300 J12-040.                                                         00377300
377400*                                                                 00377400
377500     MOVE '1' TO W-FLAG-COMP-FF3.                                 00377500
377600     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00377600
377700        W-IMP-RIMB > ZERO AND                                     00377700
377800        W-ANNO-RIFERIMENTO NOT LESS                               00377800
377900                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00377900
378000        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF3                00378000
378100        MOVE '1' TO W-FLAG-RIF-FF3-T                              00378100
378200     END-IF.                                                      00378200
378300*                                                                 00378300
378400     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00378400
378500        W-IMP-RIMB > ZERO AND                                     00378500
378600        W-ANNO-RIFERIMENTO NOT LESS                               00378600
378700                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00378700
378800        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF3                00378800
378900        MOVE '1' TO W-FLAG-RIF-FF3-A                              00378900
379000     END-IF.                                                      00379000
379100*                                                                 00379100
379200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00379200
379300        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00379300
379400          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00379400
379500         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00379500
379600          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00379600
379700         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00379700
379800          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00379800
379900        W-IMP-RIMB > ZERO                                         00379900
380000          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00380000
380100                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00380100
380200          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00380200
380300                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00380300
380400          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00380400
380500             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00380500
380600               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF3         00380600
380700               MOVE '1' TO W-FLAG-RIF-FF3-T                       00380700
380800          END-IF                                                  00380800
380900          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00380900
381000             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00381000
381100               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF3         00381100
381200               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00381200
381300          END-IF                                                  00381300
381400     END-IF.                                                      00381400
381500*                                                                 00381500
381600     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00381600
381700        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00381700
381800        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00381800
381900        W-IMP-RIMB > ZERO                                         00381900
382000          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00382000
382100                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00382100
382200          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00382200
382300                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00382300
382400          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00382400
382500             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00382500
382600               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF3         00382600
382700               MOVE '1' TO W-FLAG-RIF-FF3-A                       00382700
382800          END-IF                                                  00382800
382900          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00382900
383000             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00383000
383100               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-FF3         00383100
383200               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00383200
383300          END-IF                                                  00383300
383400     END-IF.                                                      00383400
383500*                                                                 00383500
383600 J12-050.                                                         00383600
383700*                                                                 00383700
383800     SET W-PUNT-COTR TO 1.                                        00383800
383900     SEARCH W-TAB-COMP-TRIB-EL                                    00383900
384000            AT END MOVE ZERO TO W-FLAG-TROVATO                    00384000
384100     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00384100
384200                                          = W-COD-TRIB AND        00384200
384300          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'FF3'AND        00384300
384400          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00384400
384500                   W-DATA-RISC                         AND        00384500
384600          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00384600
384700                   W-DATA-RISC                         AND        00384700
384800          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00384800
384900     MOVE 1                               TO W-FLAG-TROVATO.      00384900
385000*                                                                 00385000
385100 J12-060.                                                         00385100
385200*                                                                 00385200
385300     IF W-FLAG-TROVATO = 0                                        00385300
385400       GO TO J12-EXIT.                                            00385400
385500*                                                                 00385500
385600 J12-070.                                                         00385600
385700*                                                                 00385700
385800*                                                                 00385800
385900 J12-080.                                                         00385900
386000*                                                                 00386000
386100     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-FF3.          00386100
386200*                                                                 00386200
386300 J12-EXIT.                                                        00386300
386400*                                                                 00386400
386500     EXIT.                                                        00386500
386600*                                                                 00386600
386700 J13-010.                                                         00386700
386800*                                                                 00386800
386900     SET W-PUNT-COTR TO 1.                                        00386900
387000     SEARCH W-TAB-COMP-TRIB-EL                                    00387000
387100            AT END MOVE ZERO TO W-FLAG-TROVATO                    00387100
387200     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00387200
387300          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00387300
387400                   W-DATA-RISC                                AND 00387400
387500          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00387500
387600                   W-DATA-RISC                                AND 00387600
387700          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00387700
387800          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'ORO'           00387800
387900     MOVE 1                               TO W-FLAG-TROVATO.      00387900
388000*                                                                 00388000
388100     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00388100
388200*                                                                 00388200
388300     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00388300
388400*                                                                 00388400
388500 J13-020.                                                         00388500
388600*                                                                 00388600
388700*                                                                 00388700
388800     IF W-FLAG-TROVATO = 0                                        00388800
388900       GO TO J13-050.                                             00388900
389000*                                                                 00389000
389100 J13-030.                                                         00389100
389200*                                                                 00389200
389300*                                                                 00389300
389400 J13-040.                                                         00389400
389500*                                                                 00389500
389600     MOVE '1' TO W-FLAG-COMP-ORO.                                 00389600
389700     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00389700
389800        W-IMP-RIMB > ZERO AND                                     00389800
389900        W-ANNO-RIFERIMENTO NOT LESS                               00389900
390000                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00390000
390100        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ORO                00390100
390200        MOVE '1' TO W-FLAG-RIF-ORO-T                              00390200
390300     END-IF.                                                      00390300
390400*                                                                 00390400
390500     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00390500
390600        W-IMP-RIMB > ZERO AND                                     00390600
390700        W-ANNO-RIFERIMENTO NOT LESS                               00390700
390800                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00390800
390900        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ORO                00390900
391000        MOVE '1' TO W-FLAG-RIF-ORO-A                              00391000
391100     END-IF.                                                      00391100
391200*                                                                 00391200
391300     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00391300
391400        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00391400
391500          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00391500
391600         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00391600
391700          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00391700
391800         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00391800
391900          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00391900
392000        W-IMP-RIMB > ZERO                                         00392000
392100          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00392100
392200                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00392200
392300          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00392300
392400                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00392400
392500          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00392500
392600             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00392600
392700               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ORO         00392700
392800               MOVE '1' TO W-FLAG-RIF-ORO-T                       00392800
392900          END-IF                                                  00392900
393000          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00393000
393100             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00393100
393200               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ORO         00393200
393300               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00393300
393400          END-IF                                                  00393400
393500     END-IF.                                                      00393500
393600*                                                                 00393600
393700     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00393700
393800        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00393800
393900        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00393900
394000        W-IMP-RIMB > ZERO                                         00394000
394100          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00394100
394200                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00394200
394300          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00394300
394400                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00394400
394500          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00394500
394600             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00394600
394700               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ORO         00394700
394800               MOVE '1' TO W-FLAG-RIF-ORO-A                       00394800
394900          END-IF                                                  00394900
395000          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00395000
395100             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00395100
395200               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-ORO         00395200
395300               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00395300
395400          END-IF                                                  00395400
395500     END-IF.                                                      00395500
395600*                                                                 00395600
395700 J13-050.                                                         00395700
395800*                                                                 00395800
395900     SET W-PUNT-COTR TO 1.                                        00395900
396000     SEARCH W-TAB-COMP-TRIB-EL                                    00396000
396100            AT END MOVE ZERO TO W-FLAG-TROVATO                    00396100
396200     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00396200
396300                                          = W-COD-TRIB AND        00396300
396400          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'ORO'AND        00396400
396500          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00396500
396600                   W-DATA-RISC                         AND        00396600
396700          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00396700
396800                   W-DATA-RISC                         AND        00396800
396900          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00396900
397000     MOVE 1                               TO W-FLAG-TROVATO.      00397000
397100*                                                                 00397100
397200 J13-060.                                                         00397200
397300*                                                                 00397300
397400     IF W-FLAG-TROVATO = 0                                        00397400
397500       GO TO J13-EXIT.                                            00397500
397600*                                                                 00397600
397700 J13-070.                                                         00397700
397800*                                                                 00397800
397900*                                                                 00397900
398000 J13-080.                                                         00398000
398100*                                                                 00398100
398200     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-ORO.          00398200
398300*                                                                 00398300
398400 J13-EXIT.                                                        00398400
398500*                                                                 00398500
398600     EXIT.                                                        00398600
398700*                                                                 00398700
398800 J14-010.                                                         00398800
398900*                                                                 00398900
399000     SET W-PUNT-COTR TO 1.                                        00399000
399100     SEARCH W-TAB-COMP-TRIB-EL                                    00399100
399200            AT END MOVE ZERO TO W-FLAG-TROVATO                    00399200
399300     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00399300
399400          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00399400
399500                   W-DATA-RISC                                AND 00399500
399600          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00399600
399700                   W-DATA-RISC                                AND 00399700
399800          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00399800
399900          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'SEC'           00399900
400000     MOVE 1                               TO W-FLAG-TROVATO.      00400000
400100*                                                                 00400100
400200     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00400200
400300*                                                                 00400300
400400     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00400400
400500*                                                                 00400500
400600 J14-020.                                                         00400600
400700*                                                                 00400700
400800*                                                                 00400800
400900     IF W-FLAG-TROVATO = 0                                        00400900
401000       GO TO J14-050.                                             00401000
401100*                                                                 00401100
401200 J14-030.                                                         00401200
401300*                                                                 00401300
401400*                                                                 00401400
401500 J14-040.                                                         00401500
401600*                                                                 00401600
401700     MOVE '1' TO W-FLAG-COMP-SEC.                                 00401700
401800     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00401800
401900        W-IMP-RIMB > ZERO AND                                     00401900
402000        W-ANNO-RIFERIMENTO NOT LESS                               00402000
402100                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00402100
402200        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-SEC                00402200
402300        MOVE '1' TO W-FLAG-RIF-SEC-T                              00402300
402400     END-IF.                                                      00402400
402500*                                                                 00402500
402600     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00402600
402700        W-IMP-RIMB > ZERO AND                                     00402700
402800        W-ANNO-RIFERIMENTO NOT LESS                               00402800
402900                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00402900
403000        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-SEC                00403000
403100        MOVE '1' TO W-FLAG-RIF-SEC-A                              00403100
403200     END-IF.                                                      00403200
403300*                                                                 00403300
403400     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00403400
403500        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00403500
403600          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00403600
403700         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00403700
403800          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00403800
403900         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00403900
404000          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00404000
404100        W-IMP-RIMB > ZERO                                         00404100
404200          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00404200
404300                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00404300
404400          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00404400
404500                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00404500
404600          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00404600
404700             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00404700
404800               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-SEC         00404800
404900               MOVE '1' TO W-FLAG-RIF-SEC-T                       00404900
405000          END-IF                                                  00405000
405100          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00405100
405200             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00405200
405300               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-SEC         00405300
405400               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00405400
405500          END-IF                                                  00405500
405600     END-IF.                                                      00405600
405700*                                                                 00405700
405800     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00405800
405900        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00405900
406000        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00406000
406100        W-IMP-RIMB > ZERO                                         00406100
406200          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00406200
406300                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00406300
406400          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00406400
406500                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00406500
406600          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00406600
406700             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00406700
406800               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-SEC         00406800
406900               MOVE '1' TO W-FLAG-RIF-SEC-A                       00406900
407000          END-IF                                                  00407000
407100          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00407100
407200             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00407200
407300               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-SEC         00407300
407400               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00407400
407500          END-IF                                                  00407500
407600     END-IF.                                                      00407600
407700*                                                                 00407700
407800 J14-050.                                                         00407800
407900*                                                                 00407900
408000     SET W-PUNT-COTR TO 1.                                        00408000
408100     SEARCH W-TAB-COMP-TRIB-EL                                    00408100
408200            AT END MOVE ZERO TO W-FLAG-TROVATO                    00408200
408300     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00408300
408400                                          = W-COD-TRIB AND        00408400
408500          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'SEC'AND        00408500
408600          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00408600
408700                   W-DATA-RISC                         AND        00408700
408800          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00408800
408900                   W-DATA-RISC                         AND        00408900
409000          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00409000
409100     MOVE 1                               TO W-FLAG-TROVATO.      00409100
409200*                                                                 00409200
409300 J14-060.                                                         00409300
409400*                                                                 00409400
409500     IF W-FLAG-TROVATO = 0                                        00409500
409600       GO TO J14-EXIT.                                            00409600
409700*                                                                 00409700
409800 J14-070.                                                         00409800
409900*                                                                 00409900
410000*                                                                 00410000
410100 J14-080.                                                         00410100
410200*                                                                 00410200
410300     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-SEC.          00410300
410400*                                                                 00410400
410500 J14-EXIT.                                                        00410500
410600*                                                                 00410600
410700     EXIT.                                                        00410700
410800*                                                                 00410800
410900 J15-010.                                                         00410900
411000*                                                                 00411000
411100     SET W-PUNT-COTR TO 1.                                        00411100
411200     SEARCH W-TAB-COMP-TRIB-EL                                    00411200
411300            AT END MOVE ZERO TO W-FLAG-TROVATO                    00411300
411400     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00411400
411500          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00411500
411600                   W-DATA-RISC                                AND 00411600
411700          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00411700
411800                   W-DATA-RISC                                AND 00411800
411900          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00411900
412000          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IEC'           00412000
412100     MOVE 1                               TO W-FLAG-TROVATO.      00412100
412200*                                                                 00412200
412300     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00412300
412400*                                                                 00412400
412500     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00412500
412600*                                                                 00412600
412700 J15-020.                                                         00412700
412800*                                                                 00412800
412900*                                                                 00412900
413000     IF W-FLAG-TROVATO = 0                                        00413000
413100       GO TO J15-050.                                             00413100
413200*                                                                 00413200
413300 J15-030.                                                         00413300
413400*                                                                 00413400
413500*                                                                 00413500
413600 J15-040.                                                         00413600
413700*                                                                 00413700
413800     MOVE '1' TO W-FLAG-COMP-IEC.                                 00413800
413900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00413900
414000        W-IMP-RIMB > ZERO AND                                     00414000
414100        W-ANNO-RIFERIMENTO NOT LESS                               00414100
414200                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00414200
414300        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IEC                00414300
414400        MOVE '1' TO W-FLAG-RIF-IEC-T                              00414400
414500     END-IF.                                                      00414500
414600*                                                                 00414600
414700     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00414700
414800        W-IMP-RIMB > ZERO AND                                     00414800
414900        W-ANNO-RIFERIMENTO NOT LESS                               00414900
415000                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00415000
415100        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IEC                00415100
415200        MOVE '1' TO W-FLAG-RIF-IEC-A                              00415200
415300     END-IF.                                                      00415300
415400*                                                                 00415400
415500     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00415500
415600        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00415600
415700          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00415700
415800         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00415800
415900          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00415900
416000         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00416000
416100          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00416100
416200        W-IMP-RIMB > ZERO                                         00416200
416300          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00416300
416400                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00416400
416500          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00416500
416600                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00416600
416700          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00416700
416800             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00416800
416900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IEC         00416900
417000               MOVE '1' TO W-FLAG-RIF-IEC-T                       00417000
417100          END-IF                                                  00417100
417200          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00417200
417300             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00417300
417400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IEC         00417400
417500               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00417500
417600          END-IF                                                  00417600
417700     END-IF.                                                      00417700
417800*                                                                 00417800
417900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00417900
418000        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00418000
418100        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00418100
418200        W-IMP-RIMB > ZERO                                         00418200
418300          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00418300
418400                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00418400
418500          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00418500
418600                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00418600
418700          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00418700
418800             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00418800
418900               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IEC         00418900
419000               MOVE '1' TO W-FLAG-RIF-IEC-A                       00419000
419100          END-IF                                                  00419100
419200          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00419200
419300             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00419300
419400               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-IEC         00419400
419500               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00419500
419600          END-IF                                                  00419600
419700     END-IF.                                                      00419700
419800*                                                                 00419800
419900 J15-050.                                                         00419900
420000*                                                                 00420000
420100     SET W-PUNT-COTR TO 1.                                        00420100
420200     SEARCH W-TAB-COMP-TRIB-EL                                    00420200
420300            AT END MOVE ZERO TO W-FLAG-TROVATO                    00420300
420400     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00420400
420500                                          = W-COD-TRIB AND        00420500
420600          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'IEC'AND        00420600
420700          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00420700
420800                   W-DATA-RISC                         AND        00420800
420900          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00420900
421000                   W-DATA-RISC                         AND        00421000
421100          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00421100
421200     MOVE 1                               TO W-FLAG-TROVATO.      00421200
421300*                                                                 00421300
421400 J15-060.                                                         00421400
421500*                                                                 00421500
421600     IF W-FLAG-TROVATO = 0                                        00421600
421700       GO TO J15-EXIT.                                            00421700
421800*                                                                 00421800
421900 J15-070.                                                         00421900
422000*                                                                 00422000
422100*                                                                 00422100
422200 J15-080.                                                         00422200
422300*                                                                 00422300
422400     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-IEC.          00422400
422500*                                                                 00422500
422600 J15-EXIT.                                                        00422600
422700*                                                                 00422700
422800     EXIT.                                                        00422800
422900*                                                                 00422900
423000*                                                                 00423000
423100 J16-010.                                                         00423100
423200*                                                                 00423200
423300     SET W-PUNT-COTR TO 1.                                        00423300
423400     SEARCH W-TAB-COMP-TRIB-EL                                    00423400
423500            AT END MOVE ZERO TO W-FLAG-TROVATO                    00423500
423600     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00423600
423700          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00423700
423800                   W-DATA-RISC                                AND 00423800
423900          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00423900
424000                   W-DATA-RISC                                AND 00424000
424100          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00424100
424200          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'LEZ'           00424200
424300     MOVE 1                               TO W-FLAG-TROVATO.      00424300
424400*                                                                 00424400
424500     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00424500
424600*                                                                 00424600
424700     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00424700
424800*                                                                 00424800
424900 J16-020.                                                         00424900
425000*                                                                 00425000
425100*                                                                 00425100
425200     IF W-FLAG-TROVATO = 0                                        00425200
425300       GO TO J16-050.                                             00425300
425400*                                                                 00425400
425500 J16-030.                                                         00425500
425600*                                                                 00425600
425700*                                                                 00425700
425800 J16-040.                                                         00425800
425900*                                                                 00425900
426000     MOVE '1' TO W-FLAG-COMP-LEZ.                                 00426000
426100     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00426100
426200        W-IMP-RIMB > ZERO AND                                     00426200
426300        W-ANNO-RIFERIMENTO NOT LESS                               00426300
426400                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00426400
426500        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-LEZ                00426500
426600        MOVE '1' TO W-FLAG-RIF-LEZ-T                              00426600
426700     END-IF.                                                      00426700
426800*                                                                 00426800
426900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00426900
427000        W-IMP-RIMB > ZERO AND                                     00427000
427100        W-ANNO-RIFERIMENTO NOT LESS                               00427100
427200                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00427200
427300        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-LEZ                00427300
427400        MOVE '1' TO W-FLAG-RIF-LEZ-A                              00427400
427500     END-IF.                                                      00427500
427600*                                                                 00427600
427700     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00427700
427800        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00427800
427900          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00427900
428000         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00428000
428100          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00428100
428200         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00428200
428300          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00428300
428400        W-IMP-RIMB > ZERO                                         00428400
428500          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00428500
428600                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00428600
428700          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00428700
428800                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00428800
428900          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00428900
429000             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00429000
429100               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-LEZ         00429100
429200               MOVE '1' TO W-FLAG-RIF-LEZ-T                       00429200
429300          END-IF                                                  00429300
429400          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00429400
429500             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00429500
429600               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-LEZ         00429600
429700               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00429700
429800          END-IF                                                  00429800
429900     END-IF.                                                      00429900
430000*                                                                 00430000
430100     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00430100
430200        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00430200
430300        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00430300
430400        W-IMP-RIMB > ZERO                                         00430400
430500          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00430500
430600                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00430600
430700          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00430700
430800                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00430800
430900          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00430900
431000             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00431000
431100               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-LEZ         00431100
431200               MOVE '1' TO W-FLAG-RIF-LEZ-A                       00431200
431300          END-IF                                                  00431300
431400          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00431400
431500             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00431500
431600               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-LEZ         00431600
431700               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00431700
431800          END-IF                                                  00431800
431900     END-IF.                                                      00431900
432000*                                                                 00432000
432100 J16-050.                                                         00432100
432200*                                                                 00432200
432300     SET W-PUNT-COTR TO 1.                                        00432300
432400     SEARCH W-TAB-COMP-TRIB-EL                                    00432400
432500            AT END MOVE ZERO TO W-FLAG-TROVATO                    00432500
432600     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00432600
432700                                          = W-COD-TRIB AND        00432700
432800          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'LEZ'AND        00432800
432900          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00432900
433000                   W-DATA-RISC                         AND        00433000
433100          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00433100
433200                   W-DATA-RISC                         AND        00433200
433300          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00433300
433400     MOVE 1                               TO W-FLAG-TROVATO.      00433400
433500*                                                                 00433500
433600 J16-060.                                                         00433600
433700*                                                                 00433700
433800     IF W-FLAG-TROVATO = 0                                        00433800
433900       GO TO J16-EXIT.                                            00433900
434000*                                                                 00434000
434100 J16-070.                                                         00434100
434200*                                                                 00434200
434300*                                                                 00434300
434400 J16-080.                                                         00434400
434500*                                                                 00434500
434600     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-LEZ.          00434600
434700*                                                                 00434700
434800 J16-EXIT.                                                        00434800
434900*                                                                 00434900
435000     EXIT.                                                        00435000
435100*                                                                 00435100
435200 J17-010.                                                         00435200
435300*                                                                 00435300
435400     SET W-PUNT-COTR TO 1.                                        00435400
435500     SEARCH W-TAB-COMP-TRIB-EL                                    00435500
435600            AT END MOVE ZERO TO W-FLAG-TROVATO                    00435600
435700     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00435700
435800          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00435800
435900                   W-DATA-RISC                                AND 00435900
436000          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00436000
436100                   W-DATA-RISC                                AND 00436100
436200          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00436200
436300          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'BTC'           00436300
436400     MOVE 1                               TO W-FLAG-TROVATO.      00436400
436500*                                                                 00436500
436600     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00436600
436700*                                                                 00436700
436800     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00436800
436900*                                                                 00436900
437000 J17-020.                                                         00437000
437100*                                                                 00437100
437200*                                                                 00437200
437300     IF W-FLAG-TROVATO = 0                                        00437300
437400       GO TO J17-050.                                             00437400
437500*                                                                 00437500
437600 J17-030.                                                         00437600
437700*                                                                 00437700
437800*                                                                 00437800
437900 J17-040.                                                         00437900
438000*                                                                 00438000
438100     MOVE '1' TO W-FLAG-COMP-BTC.                                 00438100
438200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00438200
438300        W-IMP-RIMB > ZERO AND                                     00438300
438400        W-ANNO-RIFERIMENTO NOT LESS                               00438400
438500                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00438500
438600        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-BTC                00438600
438700        MOVE '1' TO W-FLAG-RIF-BTC-T                              00438700
438800     END-IF.                                                      00438800
438900*                                                                 00438900
439000     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00439000
439100        W-IMP-RIMB > ZERO AND                                     00439100
439200        W-ANNO-RIFERIMENTO NOT LESS                               00439200
439300                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00439300
439400        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-BTC                00439400
439500        MOVE '1' TO W-FLAG-RIF-BTC-A                              00439500
439600     END-IF.                                                      00439600
439700*                                                                 00439700
439800     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00439800
439900        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00439900
440000          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00440000
440100         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00440100
440200          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00440200
440300         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00440300
440400          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00440400
440500        W-IMP-RIMB > ZERO                                         00440500
440600          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00440600
440700                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00440700
440800          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00440800
440900                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00440900
441000          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00441000
441100             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00441100
441200               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-BTC         00441200
441300               MOVE '1' TO W-FLAG-RIF-BTC-T                       00441300
441400          END-IF                                                  00441400
441500          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00441500
441600             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00441600
441700               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-BTC         00441700
441800               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00441800
441900          END-IF                                                  00441900
442000     END-IF.                                                      00442000
442100*                                                                 00442100
442200     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00442200
442300        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00442300
442400        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00442400
442500        W-IMP-RIMB > ZERO                                         00442500
442600          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00442600
442700                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00442700
442800          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00442800
442900                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00442900
443000          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00443000
443100             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00443100
443200               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-BTC         00443200
443300               MOVE '1' TO W-FLAG-RIF-BTC-A                       00443300
443400          END-IF                                                  00443400
443500          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00443500
443600             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00443600
443700               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-BTC         00443700
443800               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00443800
443900          END-IF                                                  00443900
444000     END-IF.                                                      00444000
444100*                                                                 00444100
444200 J17-050.                                                         00444200
444300*                                                                 00444300
444400     SET W-PUNT-COTR TO 1.                                        00444400
444500     SEARCH W-TAB-COMP-TRIB-EL                                    00444500
444600            AT END MOVE ZERO TO W-FLAG-TROVATO                    00444600
444700     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00444700
444800                                          = W-COD-TRIB AND        00444800
444900          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'BTC'AND        00444900
445000          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00445000
445100                   W-DATA-RISC                         AND        00445100
445200          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00445200
445300                   W-DATA-RISC                         AND        00445300
445400          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00445400
445500     MOVE 1                               TO W-FLAG-TROVATO.      00445500
445600*                                                                 00445600
445700 J17-060.                                                         00445700
445800*                                                                 00445800
445900     IF W-FLAG-TROVATO = 0                                        00445900
446000       GO TO J17-EXIT.                                            00446000
446100*                                                                 00446100
446200 J17-070.                                                         00446200
446300*                                                                 00446300
446400*                                                                 00446400
446500 J17-080.                                                         00446500
446600*                                                                 00446600
446700     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-BTC.          00446700
446800*                                                                 00446800
446900 J17-EXIT.                                                        00446900
447000*                                                                 00447000
447100     EXIT.                                                        00447100
447200*                                                                 00447200
447300 J18-010.                                                         00447300
447400*                                                                 00447400
447500     SET W-PUNT-COTR TO 1.                                        00447500
447600     SEARCH W-TAB-COMP-TRIB-EL                                    00447600
447700            AT END MOVE ZERO TO W-FLAG-TROVATO                    00447700
447800     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR) = W-COD-TRIB  AND 00447800
447900          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR)       NOT >     00447900
448000                   W-DATA-RISC                                AND 00448000
448100          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)         NOT <     00448100
448200                   W-DATA-RISC                                AND 00448200
448300          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) = 'C'         AND 00448300
448400          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'QR1'           00448400
448500     MOVE 1                               TO W-FLAG-TROVATO.      00448500
448600*                                                                 00448600
448700     MOVE W-PERIODO-RIF           TO W-APPO-RIF-COMP.             00448700
448800*                                                                 00448800
448900     MOVE W-APPO-RIF-COMP-ANNO TO W-ANNO-RIFERIMENTO.             00448900
449000*                                                                 00449000
449100 J18-020.                                                         00449100
449200*                                                                 00449200
449300*                                                                 00449300
449400     IF W-FLAG-TROVATO = 0                                        00449400
449500       GO TO J18-050.                                             00449500
449600*                                                                 00449600
449700 J18-030.                                                         00449700
449800*                                                                 00449800
449900*                                                                 00449900
450000 J18-040.                                                         00450000
450100*                                                                 00450100
450200     MOVE '1' TO W-FLAG-COMP-QR1.                                 00450200
450300     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2010' AND        00450300
450400        W-IMP-RIMB > ZERO AND                                     00450400
450500        W-ANNO-RIFERIMENTO NOT LESS                               00450500
450600                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00450600
450700        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-QR1                00450700
450800        MOVE '1' TO W-FLAG-RIF-QR1-T                              00450800
450900     END-IF.                                                      00450900
451000*                                                                 00451000
451100     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) = '2009' AND        00451100
451200        W-IMP-RIMB > ZERO AND                                     00451200
451300        W-ANNO-RIFERIMENTO NOT LESS                               00451300
451400                           W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR)  00451400
451500        ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-QR1                00451500
451600        MOVE '1' TO W-FLAG-RIF-QR1-A                              00451600
451700     END-IF.                                                      00451700
451800*                                                                 00451800
451900     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00451900
452000        ((W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00452000
452100          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  0)       OR  00452100
452200         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  1    AND     00452200
452300          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1)       OR  00452300
452400         (W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2    AND     00452400
452500          W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  2))    AND   00452500
452600        W-IMP-RIMB > ZERO                                         00452600
452700          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00452700
452800                        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)   00452800
452900          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00452900
453000                        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)   00453000
453100          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00453100
453200             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00453200
453300               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-QR1         00453300
453400               MOVE '1' TO W-FLAG-RIF-QR1-T                       00453400
453500          END-IF                                                  00453500
453600          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00453600
453700             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00453700
453800               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-QR1         00453800
453900               MOVE '1' TO W-FLAG-RIF-T-AA-MIN                    00453900
454000          END-IF                                                  00454000
454100     END-IF.                                                      00454100
454200*                                                                 00454200
454300     IF W-TAB-COMP-TRIB-ANNO-RIF(W-PUNT-COTR) EQUAL SPACE AND     00454300
454400        W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR) =  2      AND     00454400
454500        W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR) =  1      AND     00454500
454600        W-IMP-RIMB > ZERO                                         00454600
454700          COMPUTE W-ANNO-RIF-1 = W-DATA-RISC-AA     -             00454700
454800                      W-TAB-COMP-TRIB-INIZ-INTER(W-PUNT-COTR)     00454800
454900          COMPUTE W-ANNO-RIF-2 = W-DATA-RISC-AA     -             00454900
455000                      W-TAB-COMP-TRIB-FINE-INTER(W-PUNT-COTR)     00455000
455100          IF W-ANNO-RIFERIMENTO NOT LESS    W-ANNO-RIF-1 AND      00455100
455200             W-ANNO-RIFERIMENTO NOT GREATER W-ANNO-RIF-2          00455200
455300               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-QR1         00455300
455400               MOVE '1' TO W-FLAG-RIF-QR1-A                       00455400
455500          END-IF                                                  00455500
455600          IF W-ANNO-RIFERIMENTO     LESS    W-ANNO-RIF-1 OR       00455600
455700             W-ANNO-RIFERIMENTO     GREATER W-ANNO-RIF-2          00455700
455800               ADD W-IMP-RIMB TO W-TOT-IMP-CRED-CONTR-QR1         00455800
455900               MOVE '1' TO W-FLAG-RIF-A-AA-MIN                    00455900
456000          END-IF                                                  00456000
456100     END-IF.                                                      00456100
456200*                                                                 00456200
456300 J18-050.                                                         00456300
456400*                                                                 00456400
456500     SET W-PUNT-COTR TO 1.                                        00456500
456600     SEARCH W-TAB-COMP-TRIB-EL                                    00456600
456700            AT END MOVE ZERO TO W-FLAG-TROVATO                    00456700
456800     WHEN W-TAB-COMP-TRIB-COD-TRIB(W-PUNT-COTR)                   00456800
456900                                          = W-COD-TRIB AND        00456900
457000          W-TAB-COMP-TRIB-COD-COMP(W-PUNT-COTR) = 'QR1'AND        00457000
457100          W-TAB-COMP-TRIB-INIZIO-VAL(W-PUNT-COTR) NOT >           00457100
457200                   W-DATA-RISC                         AND        00457200
457300          W-TAB-COMP-TRIB-FINE-VAL(W-PUNT-COTR)   NOT <           00457300
457400                   W-DATA-RISC                         AND        00457400
457500          W-TAB-COMP-TRIB-ESP-TRIB(W-PUNT-COTR) ='D'              00457500
457600     MOVE 1                               TO W-FLAG-TROVATO.      00457600
457700*                                                                 00457700
457800 J18-060.                                                         00457800
457900*                                                                 00457900
458000     IF W-FLAG-TROVATO = 0                                        00458000
458100       GO TO J18-EXIT.                                            00458100
458200*                                                                 00458200
458300 J18-070.                                                         00458300
458400*                                                                 00458400
458500*                                                                 00458500
458600 J18-080.                                                         00458600
458700*                                                                 00458700
458800     SUBTRACT W-IMP-PAGAM FROM W-TOT-IMP-CRED-CONTR-QR1.          00458800
458900*                                                                 00458900
459000 J18-EXIT.                                                        00459000
459100*                                                                 00459100
459200     EXIT.                                                        00459200
459300*                                                                 00459300
459400 B6-010-00T4AAAA.                                                 00459400
459500*                                                                 00459500
459600     SET W-PUNT-CAT-TRIB   TO 1.                                  00459600
459700     SEARCH W-TAB-CAT-TRIB-EL                                     00459700
459800        AT END MOVE ZERO TO W-FLAG-TROVATO                        00459800
459900     WHEN W-TAB-CAT-TRIB-ENTE(W-PUNT-CAT-TRIB)                    00459900
460000              EQUAL W-APPO-PER-RIF-XXXX                           00460000
460100     AND  W-TAB-CAT-TIPO-IMP(W-PUNT-CAT-TRIB)                     00460100
460200              EQUAL 'OBLAZIONE '                                  00460200
460300           MOVE 1 TO W-FLAG-TROVATO.                              00460300
460400*                                                                 00460400
460500 B6-020.                                                          00460500
460600*                                                                 00460600
460700*---   SI CONTROLLA SE NON E' STATO TROVATO IN TABELLA            00460700
460800*---   ERRORI SU PERIODO E SU FLAG (SEMPRE)                       00460800
460900*---                                                              00460900
461000     IF W-FLAG-TROVATO = ZERO                                     00461000
461100         MOVE 96                      TO W-ERR-PERIODO            00461100
461200         ADD 1                        TO W-CTR2                   00461200
461300         MOVE 'E'                     TO W-SEGNAL-PERIODO         00461300
461400         IF W-ERR-FLAG-PER  EQUAL ZERO                            00461400
461500             MOVE 24                  TO W-ERR-FLAG-PER           00461500
461600             ADD 1                    TO W-CTR2                   00461600
461700             MOVE 'E'                 TO W-SEGNAL-FLAG-PER        00461700
461800         END-IF                                                   00461800
461900         GO TO B6-990-EX                                          00461900
462000     END-IF.                                                      00462000
462100*                                                                 00462100
462200 B6-030.                                                          00462200
462300*---                                                              00462300
462400*---  CODICE TROVATO                                              00462400
462500*--- (GLI EVENTUALI ALTRI ERRORI SUL PERIODO DI RIFERIMENTO       00462500
462600*---  - SOLO SU ANNO - SONO FORZABILI IMPOSTANDO IL FLAG)         00462600
462700*---                                                              00462700
462800     IF W-APPO-PER-RIF-ANNO  GREATER    '1900'          AND       00462800
462900        W-APPO-PER-RIF-ANNO  NUMERIC                    AND       00462900
463000        W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1       00463000
463100        GO TO  B6-090.                                            00463100
463200 B6-040.                                                          00463200
463300*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00463300
463400*--- (ERRORE SOLO SU ANNO)                                        00463400
463500*---                                                              00463500
463600     IF W-FLAG-PER EQUAL '1'                                      00463600
463700       GO TO B6-080.                                              00463700
463800 B6-070.                                                          00463800
463900*---   ERRORI                                                     00463900
464000     MOVE 96                      TO W-ERR-PERIODO.               00464000
464100     ADD 1                        TO W-CTR2.                      00464100
464200     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00464200
464300     IF W-ERR-FLAG-PER EQUAL ZERO                                 00464300
464400       MOVE 24                      TO W-ERR-FLAG-PER             00464400
464500       ADD 1                        TO W-CTR2                     00464500
464600       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00464600
464700     GO TO B6-990-EX.                                             00464700
464800*                                                                 00464800
464900 B6-080.                                                          00464900
465000*                                                                 00465000
465100     GO TO B6-990-EX.                                             00465100
465200*---                                                              00465200
465300 B6-090.                                                          00465300
465400*---                                                              00465400
465500*---   IL CODICE TERRITORIALITA' ESISTE IN TABELLA                00465500
465600*---   E NON CI SONO ALTRI ERRORI                                 00465600
465700*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00465700
465800*---   RELATIVO AL PERIODO                                        00465800
465900*---                                                              00465900
466000     IF W-FLAG-PER NOT EQUAL '1'                                  00466000
466100       GO TO B6-990-EX.                                           00466100
466200 B6-100.                                                          00466200
466300*---   ERRORE NON BLOCCANTE                                       00466300
466400     ADD 1                        TO W-CTR1.                      00466400
466500     MOVE 24                      TO W-ERR-FLAG-PER.              00466500
466600     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00466600
466700*                                                                 00466700
466800 B6-990-EX.                                                       00466800
466900*                                                                 00466900
467000     EXIT.                                                        00467000
467100*                                                                 00467100
467200 T0-010.                                                          00467200
467300*                                                                 00467300
467400     SET W-PUNT-REGIONI    TO 1.                                  00467400
467500     SEARCH W-TAB-REGIONI-EL                                      00467500
467600        AT END MOVE ZERO TO W-FLAG-TROVATO                        00467600
467700     WHEN W-TAB-REGIONI-EL   (W-PUNT-REGIONI)                     00467700
467800              EQUAL W-APPO-PER-RIF-NU                             00467800
467900           MOVE 1 TO W-FLAG-TROVATO.                              00467900
468000*                                                                 00468000
468100 T0-020.                                                          00468100
468200*                                                                 00468200
468300*---   SI CONTROLLA SE NON E' STATO TROVATO IN TABELLA            00468300
468400*---   ERRORI SU PERIODO E SU FLAG (SEMPRE)                       00468400
468500*---                                                              00468500
468600     IF W-FLAG-TROVATO = ZERO                                     00468600
468700         MOVE 96                      TO W-ERR-PERIODO            00468700
468800         ADD 1                        TO W-CTR2                   00468800
468900         MOVE 'E'                     TO W-SEGNAL-PERIODO         00468900
469000         IF W-ERR-FLAG-PER  EQUAL ZERO                            00469000
469100             MOVE 24                  TO W-ERR-FLAG-PER           00469100
469200             ADD 1                    TO W-CTR2                   00469200
469300             MOVE 'E'                 TO W-SEGNAL-FLAG-PER        00469300
469400         END-IF                                                   00469400
469500         GO TO T0-990-EX                                          00469500
469600     END-IF.                                                      00469600
469700*                                                                 00469700
469800 T0-030.                                                          00469800
469900*---                                                              00469900
470000*---  CODICE TROVATO                                              00470000
470100*--- (GLI EVENTUALI ALTRI ERRORI SUL PERIODO DI RIFERIMENTO       00470100
470200*---  - SOLO SU ANNO - SONO FORZABILI IMPOSTANDO IL FLAG)         00470200
470300*---                                                              00470300
470400     IF W-APPO-PER-RIF-ANNO  GREATER    '1900'          AND       00470400
470500        W-APPO-PER-RIF-ANNO  NUMERIC                    AND       00470500
470600        W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1       00470600
470700        GO TO  T0-090.                                            00470700
470800 T0-040.                                                          00470800
470900*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00470900
471000*--- (ERRORE SOLO SU ANNO)                                        00471000
471100*---                                                              00471100
471200     IF W-FLAG-PER EQUAL '1'                                      00471200
471300       GO TO T0-080.                                              00471300
471400 T0-070.                                                          00471400
471500*---   ERRORI                                                     00471500
471600     MOVE 96                      TO W-ERR-PERIODO.               00471600
471700     ADD 1                        TO W-CTR2.                      00471700
471800     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00471800
471900     IF W-ERR-FLAG-PER EQUAL ZERO                                 00471900
472000       MOVE 24                      TO W-ERR-FLAG-PER             00472000
472100       ADD 1                        TO W-CTR2                     00472100
472200       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00472200
472300     GO TO T0-990-EX.                                             00472300
472400*                                                                 00472400
472500 T0-080.                                                          00472500
472600*                                                                 00472600
472700     GO TO T0-990-EX.                                             00472700
472800*---                                                              00472800
472900 T0-090.                                                          00472900
473000*---                                                              00473000
473100*---   IL CODICE TERRITORIALITA' ESISTE IN TABELLA                00473100
473200*---   E NON CI SONO ALTRI ERRORI                                 00473200
473300*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00473300
473400*---   RELATIVO AL PERIODO                                        00473400
473500*---                                                              00473500
473600     IF W-FLAG-PER NOT EQUAL '1'                                  00473600
473700       GO TO T0-990-EX.                                           00473700
473800 T0-100.                                                          00473800
473900*---   ERRORE NON BLOCCANTE                                       00473900
474000     ADD 1                        TO W-CTR1.                      00474000
474100     MOVE 24                      TO W-ERR-FLAG-PER.              00474100
474200     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00474200
474300*                                                                 00474300
474400 T0-990-EX.                                                       00474400
474500*                                                                 00474500
474600     EXIT.                                                        00474600
474700*                                                                 00474700
474800 T1-010.                                                          00474800
474900*                                                                 00474900
475000     SET W-PUNT-ENTE       TO 1.                                  00475000
475100     SEARCH W-TAB-ENTE-EL                                         00475100
475200        AT END MOVE ZERO TO W-FLAG-TROVATO                        00475200
475300     WHEN W-TAB-ENTE-COD     (W-PUNT-ENTE)                        00475300
475400              EQUAL W-APPO-PER-RIF-NU                             00475400
475500      AND W-TAB-ENTE-INIZ(W-PUNT-ENTE) NOT > BQVFB21-04-DATA-RISC 00475500
475600      AND W-TAB-ENTE-FINE(W-PUNT-ENTE) NOT < BQVFB21-04-DATA-RISC 00475600
475700           MOVE 1 TO W-FLAG-TROVATO.                              00475700
475800*                                                                 00475800
475900 T1-020.                                                          00475900
476000*                                                                 00476000
476100*---   SI CONTROLLA SE NON E' STATO TROVATO IN TABELLA            00476100
476200*---   ERRORI SU PERIODO E SU FLAG (SEMPRE)                       00476200
476300*---                                                              00476300
476400     IF W-FLAG-TROVATO = ZERO                                     00476400
476500         MOVE 96                      TO W-ERR-PERIODO            00476500
476600         ADD 1                        TO W-CTR2                   00476600
476700         MOVE 'E'                     TO W-SEGNAL-PERIODO         00476700
476800         IF W-ERR-FLAG-PER  EQUAL ZERO                            00476800
476900             MOVE 24                  TO W-ERR-FLAG-PER           00476900
477000             ADD 1                    TO W-CTR2                   00477000
477100             MOVE 'E'                 TO W-SEGNAL-FLAG-PER        00477100
477200         END-IF                                                   00477200
477300         GO TO T1-990-EX                                          00477300
477400     END-IF.                                                      00477400
477500*                                                                 00477500
477600 T1-030.                                                          00477600
477700*---                                                              00477700
477800*---  CODICE TROVATO                                              00477800
477900*--- (GLI EVENTUALI ALTRI ERRORI SUL PERIODO DI RIFERIMENTO       00477900
478000*---  - SOLO SU ANNO - SONO FORZABILI IMPOSTANDO IL FLAG)         00478000
478100*---                                                              00478100
478200     IF W-APPO-PER-RIF-ANNO  GREATER    '1900'          AND       00478200
478300        W-APPO-PER-RIF-ANNO  NUMERIC                    AND       00478300
478400        W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1       00478400
478500        GO TO  T1-090.                                            00478500
478600 T1-040.                                                          00478600
478700*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00478700
478800*--- (ERRORE SOLO SU ANNO)                                        00478800
478900*---                                                              00478900
479000     IF W-FLAG-PER EQUAL '1'                                      00479000
479100       GO TO T1-080.                                              00479100
479200 T1-070.                                                          00479200
479300*---   ERRORI                                                     00479300
479400     MOVE 96                      TO W-ERR-PERIODO.               00479400
479500     ADD 1                        TO W-CTR2.                      00479500
479600     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00479600
479700     IF W-ERR-FLAG-PER EQUAL ZERO                                 00479700
479800       MOVE 24                      TO W-ERR-FLAG-PER             00479800
479900       ADD 1                        TO W-CTR2                     00479900
480000       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00480000
480100     GO TO T1-990-EX.                                             00480100
480200*                                                                 00480200
480300 T1-080.                                                          00480300
480400*                                                                 00480400
480500     GO TO T1-990-EX.                                             00480500
480600*---                                                              00480600
480700 T1-090.                                                          00480700
480800*---                                                              00480800
480900*---   IL CODICE TERRITORIALITA' ESISTE IN TABELLA                00480900
481000*---   E NON CI SONO ALTRI ERRORI                                 00481000
481100*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00481100
481200*---   RELATIVO AL PERIODO                                        00481200
481300*---                                                              00481300
481400     IF W-FLAG-PER NOT EQUAL '1'                                  00481400
481500       GO TO T1-990-EX.                                           00481500
481600 T1-100.                                                          00481600
481700*---   ERRORE NON BLOCCANTE                                       00481700
481800     ADD 1                        TO W-CTR1.                      00481800
481900     MOVE 24                      TO W-ERR-FLAG-PER.              00481900
482000     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00482000
482100*                                                                 00482100
482200 T1-990-EX.                                                       00482200
482300*                                                                 00482300
482400     EXIT.                                                        00482400
482500*                                                                 00482500
482600 T2-010.                                                          00482600
482700*                                                                 00482700
482800     SET W-PUNT-PROV       TO 1.                                  00482800
482900     SEARCH W-TAB-PROV-EL                                         00482900
483000        AT END MOVE ZERO TO W-FLAG-TROVATO                        00483000
483100     WHEN W-TAB-PROV-EL      (W-PUNT-PROV)                        00483100
483200              EQUAL W-APPO-PER-RIF-NU                             00483200
483300           MOVE 1 TO W-FLAG-TROVATO.                              00483300
483400*                                                                 00483400
483500 T2-020.                                                          00483500
483600*                                                                 00483600
483700*---   SI CONTROLLA SE NON E' STATO TROVATO IN TABELLA            00483700
483800*---   ERRORI SU PERIODO E SU FLAG (SEMPRE)                       00483800
483900*---                                                              00483900
484000     IF W-FLAG-TROVATO = ZERO                                     00484000
484100         MOVE 96                      TO W-ERR-PERIODO            00484100
484200         ADD 1                        TO W-CTR2                   00484200
484300         MOVE 'E'                     TO W-SEGNAL-PERIODO         00484300
484400         IF W-ERR-FLAG-PER  EQUAL ZERO                            00484400
484500             MOVE 24                  TO W-ERR-FLAG-PER           00484500
484600             ADD 1                    TO W-CTR2                   00484600
484700             MOVE 'E'                 TO W-SEGNAL-FLAG-PER        00484700
484800         END-IF                                                   00484800
484900         GO TO T2-990-EX                                          00484900
485000     END-IF.                                                      00485000
485100*                                                                 00485100
485200 T2-030.                                                          00485200
485300*---                                                              00485300
485400*---  CODICE TROVATO                                              00485400
485500*--- (GLI EVENTUALI ALTRI ERRORI SUL PERIODO DI RIFERIMENTO       00485500
485600*---  - SOLO SU ANNO - SONO FORZABILI IMPOSTANDO IL FLAG)         00485600
485700*---                                                              00485700
485800     IF W-APPO-PER-RIF-ANNO  GREATER    '1900'          AND       00485800
485900        W-APPO-PER-RIF-ANNO  NUMERIC                    AND       00485900
486000        W-APPO-PER-RIF-ANNO NOT GREATER W-DATA-RISC-AA-PIU1       00486000
486100        GO TO  T2-090.                                            00486100
486200 T2-040.                                                          00486200
486300*--- PERIODO ERRATO: SI CONTROLLA IL FLAG RELATIVO AL PERIODO     00486300
486400*--- (ERRORE SOLO SU ANNO)                                        00486400
486500*---                                                              00486500
486600     IF W-FLAG-PER EQUAL '1'                                      00486600
486700       GO TO T2-080.                                              00486700
486800 T2-070.                                                          00486800
486900*---   ERRORI                                                     00486900
487000     MOVE 96                      TO W-ERR-PERIODO.               00487000
487100     ADD 1                        TO W-CTR2.                      00487100
487200     MOVE 'E'                     TO W-SEGNAL-PERIODO.            00487200
487300     IF W-ERR-FLAG-PER EQUAL ZERO                                 00487300
487400       MOVE 24                      TO W-ERR-FLAG-PER             00487400
487500       ADD 1                        TO W-CTR2                     00487500
487600       MOVE 'E'                     TO W-SEGNAL-FLAG-PER.         00487600
487700     GO TO T2-990-EX.                                             00487700
487800*                                                                 00487800
487900 T2-080.                                                          00487900
488000*                                                                 00488000
488100     GO TO T2-990-EX.                                             00488100
488200*---                                                              00488200
488300 T2-090.                                                          00488300
488400*---                                                              00488400
488500*---   IL CODICE TERRITORIALITA' ESISTE IN TABELLA                00488500
488600*---   E NON CI SONO ALTRI ERRORI                                 00488600
488700*---   SI CONTROLLA SE ERA STATO SEGNALATO UN ERRORE NEL FLAG     00488700
488800*---   RELATIVO AL PERIODO                                        00488800
488900*---                                                              00488900
489000     IF W-FLAG-PER NOT EQUAL '1'                                  00489000
489100       GO TO T2-990-EX.                                           00489100
489200 T2-100.                                                          00489200
489300*---   ERRORE NON BLOCCANTE                                       00489300
489400     ADD 1                        TO W-CTR1.                      00489400
489500     MOVE 24                      TO W-ERR-FLAG-PER.              00489500
489600     MOVE 'W'                     TO W-SEGNAL-FLAG-PER.           00489600
489700*                                                                 00489700
489800 T2-990-EX.                                                       00489800
489900*                                                                 00489900
490000     EXIT.                                                        00490000
490100*                                                                 00490100
490200 T7-010.                                                          00490200
490300*                                                                 00490300
490400*                                                                 00490400
490500 T7-990-EX.                                                       00490500
490600*                                                                 00490600
490700     EXIT.                                                        00490700
490800*---                                                              00490800
490900 CONTR-UFF-010.                                                   00490900
491000*---                                                              00491000
491100     SET W-PUNT-UFF TO 1.                                         00491100
491200     SEARCH W-TAB-UFF-EL                                          00491200
491300            AT END MOVE ZERO TO W-FLAG-TROVATO                    00491300
491400     WHEN W-TAB-UFF-COD(W-PUNT-UFF)     = W-UFFICIO-RIF   AND     00491400
491500          W-TAB-UFF-INI-VAL(W-PUNT-UFF) NOT > W-DATA-RISC AND     00491500
491600          W-TAB-UFF-FINE-VAL(W-PUNT-UFF) NOT < W-DATA-RISC        00491600
491700     MOVE W-TAB-UFF-KEY(W-PUNT-UFF)     TO W-KEY-UFF-OUT          00491700
491800     MOVE 1                                TO W-FLAG-TROVATO.     00491800
491900*---                                                              00491900
492000*---  TROVATO                                                     00492000
492100     IF W-FLAG-TROVATO = 1                                        00492100
492200        GO TO CONTR-UFF-EXIT.                                     00492200
492300*---                                                              00492300
492400 CONTR-UFF-020.                                                   00492400
492500*---                                                              00492500
492600     MOVE 'KO'                    TO W-UFF-KO.                    00492600
492700*---                                                              00492700
492800*---   IL CODICE UFFICIO                                          00492800
492900*---   NON ESISTE IN BASE INFORMATIVA;                            00492900
493000*---   SI CONTROLLA SE L'ERRORE ERA STATO SEGNALATO NEL FLAG      00493000
493100*---   RELATIVO AL CODICE UFFICIO                                 00493100
493200*---                                                              00493200
493300     IF W-FLAG-ERR-UFFICIO EQUAL '1'                              00493300
493400        GO TO CONTR-UFF-EXIT.                                     00493400
493500*---                                                              00493500
493600 CONTR-UFF-030.                                                   00493600
493700*---   ERRORI                                                     00493700
493800*---                                                              00493800
493900     MOVE 504                     TO W-ERR-UFFICIO-RIF.           00493900
494000     ADD 1                        TO W-CTR2                       00494000
494100     MOVE 'E'                     TO W-SEGNAL-UFF-RIF.            00494100
494200*---                                                              00494200
494300*--- CONTROLLO SE IL CAMPO ERRORE DEL FLAG                        00494300
494400*--- E' IMPOSTATO O NO.                                           00494400
494500     IF W-ERR-FLAG-ERR-UFFICIO EQUAL ZERO                         00494500
494600        MOVE 24                      TO W-ERR-FLAG-ERR-UFFICIO    00494600
494700        ADD 1                        TO W-CTR2                    00494700
494800        MOVE 'E'                     TO W-SEGNAL-FLAG-ERR-UFF.    00494800
494900*---                                                              00494900
495000 CONTR-UFF-EXIT.                                                  00495000
495100*---                                                              00495100
495200     EXIT.                                                        00495200
495300*---                                                              00495300
495400 CONTR-ATTO-010.                                                  00495400
495500*---                                                              00495500
495600*--- CONTROLLO FORMALE DEL CAMPO NUMERO RIFERIMENTO               00495600
495700*---                                                              00495700
495800     MOVE SPACE                TO  W-BQVFB3-COD-FISC.             00495800
495900     MOVE W-NUMERO-RIF         TO  W-BQVFB3-COD-FISC.             00495900
496000     CALL 'BQVFB3'        USING    W-PARAM-BQVFB3.                00496000
496100*---                                                              00496100
496200     IF W-BQVFB3-COD-RIT  EQUAL    ZERO                           00496200
496300        GO TO CONTR-ATTO-EXIT.                                    00496300
496400*---                                                              00496400
496500 CONTR-ATTO-020.                                                  00496500
496600*---                                                              00496600
496700*---   IL NUMERO RIFERIMENTO                                      00496700
496800*---   NON E' CORRETTO                                            00496800
496900*---   SI CONTROLLA SE L'ERRORE ERA STATO SEGNALATO NEL FLAG      00496900
497000*---   RELATIVO AL NUMERO RIFERIMENTO                             00497000
497100*---                                                              00497100
497200     MOVE 'KO'                    TO W-NUM-KO.                    00497200
497300*---                                                              00497300
497400     MOVE '1'                     TO W-NUM-RIF-KO.                00497400
497500     IF W-FLAG-ERR-NUMERO  EQUAL '1'                              00497500
497600        GO TO CONTR-ATTO-EXIT.                                    00497600
497700 CONTR-ATTO-030.                                                  00497700
497800*---   ERRORI                                                     00497800
497900     MOVE 36                      TO W-ERR-NUMERO-RIF.            00497900
498000     ADD 1                        TO W-CTR2.                      00498000
498100     MOVE 'E'                     TO W-SEGNAL-NUM-RIF.            00498100
498200*---                                                              00498200
498300*--- CONTROLLO SE IL CAMPO ERRORE DEL FLAG                        00498300
498400*--- E' IMPOSTATO O NO.                                           00498400
498500     IF W-ERR-FLAG-ERR-NUMERO EQUAL ZERO                          00498500
498600       MOVE 24                      TO W-ERR-FLAG-ERR-NUMERO      00498600
498700       ADD 1                        TO W-CTR2                     00498700
498800       MOVE 'E'                     TO W-SEGNAL-FLAG-ERR-NUM.     00498800
498900*---                                                              00498900
499000 CONTR-ATTO-EXIT.                                                 00499000
499100*---                                                              00499100
499200     EXIT.                                                        00499200
499300*---                                                              00499300
